{"version":3,"file":"content.ts.js","sources":["../../node_modules/@abraham/reflection/dist/index.js","../../node_modules/tslib/tslib.es6.mjs","../../node_modules/rxjs/dist/esm5/internal/util/isFunction.js","../../node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js","../../node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js","../../node_modules/rxjs/dist/esm5/internal/util/arrRemove.js","../../node_modules/rxjs/dist/esm5/internal/Subscription.js","../../node_modules/rxjs/dist/esm5/internal/config.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js","../../node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js","../../node_modules/rxjs/dist/esm5/internal/util/noop.js","../../node_modules/rxjs/dist/esm5/internal/util/errorContext.js","../../node_modules/rxjs/dist/esm5/internal/Subscriber.js","../../node_modules/rxjs/dist/esm5/internal/symbol/observable.js","../../node_modules/rxjs/dist/esm5/internal/util/identity.js","../../node_modules/rxjs/dist/esm5/internal/util/pipe.js","../../node_modules/rxjs/dist/esm5/internal/Observable.js","../../node_modules/rxjs/dist/esm5/internal/util/lift.js","../../node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js","../../node_modules/rxjs/dist/esm5/internal/util/ObjectUnsubscribedError.js","../../node_modules/rxjs/dist/esm5/internal/Subject.js","../../node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/dateTimestampProvider.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/Action.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/intervalProvider.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/AsyncAction.js","../../node_modules/rxjs/dist/esm5/internal/Scheduler.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/AsyncScheduler.js","../../node_modules/rxjs/dist/esm5/internal/scheduler/async.js","../../node_modules/rxjs/dist/esm5/internal/observable/empty.js","../../node_modules/rxjs/dist/esm5/internal/util/isScheduler.js","../../node_modules/rxjs/dist/esm5/internal/util/args.js","../../node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js","../../node_modules/rxjs/dist/esm5/internal/util/isPromise.js","../../node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js","../../node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js","../../node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js","../../node_modules/rxjs/dist/esm5/internal/symbol/iterator.js","../../node_modules/rxjs/dist/esm5/internal/util/isIterable.js","../../node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js","../../node_modules/rxjs/dist/esm5/internal/observable/innerFrom.js","../../node_modules/rxjs/dist/esm5/internal/util/executeSchedule.js","../../node_modules/rxjs/dist/esm5/internal/operators/observeOn.js","../../node_modules/rxjs/dist/esm5/internal/operators/subscribeOn.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js","../../node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js","../../node_modules/rxjs/dist/esm5/internal/observable/from.js","../../node_modules/rxjs/dist/esm5/internal/observable/of.js","../../node_modules/rxjs/dist/esm5/internal/util/EmptyError.js","../../node_modules/rxjs/dist/esm5/internal/firstValueFrom.js","../../node_modules/rxjs/dist/esm5/internal/util/isDate.js","../../node_modules/rxjs/dist/esm5/internal/operators/timeout.js","../../node_modules/rxjs/dist/esm5/internal/operators/map.js","../../node_modules/rxjs/dist/esm5/internal/util/mapOneOrManyArgs.js","../../node_modules/rxjs/dist/esm5/internal/util/argsArgArrayOrObject.js","../../node_modules/rxjs/dist/esm5/internal/util/createObject.js","../../node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js","../../node_modules/rxjs/dist/esm5/internal/operators/mergeInternals.js","../../node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js","../../node_modules/rxjs/dist/esm5/internal/operators/mergeAll.js","../../node_modules/rxjs/dist/esm5/internal/operators/concatAll.js","../../node_modules/rxjs/dist/esm5/internal/observable/concat.js","../../node_modules/rxjs/dist/esm5/internal/observable/forkJoin.js","../../node_modules/rxjs/dist/esm5/internal/observable/timer.js","../../node_modules/rxjs/dist/esm5/internal/observable/interval.js","../../node_modules/rxjs/dist/esm5/internal/observable/merge.js","../../node_modules/rxjs/dist/esm5/internal/util/argsOrArgArray.js","../../node_modules/rxjs/dist/esm5/internal/operators/filter.js","../../node_modules/rxjs/dist/esm5/internal/operators/bufferTime.js","../../node_modules/rxjs/dist/esm5/internal/operators/catchError.js","../../node_modules/rxjs/dist/esm5/internal/operators/scanInternals.js","../../node_modules/rxjs/dist/esm5/internal/operators/combineLatest.js","../../node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js","../../node_modules/rxjs/dist/esm5/internal/operators/concatMap.js","../../node_modules/rxjs/dist/esm5/internal/operators/debounce.js","../../node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js","../../node_modules/rxjs/dist/esm5/internal/operators/take.js","../../node_modules/rxjs/dist/esm5/internal/operators/mapTo.js","../../node_modules/rxjs/dist/esm5/internal/operators/delayWhen.js","../../node_modules/rxjs/dist/esm5/internal/operators/delay.js","../../node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js","../../node_modules/rxjs/dist/esm5/internal/operators/exhaustMap.js","../../node_modules/rxjs/dist/esm5/internal/operators/merge.js","../../node_modules/rxjs/dist/esm5/internal/operators/mergeWith.js","../../node_modules/rxjs/dist/esm5/internal/operators/pairwise.js","../../node_modules/rxjs/dist/esm5/internal/operators/repeat.js","../../node_modules/rxjs/dist/esm5/internal/operators/scan.js","../../node_modules/rxjs/dist/esm5/internal/operators/skip.js","../../node_modules/rxjs/dist/esm5/internal/operators/startWith.js","../../node_modules/rxjs/dist/esm5/internal/operators/switchMap.js","../../node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js","../../node_modules/rxjs/dist/esm5/internal/operators/tap.js","../../node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js","../../src/content/core/interceptor/interceptor.ts","../../node_modules/svelte/src/runtime/internal/await_block.js","../../node_modules/svelte/src/runtime/internal/each.js","../../node_modules/svelte/src/runtime/internal/spread.js","../../node_modules/svelte/src/runtime/store/index.js","../../src/util/store/fromObservable.ts","../../src/lib/checkbox/checkbox.svelte","../../src/lib/settings/boolean-setting-input.svelte","../../src/lib/settings/numeric-setting-input.svelte","../../src/lib/settings/choice-setting-input.svelte","../../src/lib/settings/text-setting-input.svelte","../../src/content/core/settings/setting.ts","../../node_modules/inversify/es/constants/metadata_keys.js","../../node_modules/inversify/es/constants/literal_types.js","../../node_modules/inversify/es/utils/id.js","../../node_modules/inversify/es/bindings/binding.js","../../node_modules/inversify/es/constants/error_msgs.js","../../node_modules/inversify/es/planning/metadata_reader.js","../../node_modules/inversify/es/bindings/binding_count.js","../../node_modules/inversify/es/utils/exceptions.js","../../node_modules/inversify/es/utils/serialization.js","../../node_modules/inversify/es/planning/context.js","../../node_modules/inversify/es/planning/metadata.js","../../node_modules/inversify/es/planning/plan.js","../../node_modules/inversify/es/annotation/lazy_service_identifier.js","../../node_modules/inversify/es/planning/queryable_string.js","../../node_modules/inversify/es/planning/target.js","../../node_modules/inversify/es/planning/reflection_utils.js","../../node_modules/inversify/es/planning/request.js","../../node_modules/inversify/es/planning/planner.js","../../node_modules/inversify/es/utils/async.js","../../node_modules/inversify/es/scope/scope.js","../../node_modules/inversify/es/utils/factory_type.js","../../node_modules/inversify/es/utils/binding_utils.js","../../node_modules/inversify/es/resolution/instantiation.js","../../node_modules/inversify/es/resolution/resolver.js","../../node_modules/inversify/es/syntax/constraint_helpers.js","../../node_modules/inversify/es/syntax/binding_when_syntax.js","../../node_modules/inversify/es/syntax/binding_on_syntax.js","../../node_modules/inversify/es/syntax/binding_when_on_syntax.js","../../node_modules/inversify/es/syntax/binding_in_syntax.js","../../node_modules/inversify/es/syntax/binding_in_when_on_syntax.js","../../node_modules/inversify/es/syntax/binding_to_syntax.js","../../node_modules/inversify/es/container/container_snapshot.js","../../node_modules/inversify/es/utils/clonable.js","../../node_modules/inversify/es/container/lookup.js","../../node_modules/inversify/es/container/module_activation_store.js","../../node_modules/inversify/es/container/container.js","../../node_modules/inversify/es/utils/js.js","../../node_modules/inversify/es/annotation/decorator_utils.js","../../node_modules/inversify/es/annotation/injectable.js","../../node_modules/inversify/es/annotation/inject_base.js","../../node_modules/inversify/es/annotation/inject.js","../../node_modules/inversify/es/annotation/property_event_decorator.js","../../node_modules/inversify/es/annotation/post_construct.js","../../src/content/core/logger/logging.service.ts","../../src/content/core/event/applicationEvent.ts","../../src/content/core/logger/loggerFactory.interface.ts","../../src/content/core/event/events.service.ts","../../src/content/core/event/eventProcessor.ts","../../src/content/core/event/eventListener.ts","../../src/content/events/canvas-cleared.event.ts","../../src/content/core/commands/results/interpretable-result.ts","../../src/content/core/commands/results/interpretable-success.ts","../../src/content/core/commands/builder/deferred-interpretable-builder.ts","../../src/content/core/commands/results/interpretable-defer-result.ts","../../src/content/core/commands/builder/command-params-builder.ts","../../src/content/core/commands/results/interpretable-error.ts","../../src/content/core/commands/results/interpretable-command-partial-match.ts","../../src/content/core/commands/command.ts","../../src/content/core/commands/commands.service.ts","../../src/content/core/hotkeys/hotkeys.service.ts","../../src/content/core/tooltips/tooltips.service.ts","../../src/content/core/feature/feature.ts","../../src/content/core/logger/logger.service.ts","../../src/content/core/setup/setup.ts","../../src/util/document/appendElement.ts","../../src/content/core/setup/earlySetup.decorator.ts","../../src/content/setups/game-patch-ready/game-patch-ready.setup.ts","../../src/content/setups/chat-controls/chat-controls.setup.ts","../../src/content/core/hotkeys/hotkey.ts","../../src/content/services/global-settings/global-settings.service.ts","../../src/content/setups/controls/controls.svelte","../../src/content/setups/controls/controls.setup.ts","../../src/content/setups/customizer-actions/customizer-actions.svelte","../../src/content/setups/customizer-actions/customizer-actions.setup.ts","../../src/content/setups/skribbl-initialized/skribbl-initialized.setup.ts","../../src/content/setups/toast/toast.setup.ts","../../src/content/setups/panel/panel-tabs.svelte","../../src/content/setups/panel/panel.setup.ts","../../src/content/setups/toolbar/toolbar.setup.ts","../../src/content/setups/elements/elements.setup.ts","../../src/content/events/chat-typed.event.ts","../../src/content/events/color-changed.event.ts","../../src/content/setups/skribbl-emit-relay/skribbl-emit-relay.setup.ts","../../src/content/setups/skribbl-message-relay/skribbl-message-relay.setup.ts","../../src/content/events/draw.event.ts","../../src/content/events/hints-added.event.ts","../../src/content/events/image-reset.event.ts","../../src/util/skribbl/lobbyInteraction.ts","../../src/content/events/lobby-interacted.event.ts","../../src/content/events/lobby-player-changed.event.ts","../../src/util/arrayChunk.ts","../../src/util/skribbl/lobbyState.ts","../../src/content/setups/game-settings/game-settings.setup.ts","../../src/content/events/lobby-state-changed.event.ts","../../src/content/events/message-received.event.ts","../../src/content/events/message-sent.event.ts","../../src/content/events/player-popup-visible.event.ts","../../src/content/events/round-started.event.ts","../../src/content/events/scoreboard-visible.event.ts","../../src/content/events/size-changed.event.ts","../../src/content/events/text-overlay-visible.event.ts","../../src/content/events/tool-changed.event.ts","../../src/content/events/word-guessed.event.ts","../../src/content/features/canvas-rate-icons/canvas-rate-icons.feature.ts","../../src/content/events/lobby-left.event.ts","../../src/util/skribbl/lobby.ts","../../src/content/events/lobby-joined.event.ts","../../src/content/services/lobby/lobby.service.ts","../../src/lib/bounceload/bounceload.svelte","../../src/lib/icon-button/icon-button.svelte","../../src/content/services/toast/toast.svelte","../../src/content/services/toast/toast.service.ts","../../src/content/setups/prioritized-canvas-events/prioritized-canvas-events.setup.ts","../../src/content/features/canvas-zoom/canvas-zoom-info.svelte","../../src/content/features/canvas-zoom/canvas-zoom.feature.ts","../../src/util/document/replaceOrAddCssRule.ts","../../src/content/services/players/skribblLandingPlayer.ts","../../src/content/services/players/skribblLobbyPlayer.ts","../../src/api/runtime.ts","../../src/api/models/AccessTokenDto.ts","../../src/api/models/AnnouncementDto.ts","../../src/api/models/AwardDto.ts","../../src/api/models/AwardInventoryDto.ts","../../src/api/models/CloudDeleteDto.ts","../../src/api/models/CloudImageDto.ts","../../src/api/models/CloudSearchDto.ts","../../src/api/models/CloudUploadDto.ts","../../src/api/models/CloudUploadedDto.ts","../../src/api/models/EmojiCandidateDto.ts","../../src/api/models/EmojiDto.ts","../../src/api/models/EventDto.ts","../../src/api/models/EventDropDto.ts","../../src/api/models/GuildDto.ts","../../src/api/models/GuildInviteDto.ts","../../src/api/models/MemberDto.ts","../../src/api/models/MemberSearchDto.ts","../../src/api/models/MemberWebhookDto.ts","../../src/api/models/PostImageDto.ts","../../src/api/models/SceneThemeDto.ts","../../src/api/models/SceneDto.ts","../../src/api/models/SceneInventoryItemDto.ts","../../src/api/models/SceneInventoryDto.ts","../../src/api/models/SetActiveSceneDto.ts","../../src/api/models/SpriteSlotDto.ts","../../src/api/models/SpriteComboDto.ts","../../src/api/models/SpriteDto.ts","../../src/api/models/SpriteInventoryDto.ts","../../src/api/models/SpriteSlotCountDto.ts","../../src/api/models/ThemeMetaDto.ts","../../src/api/models/ThemeDto.ts","../../src/api/models/ThemeListingDto.ts","../../src/api/models/ThemePublishRequestDto.ts","../../src/api/models/ThemeShareDto.ts","../../src/api/models/ThemeUpdateRequestDto.ts","../../src/api/models/UpdateDiscordID.ts","../../src/api/apis/AnnouncementsApi.ts","../../src/api/apis/AwardsApi.ts","../../src/api/apis/CloudApi.ts","../../src/api/apis/EmojisApi.ts","../../src/api/apis/EventsApi.ts","../../src/api/apis/GuildsApi.ts","../../src/api/apis/InventoryApi.ts","../../src/api/apis/MembersApi.ts","../../src/api/apis/ScenesApi.ts","../../src/api/apis/SpritesApi.ts","../../src/api/apis/ThemesApi.ts","../../src/content/core/token/token.service.ts","../../src/content/services/api/api.service.ts","../../src/content/services/member/member.service.ts","../../src/content/services/players/skribblOverlayPlayer.ts","../../src/content/services/players/skribblPopupPlayer.ts","../../src/content/services/players/skribblScoreboardPodiumPlayer.ts","../../src/content/services/players/skribblScoreboardRegularPlayer.ts","../../src/content/setups/landing-player/landing-player.setup.ts","../../src/util/typo/lobbyKey.ts","../../src/content/services/players/players.service.ts","../../src/content/services/chat/message.svelte","../../src/content/services/chat/chat.service.ts","../../src/content/features/chat-clear/chat-clear.feature.ts","../../src/content/core/commands/results/interpretable-empty-remainder.ts","../../src/content/core/commands/command-parameter.ts","../../src/content/core/commands/params/string-command-parameter.ts","../../src/content/core/commands/results/interpretable-argument-parsing-error.ts","../../src/content/core/commands/results/interpretable-silent-success.ts","../../src/lib/area-flyout/area-flyout.svelte","../../src/content/features/chat-commands/command-preview.svelte","../../src/content/features/chat-commands/command-input.svelte","../../src/content/features/chat-commands/chat-commands.feature.ts","../../src/content/features/chat-copy-formatted/chat-copy-formatted.feature.ts","../../src/util/promiseAllObject.ts","../../src/content/setups/api-data/api-data.setup.ts","../../src/content/features/chat-emojis/chat-emojis.svelte","../../src/content/features/chat-emojis/emoji-picker.svelte","../../src/content/features/chat-emojis/chat-emojis.feature.ts","../../src/content/features/chat-focus/chat-focus-info.svelte","../../src/content/features/chat-focus/chat-focus.feature.ts","../../src/content/features/chat-message-splits/chat-message-splits.feature.ts","../../src/content/features/chat-profile-link/chat-profile-link.feature.ts","../../src/content/core/commands/params/numeric-optional-command-parameter.ts","../../src/content/core/commands/params/string-optional-command-parameter.ts","../../src/content/services/lobby-interactions/lobby-interactions.service.ts","../../src/lib/flat-button/flat-button.svelte","../../src/content/features/chat-quick-react/quick-react.svelte","../../src/content/features/chat-quick-react/chat-quick-react.feature.ts","../../src/content/features/chat-recall/chat-recall.feature.ts","../../src/util/imageData.ts","../../src/content/services/drawing/drawing.service.ts","../../src/content/services/image-finished/image-finished.service.ts","../../src/content/features/controls-cloud/cloud.service.ts","../../src/util/skribbl/skd.ts","../../src/content/features/toolbar-imagelab/imagelab.service.ts","../../src/content/features/toolbar-imagepost/image-post.service.ts","../../src/content/services/modal/modal-document.svelte","../../src/content/services/modal/modal-card.svelte","../../src/content/services/modal/modal.service.ts","../../src/util/download.ts","../../src/util/typo/getCloudCommands.ts","../../src/util/typo/getCloudMeta.ts","../../src/content/features/controls-cloud/controls-cloud.svelte","../../src/content/features/controls-cloud/controls-cloud.feature.ts","../../src/content/core/feature/features.service.ts","../../src/content/features/controls-settings/controls-settings-hotkey.svelte","../../src/content/features/controls-settings/controls-settings-command.svelte","../../src/content/features/controls-settings/controls-settings-details.svelte","../../src/content/features/controls-settings/controls-settings-feature.svelte","../../src/content/features/controls-settings/controls-settings.svelte","../../src/content/features/controls-settings/controls-settings.feature.ts","../../src/util/typo/themes/colors.ts","../../src/util/typo/themes/theme.ts","../../src/util/typo/themes/convertOldTheme.ts","../../src/content/services/themes/themes.service.ts","../../src/util/typo/themes/cssVariableSelectorHooks.ts","../../src/content/setups/css-color-var-selectors/cssColorVarSelectors.setup.ts","../../src/util/typo/themes/colorScheme.ts","../../src/util/typo/themes/generateThemeBackgroundElement.ts","../../src/util/stringHasContent.ts","../../src/util/typo/themes/generateThemeCssElement.ts","../../src/util/typo/themes/generateThemeExternalCssElement.ts","../../src/util/typo/themes/generateThemeFontElement.ts","../../src/util/typo/themes/generateThemeHtmlElement.ts","../../src/content/features/controls-themes/themes-browser.svelte","../../src/lib/color-picker/color-picker.svelte","../../src/lib/color-picker/color-picker-button.svelte","../../src/content/features/controls-themes/themes-editor.svelte","../../src/content/features/controls-themes/themes-list.svelte","../../src/content/features/controls-themes/controls-themes.svelte","../../src/content/features/controls-themes/controls-themes.feature.ts","../../src/content/features/customizer-outfit-toggle/customizer-outfit-toggle.feature.ts","../../src/content/features/customizer-practice-join/customizer-practice-join.feature.ts","../../src/content/services/tools/draw-mod.ts","../../src/content/core/extension-container/extension-container.ts","../../src/content/services/tools/constant-draw-mod.ts","../../src/content/services/tools/coordinateListener.ts","../../src/content/services/tools/draw-tool.ts","../../src/content/services/tools/tools.service.ts","../../src/content/features/drawing-brush-lab/mods/mandala-mod.ts","../../src/content/features/drawing-brush-lab/mods/noise-mod.ts","../../src/content/features/drawing-brush-lab/mods/parallel-line-mod.ts","../../src/content/features/drawing-brush-lab/mods/rainbow-mod.ts","../../src/content/features/drawing-color-palettes/default-palettes.ts","../../src/content/services/colors/colors.service.ts","../../src/content/features/drawing-brush-lab/mods/random-color-mod.ts","../../src/content/features/drawing-brush-lab/mods/sculpt-mod.ts","../../src/content/features/drawing-brush-lab/mods/tilt-mod.ts","../../src/content/features/drawing-brush-lab/tools/dash-tool.ts","../../src/content/features/drawing-brush-lab/tools/dot-tool.ts","../../src/content/features/drawing-brush-lab/tools/grid-tool.ts","../../src/content/features/drawing-brush-lab/drawing-brush-lab-info.svelte","../../src/content/features/drawing-brush-lab/drawing-brush-lab-switch.svelte","../../src/content/features/drawing-brush-lab/drawing-brush-lab-group.svelte","../../src/content/features/drawing-brush-lab/drawing-brush-lab-manage.svelte","../../src/content/features/drawing-brush-lab/drawing-brush-lab.feature.ts","../../src/content/features/drawing-color-palettes/drawing-color-palettes-info.svelte","../../src/content/features/drawing-color-palettes/color-palette-builder.svelte","../../src/content/features/drawing-color-palettes/drawing-color-palettes-manage.svelte","../../src/content/features/drawing-color-palettes/color-palette-picker.svelte","../../src/content/features/drawing-color-palettes/drawing-color-palettes.feature.ts","../../src/content/features/drawing-color-tools/pipette-tool.ts","../../src/content/features/drawing-color-tools/drawing-color-tools-info.svelte","../../src/content/features/drawing-color-tools/drawing-color-tools.svelte","../../src/content/features/drawing-color-tools/drawing-color-tools.feature.ts","../../src/util/typo/pressure.ts","../../src/content/features/drawing-pressure/pressure-mod.ts","../../src/content/features/drawing-pressure/drawing-pressure-info.svelte","../../src/content/features/drawing-pressure/drawing-pressure.feature.ts","../../src/signalr/TypedSignalR.Client/index.ts","../../node_modules/@microsoft/signalr/dist/esm/Errors.js","../../node_modules/@microsoft/signalr/dist/esm/HttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/ILogger.js","../../node_modules/@microsoft/signalr/dist/esm/Loggers.js","../../node_modules/@microsoft/signalr/dist/esm/Utils.js","../../node_modules/@microsoft/signalr/dist/esm/FetchHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/XhrHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/DefaultHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/TextMessageFormat.js","../../node_modules/@microsoft/signalr/dist/esm/HandshakeProtocol.js","../../node_modules/@microsoft/signalr/dist/esm/IHubProtocol.js","../../node_modules/@microsoft/signalr/dist/esm/Subject.js","../../node_modules/@microsoft/signalr/dist/esm/MessageBuffer.js","../../node_modules/@microsoft/signalr/dist/esm/HubConnection.js","../../node_modules/@microsoft/signalr/dist/esm/DefaultReconnectPolicy.js","../../node_modules/@microsoft/signalr/dist/esm/HeaderNames.js","../../node_modules/@microsoft/signalr/dist/esm/AccessTokenHttpClient.js","../../node_modules/@microsoft/signalr/dist/esm/ITransport.js","../../node_modules/@microsoft/signalr/dist/esm/AbortController.js","../../node_modules/@microsoft/signalr/dist/esm/LongPollingTransport.js","../../node_modules/@microsoft/signalr/dist/esm/ServerSentEventsTransport.js","../../node_modules/@microsoft/signalr/dist/esm/WebSocketTransport.js","../../node_modules/@microsoft/signalr/dist/esm/HttpConnection.js","../../node_modules/@microsoft/signalr/dist/esm/JsonHubProtocol.js","../../node_modules/@microsoft/signalr/dist/esm/HubConnectionBuilder.js","../../src/content/services/socket/socket.service.ts","../../src/content/features/lobby-status/lobby-connection.service.ts","../../src/util/signalr/parseErrorOrThrow.ts","../../src/content/features/drops/drops.svelte","../../src/content/features/drops/drops-info.svelte","../../src/content/features/drops/drops.feature.ts","../../src/content/features/guess-check/guess-overlay.ts","../../src/content/features/guess-check/guess-check.svelte","../../src/content/features/guess-check/guess-check.feature.ts","../../src/content/features/hotkeys/hotkeys.feature.ts","../../src/content/features/image-agent/image-agent.svelte","../../src/content/features/image-agent/image-agent.feature.ts","../../src/content/features/line-tool/line-tool-info.svelte","../../src/content/features/line-tool/line-tool.feature.ts","../../src/util/rxjs/repeatAfterDelay.ts","../../src/content/features/lobby-status/lobby-status.svelte","../../src/content/features/lobby-status/lobby-status.feature.ts","../../src/content/features/lobby-time-visualizer/lobby-time-visualizer-info.svelte","../../src/content/features/lobby-time-visualizer/lobby-time-visualizer.feature.ts","../../src/content/features/logging/logging-manage.svelte","../../src/content/features/logging/logging-info.svelte","../../src/content/features/logging/logging.feature.ts","../../src/content/features/panel-cabin/panel-cabin.svelte","../../src/content/features/panel-cabin/panel-cabin-sprite-picker.svelte","../../src/content/features/panel-cabin/panel-cabin-scene-picker.svelte","../../src/content/features/panel-cabin/panel-cabin.feature.ts","../../src/content/features/panel-changelog/panel-changelog.svelte","../../src/content/features/panel-changelog/panel-changelog.feature.ts","../../src/content/services/lobby-items/lobby-items.service.ts","../../src/content/features/panel-filters/panel-filters.svelte","../../src/content/features/panel-filters/filter-form.svelte","../../src/content/features/panel-filters/filter-search.svelte","../../src/content/features/panel-filters/panel-filters.feature.ts","../../src/content/features/panel-lobbies/panel-lobbies.svelte","../../src/content/features/panel-lobbies/panel-lobbies.feature.ts","../../src/content/services/players/skribblPlayerDisplay.interface.ts","../../src/signalr/tobeh.Avallone.Server.Classes.Dto.ts","../../src/content/features/player-awards/awards-display.svelte","../../src/content/features/player-awards/player-awards.svelte","../../src/content/features/player-awards/player-awards-award-picker.svelte","../../src/content/features/player-awards/player-awards-feature.ts","../../src/content/features/player-ids/player-ids.feature.ts","../../src/content/features/player-scenes/scene-container.svelte","../../src/content/features/player-scenes/player-scenes.feature.ts","../../src/content/features/player-sprites/sprite-container.svelte","../../src/content/features/player-sprites/player-sprites.feature.ts","../../src/content/features/toolbar-challenges/challenge.ts","../../src/content/features/toolbar-challenges/challenges/blind-guess-challenge.ts","../../src/content/features/toolbar-challenges/challenges/deaf-guess-challenge.ts","../../src/content/features/toolbar-challenges/challenges/dont-clear-challenge.ts","../../src/content/features/toolbar-challenges/challenges/drunk-vision-challenge.ts","../../src/content/features/toolbar-challenges/challenges/monochrome-challenge.ts","../../src/content/features/toolbar-challenges/challenges/one-shot-challenge.ts","../../src/content/features/toolbar-challenges/toolbar-challenges.svelte","../../src/content/features/toolbar-challenges/toolbar-challenges.feature.ts","../../src/content/features/toolbar-fullscreen/toolbar-fullscreen.feature.ts","../../src/util/upload.ts","../../src/content/features/toolbar-imagelab/toolbar-imagelab.svelte","../../src/content/features/toolbar-imagelab/imagelab-position-picker.svelte","../../src/content/features/toolbar-imagelab/toolbar-imagelab.feature.ts","../../src/content/features/toolbar-imagepost/toolbar-imagepost.svelte","../../src/content/features/toolbar-imagepost/toolbar-imagepost.feature.ts","../../src/util/clipboard.ts","../../src/worker/workers.ts","../../src/content/features/toolbar-save/toolbar-save.svelte","../../src/content/features/toolbar-save/toolbar-save.feature.ts","../../src/content/features/tooltips/tooltip.svelte","../../src/content/features/tooltips/tooltips.feature.ts","../../src/content/features/lobby-navigation/lobby-navigation.svelte","../../src/content/features/lobby-navigation/lobby-navigation.feature.ts","../../src/content/features/user-info/user-info.svelte","../../src/content/features/user-info/user-info.feature.ts","../../src/content/features/panel-news/panel-news.svelte","../../src/content/features/panel-news/panel-news.feature.ts","../../src/content/content.ts"],"sourcesContent":["const Metadata = new WeakMap();\nfunction decorateProperty(decorators, target, propertyKey, descriptor) {\n    decorators.reverse().forEach((decorator) => {\n        descriptor = decorator(target, propertyKey, descriptor) || descriptor;\n    });\n    return descriptor;\n}\nfunction decorateConstructor(decorators, target) {\n    decorators.reverse().forEach((decorator) => {\n        const decorated = decorator(target);\n        if (decorated) {\n            target = decorated;\n        }\n    });\n    return target;\n}\nexport function decorate(decorators, target, propertyKey, attributes) {\n    if (!Array.isArray(decorators) || decorators.length === 0) {\n        throw new TypeError();\n    }\n    if (propertyKey !== undefined) {\n        return decorateProperty(decorators, target, propertyKey, attributes);\n    }\n    if (typeof target === 'function') {\n        return decorateConstructor(decorators, target);\n    }\n    return;\n}\nfunction getMetadataMap(target, propertyKey) {\n    return Metadata.get(target) && Metadata.get(target).get(propertyKey);\n}\nfunction ordinaryGetOwnMetadata(metadataKey, target, propertyKey) {\n    if (target === undefined) {\n        throw new TypeError();\n    }\n    const metadataMap = getMetadataMap(target, propertyKey);\n    return metadataMap && metadataMap.get(metadataKey);\n}\nfunction createMetadataMap(target, propertyKey) {\n    const targetMetadata = Metadata.get(target) ||\n        new Map();\n    Metadata.set(target, targetMetadata);\n    const metadataMap = targetMetadata.get(propertyKey) || new Map();\n    targetMetadata.set(propertyKey, metadataMap);\n    return metadataMap;\n}\nfunction ordinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey) {\n    if (propertyKey && !['string', 'symbol'].includes(typeof propertyKey)) {\n        throw new TypeError();\n    }\n    (getMetadataMap(target, propertyKey) ||\n        createMetadataMap(target, propertyKey)).set(metadataKey, metadataValue);\n}\nfunction ordinaryGetMetadata(metadataKey, target, propertyKey) {\n    return ordinaryGetOwnMetadata(metadataKey, target, propertyKey)\n        ? ordinaryGetOwnMetadata(metadataKey, target, propertyKey)\n        : Object.getPrototypeOf(target)\n            ? ordinaryGetMetadata(metadataKey, Object.getPrototypeOf(target), propertyKey)\n            : undefined;\n}\nexport function metadata(metadataKey, metadataValue) {\n    return function decorator(target, propertyKey) {\n        ordinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n    };\n}\nexport function getMetadata(metadataKey, target, propertyKey) {\n    return ordinaryGetMetadata(metadataKey, target, propertyKey);\n}\nexport function getOwnMetadata(metadataKey, target, propertyKey) {\n    return ordinaryGetOwnMetadata(metadataKey, target, propertyKey);\n}\nexport function hasOwnMetadata(metadataKey, target, propertyKey) {\n    return !!ordinaryGetOwnMetadata(metadataKey, target, propertyKey);\n}\nexport function hasMetadata(metadataKey, target, propertyKey) {\n    return !!ordinaryGetMetadata(metadataKey, target, propertyKey);\n}\nexport function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n    ordinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n}\nexport const Reflection = {\n    decorate,\n    defineMetadata,\n    getMetadata,\n    getOwnMetadata,\n    hasMetadata,\n    hasOwnMetadata,\n    metadata,\n};\nObject.assign(Reflect, Reflection);\n//# sourceMappingURL=index.js.map","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map","export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map","import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map","export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map","import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._finalizers = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialFinalizer = this.initialTeardown;\n            if (isFunction(initialFinalizer)) {\n                try {\n                    initialFinalizer();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _finalizers = this._finalizers;\n            if (_finalizers) {\n                this._finalizers = null;\n                try {\n                    for (var _finalizers_1 = __values(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {\n                        var finalizer = _finalizers_1_1.value;\n                        try {\n                            execFinalizer(finalizer);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execFinalizer(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _finalizers = this._finalizers;\n        _finalizers && arrRemove(_finalizers, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execFinalizer(finalizer) {\n    if (isFunction(finalizer)) {\n        finalizer();\n    }\n    else {\n        finalizer.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map","export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {\n            return delegate.setTimeout.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setTimeout.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map","import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map","export function noop() { }\n//# sourceMappingURL=noop.js.map","import { config } from '../config';\nvar context = null;\nexport function errorContext(cb) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        var isRoot = !context;\n        if (isRoot) {\n            context = { errorThrown: false, error: null };\n        }\n        cb();\n        if (isRoot) {\n            var _a = context, errorThrown = _a.errorThrown, error = _a.error;\n            context = null;\n            if (errorThrown) {\n                throw error;\n            }\n        }\n    }\n    else {\n        cb();\n    }\n}\nexport function captureError(err) {\n    if (config.useDeprecatedSynchronousErrorHandling && context) {\n        context.errorThrown = true;\n        context.error = err;\n    }\n}\n//# sourceMappingURL=errorContext.js.map","import { __extends } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar _bind = Function.prototype.bind;\nfunction bind(fn, thisArg) {\n    return _bind.call(fn, thisArg);\n}\nvar ConsumerObserver = (function () {\n    function ConsumerObserver(partialObserver) {\n        this.partialObserver = partialObserver;\n    }\n    ConsumerObserver.prototype.next = function (value) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.next) {\n            try {\n                partialObserver.next(value);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    ConsumerObserver.prototype.error = function (err) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.error) {\n            try {\n                partialObserver.error(err);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n        else {\n            handleUnhandledError(err);\n        }\n    };\n    ConsumerObserver.prototype.complete = function () {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.complete) {\n            try {\n                partialObserver.complete();\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    return ConsumerObserver;\n}());\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var partialObserver;\n        if (isFunction(observerOrNext) || !observerOrNext) {\n            partialObserver = {\n                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),\n                error: error !== null && error !== void 0 ? error : undefined,\n                complete: complete !== null && complete !== void 0 ? complete : undefined,\n            };\n        }\n        else {\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n                partialObserver = {\n                    next: observerOrNext.next && bind(observerOrNext.next, context_1),\n                    error: observerOrNext.error && bind(observerOrNext.error, context_1),\n                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),\n                };\n            }\n            else {\n                partialObserver = observerOrNext;\n            }\n        }\n        _this.destination = new ConsumerObserver(partialObserver);\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction handleUnhandledError(error) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        captureError(error);\n    }\n    else {\n        reportUnhandledError(error);\n    }\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map","export var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","export function identity(x) {\n    return x;\n}\n//# sourceMappingURL=identity.js.map","import { identity } from './identity';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map","import { SafeSubscriber, Subscriber } from './Subscriber';\nimport { isSubscription } from './Subscription';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nimport { isFunction } from './util/isFunction';\nimport { errorContext } from './util/errorContext';\nvar Observable = (function () {\n    function Observable(subscribe) {\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var _this = this;\n        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new SafeSubscriber(observerOrNext, error, complete);\n        errorContext(function () {\n            var _a = _this, operator = _a.operator, source = _a.source;\n            subscriber.add(operator\n                ?\n                    operator.call(subscriber, source)\n                : source\n                    ?\n                        _this._subscribe(subscriber)\n                    :\n                        _this._trySubscribe(subscriber));\n        });\n        return subscriber;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.error(err);\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscriber = new SafeSubscriber({\n                next: function (value) {\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscriber.unsubscribe();\n                    }\n                },\n                error: reject,\n                complete: resolve,\n            });\n            _this.subscribe(subscriber);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var _a;\n        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        return pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    var _a;\n    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : config.Promise) !== null && _a !== void 0 ? _a : Promise;\n}\nfunction isObserver(value) {\n    return value && isFunction(value.next) && isFunction(value.error) && isFunction(value.complete);\n}\nfunction isSubscriber(value) {\n    return (value && value instanceof Subscriber) || (isObserver(value) && isSubscription(value));\n}\n//# sourceMappingURL=Observable.js.map","import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map","import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function createOperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n    return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize, shouldUnsubscribe) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this.shouldUnsubscribe = shouldUnsubscribe;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n            var closed_1 = this.closed;\n            _super.prototype.unsubscribe.call(this);\n            !closed_1 && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n        }\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map","import { createErrorClass } from './createErrorClass';\nexport var ObjectUnsubscribedError = createErrorClass(function (_super) {\n    return function ObjectUnsubscribedErrorImpl() {\n        _super(this);\n        this.name = 'ObjectUnsubscribedError';\n        this.message = 'object unsubscribed';\n    };\n});\n//# sourceMappingURL=ObjectUnsubscribedError.js.map","import { __extends, __values } from \"tslib\";\nimport { Observable } from './Observable';\nimport { Subscription, EMPTY_SUBSCRIPTION } from './Subscription';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { arrRemove } from './util/arrRemove';\nimport { errorContext } from './util/errorContext';\nvar Subject = (function (_super) {\n    __extends(Subject, _super);\n    function Subject() {\n        var _this = _super.call(this) || this;\n        _this.closed = false;\n        _this.currentObservers = null;\n        _this.observers = [];\n        _this.isStopped = false;\n        _this.hasError = false;\n        _this.thrownError = null;\n        return _this;\n    }\n    Subject.prototype.lift = function (operator) {\n        var subject = new AnonymousSubject(this, this);\n        subject.operator = operator;\n        return subject;\n    };\n    Subject.prototype._throwIfClosed = function () {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n    };\n    Subject.prototype.next = function (value) {\n        var _this = this;\n        errorContext(function () {\n            var e_1, _a;\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                if (!_this.currentObservers) {\n                    _this.currentObservers = Array.from(_this.observers);\n                }\n                try {\n                    for (var _b = __values(_this.currentObservers), _c = _b.next(); !_c.done; _c = _b.next()) {\n                        var observer = _c.value;\n                        observer.next(value);\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n            }\n        });\n    };\n    Subject.prototype.error = function (err) {\n        var _this = this;\n        errorContext(function () {\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                _this.hasError = _this.isStopped = true;\n                _this.thrownError = err;\n                var observers = _this.observers;\n                while (observers.length) {\n                    observers.shift().error(err);\n                }\n            }\n        });\n    };\n    Subject.prototype.complete = function () {\n        var _this = this;\n        errorContext(function () {\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                _this.isStopped = true;\n                var observers = _this.observers;\n                while (observers.length) {\n                    observers.shift().complete();\n                }\n            }\n        });\n    };\n    Subject.prototype.unsubscribe = function () {\n        this.isStopped = this.closed = true;\n        this.observers = this.currentObservers = null;\n    };\n    Object.defineProperty(Subject.prototype, \"observed\", {\n        get: function () {\n            var _a;\n            return ((_a = this.observers) === null || _a === void 0 ? void 0 : _a.length) > 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Subject.prototype._trySubscribe = function (subscriber) {\n        this._throwIfClosed();\n        return _super.prototype._trySubscribe.call(this, subscriber);\n    };\n    Subject.prototype._subscribe = function (subscriber) {\n        this._throwIfClosed();\n        this._checkFinalizedStatuses(subscriber);\n        return this._innerSubscribe(subscriber);\n    };\n    Subject.prototype._innerSubscribe = function (subscriber) {\n        var _this = this;\n        var _a = this, hasError = _a.hasError, isStopped = _a.isStopped, observers = _a.observers;\n        if (hasError || isStopped) {\n            return EMPTY_SUBSCRIPTION;\n        }\n        this.currentObservers = null;\n        observers.push(subscriber);\n        return new Subscription(function () {\n            _this.currentObservers = null;\n            arrRemove(observers, subscriber);\n        });\n    };\n    Subject.prototype._checkFinalizedStatuses = function (subscriber) {\n        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, isStopped = _a.isStopped;\n        if (hasError) {\n            subscriber.error(thrownError);\n        }\n        else if (isStopped) {\n            subscriber.complete();\n        }\n    };\n    Subject.prototype.asObservable = function () {\n        var observable = new Observable();\n        observable.source = this;\n        return observable;\n    };\n    Subject.create = function (destination, source) {\n        return new AnonymousSubject(destination, source);\n    };\n    return Subject;\n}(Observable));\nexport { Subject };\nvar AnonymousSubject = (function (_super) {\n    __extends(AnonymousSubject, _super);\n    function AnonymousSubject(destination, source) {\n        var _this = _super.call(this) || this;\n        _this.destination = destination;\n        _this.source = source;\n        return _this;\n    }\n    AnonymousSubject.prototype.next = function (value) {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.next) === null || _b === void 0 ? void 0 : _b.call(_a, value);\n    };\n    AnonymousSubject.prototype.error = function (err) {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.error) === null || _b === void 0 ? void 0 : _b.call(_a, err);\n    };\n    AnonymousSubject.prototype.complete = function () {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.complete) === null || _b === void 0 ? void 0 : _b.call(_a);\n    };\n    AnonymousSubject.prototype._subscribe = function (subscriber) {\n        var _a, _b;\n        return (_b = (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber)) !== null && _b !== void 0 ? _b : EMPTY_SUBSCRIPTION;\n    };\n    return AnonymousSubject;\n}(Subject));\nexport { AnonymousSubject };\n//# sourceMappingURL=Subject.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nvar BehaviorSubject = (function (_super) {\n    __extends(BehaviorSubject, _super);\n    function BehaviorSubject(_value) {\n        var _this = _super.call(this) || this;\n        _this._value = _value;\n        return _this;\n    }\n    Object.defineProperty(BehaviorSubject.prototype, \"value\", {\n        get: function () {\n            return this.getValue();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    BehaviorSubject.prototype._subscribe = function (subscriber) {\n        var subscription = _super.prototype._subscribe.call(this, subscriber);\n        !subscription.closed && subscriber.next(this._value);\n        return subscription;\n    };\n    BehaviorSubject.prototype.getValue = function () {\n        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, _value = _a._value;\n        if (hasError) {\n            throw thrownError;\n        }\n        this._throwIfClosed();\n        return _value;\n    };\n    BehaviorSubject.prototype.next = function (value) {\n        _super.prototype.next.call(this, (this._value = value));\n    };\n    return BehaviorSubject;\n}(Subject));\nexport { BehaviorSubject };\n//# sourceMappingURL=BehaviorSubject.js.map","export var dateTimestampProvider = {\n    now: function () {\n        return (dateTimestampProvider.delegate || Date).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=dateTimestampProvider.js.map","import { __extends } from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = (function (_super) {\n    __extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var intervalProvider = {\n    setInterval: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = intervalProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setInterval) {\n            return delegate.setInterval.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setInterval.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearInterval: function (handle) {\n        var delegate = intervalProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearInterval) || clearInterval)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=intervalProvider.js.map","import { __extends } from \"tslib\";\nimport { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nvar AsyncAction = (function (_super) {\n    __extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = (_a = this.id) !== null && _a !== void 0 ? _a : this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, _id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (_scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay != null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        if (id != null) {\n            intervalProvider.clearInterval(id);\n        }\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, _delay) {\n        var errored = false;\n        var errorValue;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = e ? e : new Error('Scheduled action threw falsy error');\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            var _a = this, id = _a.id, scheduler = _a.scheduler;\n            var actions = scheduler.actions;\n            this.work = this.state = this.scheduler = null;\n            this.pending = false;\n            arrRemove(actions, this);\n            if (id != null) {\n                this.id = this.recycleAsyncId(scheduler, id, null);\n            }\n            this.delay = null;\n            _super.prototype.unsubscribe.call(this);\n        }\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map","import { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar Scheduler = (function () {\n    function Scheduler(schedulerActionCtor, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        this.schedulerActionCtor = schedulerActionCtor;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) { delay = 0; }\n        return new this.schedulerActionCtor(this, work).schedule(state, delay);\n    };\n    Scheduler.now = dateTimestampProvider.now;\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map","import { __extends } from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = (function (_super) {\n    __extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        var _this = _super.call(this, SchedulerAction, now) || this;\n        _this.actions = [];\n        _this._active = false;\n        return _this;\n    }\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this._active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this._active = true;\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions.shift()));\n        this._active = false;\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var asyncScheduler = new AsyncScheduler(AsyncAction);\nexport var async = asyncScheduler;\n//# sourceMappingURL=async.js.map","import { Observable } from '../Observable';\nexport var EMPTY = new Observable(function (subscriber) { return subscriber.complete(); });\nexport function empty(scheduler) {\n    return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\nfunction emptyScheduled(scheduler) {\n    return new Observable(function (subscriber) { return scheduler.schedule(function () { return subscriber.complete(); }); });\n}\n//# sourceMappingURL=empty.js.map","import { isFunction } from './isFunction';\nexport function isScheduler(value) {\n    return value && isFunction(value.schedule);\n}\n//# sourceMappingURL=isScheduler.js.map","import { isFunction } from './isFunction';\nimport { isScheduler } from './isScheduler';\nfunction last(arr) {\n    return arr[arr.length - 1];\n}\nexport function popResultSelector(args) {\n    return isFunction(last(args)) ? args.pop() : undefined;\n}\nexport function popScheduler(args) {\n    return isScheduler(last(args)) ? args.pop() : undefined;\n}\nexport function popNumber(args, defaultValue) {\n    return typeof last(args) === 'number' ? args.pop() : defaultValue;\n}\n//# sourceMappingURL=args.js.map","export var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","import { isFunction } from \"./isFunction\";\nexport function isPromise(value) {\n    return isFunction(value === null || value === void 0 ? void 0 : value.then);\n}\n//# sourceMappingURL=isPromise.js.map","import { observable as Symbol_observable } from '../symbol/observable';\nimport { isFunction } from './isFunction';\nexport function isInteropObservable(input) {\n    return isFunction(input[Symbol_observable]);\n}\n//# sourceMappingURL=isInteropObservable.js.map","import { isFunction } from './isFunction';\nexport function isAsyncIterable(obj) {\n    return Symbol.asyncIterator && isFunction(obj === null || obj === void 0 ? void 0 : obj[Symbol.asyncIterator]);\n}\n//# sourceMappingURL=isAsyncIterable.js.map","export function createInvalidObservableTypeError(input) {\n    return new TypeError(\"You provided \" + (input !== null && typeof input === 'object' ? 'an invalid object' : \"'\" + input + \"'\") + \" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.\");\n}\n//# sourceMappingURL=throwUnobservableError.js.map","export function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = getSymbolIterator();\n//# sourceMappingURL=iterator.js.map","import { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from './isFunction';\nexport function isIterable(input) {\n    return isFunction(input === null || input === void 0 ? void 0 : input[Symbol_iterator]);\n}\n//# sourceMappingURL=isIterable.js.map","import { __asyncGenerator, __await, __generator } from \"tslib\";\nimport { isFunction } from './isFunction';\nexport function readableStreamLikeToAsyncGenerator(readableStream) {\n    return __asyncGenerator(this, arguments, function readableStreamLikeToAsyncGenerator_1() {\n        var reader, _a, value, done;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    reader = readableStream.getReader();\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, , 9, 10]);\n                    _b.label = 2;\n                case 2:\n                    if (!true) return [3, 8];\n                    return [4, __await(reader.read())];\n                case 3:\n                    _a = _b.sent(), value = _a.value, done = _a.done;\n                    if (!done) return [3, 5];\n                    return [4, __await(void 0)];\n                case 4: return [2, _b.sent()];\n                case 5: return [4, __await(value)];\n                case 6: return [4, _b.sent()];\n                case 7:\n                    _b.sent();\n                    return [3, 2];\n                case 8: return [3, 10];\n                case 9:\n                    reader.releaseLock();\n                    return [7];\n                case 10: return [2];\n            }\n        });\n    });\n}\nexport function isReadableStreamLike(obj) {\n    return isFunction(obj === null || obj === void 0 ? void 0 : obj.getReader);\n}\n//# sourceMappingURL=isReadableStreamLike.js.map","import { __asyncValues, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isPromise } from '../util/isPromise';\nimport { Observable } from '../Observable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isIterable } from '../util/isIterable';\nimport { isReadableStreamLike, readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nimport { isFunction } from '../util/isFunction';\nimport { reportUnhandledError } from '../util/reportUnhandledError';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport function innerFrom(input) {\n    if (input instanceof Observable) {\n        return input;\n    }\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return fromInteropObservable(input);\n        }\n        if (isArrayLike(input)) {\n            return fromArrayLike(input);\n        }\n        if (isPromise(input)) {\n            return fromPromise(input);\n        }\n        if (isAsyncIterable(input)) {\n            return fromAsyncIterable(input);\n        }\n        if (isIterable(input)) {\n            return fromIterable(input);\n        }\n        if (isReadableStreamLike(input)) {\n            return fromReadableStreamLike(input);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\nexport function fromInteropObservable(obj) {\n    return new Observable(function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (isFunction(obs.subscribe)) {\n            return obs.subscribe(subscriber);\n        }\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    });\n}\nexport function fromArrayLike(array) {\n    return new Observable(function (subscriber) {\n        for (var i = 0; i < array.length && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    });\n}\nexport function fromPromise(promise) {\n    return new Observable(function (subscriber) {\n        promise\n            .then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, reportUnhandledError);\n    });\n}\nexport function fromIterable(iterable) {\n    return new Observable(function (subscriber) {\n        var e_1, _a;\n        try {\n            for (var iterable_1 = __values(iterable), iterable_1_1 = iterable_1.next(); !iterable_1_1.done; iterable_1_1 = iterable_1.next()) {\n                var value = iterable_1_1.value;\n                subscriber.next(value);\n                if (subscriber.closed) {\n                    return;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) _a.call(iterable_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        subscriber.complete();\n    });\n}\nexport function fromAsyncIterable(asyncIterable) {\n    return new Observable(function (subscriber) {\n        process(asyncIterable, subscriber).catch(function (err) { return subscriber.error(err); });\n    });\n}\nexport function fromReadableStreamLike(readableStream) {\n    return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream));\n}\nfunction process(asyncIterable, subscriber) {\n    var asyncIterable_1, asyncIterable_1_1;\n    var e_2, _a;\n    return __awaiter(this, void 0, void 0, function () {\n        var value, e_2_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 5, 6, 11]);\n                    asyncIterable_1 = __asyncValues(asyncIterable);\n                    _b.label = 1;\n                case 1: return [4, asyncIterable_1.next()];\n                case 2:\n                    if (!(asyncIterable_1_1 = _b.sent(), !asyncIterable_1_1.done)) return [3, 4];\n                    value = asyncIterable_1_1.value;\n                    subscriber.next(value);\n                    if (subscriber.closed) {\n                        return [2];\n                    }\n                    _b.label = 3;\n                case 3: return [3, 1];\n                case 4: return [3, 11];\n                case 5:\n                    e_2_1 = _b.sent();\n                    e_2 = { error: e_2_1 };\n                    return [3, 11];\n                case 6:\n                    _b.trys.push([6, , 9, 10]);\n                    if (!(asyncIterable_1_1 && !asyncIterable_1_1.done && (_a = asyncIterable_1.return))) return [3, 8];\n                    return [4, _a.call(asyncIterable_1)];\n                case 7:\n                    _b.sent();\n                    _b.label = 8;\n                case 8: return [3, 10];\n                case 9:\n                    if (e_2) throw e_2.error;\n                    return [7];\n                case 10: return [7];\n                case 11:\n                    subscriber.complete();\n                    return [2];\n            }\n        });\n    });\n}\n//# sourceMappingURL=innerFrom.js.map","export function executeSchedule(parentSubscription, scheduler, work, delay, repeat) {\n    if (delay === void 0) { delay = 0; }\n    if (repeat === void 0) { repeat = false; }\n    var scheduleSubscription = scheduler.schedule(function () {\n        work();\n        if (repeat) {\n            parentSubscription.add(this.schedule(null, delay));\n        }\n        else {\n            this.unsubscribe();\n        }\n    }, delay);\n    parentSubscription.add(scheduleSubscription);\n    if (!repeat) {\n        return scheduleSubscription;\n    }\n}\n//# sourceMappingURL=executeSchedule.js.map","import { executeSchedule } from '../util/executeSchedule';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function observeOn(scheduler, delay) {\n    if (delay === void 0) { delay = 0; }\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return executeSchedule(subscriber, scheduler, function () { return subscriber.next(value); }, delay); }, function () { return executeSchedule(subscriber, scheduler, function () { return subscriber.complete(); }, delay); }, function (err) { return executeSchedule(subscriber, scheduler, function () { return subscriber.error(err); }, delay); }));\n    });\n}\n//# sourceMappingURL=observeOn.js.map","import { operate } from '../util/lift';\nexport function subscribeOn(scheduler, delay) {\n    if (delay === void 0) { delay = 0; }\n    return operate(function (source, subscriber) {\n        subscriber.add(scheduler.schedule(function () { return source.subscribe(subscriber); }, delay));\n    });\n}\n//# sourceMappingURL=subscribeOn.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nexport function scheduleObservable(input, scheduler) {\n    return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n//# sourceMappingURL=scheduleObservable.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nexport function schedulePromise(input, scheduler) {\n    return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n//# sourceMappingURL=schedulePromise.js.map","import { Observable } from '../Observable';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var i = 0;\n        return scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n            }\n            else {\n                subscriber.next(input[i++]);\n                if (!subscriber.closed) {\n                    this.schedule();\n                }\n            }\n        });\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map","import { Observable } from '../Observable';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from '../util/isFunction';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function scheduleIterable(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var iterator;\n        executeSchedule(subscriber, scheduler, function () {\n            iterator = input[Symbol_iterator]();\n            executeSchedule(subscriber, scheduler, function () {\n                var _a;\n                var value;\n                var done;\n                try {\n                    (_a = iterator.next(), value = _a.value, done = _a.done);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                    return;\n                }\n                if (done) {\n                    subscriber.complete();\n                }\n                else {\n                    subscriber.next(value);\n                }\n            }, 0, true);\n        });\n        return function () { return isFunction(iterator === null || iterator === void 0 ? void 0 : iterator.return) && iterator.return(); };\n    });\n}\n//# sourceMappingURL=scheduleIterable.js.map","import { Observable } from '../Observable';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function scheduleAsyncIterable(input, scheduler) {\n    if (!input) {\n        throw new Error('Iterable cannot be null');\n    }\n    return new Observable(function (subscriber) {\n        executeSchedule(subscriber, scheduler, function () {\n            var iterator = input[Symbol.asyncIterator]();\n            executeSchedule(subscriber, scheduler, function () {\n                iterator.next().then(function (result) {\n                    if (result.done) {\n                        subscriber.complete();\n                    }\n                    else {\n                        subscriber.next(result.value);\n                    }\n                });\n            }, 0, true);\n        });\n    });\n}\n//# sourceMappingURL=scheduleAsyncIterable.js.map","import { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nexport function scheduleReadableStreamLike(input, scheduler) {\n    return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input), scheduler);\n}\n//# sourceMappingURL=scheduleReadableStreamLike.js.map","import { scheduleObservable } from './scheduleObservable';\nimport { schedulePromise } from './schedulePromise';\nimport { scheduleArray } from './scheduleArray';\nimport { scheduleIterable } from './scheduleIterable';\nimport { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isIterable } from '../util/isIterable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isReadableStreamLike } from '../util/isReadableStreamLike';\nimport { scheduleReadableStreamLike } from './scheduleReadableStreamLike';\nexport function scheduled(input, scheduler) {\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return scheduleObservable(input, scheduler);\n        }\n        if (isArrayLike(input)) {\n            return scheduleArray(input, scheduler);\n        }\n        if (isPromise(input)) {\n            return schedulePromise(input, scheduler);\n        }\n        if (isAsyncIterable(input)) {\n            return scheduleAsyncIterable(input, scheduler);\n        }\n        if (isIterable(input)) {\n            return scheduleIterable(input, scheduler);\n        }\n        if (isReadableStreamLike(input)) {\n            return scheduleReadableStreamLike(input, scheduler);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\n//# sourceMappingURL=scheduled.js.map","import { scheduled } from '../scheduled/scheduled';\nimport { innerFrom } from './innerFrom';\nexport function from(input, scheduler) {\n    return scheduler ? scheduled(input, scheduler) : innerFrom(input);\n}\n//# sourceMappingURL=from.js.map","import { popScheduler } from '../util/args';\nimport { from } from './from';\nexport function of() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    return from(args, scheduler);\n}\n//# sourceMappingURL=of.js.map","import { createErrorClass } from './createErrorClass';\nexport var EmptyError = createErrorClass(function (_super) { return function EmptyErrorImpl() {\n    _super(this);\n    this.name = 'EmptyError';\n    this.message = 'no elements in sequence';\n}; });\n//# sourceMappingURL=EmptyError.js.map","import { EmptyError } from './util/EmptyError';\nimport { SafeSubscriber } from './Subscriber';\nexport function firstValueFrom(source, config) {\n    var hasConfig = typeof config === 'object';\n    return new Promise(function (resolve, reject) {\n        var subscriber = new SafeSubscriber({\n            next: function (value) {\n                resolve(value);\n                subscriber.unsubscribe();\n            },\n            error: reject,\n            complete: function () {\n                if (hasConfig) {\n                    resolve(config.defaultValue);\n                }\n                else {\n                    reject(new EmptyError());\n                }\n            },\n        });\n        source.subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=firstValueFrom.js.map","export function isValidDate(value) {\n    return value instanceof Date && !isNaN(value);\n}\n//# sourceMappingURL=isDate.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n    return function TimeoutErrorImpl(info) {\n        if (info === void 0) { info = null; }\n        _super(this);\n        this.message = 'Timeout has occurred';\n        this.name = 'TimeoutError';\n        this.info = info;\n    };\n});\nexport function timeout(config, schedulerArg) {\n    var _a = (isValidDate(config) ? { first: config } : typeof config === 'number' ? { each: config } : config), first = _a.first, each = _a.each, _b = _a.with, _with = _b === void 0 ? timeoutErrorFactory : _b, _c = _a.scheduler, scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c, _d = _a.meta, meta = _d === void 0 ? null : _d;\n    if (first == null && each == null) {\n        throw new TypeError('No timeout provided.');\n    }\n    return operate(function (source, subscriber) {\n        var originalSourceSubscription;\n        var timerSubscription;\n        var lastValue = null;\n        var seen = 0;\n        var startTimer = function (delay) {\n            timerSubscription = executeSchedule(subscriber, scheduler, function () {\n                try {\n                    originalSourceSubscription.unsubscribe();\n                    innerFrom(_with({\n                        meta: meta,\n                        lastValue: lastValue,\n                        seen: seen,\n                    })).subscribe(subscriber);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }, delay);\n        };\n        originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            seen++;\n            subscriber.next((lastValue = value));\n            each > 0 && startTimer(each);\n        }, undefined, undefined, function () {\n            if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n                timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            }\n            lastValue = null;\n        }));\n        !seen && startTimer(first != null ? (typeof first === 'number' ? first : +first - scheduler.now()) : each);\n    });\n}\nfunction timeoutErrorFactory(info) {\n    throw new TimeoutError(info);\n}\n//# sourceMappingURL=timeout.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { map } from \"../operators/map\";\nvar isArray = Array.isArray;\nfunction callOrApply(fn, args) {\n    return isArray(args) ? fn.apply(void 0, __spreadArray([], __read(args))) : fn(args);\n}\nexport function mapOneOrManyArgs(fn) {\n    return map(function (args) { return callOrApply(fn, args); });\n}\n//# sourceMappingURL=mapOneOrManyArgs.js.map","var isArray = Array.isArray;\nvar getPrototypeOf = Object.getPrototypeOf, objectProto = Object.prototype, getKeys = Object.keys;\nexport function argsArgArrayOrObject(args) {\n    if (args.length === 1) {\n        var first_1 = args[0];\n        if (isArray(first_1)) {\n            return { args: first_1, keys: null };\n        }\n        if (isPOJO(first_1)) {\n            var keys = getKeys(first_1);\n            return {\n                args: keys.map(function (key) { return first_1[key]; }),\n                keys: keys,\n            };\n        }\n    }\n    return { args: args, keys: null };\n}\nfunction isPOJO(obj) {\n    return obj && typeof obj === 'object' && getPrototypeOf(obj) === objectProto;\n}\n//# sourceMappingURL=argsArgArrayOrObject.js.map","export function createObject(keys, values) {\n    return keys.reduce(function (result, key, i) { return ((result[key] = values[i]), result); }, {});\n}\n//# sourceMappingURL=createObject.js.map","import { Observable } from '../Observable';\nimport { argsArgArrayOrObject } from '../util/argsArgArrayOrObject';\nimport { from } from './from';\nimport { identity } from '../util/identity';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { popResultSelector, popScheduler } from '../util/args';\nimport { createObject } from '../util/createObject';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function combineLatest() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var resultSelector = popResultSelector(args);\n    var _a = argsArgArrayOrObject(args), observables = _a.args, keys = _a.keys;\n    if (observables.length === 0) {\n        return from([], scheduler);\n    }\n    var result = new Observable(combineLatestInit(observables, scheduler, keys\n        ?\n            function (values) { return createObject(keys, values); }\n        :\n            identity));\n    return resultSelector ? result.pipe(mapOneOrManyArgs(resultSelector)) : result;\n}\nexport function combineLatestInit(observables, scheduler, valueTransform) {\n    if (valueTransform === void 0) { valueTransform = identity; }\n    return function (subscriber) {\n        maybeSchedule(scheduler, function () {\n            var length = observables.length;\n            var values = new Array(length);\n            var active = length;\n            var remainingFirstValues = length;\n            var _loop_1 = function (i) {\n                maybeSchedule(scheduler, function () {\n                    var source = from(observables[i], scheduler);\n                    var hasFirstValue = false;\n                    source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                        values[i] = value;\n                        if (!hasFirstValue) {\n                            hasFirstValue = true;\n                            remainingFirstValues--;\n                        }\n                        if (!remainingFirstValues) {\n                            subscriber.next(valueTransform(values.slice()));\n                        }\n                    }, function () {\n                        if (!--active) {\n                            subscriber.complete();\n                        }\n                    }));\n                }, subscriber);\n            };\n            for (var i = 0; i < length; i++) {\n                _loop_1(i);\n            }\n        }, subscriber);\n    };\n}\nfunction maybeSchedule(scheduler, execute, subscription) {\n    if (scheduler) {\n        executeSchedule(subscription, scheduler, execute);\n    }\n    else {\n        execute();\n    }\n}\n//# sourceMappingURL=combineLatest.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function mergeInternals(source, subscriber, project, concurrent, onBeforeNext, expand, innerSubScheduler, additionalFinalizer) {\n    var buffer = [];\n    var active = 0;\n    var index = 0;\n    var isComplete = false;\n    var checkComplete = function () {\n        if (isComplete && !buffer.length && !active) {\n            subscriber.complete();\n        }\n    };\n    var outerNext = function (value) { return (active < concurrent ? doInnerSub(value) : buffer.push(value)); };\n    var doInnerSub = function (value) {\n        expand && subscriber.next(value);\n        active++;\n        var innerComplete = false;\n        innerFrom(project(value, index++)).subscribe(createOperatorSubscriber(subscriber, function (innerValue) {\n            onBeforeNext === null || onBeforeNext === void 0 ? void 0 : onBeforeNext(innerValue);\n            if (expand) {\n                outerNext(innerValue);\n            }\n            else {\n                subscriber.next(innerValue);\n            }\n        }, function () {\n            innerComplete = true;\n        }, undefined, function () {\n            if (innerComplete) {\n                try {\n                    active--;\n                    var _loop_1 = function () {\n                        var bufferedValue = buffer.shift();\n                        if (innerSubScheduler) {\n                            executeSchedule(subscriber, innerSubScheduler, function () { return doInnerSub(bufferedValue); });\n                        }\n                        else {\n                            doInnerSub(bufferedValue);\n                        }\n                    };\n                    while (buffer.length && active < concurrent) {\n                        _loop_1();\n                    }\n                    checkComplete();\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }\n        }));\n    };\n    source.subscribe(createOperatorSubscriber(subscriber, outerNext, function () {\n        isComplete = true;\n        checkComplete();\n    }));\n    return function () {\n        additionalFinalizer === null || additionalFinalizer === void 0 ? void 0 : additionalFinalizer();\n    };\n}\n//# sourceMappingURL=mergeInternals.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function (a, i) { return map(function (b, ii) { return resultSelector(a, b, i, ii); })(innerFrom(project(a, i))); }, concurrent);\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return operate(function (source, subscriber) { return mergeInternals(source, subscriber, project, concurrent); });\n}\n//# sourceMappingURL=mergeMap.js.map","import { mergeMap } from './mergeMap';\nimport { identity } from '../util/identity';\nexport function mergeAll(concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    return mergeMap(identity, concurrent);\n}\n//# sourceMappingURL=mergeAll.js.map","import { mergeAll } from './mergeAll';\nexport function concatAll() {\n    return mergeAll(1);\n}\n//# sourceMappingURL=concatAll.js.map","import { concatAll } from '../operators/concatAll';\nimport { popScheduler } from '../util/args';\nimport { from } from './from';\nexport function concat() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return concatAll()(from(args, popScheduler(args)));\n}\n//# sourceMappingURL=concat.js.map","import { Observable } from '../Observable';\nimport { argsArgArrayOrObject } from '../util/argsArgArrayOrObject';\nimport { innerFrom } from './innerFrom';\nimport { popResultSelector } from '../util/args';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { createObject } from '../util/createObject';\nexport function forkJoin() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var resultSelector = popResultSelector(args);\n    var _a = argsArgArrayOrObject(args), sources = _a.args, keys = _a.keys;\n    var result = new Observable(function (subscriber) {\n        var length = sources.length;\n        if (!length) {\n            subscriber.complete();\n            return;\n        }\n        var values = new Array(length);\n        var remainingCompletions = length;\n        var remainingEmissions = length;\n        var _loop_1 = function (sourceIndex) {\n            var hasValue = false;\n            innerFrom(sources[sourceIndex]).subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (!hasValue) {\n                    hasValue = true;\n                    remainingEmissions--;\n                }\n                values[sourceIndex] = value;\n            }, function () { return remainingCompletions--; }, undefined, function () {\n                if (!remainingCompletions || !hasValue) {\n                    if (!remainingEmissions) {\n                        subscriber.next(keys ? createObject(keys, values) : values);\n                    }\n                    subscriber.complete();\n                }\n            }));\n        };\n        for (var sourceIndex = 0; sourceIndex < length; sourceIndex++) {\n            _loop_1(sourceIndex);\n        }\n    });\n    return resultSelector ? result.pipe(mapOneOrManyArgs(resultSelector)) : result;\n}\n//# sourceMappingURL=forkJoin.js.map","import { Observable } from '../Observable';\nimport { async as asyncScheduler } from '../scheduler/async';\nimport { isScheduler } from '../util/isScheduler';\nimport { isValidDate } from '../util/isDate';\nexport function timer(dueTime, intervalOrScheduler, scheduler) {\n    if (dueTime === void 0) { dueTime = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var intervalDuration = -1;\n    if (intervalOrScheduler != null) {\n        if (isScheduler(intervalOrScheduler)) {\n            scheduler = intervalOrScheduler;\n        }\n        else {\n            intervalDuration = intervalOrScheduler;\n        }\n    }\n    return new Observable(function (subscriber) {\n        var due = isValidDate(dueTime) ? +dueTime - scheduler.now() : dueTime;\n        if (due < 0) {\n            due = 0;\n        }\n        var n = 0;\n        return scheduler.schedule(function () {\n            if (!subscriber.closed) {\n                subscriber.next(n++);\n                if (0 <= intervalDuration) {\n                    this.schedule(undefined, intervalDuration);\n                }\n                else {\n                    subscriber.complete();\n                }\n            }\n        }, due);\n    });\n}\n//# sourceMappingURL=timer.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { timer } from './timer';\nexport function interval(period, scheduler) {\n    if (period === void 0) { period = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    if (period < 0) {\n        period = 0;\n    }\n    return timer(period, period, scheduler);\n}\n//# sourceMappingURL=interval.js.map","import { mergeAll } from '../operators/mergeAll';\nimport { innerFrom } from './innerFrom';\nimport { EMPTY } from './empty';\nimport { popNumber, popScheduler } from '../util/args';\nimport { from } from './from';\nexport function merge() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var concurrent = popNumber(args, Infinity);\n    var sources = args;\n    return !sources.length\n        ?\n            EMPTY\n        : sources.length === 1\n            ?\n                innerFrom(sources[0])\n            :\n                mergeAll(concurrent)(from(sources, scheduler));\n}\n//# sourceMappingURL=merge.js.map","var isArray = Array.isArray;\nexport function argsOrArgArray(args) {\n    return args.length === 1 && isArray(args[0]) ? args[0] : args;\n}\n//# sourceMappingURL=argsOrArgArray.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function filter(predicate, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return predicate.call(thisArg, value, index++) && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=filter.js.map","import { __values } from \"tslib\";\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { arrRemove } from '../util/arrRemove';\nimport { asyncScheduler } from '../scheduler/async';\nimport { popScheduler } from '../util/args';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function bufferTime(bufferTimeSpan) {\n    var _a, _b;\n    var otherArgs = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        otherArgs[_i - 1] = arguments[_i];\n    }\n    var scheduler = (_a = popScheduler(otherArgs)) !== null && _a !== void 0 ? _a : asyncScheduler;\n    var bufferCreationInterval = (_b = otherArgs[0]) !== null && _b !== void 0 ? _b : null;\n    var maxBufferSize = otherArgs[1] || Infinity;\n    return operate(function (source, subscriber) {\n        var bufferRecords = [];\n        var restartOnEmit = false;\n        var emit = function (record) {\n            var buffer = record.buffer, subs = record.subs;\n            subs.unsubscribe();\n            arrRemove(bufferRecords, record);\n            subscriber.next(buffer);\n            restartOnEmit && startBuffer();\n        };\n        var startBuffer = function () {\n            if (bufferRecords) {\n                var subs = new Subscription();\n                subscriber.add(subs);\n                var buffer = [];\n                var record_1 = {\n                    buffer: buffer,\n                    subs: subs,\n                };\n                bufferRecords.push(record_1);\n                executeSchedule(subs, scheduler, function () { return emit(record_1); }, bufferTimeSpan);\n            }\n        };\n        if (bufferCreationInterval !== null && bufferCreationInterval >= 0) {\n            executeSchedule(subscriber, scheduler, startBuffer, bufferCreationInterval, true);\n        }\n        else {\n            restartOnEmit = true;\n        }\n        startBuffer();\n        var bufferTimeSubscriber = createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a;\n            var recordsCopy = bufferRecords.slice();\n            try {\n                for (var recordsCopy_1 = __values(recordsCopy), recordsCopy_1_1 = recordsCopy_1.next(); !recordsCopy_1_1.done; recordsCopy_1_1 = recordsCopy_1.next()) {\n                    var record = recordsCopy_1_1.value;\n                    var buffer = record.buffer;\n                    buffer.push(value);\n                    maxBufferSize <= buffer.length && emit(record);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (recordsCopy_1_1 && !recordsCopy_1_1.done && (_a = recordsCopy_1.return)) _a.call(recordsCopy_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }, function () {\n            while (bufferRecords === null || bufferRecords === void 0 ? void 0 : bufferRecords.length) {\n                subscriber.next(bufferRecords.shift().buffer);\n            }\n            bufferTimeSubscriber === null || bufferTimeSubscriber === void 0 ? void 0 : bufferTimeSubscriber.unsubscribe();\n            subscriber.complete();\n            subscriber.unsubscribe();\n        }, undefined, function () { return (bufferRecords = null); });\n        source.subscribe(bufferTimeSubscriber);\n    });\n}\n//# sourceMappingURL=bufferTime.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { operate } from '../util/lift';\nexport function catchError(selector) {\n    return operate(function (source, subscriber) {\n        var innerSub = null;\n        var syncUnsub = false;\n        var handledResult;\n        innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, undefined, function (err) {\n            handledResult = innerFrom(selector(err, catchError(selector)(source)));\n            if (innerSub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                handledResult.subscribe(subscriber);\n            }\n            else {\n                syncUnsub = true;\n            }\n        }));\n        if (syncUnsub) {\n            innerSub.unsubscribe();\n            innerSub = null;\n            handledResult.subscribe(subscriber);\n        }\n    });\n}\n//# sourceMappingURL=catchError.js.map","import { createOperatorSubscriber } from './OperatorSubscriber';\nexport function scanInternals(accumulator, seed, hasSeed, emitOnNext, emitBeforeComplete) {\n    return function (source, subscriber) {\n        var hasState = hasSeed;\n        var state = seed;\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var i = index++;\n            state = hasState\n                ?\n                    accumulator(state, value, i)\n                :\n                    ((hasState = true), value);\n            emitOnNext && subscriber.next(state);\n        }, emitBeforeComplete &&\n            (function () {\n                hasState && subscriber.next(state);\n                subscriber.complete();\n            })));\n    };\n}\n//# sourceMappingURL=scanInternals.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { combineLatestInit } from '../observable/combineLatest';\nimport { operate } from '../util/lift';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { pipe } from '../util/pipe';\nimport { popResultSelector } from '../util/args';\nexport function combineLatest() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var resultSelector = popResultSelector(args);\n    return resultSelector\n        ? pipe(combineLatest.apply(void 0, __spreadArray([], __read(args))), mapOneOrManyArgs(resultSelector))\n        : operate(function (source, subscriber) {\n            combineLatestInit(__spreadArray([source], __read(argsOrArgArray(args))))(subscriber);\n        });\n}\n//# sourceMappingURL=combineLatest.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { combineLatest } from './combineLatest';\nexport function combineLatestWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return combineLatest.apply(void 0, __spreadArray([], __read(otherSources)));\n}\n//# sourceMappingURL=combineLatestWith.js.map","import { mergeMap } from './mergeMap';\nimport { isFunction } from '../util/isFunction';\nexport function concatMap(project, resultSelector) {\n    return isFunction(resultSelector) ? mergeMap(project, resultSelector, 1) : mergeMap(project, 1);\n}\n//# sourceMappingURL=concatMap.js.map","import { operate } from '../util/lift';\nimport { noop } from '../util/noop';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function debounce(durationSelector) {\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        var lastValue = null;\n        var durationSubscriber = null;\n        var emit = function () {\n            durationSubscriber === null || durationSubscriber === void 0 ? void 0 : durationSubscriber.unsubscribe();\n            durationSubscriber = null;\n            if (hasValue) {\n                hasValue = false;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            durationSubscriber === null || durationSubscriber === void 0 ? void 0 : durationSubscriber.unsubscribe();\n            hasValue = true;\n            lastValue = value;\n            durationSubscriber = createOperatorSubscriber(subscriber, emit, noop);\n            innerFrom(durationSelector(value)).subscribe(durationSubscriber);\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = durationSubscriber = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounce.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function debounceTime(dueTime, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return operate(function (source, subscriber) {\n        var activeTask = null;\n        var lastValue = null;\n        var lastTime = null;\n        var emit = function () {\n            if (activeTask) {\n                activeTask.unsubscribe();\n                activeTask = null;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        function emitWhenIdle() {\n            var targetTime = lastTime + dueTime;\n            var now = scheduler.now();\n            if (now < targetTime) {\n                activeTask = this.schedule(undefined, targetTime - now);\n                subscriber.add(activeTask);\n                return;\n            }\n            emit();\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            lastValue = value;\n            lastTime = scheduler.now();\n            if (!activeTask) {\n                activeTask = scheduler.schedule(emitWhenIdle, dueTime);\n                subscriber.add(activeTask);\n            }\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = activeTask = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounceTime.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function take(count) {\n    return count <= 0\n        ?\n            function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var seen = 0;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (++seen <= count) {\n                    subscriber.next(value);\n                    if (count <= seen) {\n                        subscriber.complete();\n                    }\n                }\n            }));\n        });\n}\n//# sourceMappingURL=take.js.map","import { map } from './map';\nexport function mapTo(value) {\n    return map(function () { return value; });\n}\n//# sourceMappingURL=mapTo.js.map","import { concat } from '../observable/concat';\nimport { take } from './take';\nimport { ignoreElements } from './ignoreElements';\nimport { mapTo } from './mapTo';\nimport { mergeMap } from './mergeMap';\nimport { innerFrom } from '../observable/innerFrom';\nexport function delayWhen(delayDurationSelector, subscriptionDelay) {\n    if (subscriptionDelay) {\n        return function (source) {\n            return concat(subscriptionDelay.pipe(take(1), ignoreElements()), source.pipe(delayWhen(delayDurationSelector)));\n        };\n    }\n    return mergeMap(function (value, index) { return innerFrom(delayDurationSelector(value, index)).pipe(take(1), mapTo(value)); });\n}\n//# sourceMappingURL=delayWhen.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { delayWhen } from './delayWhen';\nimport { timer } from '../observable/timer';\nexport function delay(due, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var duration = timer(due, scheduler);\n    return delayWhen(function () { return duration; });\n}\n//# sourceMappingURL=delay.js.map","import { identity } from '../util/identity';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function distinctUntilChanged(comparator, keySelector) {\n    if (keySelector === void 0) { keySelector = identity; }\n    comparator = comparator !== null && comparator !== void 0 ? comparator : defaultCompare;\n    return operate(function (source, subscriber) {\n        var previousKey;\n        var first = true;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var currentKey = keySelector(value);\n            if (first || !comparator(previousKey, currentKey)) {\n                first = false;\n                previousKey = currentKey;\n                subscriber.next(value);\n            }\n        }));\n    });\n}\nfunction defaultCompare(a, b) {\n    return a === b;\n}\n//# sourceMappingURL=distinctUntilChanged.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function exhaustMap(project, resultSelector) {\n    if (resultSelector) {\n        return function (source) {\n            return source.pipe(exhaustMap(function (a, i) { return innerFrom(project(a, i)).pipe(map(function (b, ii) { return resultSelector(a, b, i, ii); })); }));\n        };\n    }\n    return operate(function (source, subscriber) {\n        var index = 0;\n        var innerSub = null;\n        var isComplete = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (outerValue) {\n            if (!innerSub) {\n                innerSub = createOperatorSubscriber(subscriber, undefined, function () {\n                    innerSub = null;\n                    isComplete && subscriber.complete();\n                });\n                innerFrom(project(outerValue, index++)).subscribe(innerSub);\n            }\n        }, function () {\n            isComplete = true;\n            !innerSub && subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=exhaustMap.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { operate } from '../util/lift';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { mergeAll } from './mergeAll';\nimport { popNumber, popScheduler } from '../util/args';\nimport { from } from '../observable/from';\nexport function merge() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var concurrent = popNumber(args, Infinity);\n    args = argsOrArgArray(args);\n    return operate(function (source, subscriber) {\n        mergeAll(concurrent)(from(__spreadArray([source], __read(args)), scheduler)).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=merge.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { merge } from './merge';\nexport function mergeWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return merge.apply(void 0, __spreadArray([], __read(otherSources)));\n}\n//# sourceMappingURL=mergeWith.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function pairwise() {\n    return operate(function (source, subscriber) {\n        var prev;\n        var hasPrev = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var p = prev;\n            prev = value;\n            hasPrev && subscriber.next([p, value]);\n            hasPrev = true;\n        }));\n    });\n}\n//# sourceMappingURL=pairwise.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { timer } from '../observable/timer';\nexport function repeat(countOrConfig) {\n    var _a;\n    var count = Infinity;\n    var delay;\n    if (countOrConfig != null) {\n        if (typeof countOrConfig === 'object') {\n            (_a = countOrConfig.count, count = _a === void 0 ? Infinity : _a, delay = countOrConfig.delay);\n        }\n        else {\n            count = countOrConfig;\n        }\n    }\n    return count <= 0\n        ? function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var soFar = 0;\n            var sourceSub;\n            var resubscribe = function () {\n                sourceSub === null || sourceSub === void 0 ? void 0 : sourceSub.unsubscribe();\n                sourceSub = null;\n                if (delay != null) {\n                    var notifier = typeof delay === 'number' ? timer(delay) : innerFrom(delay(soFar));\n                    var notifierSubscriber_1 = createOperatorSubscriber(subscriber, function () {\n                        notifierSubscriber_1.unsubscribe();\n                        subscribeToSource();\n                    });\n                    notifier.subscribe(notifierSubscriber_1);\n                }\n                else {\n                    subscribeToSource();\n                }\n            };\n            var subscribeToSource = function () {\n                var syncUnsub = false;\n                sourceSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, function () {\n                    if (++soFar < count) {\n                        if (sourceSub) {\n                            resubscribe();\n                        }\n                        else {\n                            syncUnsub = true;\n                        }\n                    }\n                    else {\n                        subscriber.complete();\n                    }\n                }));\n                if (syncUnsub) {\n                    resubscribe();\n                }\n            };\n            subscribeToSource();\n        });\n}\n//# sourceMappingURL=repeat.js.map","import { operate } from '../util/lift';\nimport { scanInternals } from './scanInternals';\nexport function scan(accumulator, seed) {\n    return operate(scanInternals(accumulator, seed, arguments.length >= 2, true));\n}\n//# sourceMappingURL=scan.js.map","import { filter } from './filter';\nexport function skip(count) {\n    return filter(function (_, index) { return count <= index; });\n}\n//# sourceMappingURL=skip.js.map","import { concat } from '../observable/concat';\nimport { popScheduler } from '../util/args';\nimport { operate } from '../util/lift';\nexport function startWith() {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(values);\n    return operate(function (source, subscriber) {\n        (scheduler ? concat(values, source, scheduler) : concat(values, source)).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=startWith.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function switchMap(project, resultSelector) {\n    return operate(function (source, subscriber) {\n        var innerSubscriber = null;\n        var index = 0;\n        var isComplete = false;\n        var checkComplete = function () { return isComplete && !innerSubscriber && subscriber.complete(); };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            innerSubscriber === null || innerSubscriber === void 0 ? void 0 : innerSubscriber.unsubscribe();\n            var innerIndex = 0;\n            var outerIndex = index++;\n            innerFrom(project(value, outerIndex)).subscribe((innerSubscriber = createOperatorSubscriber(subscriber, function (innerValue) { return subscriber.next(resultSelector ? resultSelector(value, innerValue, outerIndex, innerIndex++) : innerValue); }, function () {\n                innerSubscriber = null;\n                checkComplete();\n            })));\n        }, function () {\n            isComplete = true;\n            checkComplete();\n        }));\n    });\n}\n//# sourceMappingURL=switchMap.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { noop } from '../util/noop';\nexport function takeUntil(notifier) {\n    return operate(function (source, subscriber) {\n        innerFrom(notifier).subscribe(createOperatorSubscriber(subscriber, function () { return subscriber.complete(); }, noop));\n        !subscriber.closed && source.subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=takeUntil.js.map","import { isFunction } from '../util/isFunction';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { identity } from '../util/identity';\nexport function tap(observerOrNext, error, complete) {\n    var tapObserver = isFunction(observerOrNext) || error || complete\n        ?\n            { next: observerOrNext, error: error, complete: complete }\n        : observerOrNext;\n    return tapObserver\n        ? operate(function (source, subscriber) {\n            var _a;\n            (_a = tapObserver.subscribe) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n            var isUnsub = true;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                var _a;\n                (_a = tapObserver.next) === null || _a === void 0 ? void 0 : _a.call(tapObserver, value);\n                subscriber.next(value);\n            }, function () {\n                var _a;\n                isUnsub = false;\n                (_a = tapObserver.complete) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                subscriber.complete();\n            }, function (err) {\n                var _a;\n                isUnsub = false;\n                (_a = tapObserver.error) === null || _a === void 0 ? void 0 : _a.call(tapObserver, err);\n                subscriber.error(err);\n            }, function () {\n                var _a, _b;\n                if (isUnsub) {\n                    (_a = tapObserver.unsubscribe) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                }\n                (_b = tapObserver.finalize) === null || _b === void 0 ? void 0 : _b.call(tapObserver);\n            }));\n        })\n        :\n            identity;\n}\n//# sourceMappingURL=tap.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { identity } from '../util/identity';\nimport { noop } from '../util/noop';\nimport { popResultSelector } from '../util/args';\nexport function withLatestFrom() {\n    var inputs = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        inputs[_i] = arguments[_i];\n    }\n    var project = popResultSelector(inputs);\n    return operate(function (source, subscriber) {\n        var len = inputs.length;\n        var otherValues = new Array(len);\n        var hasValue = inputs.map(function () { return false; });\n        var ready = false;\n        var _loop_1 = function (i) {\n            innerFrom(inputs[i]).subscribe(createOperatorSubscriber(subscriber, function (value) {\n                otherValues[i] = value;\n                if (!ready && !hasValue[i]) {\n                    hasValue[i] = true;\n                    (ready = hasValue.every(identity)) && (hasValue = null);\n                }\n            }, noop));\n        };\n        for (var i = 0; i < len; i++) {\n            _loop_1(i);\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            if (ready) {\n                var values = __spreadArray([value], __read(otherValues));\n                subscriber.next(project ? project.apply(void 0, __spreadArray([], __read(values))) : values);\n            }\n        }));\n    });\n}\n//# sourceMappingURL=withLatestFrom.js.map","import { element, requireElement } from \"@/util/document/requiredQuerySelector\";\nimport { BehaviorSubject, combineLatestWith, filter, firstValueFrom, map, type Observable, tap } from \"rxjs\";\n\nexport interface prioritizedCanvasEvents {\n  add: (priority: listenerPriority) => HTMLCanvasElement[\"addEventListener\"],\n  remove: HTMLCanvasElement[\"removeEventListener\"]\n}\n\nexport type listenerPriority = \"preDraw\" | \"draw\" | \"postDraw\";\n\nexport class Interceptor {\n\n  private readonly _typoBodyLoaded$ = new BehaviorSubject<boolean>(false);\n  private readonly _canvasFound$ = new BehaviorSubject<boolean>(false);\n  private readonly _contentScriptLoaded$ = new BehaviorSubject<boolean>(false);\n  private readonly _tokenProcessed$ = new BehaviorSubject<boolean>(false);\n  private readonly _patchLoaded$ = new BehaviorSubject<boolean>(false);\n  private readonly _canvasPrioritizedEventsReady$ = new BehaviorSubject<prioritizedCanvasEvents | undefined>(undefined);\n\n  private readonly _canvasEventListener = new Map<string, Map<listenerPriority, Set<{priority: listenerPriority, handler: (e: Event) => (undefined | boolean)}>>>();\n\n  private readonly _canvasPrioritizedEventsReady = firstValueFrom(this._canvasPrioritizedEventsReady$.pipe(\n    filter(v => v !== undefined)\n  ));\n\n  constructor(private _debuggingEnabled = false) {\n    this._typoBodyLoaded$.pipe(\n\n      /* wait until typo loaded body manually - see loader.ts */\n      filter((loaded) => loaded),\n\n      /* trigger listeners that have to run on typo loaded body */\n      tap(() => this.listenForCanvas()),\n\n      /* wait for all prerequisites */\n      combineLatestWith(this._canvasFound$, this._contentScriptLoaded$, this._tokenProcessed$),\n      filter(([, canvas, content, token]) => canvas && content && token)\n    ).subscribe(() => {\n      this.debug(\"All prerequisites executed, injecting patch and listening to canvas events\");\n      this.listenPrioritizedCanvasElements();\n      this.injectPatch();\n    });\n\n    this.debug(\"Interceptor initialized, starting listeners for token and game.js\");\n    this.waitForTypoLoadedBody();\n    this.processToken();\n\n    this.patchLoaded$.subscribe(() => {\n      document.body.dataset[\"typo_loaded\"] = \"true\";\n    });\n  }\n\n  private debug(...args: unknown[]){\n    if(!this._debuggingEnabled) return;\n    console.log(\"[INTERCEPTOR DEBUG]\", ...args);\n  }\n\n  private injectPatch() {\n    this.debug(\"Injecting game patch\");\n\n    const patch = document.createElement(\"script\");\n    patch.src = chrome.runtime.getURL(\"gamePatch.js\");\n    patch.onload = async () => {\n\n      /* signalize patched game is ready */\n      this.debug(\"Game patch loaded\");\n      this._patchLoaded$.next(true);\n      this._patchLoaded$.complete();\n    };\n    document.body.appendChild(patch);\n  }\n\n  private async processToken(){\n    this.debug(\"Processing token\");\n    const url = new URL(window.location.href);\n    const tokenParam = url.searchParams.get(\"accessToken\");\n    if(tokenParam !== null) {\n      await chrome.runtime.sendMessage({ type: \"set token\", token: tokenParam });\n      url.searchParams.delete(\"accessToken\");\n      window.history.replaceState({}, \"\", url.toString());\n    }\n\n    this.debug(\"Token processed\");\n    this._tokenProcessed$.next(true);\n    this._tokenProcessed$.complete();\n  }\n\n  private waitForTypoLoadedBody(){\n    this.debug(\"Listening for body from typo loader\");\n\n    /* check if body is already added */\n    if(document.body.dataset[\"typo_loader\"] === \"true\") {\n      this.debug(\"Body already loaded\");\n      this._typoBodyLoaded$.next(true);\n      this._typoBodyLoaded$.complete();\n      return;\n    }\n\n    /* observe changes in child list */\n    const bodyObserver = new MutationObserver(() => {\n\n      /* if body is not from typo loader, skip */\n      if(document.body.dataset[\"typo_loader\"] === \"true\") {\n        this.debug(\"Typo body loaded\");\n        this._typoBodyLoaded$.next(true);\n        this._typoBodyLoaded$.complete();\n        bodyObserver.disconnect();\n      }\n    });\n\n    bodyObserver.observe(document, {\n      childList: true,\n      subtree: true\n    });\n  }\n\n  private listenForCanvas(){\n    this.debug(\"Listening on DOM buildup until canvas element is added\");\n\n    /* check if canvas is already added */\n    if(element(\"#game-canvas > canvas\")) {\n      this.debug(\"Canvas already present\");\n      this._canvasFound$.next(true);\n      this._canvasFound$.complete();\n      return;\n    }\n\n    /* observe changes in child list */\n    const scriptObserver = new MutationObserver((mutations) => {\n\n      mutations.forEach((mutation) => {\n        if(mutation.type === \"childList\") {\n\n          /* if canvas element is found */\n          const target = [...mutation.addedNodes].find(n => n.nodeName === \"CANVAS\" && (n as HTMLCanvasElement).parentElement?.id === \"game-canvas\");\n          if(target){\n            this.debug(\"Canvas found\");\n            this._canvasFound$.next(true);\n            this._canvasFound$.complete();\n          }\n        }\n      });\n    });\n\n    scriptObserver.observe(document.body, {\n      childList: true,\n      subtree: true\n    });\n  }\n\n  /**\n   * Listen to all events on the canvas and execute prioritized listeners first\n   * Makes it possible to override skribbl event bindings on the canvas\n   * @private\n   */\n  private listenPrioritizedCanvasElements() {\n    const addListener = (priority: listenerPriority) => {\n      return (type: string, listener: (e: Event) => (undefined | boolean)) => {\n        const listeners = this._canvasEventListener.get(type);\n        if(listeners === undefined) {\n          this._canvasEventListener.set(type, new Map([[priority, new Set([{priority, handler: listener}])]]));\n        } else {\n          const priorityListeners = listeners.get(priority);\n          if(priorityListeners === undefined) {\n            listeners.set(priority, new Set([{priority, handler: listener}]));\n          } else {\n            priorityListeners.add({priority, handler: listener});\n          }\n        }\n      };\n    };\n\n    const removeListener = (type: string, listener: (e: Event) => (undefined | boolean)) => {\n      const listeners = this._canvasEventListener.get(type);\n      if(listeners === undefined) return;\n\n      for(const priorityListeners of listeners.values()){\n        for(const priorityListener of priorityListeners){\n          if(priorityListener.handler === listener) {\n            priorityListeners.delete(priorityListener);\n          }\n        }\n      }\n    };\n\n    const canvas = requireElement(\"#game-canvas > canvas\");\n\n    /* listen all events, execute prioritized listeners first */\n    for (const key in canvas) {\n      if(/^on/.test(key)) {\n        const eventType = key.slice(2);\n        canvas.addEventListener(eventType, event => {\n          const eventListeners = this._canvasEventListener.get(eventType);\n          if(eventListeners === undefined) return;\n\n          const listeners = [\n            ...eventListeners.get(\"preDraw\") ?? [],\n            ...eventListeners.get(\"draw\") ?? [],\n            ...eventListeners.get(\"postDraw\") ?? []\n          ];\n\n          for(const listener of listeners){\n\n            /* if listener returns false, cancel event and do not process any other listeners */\n            if(listener.handler(event) === false) {\n              event.stopImmediatePropagation();\n              return;\n            }\n          }\n        });\n      }\n    }\n\n    this._canvasPrioritizedEventsReady$.next({\n      add: addListener,\n      remove: removeListener\n    });\n  }\n\n  public triggerPatchInjection(){\n    if(this._contentScriptLoaded$.closed) throw new Error(\"Already triggered patch injection\");\n\n    this.debug(\"Content script loaded, triggering patch injection\");\n    this._contentScriptLoaded$.next(true);\n    this._contentScriptLoaded$.complete();\n  }\n\n  public enableDebugging(){\n    this._debuggingEnabled = true;\n  }\n\n  public get patchLoaded$(): Observable<void> {\n    return this._patchLoaded$.pipe(\n      filter(v => v),\n      map(() => void 0)\n    );\n  }\n\n  public get canvasPrioritizedEventsReady() {\n    return this._canvasPrioritizedEventsReady;\n  }\n}","import { is_promise } from './utils.js';\nimport { check_outros, group_outros, transition_in, transition_out } from './transitions.js';\nimport { flush } from './scheduler.js';\nimport { get_current_component, set_current_component } from './lifecycle.js';\n\n/**\n * @template T\n * @param {Promise<T>} promise\n * @param {import('./private.js').PromiseInfo<T>} info\n * @returns {boolean}\n */\nexport function handle_promise(promise, info) {\n\tconst token = (info.token = {});\n\t/**\n\t * @param {import('./private.js').FragmentFactory} type\n\t * @param {0 | 1 | 2} index\n\t * @param {number} [key]\n\t * @param {any} [value]\n\t * @returns {void}\n\t */\n\tfunction update(type, index, key, value) {\n\t\tif (info.token !== token) return;\n\t\tinfo.resolved = value;\n\t\tlet child_ctx = info.ctx;\n\t\tif (key !== undefined) {\n\t\t\tchild_ctx = child_ctx.slice();\n\t\t\tchild_ctx[key] = value;\n\t\t}\n\t\tconst block = type && (info.current = type)(child_ctx);\n\t\tlet needs_flush = false;\n\t\tif (info.block) {\n\t\t\tif (info.blocks) {\n\t\t\t\tinfo.blocks.forEach((block, i) => {\n\t\t\t\t\tif (i !== index && block) {\n\t\t\t\t\t\tgroup_outros();\n\t\t\t\t\t\ttransition_out(block, 1, 1, () => {\n\t\t\t\t\t\t\tif (info.blocks[i] === block) {\n\t\t\t\t\t\t\t\tinfo.blocks[i] = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcheck_outros();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tinfo.block.d(1);\n\t\t\t}\n\t\t\tblock.c();\n\t\t\ttransition_in(block, 1);\n\t\t\tblock.m(info.mount(), info.anchor);\n\t\t\tneeds_flush = true;\n\t\t}\n\t\tinfo.block = block;\n\t\tif (info.blocks) info.blocks[index] = block;\n\t\tif (needs_flush) {\n\t\t\tflush();\n\t\t}\n\t}\n\tif (is_promise(promise)) {\n\t\tconst current_component = get_current_component();\n\t\tpromise.then(\n\t\t\t(value) => {\n\t\t\t\tset_current_component(current_component);\n\t\t\t\tupdate(info.then, 1, info.value, value);\n\t\t\t\tset_current_component(null);\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tset_current_component(current_component);\n\t\t\t\tupdate(info.catch, 2, info.error, error);\n\t\t\t\tset_current_component(null);\n\t\t\t\tif (!info.hasCatch) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\t// if we previously had a then/catch block, destroy it\n\t\tif (info.current !== info.pending) {\n\t\t\tupdate(info.pending, 0);\n\t\t\treturn true;\n\t\t}\n\t} else {\n\t\tif (info.current !== info.then) {\n\t\t\tupdate(info.then, 1, info.value, promise);\n\t\t\treturn true;\n\t\t}\n\t\tinfo.resolved = /** @type {T} */ (promise);\n\t}\n}\n\n/** @returns {void} */\nexport function update_await_block_branch(info, ctx, dirty) {\n\tconst child_ctx = ctx.slice();\n\tconst { resolved } = info;\n\tif (info.current === info.then) {\n\t\tchild_ctx[info.value] = resolved;\n\t}\n\tif (info.current === info.catch) {\n\t\tchild_ctx[info.error] = resolved;\n\t}\n\tinfo.block.p(child_ctx, dirty);\n}\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","/** @returns {{}} */\nexport function get_spread_update(levels, updates) {\n\tconst update = {};\n\tconst to_null_out = {};\n\tconst accounted_for = { $$scope: 1 };\n\tlet i = levels.length;\n\twhile (i--) {\n\t\tconst o = levels[i];\n\t\tconst n = updates[i];\n\t\tif (n) {\n\t\t\tfor (const key in o) {\n\t\t\t\tif (!(key in n)) to_null_out[key] = 1;\n\t\t\t}\n\t\t\tfor (const key in n) {\n\t\t\t\tif (!accounted_for[key]) {\n\t\t\t\t\tupdate[key] = n[key];\n\t\t\t\t\taccounted_for[key] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlevels[i] = n;\n\t\t} else {\n\t\t\tfor (const key in o) {\n\t\t\t\taccounted_for[key] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (const key in to_null_out) {\n\t\tif (!(key in update)) update[key] = undefined;\n\t}\n\treturn update;\n}\n\nexport function get_spread_object(spread_props) {\n\treturn typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n","import {\n\trun_all,\n\tsubscribe,\n\tnoop,\n\tsafe_not_equal,\n\tis_function,\n\tget_store_value\n} from '../internal/index.js';\n\nconst subscriber_queue = [];\n\n/**\n * Creates a `Readable` store that allows reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#readable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readable(value, start) {\n\treturn {\n\t\tsubscribe: writable(value, start).subscribe\n\t};\n}\n\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#writable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Writable<T>}\n */\nexport function writable(value, start = noop) {\n\t/** @type {import('./public.js').Unsubscriber} */\n\tlet stop;\n\t/** @type {Set<import('./private.js').SubscribeInvalidateTuple<T>>} */\n\tconst subscribers = new Set();\n\t/** @param {T} new_value\n\t * @returns {void}\n\t */\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) {\n\t\t\t\t// store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (const subscriber of subscribers) {\n\t\t\t\t\tsubscriber[1]();\n\t\t\t\t\tsubscriber_queue.push(subscriber, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./public.js').Updater<T>} fn\n\t * @returns {void}\n\t */\n\tfunction update(fn) {\n\t\tset(fn(value));\n\t}\n\n\t/**\n\t * @param {import('./public.js').Subscriber<T>} run\n\t * @param {import('./private.js').Invalidator<T>} [invalidate]\n\t * @returns {import('./public.js').Unsubscriber}\n\t */\n\tfunction subscribe(run, invalidate = noop) {\n\t\t/** @type {import('./private.js').SubscribeInvalidateTuple<T>} */\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.add(subscriber);\n\t\tif (subscribers.size === 1) {\n\t\t\tstop = start(set, update) || noop;\n\t\t}\n\t\trun(value);\n\t\treturn () => {\n\t\t\tsubscribers.delete(subscriber);\n\t\t\tif (subscribers.size === 0 && stop) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\treturn { set, update, subscribe };\n}\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>, set: (value: T) => void, update: (fn: import('./public.js').Updater<T>) => void) => import('./public.js').Unsubscriber | void} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>) => T} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * @template {import('./private.js').Stores} S\n * @template T\n * @param {S} stores\n * @param {Function} fn\n * @param {T} [initial_value]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function derived(stores, fn, initial_value) {\n\tconst single = !Array.isArray(stores);\n\t/** @type {Array<import('./public.js').Readable<any>>} */\n\tconst stores_array = single ? [stores] : stores;\n\tif (!stores_array.every(Boolean)) {\n\t\tthrow new Error('derived() expects stores as input, got a falsy value');\n\t}\n\tconst auto = fn.length < 2;\n\treturn readable(initial_value, (set, update) => {\n\t\tlet started = false;\n\t\tconst values = [];\n\t\tlet pending = 0;\n\t\tlet cleanup = noop;\n\t\tconst sync = () => {\n\t\t\tif (pending) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcleanup();\n\t\t\tconst result = fn(single ? values[0] : values, set, update);\n\t\t\tif (auto) {\n\t\t\t\tset(result);\n\t\t\t} else {\n\t\t\t\tcleanup = is_function(result) ? result : noop;\n\t\t\t}\n\t\t};\n\t\tconst unsubscribers = stores_array.map((store, i) =>\n\t\t\tsubscribe(\n\t\t\t\tstore,\n\t\t\t\t(value) => {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t\tpending &= ~(1 << i);\n\t\t\t\t\tif (started) {\n\t\t\t\t\t\tsync();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tpending |= 1 << i;\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tstarted = true;\n\t\tsync();\n\t\treturn function stop() {\n\t\t\trun_all(unsubscribers);\n\t\t\tcleanup();\n\t\t\t// We need to set this to false because callbacks can still happen despite having unsubscribed:\n\t\t\t// Callbacks might already be placed in the queue which doesn't know it should no longer\n\t\t\t// invoke this derived store.\n\t\t\tstarted = false;\n\t\t};\n\t});\n}\n\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * https://svelte.dev/docs/svelte-store#readonly\n * @template T\n * @param {import('./public.js').Readable<T>} store  - store to make readonly\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readonly(store) {\n\treturn {\n\t\tsubscribe: store.subscribe.bind(store)\n\t};\n}\n\nexport { get_store_value as get };\n","import { Observable } from \"rxjs\";\nimport { writable } from \"svelte/store\";\n\nexport function fromObservable<TData>(observable: Observable<TData>, initialValue: TData, onWrite?: (value: TData) => void, allowWriteBeforeEmit = true) {\n  const store = writable(initialValue);\n\n  /**\n   * Allow writing back to source only when the observable has emitted at least once,\n   * to prevent writing back a placeholder default value\n   */\n  let hasEmitted = allowWriteBeforeEmit;\n\n  const subscription = observable.subscribe({\n    next: (value) => {\n      store.set(value);\n      hasEmitted = true;\n    },\n    error: (err) => console.error(\"Error from observable:\", err),\n  });\n\n  return {\n    subscribe: store.subscribe,\n    unsubscribe: () => subscription.unsubscribe(),\n    set: (value: TData) => {\n      store.set(value);\n      if(hasEmitted) onWrite?.(value);\n    },\n  };\n}","<script lang=\"ts\">\n  import { createEventDispatcher } from \"svelte\";\n\n  export let checked = false;\n  export let disabled = false;\n  export let description = \"\";\n  const dispatch = createEventDispatcher();\n</script>\n\n<style lang=\"scss\">\n\n  div {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    gap: .5em;\n    cursor: pointer;\n    padding: .2em;\n\n    &.disabled {\n      opacity: .5;\n      pointer-events: none;\n    }\n\n    img {\n      height: 1.5em;\n      aspect-ratio: 1;\n      filter: drop-shadow(3px 3px 0px rgba(0, 0, 0, .3));\n      user-select: none;\n    }\n\n    span {\n      user-select: none;\n      font-weight: 600;\n    }\n  }\n</style>\n\n<div class:disabled={disabled} role=\"checkbox\" tabindex=\"0\" aria-checked=\"{checked}\" on:click\n     on:click={() => {checked = !checked; dispatch(\"change\", checked)}}\n     on:keypress={(key) => {key.key === 'Enter' ? checked = !checked : 0; dispatch(\"change\", checked)}}\n>\n  <img src=\"\" alt=\"icon\" style=\"content: var(--{checked ? 'file-img-enabled-gif' : 'file-img-disabled-gif'})\">\n  {#if (description)}\n    <span>{description}</span>\n  {/if}\n</div>","<script lang=\"ts\">\n\n  import type { ExtensionSetting } from \"@/content/core/settings/setting\";\n  import Checkbox from \"../checkbox/checkbox.svelte\";\n\n  export let setting: ExtensionSetting<boolean>;\n  let settingStore: ExtensionSetting<boolean>[\"store\"] | undefined;\n\n  $: {\n    settingStore = setting.store;\n  }\n\n</script>\n\n<style lang=\"scss\">\n  b {\n    font-size: 1.1rem;\n  }\n</style>\n\n{#if settingStore}\n  <b><Checkbox bind:checked={$settingStore} description={setting.name}/></b>\n  <div>{setting.description}</div>\n{/if}\n\n\n","<script lang=\"ts\">\n\n  import type { ExtensionSetting } from \"@/content/core/settings/setting\";\n  import Checkbox from \"../checkbox/checkbox.svelte\";\n\n  export let setting: ExtensionSetting<number>;\n  export let bounds: { min: number, max: number } | undefined;\n  export let withSliderAndSteps: number | undefined;\n\n  let settingStore: ExtensionSetting<number>[\"store\"] | undefined;\n\n  $: {\n    settingStore = setting.store;\n  }\n\n</script>\n\n<style lang=\"scss\">\n  .typo-numeric-setting {\n\n    b {\n      font-size: 1.1rem;\n    }\n\n    display: grid;\n    align-items: center;\n    grid-template-columns: auto auto;\n    grid-template-rows: auto auto auto;\n\n    input:invalid{\n      border-color: unset;\n    }\n\n    input[type=number] {\n      width: 10ex;\n    }\n\n    input[type=range] {\n      grid-column: span 2;\n    }\n  }\n</style>\n\n{#if settingStore}\n  <div class=\"typo-numeric-setting\">\n    <b>{setting.name}</b>\n    <input type=\"number\" min=\"{bounds?.min}\" max=\"{bounds?.max}\" bind:value={$settingStore} />\n\n    {#if withSliderAndSteps !== undefined && bounds}\n      <input type=\"range\" min=\"{bounds.min}\" max=\"{bounds.max}\" bind:value={$settingStore} step=\"{withSliderAndSteps}\" />\n    {/if}\n\n    <div>{setting.description}</div>\n  </div>\n{/if}\n\n\n","<script lang=\"ts\" generics=\"TChoice extends string\">\n\n  import type { ExtensionSetting } from \"@/content/core/settings/setting\";\n\n  export let setting: ExtensionSetting<TChoice>;\n  export let choices: { choice: TChoice, name: string }[];\n  let settingStore: ExtensionSetting<TChoice>[\"store\"] | undefined;\n\n  $: {\n    settingStore = setting.store;\n  }\n\n</script>\n\n<style lang=\"scss\">\n  .typo-numeric-setting {\n\n    b {\n      font-size: 1.1rem;\n    }\n\n    display: flex;\n    flex-direction: column;\n    justify-items: stretch;\n    gap: .5rem;\n  }\n</style>\n\n{#if settingStore}\n  <div class=\"typo-numeric-setting\">\n    <b>{setting.name}</b>\n    <select bind:value={$settingStore}>\n      {#each choices as { choice, name }}\n        <option value={choice}>{name}</option>\n      {/each}\n    </select>\n\n    <div>{setting.description}</div>\n  </div>\n{/if}\n\n\n","<script lang=\"ts\">\n\n  import type { ExtensionSetting } from \"@/content/core/settings/setting\";\n\n  export let setting: ExtensionSetting<string>;\n\n  let settingStore: ExtensionSetting<string>[\"store\"] | undefined;\n\n  $: {\n    settingStore = setting.store;\n  }\n\n</script>\n\n<style lang=\"scss\">\n  .typo-text-setting {\n\n    b {\n      font-size: 1.1rem;\n    }\n\n    display: grid;\n    align-items: center;\n    grid-template-columns: auto auto;\n    grid-template-rows: auto auto;\n\n    input:invalid{\n      border-color: unset;\n    }\n\n    input {\n      grid-column: span 2;\n    }\n  }\n</style>\n\n{#if settingStore}\n  <div class=\"typo-text-setting\">\n    <b>{setting.name}</b>\n    <input type=\"text\" bind:value={$settingStore} />\n\n    <div>{setting.description}</div>\n  </div>\n{/if}\n\n\n","import type { TypoFeature } from \"@/content/core/feature/feature\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { BehaviorSubject, from, of, switchMap } from \"rxjs\";\nimport BooleanSettingInput from \"@/lib/settings/boolean-setting-input.svelte\";\nimport NumericSettingInput from \"@/lib/settings/numeric-setting-input.svelte\";\nimport ChoiceSettingInput from \"@/lib/settings/choice-setting-input.svelte\";\nimport TextSettingInput from \"@/lib/settings/text-setting-input.svelte\";\nimport type { SvelteComponent } from \"svelte\";\n\nexport type primitive = string | number | boolean;\nexport type serializable = undefined | primitive | serializable[] | { [key: string]: serializable };\n\nexport type serializableObject = Record<string, serializable>;\n\nexport class ExtensionSetting<TValue extends serializable> {\n\n  private _name?: string;\n  private _description?: string;\n  private _changes = new BehaviorSubject<TValue | null>(null);\n\n  constructor(\n    private readonly key: string,\n    private defaultValue: TValue,\n    private readonly feature?: TypoFeature\n  ) {\n    this.feature = feature;\n  }\n\n  private get globalKey() {\n    const sanitized = this.key.replace(/[^a-zA-Z0-9.]/g, \"_\");\n    return this.feature ?\n      `feature_${this.feature.featureId}.${sanitized}` :\n      `global.${sanitized}`;\n  }\n\n  public async getValue(): Promise<TValue> {\n    const string = await chrome.runtime.sendMessage({ type: \"get setting\", key: this.globalKey });\n    if(string === undefined || string === null) return this.defaultValue;\n    const value = JSON.parse(string) as TValue;\n\n    /* update cached value */\n    this._changes.next(value);\n\n    return value;\n  }\n\n  public async setValue(value: TValue) {\n    const json = JSON.stringify(value);\n    await chrome.runtime.sendMessage({ type: \"set setting\", key: this.globalKey, value: json });\n    this._changes.next(value);\n  }\n\n  public get name() {\n    return this._name;\n  }\n\n  public get description() {\n    return this._description;\n  }\n\n  public setDefaultValue(value: TValue) {\n    this.defaultValue = value;\n  }\n\n  public withName(name: string) {\n    this._name = name;\n    return this;\n  }\n\n  public withDescription(description: string) {\n    this._description = description;\n    return this;\n  }\n\n  public get changes$() {\n    return this._changes.pipe(\n      switchMap((data) => data === null ? from(this.getValue()) : of(data))\n    );\n  }\n\n  public get store() {\n    return fromObservable(this.changes$, this.defaultValue, value => this.setValue(value), false);\n  }\n\n  public get asFrozen(): Omit<ExtensionSetting<TValue>, \"withDescription\" | \"withName\">{\n    return this;\n  }\n}\n\nexport abstract class SettingWithInput<TSetting extends serializable> extends ExtensionSetting<TSetting> {\n  public abstract get componentData(): componentData<SvelteComponent<{setting: ExtensionSetting<TSetting>}>>;\n}\n\nexport class BooleanExtensionSetting extends SettingWithInput<boolean> {\n  public override get componentData()  {\n    return {\n      componentType: BooleanSettingInput,\n      props: { setting: this }\n    };\n  }\n}\n\nexport class TextExtensionSetting extends SettingWithInput<string> {\n  public override get componentData()  {\n    return {\n      componentType: TextSettingInput,\n      props: { setting: this }\n    };\n  }\n}\n\nexport class NumericExtensionSetting extends SettingWithInput<number> {\n\n  private _min?: number;\n  private _max?: number;\n  private _sliderWithSteps?: number;\n\n  public override get componentData()  {\n    return {\n      componentType: NumericSettingInput,\n      props: {\n        setting: this,\n        withSliderAndSteps: this._sliderWithSteps,\n        bounds: this._min !== undefined && this._max !== undefined ? {min: this._min, max: this._max} : undefined\n      }\n    };\n  }\n\n  public withBounds(min: number, max: number) {\n    this._min = min;\n    this._max = max;\n    return this;\n  }\n\n  public withSlider(steps = 1) {\n    this._sliderWithSteps = steps;\n    return this;\n  }\n}\n\nexport class ChoiceExtensionSetting<TChoice extends string> extends SettingWithInput<TChoice> {\n  private _choices: { choice: TChoice, name: string }[] = [];\n\n  public override get componentData() {\n    return {\n      componentType: ChoiceSettingInput,\n      props: {\n        setting: this,\n        choices: this._choices\n      },\n    };\n  }\n\n  public withChoices(choices: { choice: TChoice, name: string }[]) {\n    this._choices = choices;\n    return this;\n  }\n}","export var NAMED_TAG = 'named';\r\nexport var NAME_TAG = 'name';\r\nexport var UNMANAGED_TAG = 'unmanaged';\r\nexport var OPTIONAL_TAG = 'optional';\r\nexport var INJECT_TAG = 'inject';\r\nexport var MULTI_INJECT_TAG = 'multi_inject';\r\nexport var TAGGED = 'inversify:tagged';\r\nexport var TAGGED_PROP = 'inversify:tagged_props';\r\nexport var PARAM_TYPES = 'inversify:paramtypes';\r\nexport var DESIGN_PARAM_TYPES = 'design:paramtypes';\r\nexport var POST_CONSTRUCT = 'post_construct';\r\nexport var PRE_DESTROY = 'pre_destroy';\r\nfunction getNonCustomTagKeys() {\r\n    return [\r\n        INJECT_TAG,\r\n        MULTI_INJECT_TAG,\r\n        NAME_TAG,\r\n        UNMANAGED_TAG,\r\n        NAMED_TAG,\r\n        OPTIONAL_TAG,\r\n    ];\r\n}\r\nexport var NON_CUSTOM_TAG_KEYS = getNonCustomTagKeys();\r\n","var BindingScopeEnum = {\r\n    Request: 'Request',\r\n    Singleton: 'Singleton',\r\n    Transient: 'Transient'\r\n};\r\nvar BindingTypeEnum = {\r\n    ConstantValue: 'ConstantValue',\r\n    Constructor: 'Constructor',\r\n    DynamicValue: 'DynamicValue',\r\n    Factory: 'Factory',\r\n    Function: 'Function',\r\n    Instance: 'Instance',\r\n    Invalid: 'Invalid',\r\n    Provider: 'Provider'\r\n};\r\nvar TargetTypeEnum = {\r\n    ClassProperty: 'ClassProperty',\r\n    ConstructorArgument: 'ConstructorArgument',\r\n    Variable: 'Variable'\r\n};\r\nexport { BindingScopeEnum, BindingTypeEnum, TargetTypeEnum };\r\n","var idCounter = 0;\r\nfunction id() {\r\n    return idCounter++;\r\n}\r\nexport { id };\r\n","import { BindingScopeEnum, BindingTypeEnum } from '../constants/literal_types';\r\nimport { id } from '../utils/id';\r\nvar Binding = (function () {\r\n    function Binding(serviceIdentifier, scope) {\r\n        this.id = id();\r\n        this.activated = false;\r\n        this.serviceIdentifier = serviceIdentifier;\r\n        this.scope = scope;\r\n        this.type = BindingTypeEnum.Invalid;\r\n        this.constraint = function (request) { return true; };\r\n        this.implementationType = null;\r\n        this.cache = null;\r\n        this.factory = null;\r\n        this.provider = null;\r\n        this.onActivation = null;\r\n        this.onDeactivation = null;\r\n        this.dynamicValue = null;\r\n    }\r\n    Binding.prototype.clone = function () {\r\n        var clone = new Binding(this.serviceIdentifier, this.scope);\r\n        clone.activated = (clone.scope === BindingScopeEnum.Singleton) ? this.activated : false;\r\n        clone.implementationType = this.implementationType;\r\n        clone.dynamicValue = this.dynamicValue;\r\n        clone.scope = this.scope;\r\n        clone.type = this.type;\r\n        clone.factory = this.factory;\r\n        clone.provider = this.provider;\r\n        clone.constraint = this.constraint;\r\n        clone.onActivation = this.onActivation;\r\n        clone.onDeactivation = this.onDeactivation;\r\n        clone.cache = this.cache;\r\n        return clone;\r\n    };\r\n    return Binding;\r\n}());\r\nexport { Binding };\r\n","export var DUPLICATED_INJECTABLE_DECORATOR = 'Cannot apply @injectable decorator multiple times.';\r\nexport var DUPLICATED_METADATA = 'Metadata key was used more than once in a parameter:';\r\nexport var NULL_ARGUMENT = 'NULL argument';\r\nexport var KEY_NOT_FOUND = 'Key Not Found';\r\nexport var AMBIGUOUS_MATCH = 'Ambiguous match found for serviceIdentifier:';\r\nexport var CANNOT_UNBIND = 'Could not unbind serviceIdentifier:';\r\nexport var NOT_REGISTERED = 'No matching bindings found for serviceIdentifier:';\r\nexport var MISSING_INJECTABLE_ANNOTATION = 'Missing required @injectable annotation in:';\r\nexport var MISSING_INJECT_ANNOTATION = 'Missing required @inject or @multiInject annotation in:';\r\nexport var UNDEFINED_INJECT_ANNOTATION = function (name) {\r\n    return \"@inject called with undefined this could mean that the class \" + name + \" has \" +\r\n        'a circular dependency problem. You can use a LazyServiceIdentifier to  ' +\r\n        'overcome this limitation.';\r\n};\r\nexport var CIRCULAR_DEPENDENCY = 'Circular dependency found:';\r\nexport var NOT_IMPLEMENTED = 'Sorry, this feature is not fully implemented yet.';\r\nexport var INVALID_BINDING_TYPE = 'Invalid binding type:';\r\nexport var NO_MORE_SNAPSHOTS_AVAILABLE = 'No snapshot available to restore.';\r\nexport var INVALID_MIDDLEWARE_RETURN = 'Invalid return type in middleware. Middleware must return!';\r\nexport var INVALID_FUNCTION_BINDING = 'Value provided to function binding must be a function!';\r\nexport var LAZY_IN_SYNC = function (key) { return \"You are attempting to construct '\" + key + \"' in a synchronous way\\n but it has asynchronous dependencies.\"; };\r\nexport var INVALID_TO_SELF_VALUE = 'The toSelf function can only be applied when a constructor is ' +\r\n    'used as service identifier';\r\nexport var INVALID_DECORATOR_OPERATION = 'The @inject @multiInject @tagged and @named decorators ' +\r\n    'must be applied to the parameters of a class constructor or a class property.';\r\nexport var ARGUMENTS_LENGTH_MISMATCH = function () {\r\n    var values = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        values[_i] = arguments[_i];\r\n    }\r\n    return 'The number of constructor arguments in the derived class ' +\r\n        (values[0] + \" must be >= than the number of constructor arguments of its base class.\");\r\n};\r\nexport var CONTAINER_OPTIONS_MUST_BE_AN_OBJECT = 'Invalid Container constructor argument. Container options ' +\r\n    'must be an object.';\r\nexport var CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE = 'Invalid Container option. Default scope must ' +\r\n    'be a string (\"singleton\" or \"transient\").';\r\nexport var CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE = 'Invalid Container option. Auto bind injectable must ' +\r\n    'be a boolean';\r\nexport var CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK = 'Invalid Container option. Skip base check must ' +\r\n    'be a boolean';\r\nexport var MULTIPLE_PRE_DESTROY_METHODS = 'Cannot apply @preDestroy decorator multiple times in the same class';\r\nexport var MULTIPLE_POST_CONSTRUCT_METHODS = 'Cannot apply @postConstruct decorator multiple times in the same class';\r\nexport var ASYNC_UNBIND_REQUIRED = 'Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)';\r\nexport var POST_CONSTRUCT_ERROR = function (clazz, errorMessage) { return \"@postConstruct error in class \" + clazz + \": \" + errorMessage; };\r\nexport var PRE_DESTROY_ERROR = function (clazz, errorMessage) { return \"@preDestroy error in class \" + clazz + \": \" + errorMessage; };\r\nexport var ON_DEACTIVATION_ERROR = function (clazz, errorMessage) { return \"onDeactivation() error in class \" + clazz + \": \" + errorMessage; };\r\nexport var CIRCULAR_DEPENDENCY_IN_FACTORY = function (factoryType, serviceIdentifier) {\r\n    return \"It looks like there is a circular dependency in one of the '\" + factoryType + \"' bindings. Please investigate bindings with \" +\r\n        (\"service identifier '\" + serviceIdentifier + \"'.\");\r\n};\r\nexport var STACK_OVERFLOW = 'Maximum call stack size exceeded';\r\n","import * as METADATA_KEY from '../constants/metadata_keys';\r\nvar MetadataReader = (function () {\r\n    function MetadataReader() {\r\n    }\r\n    MetadataReader.prototype.getConstructorMetadata = function (constructorFunc) {\r\n        var compilerGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.PARAM_TYPES, constructorFunc);\r\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED, constructorFunc);\r\n        return {\r\n            compilerGeneratedMetadata: compilerGeneratedMetadata,\r\n            userGeneratedMetadata: userGeneratedMetadata || {}\r\n        };\r\n    };\r\n    MetadataReader.prototype.getPropertiesMetadata = function (constructorFunc) {\r\n        var userGeneratedMetadata = Reflect.getMetadata(METADATA_KEY.TAGGED_PROP, constructorFunc) || [];\r\n        return userGeneratedMetadata;\r\n    };\r\n    return MetadataReader;\r\n}());\r\nexport { MetadataReader };\r\n","export var BindingCount = {\r\n    MultipleBindingsAvailable: 2,\r\n    NoBindingsAvailable: 0,\r\n    OnlyOneBindingAvailable: 1\r\n};\r\n","import * as ERROR_MSGS from '../constants/error_msgs';\r\nexport function isStackOverflowExeption(error) {\r\n    return (error instanceof RangeError ||\r\n        error.message === ERROR_MSGS.STACK_OVERFLOW);\r\n}\r\nexport var tryAndThrowErrorIfStackOverflow = function (fn, errorCallback) {\r\n    try {\r\n        return fn();\r\n    }\r\n    catch (error) {\r\n        if (isStackOverflowExeption(error)) {\r\n            error = errorCallback();\r\n        }\r\n        throw error;\r\n    }\r\n};\r\n","import * as ERROR_MSGS from '../constants/error_msgs';\r\nfunction getServiceIdentifierAsString(serviceIdentifier) {\r\n    if (typeof serviceIdentifier === 'function') {\r\n        var _serviceIdentifier = serviceIdentifier;\r\n        return _serviceIdentifier.name;\r\n    }\r\n    else if (typeof serviceIdentifier === 'symbol') {\r\n        return serviceIdentifier.toString();\r\n    }\r\n    else {\r\n        var _serviceIdentifier = serviceIdentifier;\r\n        return _serviceIdentifier;\r\n    }\r\n}\r\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\r\n    var registeredBindingsList = '';\r\n    var registeredBindings = getBindings(container, serviceIdentifier);\r\n    if (registeredBindings.length !== 0) {\r\n        registeredBindingsList = '\\nRegistered bindings:';\r\n        registeredBindings.forEach(function (binding) {\r\n            var name = 'Object';\r\n            if (binding.implementationType !== null) {\r\n                name = getFunctionName(binding.implementationType);\r\n            }\r\n            registeredBindingsList = registeredBindingsList + \"\\n \" + name;\r\n            if (binding.constraint.metaData) {\r\n                registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\r\n            }\r\n        });\r\n    }\r\n    return registeredBindingsList;\r\n}\r\nfunction alreadyDependencyChain(request, serviceIdentifier) {\r\n    if (request.parentRequest === null) {\r\n        return false;\r\n    }\r\n    else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\r\n        return true;\r\n    }\r\n    else {\r\n        return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\r\n    }\r\n}\r\nfunction dependencyChainToString(request) {\r\n    function _createStringArr(req, result) {\r\n        if (result === void 0) { result = []; }\r\n        var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\r\n        result.push(serviceIdentifier);\r\n        if (req.parentRequest !== null) {\r\n            return _createStringArr(req.parentRequest, result);\r\n        }\r\n        return result;\r\n    }\r\n    var stringArr = _createStringArr(request);\r\n    return stringArr.reverse().join(' --> ');\r\n}\r\nfunction circularDependencyToException(request) {\r\n    request.childRequests.forEach(function (childRequest) {\r\n        if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\r\n            var services = dependencyChainToString(childRequest);\r\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\r\n        }\r\n        else {\r\n            circularDependencyToException(childRequest);\r\n        }\r\n    });\r\n}\r\nfunction listMetadataForTarget(serviceIdentifierString, target) {\r\n    if (target.isTagged() || target.isNamed()) {\r\n        var m_1 = '';\r\n        var namedTag = target.getNamedTag();\r\n        var otherTags = target.getCustomTags();\r\n        if (namedTag !== null) {\r\n            m_1 += namedTag.toString() + '\\n';\r\n        }\r\n        if (otherTags !== null) {\r\n            otherTags.forEach(function (tag) {\r\n                m_1 += tag.toString() + '\\n';\r\n            });\r\n        }\r\n        return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\r\n    }\r\n    else {\r\n        return \" \" + serviceIdentifierString;\r\n    }\r\n}\r\nfunction getFunctionName(func) {\r\n    if (func.name) {\r\n        return func.name;\r\n    }\r\n    else {\r\n        var name_1 = func.toString();\r\n        var match = name_1.match(/^function\\s*([^\\s(]+)/);\r\n        return match ? match[1] : \"Anonymous function: \" + name_1;\r\n    }\r\n}\r\nfunction getSymbolDescription(symbol) {\r\n    return symbol.toString().slice(7, -1);\r\n}\r\nexport { getFunctionName, getServiceIdentifierAsString, listRegisteredBindingsForServiceIdentifier, listMetadataForTarget, circularDependencyToException, getSymbolDescription };\r\n","import { id } from '../utils/id';\r\nvar Context = (function () {\r\n    function Context(container) {\r\n        this.id = id();\r\n        this.container = container;\r\n    }\r\n    Context.prototype.addPlan = function (plan) {\r\n        this.plan = plan;\r\n    };\r\n    Context.prototype.setCurrentRequest = function (currentRequest) {\r\n        this.currentRequest = currentRequest;\r\n    };\r\n    return Context;\r\n}());\r\nexport { Context };\r\n","import * as METADATA_KEY from '../constants/metadata_keys';\r\nvar Metadata = (function () {\r\n    function Metadata(key, value) {\r\n        this.key = key;\r\n        this.value = value;\r\n    }\r\n    Metadata.prototype.toString = function () {\r\n        if (this.key === METADATA_KEY.NAMED_TAG) {\r\n            return \"named: \" + String(this.value).toString() + \" \";\r\n        }\r\n        else {\r\n            return \"tagged: { key:\" + this.key.toString() + \", value: \" + String(this.value) + \" }\";\r\n        }\r\n    };\r\n    return Metadata;\r\n}());\r\nexport { Metadata };\r\n","var Plan = (function () {\r\n    function Plan(parentContext, rootRequest) {\r\n        this.parentContext = parentContext;\r\n        this.rootRequest = rootRequest;\r\n    }\r\n    return Plan;\r\n}());\r\nexport { Plan };\r\n","var LazyServiceIdentifier = (function () {\r\n    function LazyServiceIdentifier(cb) {\r\n        this._cb = cb;\r\n    }\r\n    LazyServiceIdentifier.prototype.unwrap = function () {\r\n        return this._cb();\r\n    };\r\n    return LazyServiceIdentifier;\r\n}());\r\nexport { LazyServiceIdentifier };\r\n","var QueryableString = (function () {\r\n    function QueryableString(str) {\r\n        this.str = str;\r\n    }\r\n    QueryableString.prototype.startsWith = function (searchString) {\r\n        return this.str.indexOf(searchString) === 0;\r\n    };\r\n    QueryableString.prototype.endsWith = function (searchString) {\r\n        var reverseString = '';\r\n        var reverseSearchString = searchString.split('').reverse().join('');\r\n        reverseString = this.str.split('').reverse().join('');\r\n        return this.startsWith.call({ str: reverseString }, reverseSearchString);\r\n    };\r\n    QueryableString.prototype.contains = function (searchString) {\r\n        return (this.str.indexOf(searchString) !== -1);\r\n    };\r\n    QueryableString.prototype.equals = function (compareString) {\r\n        return this.str === compareString;\r\n    };\r\n    QueryableString.prototype.value = function () {\r\n        return this.str;\r\n    };\r\n    return QueryableString;\r\n}());\r\nexport { QueryableString };\r\n","import * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { id } from '../utils/id';\r\nimport { getSymbolDescription } from '../utils/serialization';\r\nimport { Metadata } from './metadata';\r\nimport { QueryableString } from './queryable_string';\r\nvar Target = (function () {\r\n    function Target(type, identifier, serviceIdentifier, namedOrTagged) {\r\n        this.id = id();\r\n        this.type = type;\r\n        this.serviceIdentifier = serviceIdentifier;\r\n        var queryableName = typeof identifier === 'symbol' ? getSymbolDescription(identifier) : identifier;\r\n        this.name = new QueryableString(queryableName || '');\r\n        this.identifier = identifier;\r\n        this.metadata = new Array();\r\n        var metadataItem = null;\r\n        if (typeof namedOrTagged === 'string') {\r\n            metadataItem = new Metadata(METADATA_KEY.NAMED_TAG, namedOrTagged);\r\n        }\r\n        else if (namedOrTagged instanceof Metadata) {\r\n            metadataItem = namedOrTagged;\r\n        }\r\n        if (metadataItem !== null) {\r\n            this.metadata.push(metadataItem);\r\n        }\r\n    }\r\n    Target.prototype.hasTag = function (key) {\r\n        for (var _i = 0, _a = this.metadata; _i < _a.length; _i++) {\r\n            var m = _a[_i];\r\n            if (m.key === key) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Target.prototype.isArray = function () {\r\n        return this.hasTag(METADATA_KEY.MULTI_INJECT_TAG);\r\n    };\r\n    Target.prototype.matchesArray = function (name) {\r\n        return this.matchesTag(METADATA_KEY.MULTI_INJECT_TAG)(name);\r\n    };\r\n    Target.prototype.isNamed = function () {\r\n        return this.hasTag(METADATA_KEY.NAMED_TAG);\r\n    };\r\n    Target.prototype.isTagged = function () {\r\n        return this.metadata.some(function (metadata) { return METADATA_KEY.NON_CUSTOM_TAG_KEYS.every(function (key) { return metadata.key !== key; }); });\r\n    };\r\n    Target.prototype.isOptional = function () {\r\n        return this.matchesTag(METADATA_KEY.OPTIONAL_TAG)(true);\r\n    };\r\n    Target.prototype.getNamedTag = function () {\r\n        if (this.isNamed()) {\r\n            return this.metadata.filter(function (m) { return m.key === METADATA_KEY.NAMED_TAG; })[0];\r\n        }\r\n        return null;\r\n    };\r\n    Target.prototype.getCustomTags = function () {\r\n        if (this.isTagged()) {\r\n            return this.metadata.filter(function (metadata) { return METADATA_KEY.NON_CUSTOM_TAG_KEYS.every(function (key) { return metadata.key !== key; }); });\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    Target.prototype.matchesNamedTag = function (name) {\r\n        return this.matchesTag(METADATA_KEY.NAMED_TAG)(name);\r\n    };\r\n    Target.prototype.matchesTag = function (key) {\r\n        var _this = this;\r\n        return function (value) {\r\n            for (var _i = 0, _a = _this.metadata; _i < _a.length; _i++) {\r\n                var m = _a[_i];\r\n                if (m.key === key && m.value === value) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n    };\r\n    return Target;\r\n}());\r\nexport { Target };\r\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nimport { LazyServiceIdentifier } from '../annotation/lazy_service_identifier';\r\nimport * as ERROR_MSGS from '../constants/error_msgs';\r\nimport { TargetTypeEnum } from '../constants/literal_types';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { getFunctionName } from '../utils/serialization';\r\nimport { Target } from './target';\r\nfunction getDependencies(metadataReader, func) {\r\n    var constructorName = getFunctionName(func);\r\n    return getTargets(metadataReader, constructorName, func, false);\r\n}\r\nfunction getTargets(metadataReader, constructorName, func, isBaseClass) {\r\n    var metadata = metadataReader.getConstructorMetadata(func);\r\n    var serviceIdentifiers = metadata.compilerGeneratedMetadata;\r\n    if (serviceIdentifiers === undefined) {\r\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" \" + constructorName + \".\";\r\n        throw new Error(msg);\r\n    }\r\n    var constructorArgsMetadata = metadata.userGeneratedMetadata;\r\n    var keys = Object.keys(constructorArgsMetadata);\r\n    var hasUserDeclaredUnknownInjections = (func.length === 0 && keys.length > 0);\r\n    var hasOptionalParameters = keys.length > func.length;\r\n    var iterations = (hasUserDeclaredUnknownInjections || hasOptionalParameters) ? keys.length : func.length;\r\n    var constructorTargets = getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations);\r\n    var propertyTargets = getClassPropsAsTargets(metadataReader, func, constructorName);\r\n    var targets = __spreadArray(__spreadArray([], constructorTargets, true), propertyTargets, true);\r\n    return targets;\r\n}\r\nfunction getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata) {\r\n    var targetMetadata = constructorArgsMetadata[index.toString()] || [];\r\n    var metadata = formatTargetMetadata(targetMetadata);\r\n    var isManaged = metadata.unmanaged !== true;\r\n    var serviceIdentifier = serviceIdentifiers[index];\r\n    var injectIdentifier = metadata.inject || metadata.multiInject;\r\n    serviceIdentifier = (injectIdentifier ? injectIdentifier : serviceIdentifier);\r\n    if (serviceIdentifier instanceof LazyServiceIdentifier) {\r\n        serviceIdentifier = serviceIdentifier.unwrap();\r\n    }\r\n    if (isManaged) {\r\n        var isObject = serviceIdentifier === Object;\r\n        var isFunction = serviceIdentifier === Function;\r\n        var isUndefined = serviceIdentifier === undefined;\r\n        var isUnknownType = isObject || isFunction || isUndefined;\r\n        if (!isBaseClass && isUnknownType) {\r\n            var msg = ERROR_MSGS.MISSING_INJECT_ANNOTATION + \" argument \" + index + \" in class \" + constructorName + \".\";\r\n            throw new Error(msg);\r\n        }\r\n        var target = new Target(TargetTypeEnum.ConstructorArgument, metadata.targetName, serviceIdentifier);\r\n        target.metadata = targetMetadata;\r\n        return target;\r\n    }\r\n    return null;\r\n}\r\nfunction getConstructorArgsAsTargets(isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata, iterations) {\r\n    var targets = [];\r\n    for (var i = 0; i < iterations; i++) {\r\n        var index = i;\r\n        var target = getConstructorArgsAsTarget(index, isBaseClass, constructorName, serviceIdentifiers, constructorArgsMetadata);\r\n        if (target !== null) {\r\n            targets.push(target);\r\n        }\r\n    }\r\n    return targets;\r\n}\r\nfunction _getServiceIdentifierForProperty(inject, multiInject, propertyName, className) {\r\n    var serviceIdentifier = (inject || multiInject);\r\n    if (serviceIdentifier === undefined) {\r\n        var msg = ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION + \" for property \" + String(propertyName) + \" in class \" + className + \".\";\r\n        throw new Error(msg);\r\n    }\r\n    return serviceIdentifier;\r\n}\r\nfunction getClassPropsAsTargets(metadataReader, constructorFunc, constructorName) {\r\n    var classPropsMetadata = metadataReader.getPropertiesMetadata(constructorFunc);\r\n    var targets = [];\r\n    var symbolKeys = Object.getOwnPropertySymbols(classPropsMetadata);\r\n    var stringKeys = Object.keys(classPropsMetadata);\r\n    var keys = stringKeys.concat(symbolKeys);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        var targetMetadata = classPropsMetadata[key];\r\n        var metadata = formatTargetMetadata(targetMetadata);\r\n        var identifier = metadata.targetName || key;\r\n        var serviceIdentifier = _getServiceIdentifierForProperty(metadata.inject, metadata.multiInject, key, constructorName);\r\n        var target = new Target(TargetTypeEnum.ClassProperty, identifier, serviceIdentifier);\r\n        target.metadata = targetMetadata;\r\n        targets.push(target);\r\n    }\r\n    var baseConstructor = Object.getPrototypeOf(constructorFunc.prototype).constructor;\r\n    if (baseConstructor !== Object) {\r\n        var baseTargets = getClassPropsAsTargets(metadataReader, baseConstructor, constructorName);\r\n        targets = __spreadArray(__spreadArray([], targets, true), baseTargets, true);\r\n    }\r\n    return targets;\r\n}\r\nfunction getBaseClassDependencyCount(metadataReader, func) {\r\n    var baseConstructor = Object.getPrototypeOf(func.prototype).constructor;\r\n    if (baseConstructor !== Object) {\r\n        var baseConstructorName = getFunctionName(baseConstructor);\r\n        var targets = getTargets(metadataReader, baseConstructorName, baseConstructor, true);\r\n        var metadata = targets.map(function (t) { return t.metadata.filter(function (m) { return m.key === METADATA_KEY.UNMANAGED_TAG; }); });\r\n        var unmanagedCount = [].concat.apply([], metadata).length;\r\n        var dependencyCount = targets.length - unmanagedCount;\r\n        if (dependencyCount > 0) {\r\n            return dependencyCount;\r\n        }\r\n        else {\r\n            return getBaseClassDependencyCount(metadataReader, baseConstructor);\r\n        }\r\n    }\r\n    else {\r\n        return 0;\r\n    }\r\n}\r\nfunction formatTargetMetadata(targetMetadata) {\r\n    var targetMetadataMap = {};\r\n    targetMetadata.forEach(function (m) {\r\n        targetMetadataMap[m.key.toString()] = m.value;\r\n    });\r\n    return {\r\n        inject: targetMetadataMap[METADATA_KEY.INJECT_TAG],\r\n        multiInject: targetMetadataMap[METADATA_KEY.MULTI_INJECT_TAG],\r\n        targetName: targetMetadataMap[METADATA_KEY.NAME_TAG],\r\n        unmanaged: targetMetadataMap[METADATA_KEY.UNMANAGED_TAG]\r\n    };\r\n}\r\nexport { getDependencies, getBaseClassDependencyCount, getFunctionName };\r\n","import { id } from '../utils/id';\r\nvar Request = (function () {\r\n    function Request(serviceIdentifier, parentContext, parentRequest, bindings, target) {\r\n        this.id = id();\r\n        this.serviceIdentifier = serviceIdentifier;\r\n        this.parentContext = parentContext;\r\n        this.parentRequest = parentRequest;\r\n        this.target = target;\r\n        this.childRequests = [];\r\n        this.bindings = (Array.isArray(bindings) ? bindings : [bindings]);\r\n        this.requestScope = parentRequest === null\r\n            ? new Map()\r\n            : null;\r\n    }\r\n    Request.prototype.addChildRequest = function (serviceIdentifier, bindings, target) {\r\n        var child = new Request(serviceIdentifier, this.parentContext, this, bindings, target);\r\n        this.childRequests.push(child);\r\n        return child;\r\n    };\r\n    return Request;\r\n}());\r\nexport { Request };\r\n","import { BindingCount } from '../bindings/binding_count';\r\nimport * as ERROR_MSGS from '../constants/error_msgs';\r\nimport { BindingTypeEnum, TargetTypeEnum } from '../constants/literal_types';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { isStackOverflowExeption } from '../utils/exceptions';\r\nimport { circularDependencyToException, getServiceIdentifierAsString, listMetadataForTarget, listRegisteredBindingsForServiceIdentifier } from '../utils/serialization';\r\nimport { Context } from './context';\r\nimport { Metadata } from './metadata';\r\nimport { Plan } from './plan';\r\nimport { getBaseClassDependencyCount, getDependencies, getFunctionName } from './reflection_utils';\r\nimport { Request } from './request';\r\nimport { Target } from './target';\r\nfunction getBindingDictionary(cntnr) {\r\n    return cntnr._bindingDictionary;\r\n}\r\nfunction _createTarget(isMultiInject, targetType, serviceIdentifier, name, key, value) {\r\n    var metadataKey = isMultiInject ? METADATA_KEY.MULTI_INJECT_TAG : METADATA_KEY.INJECT_TAG;\r\n    var injectMetadata = new Metadata(metadataKey, serviceIdentifier);\r\n    var target = new Target(targetType, name, serviceIdentifier, injectMetadata);\r\n    if (key !== undefined) {\r\n        var tagMetadata = new Metadata(key, value);\r\n        target.metadata.push(tagMetadata);\r\n    }\r\n    return target;\r\n}\r\nfunction _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target) {\r\n    var bindings = getBindings(context.container, target.serviceIdentifier);\r\n    var activeBindings = [];\r\n    if (bindings.length === BindingCount.NoBindingsAvailable &&\r\n        context.container.options.autoBindInjectable &&\r\n        typeof target.serviceIdentifier === 'function' &&\r\n        metadataReader.getConstructorMetadata(target.serviceIdentifier).compilerGeneratedMetadata) {\r\n        context.container.bind(target.serviceIdentifier).toSelf();\r\n        bindings = getBindings(context.container, target.serviceIdentifier);\r\n    }\r\n    if (!avoidConstraints) {\r\n        activeBindings = bindings.filter(function (binding) {\r\n            var request = new Request(binding.serviceIdentifier, context, parentRequest, binding, target);\r\n            return binding.constraint(request);\r\n        });\r\n    }\r\n    else {\r\n        activeBindings = bindings;\r\n    }\r\n    _validateActiveBindingCount(target.serviceIdentifier, activeBindings, target, context.container);\r\n    return activeBindings;\r\n}\r\nfunction _validateActiveBindingCount(serviceIdentifier, bindings, target, container) {\r\n    switch (bindings.length) {\r\n        case BindingCount.NoBindingsAvailable:\r\n            if (target.isOptional()) {\r\n                return bindings;\r\n            }\r\n            else {\r\n                var serviceIdentifierString = getServiceIdentifierAsString(serviceIdentifier);\r\n                var msg = ERROR_MSGS.NOT_REGISTERED;\r\n                msg += listMetadataForTarget(serviceIdentifierString, target);\r\n                msg += listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\r\n                throw new Error(msg);\r\n            }\r\n        case BindingCount.OnlyOneBindingAvailable:\r\n            return bindings;\r\n        case BindingCount.MultipleBindingsAvailable:\r\n        default:\r\n            if (!target.isArray()) {\r\n                var serviceIdentifierString = getServiceIdentifierAsString(serviceIdentifier);\r\n                var msg = ERROR_MSGS.AMBIGUOUS_MATCH + \" \" + serviceIdentifierString;\r\n                msg += listRegisteredBindingsForServiceIdentifier(container, serviceIdentifierString, getBindings);\r\n                throw new Error(msg);\r\n            }\r\n            else {\r\n                return bindings;\r\n            }\r\n    }\r\n}\r\nfunction _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, parentRequest, target) {\r\n    var activeBindings;\r\n    var childRequest;\r\n    if (parentRequest === null) {\r\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, null, target);\r\n        childRequest = new Request(serviceIdentifier, context, null, activeBindings, target);\r\n        var thePlan = new Plan(context, childRequest);\r\n        context.addPlan(thePlan);\r\n    }\r\n    else {\r\n        activeBindings = _getActiveBindings(metadataReader, avoidConstraints, context, parentRequest, target);\r\n        childRequest = parentRequest.addChildRequest(target.serviceIdentifier, activeBindings, target);\r\n    }\r\n    activeBindings.forEach(function (binding) {\r\n        var subChildRequest = null;\r\n        if (target.isArray()) {\r\n            subChildRequest = childRequest.addChildRequest(binding.serviceIdentifier, binding, target);\r\n        }\r\n        else {\r\n            if (binding.cache) {\r\n                return;\r\n            }\r\n            subChildRequest = childRequest;\r\n        }\r\n        if (binding.type === BindingTypeEnum.Instance && binding.implementationType !== null) {\r\n            var dependencies = getDependencies(metadataReader, binding.implementationType);\r\n            if (!context.container.options.skipBaseClassChecks) {\r\n                var baseClassDependencyCount = getBaseClassDependencyCount(metadataReader, binding.implementationType);\r\n                if (dependencies.length < baseClassDependencyCount) {\r\n                    var error = ERROR_MSGS.ARGUMENTS_LENGTH_MISMATCH(getFunctionName(binding.implementationType));\r\n                    throw new Error(error);\r\n                }\r\n            }\r\n            dependencies.forEach(function (dependency) {\r\n                _createSubRequests(metadataReader, false, dependency.serviceIdentifier, context, subChildRequest, dependency);\r\n            });\r\n        }\r\n    });\r\n}\r\nfunction getBindings(container, serviceIdentifier) {\r\n    var bindings = [];\r\n    var bindingDictionary = getBindingDictionary(container);\r\n    if (bindingDictionary.hasKey(serviceIdentifier)) {\r\n        bindings = bindingDictionary.get(serviceIdentifier);\r\n    }\r\n    else if (container.parent !== null) {\r\n        bindings = getBindings(container.parent, serviceIdentifier);\r\n    }\r\n    return bindings;\r\n}\r\nfunction plan(metadataReader, container, isMultiInject, targetType, serviceIdentifier, key, value, avoidConstraints) {\r\n    if (avoidConstraints === void 0) { avoidConstraints = false; }\r\n    var context = new Context(container);\r\n    var target = _createTarget(isMultiInject, targetType, serviceIdentifier, '', key, value);\r\n    try {\r\n        _createSubRequests(metadataReader, avoidConstraints, serviceIdentifier, context, null, target);\r\n        return context;\r\n    }\r\n    catch (error) {\r\n        if (isStackOverflowExeption(error)) {\r\n            circularDependencyToException(context.plan.rootRequest);\r\n        }\r\n        throw error;\r\n    }\r\n}\r\nfunction createMockRequest(container, serviceIdentifier, key, value) {\r\n    var target = new Target(TargetTypeEnum.Variable, '', serviceIdentifier, new Metadata(key, value));\r\n    var context = new Context(container);\r\n    var request = new Request(serviceIdentifier, context, null, [], target);\r\n    return request;\r\n}\r\nexport { plan, createMockRequest, getBindingDictionary };\r\n","function isPromise(object) {\r\n    var isObjectOrFunction = (typeof object === 'object' && object !== null) || typeof object === 'function';\r\n    return isObjectOrFunction && typeof object.then === \"function\";\r\n}\r\nfunction isPromiseOrContainsPromise(object) {\r\n    if (isPromise(object)) {\r\n        return true;\r\n    }\r\n    return Array.isArray(object) && object.some(isPromise);\r\n}\r\nexport { isPromise, isPromiseOrContainsPromise };\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { BindingScopeEnum } from '../constants/literal_types';\r\nimport { isPromise } from '../utils/async';\r\nexport var tryGetFromScope = function (requestScope, binding) {\r\n    if ((binding.scope === BindingScopeEnum.Singleton) && binding.activated) {\r\n        return binding.cache;\r\n    }\r\n    if (binding.scope === BindingScopeEnum.Request &&\r\n        requestScope.has(binding.id)) {\r\n        return requestScope.get(binding.id);\r\n    }\r\n    return null;\r\n};\r\nexport var saveToScope = function (requestScope, binding, result) {\r\n    if (binding.scope === BindingScopeEnum.Singleton) {\r\n        _saveToSingletonScope(binding, result);\r\n    }\r\n    if (binding.scope === BindingScopeEnum.Request) {\r\n        _saveToRequestScope(requestScope, binding, result);\r\n    }\r\n};\r\nvar _saveToRequestScope = function (requestScope, binding, result) {\r\n    if (!requestScope.has(binding.id)) {\r\n        requestScope.set(binding.id, result);\r\n    }\r\n};\r\nvar _saveToSingletonScope = function (binding, result) {\r\n    binding.cache = result;\r\n    binding.activated = true;\r\n    if (isPromise(result)) {\r\n        void _saveAsyncResultToSingletonScope(binding, result);\r\n    }\r\n};\r\nvar _saveAsyncResultToSingletonScope = function (binding, asyncResult) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result, ex_1;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                _a.trys.push([0, 2, , 3]);\r\n                return [4, asyncResult];\r\n            case 1:\r\n                result = _a.sent();\r\n                binding.cache = result;\r\n                return [3, 3];\r\n            case 2:\r\n                ex_1 = _a.sent();\r\n                binding.cache = null;\r\n                binding.activated = false;\r\n                throw ex_1;\r\n            case 3: return [2];\r\n        }\r\n    });\r\n}); };\r\n","export var FactoryType;\r\n(function (FactoryType) {\r\n    FactoryType[\"DynamicValue\"] = \"toDynamicValue\";\r\n    FactoryType[\"Factory\"] = \"toFactory\";\r\n    FactoryType[\"Provider\"] = \"toProvider\";\r\n})(FactoryType || (FactoryType = {}));\r\n","import { getServiceIdentifierAsString } from '../utils/serialization';\r\nimport * as ERROR_MSGS from '../constants/error_msgs';\r\nimport { BindingTypeEnum } from '../constants/literal_types';\r\nimport { FactoryType } from './factory_type';\r\nexport var multiBindToService = function (container) {\r\n    return function (service) {\r\n        return function () {\r\n            var types = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                types[_i] = arguments[_i];\r\n            }\r\n            return types.forEach(function (t) { return container.bind(t).toService(service); });\r\n        };\r\n    };\r\n};\r\nexport var ensureFullyBound = function (binding) {\r\n    var boundValue = null;\r\n    switch (binding.type) {\r\n        case BindingTypeEnum.ConstantValue:\r\n        case BindingTypeEnum.Function:\r\n            boundValue = binding.cache;\r\n            break;\r\n        case BindingTypeEnum.Constructor:\r\n        case BindingTypeEnum.Instance:\r\n            boundValue = binding.implementationType;\r\n            break;\r\n        case BindingTypeEnum.DynamicValue:\r\n            boundValue = binding.dynamicValue;\r\n            break;\r\n        case BindingTypeEnum.Provider:\r\n            boundValue = binding.provider;\r\n            break;\r\n        case BindingTypeEnum.Factory:\r\n            boundValue = binding.factory;\r\n            break;\r\n    }\r\n    if (boundValue === null) {\r\n        var serviceIdentifierAsString = getServiceIdentifierAsString(binding.serviceIdentifier);\r\n        throw new Error(ERROR_MSGS.INVALID_BINDING_TYPE + \" \" + serviceIdentifierAsString);\r\n    }\r\n};\r\nexport var getFactoryDetails = function (binding) {\r\n    switch (binding.type) {\r\n        case BindingTypeEnum.Factory:\r\n            return { factory: binding.factory, factoryType: FactoryType.Factory };\r\n        case BindingTypeEnum.Provider:\r\n            return { factory: binding.provider, factoryType: FactoryType.Provider };\r\n        case BindingTypeEnum.DynamicValue:\r\n            return { factory: binding.dynamicValue, factoryType: FactoryType.DynamicValue };\r\n        default:\r\n            throw new Error(\"Unexpected factory type \" + binding.type);\r\n    }\r\n};\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nimport { ON_DEACTIVATION_ERROR, POST_CONSTRUCT_ERROR, PRE_DESTROY_ERROR } from '../constants/error_msgs';\r\nimport { BindingScopeEnum, TargetTypeEnum } from '../constants/literal_types';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { isPromise, isPromiseOrContainsPromise } from '../utils/async';\r\nfunction _resolveRequests(childRequests, resolveRequest) {\r\n    return childRequests.reduce(function (resolvedRequests, childRequest) {\r\n        var injection = resolveRequest(childRequest);\r\n        var targetType = childRequest.target.type;\r\n        if (targetType === TargetTypeEnum.ConstructorArgument) {\r\n            resolvedRequests.constructorInjections.push(injection);\r\n        }\r\n        else {\r\n            resolvedRequests.propertyRequests.push(childRequest);\r\n            resolvedRequests.propertyInjections.push(injection);\r\n        }\r\n        if (!resolvedRequests.isAsync) {\r\n            resolvedRequests.isAsync = isPromiseOrContainsPromise(injection);\r\n        }\r\n        return resolvedRequests;\r\n    }, { constructorInjections: [], propertyInjections: [], propertyRequests: [], isAsync: false });\r\n}\r\nfunction _createInstance(constr, childRequests, resolveRequest) {\r\n    var result;\r\n    if (childRequests.length > 0) {\r\n        var resolved = _resolveRequests(childRequests, resolveRequest);\r\n        var createInstanceWithInjectionsArg = __assign(__assign({}, resolved), { constr: constr });\r\n        if (resolved.isAsync) {\r\n            result = createInstanceWithInjectionsAsync(createInstanceWithInjectionsArg);\r\n        }\r\n        else {\r\n            result = createInstanceWithInjections(createInstanceWithInjectionsArg);\r\n        }\r\n    }\r\n    else {\r\n        result = new constr();\r\n    }\r\n    return result;\r\n}\r\nfunction createInstanceWithInjections(args) {\r\n    var _a;\r\n    var instance = new ((_a = args.constr).bind.apply(_a, __spreadArray([void 0], args.constructorInjections, false)))();\r\n    args.propertyRequests.forEach(function (r, index) {\r\n        var property = r.target.identifier;\r\n        var injection = args.propertyInjections[index];\r\n        if (!r.target.isOptional() || injection !== undefined) {\r\n            instance[property] = injection;\r\n        }\r\n    });\r\n    return instance;\r\n}\r\nfunction createInstanceWithInjectionsAsync(args) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var constructorInjections, propertyInjections;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4, possiblyWaitInjections(args.constructorInjections)];\r\n                case 1:\r\n                    constructorInjections = _a.sent();\r\n                    return [4, possiblyWaitInjections(args.propertyInjections)];\r\n                case 2:\r\n                    propertyInjections = _a.sent();\r\n                    return [2, createInstanceWithInjections(__assign(__assign({}, args), { constructorInjections: constructorInjections, propertyInjections: propertyInjections }))];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction possiblyWaitInjections(possiblePromiseinjections) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var injections, _i, possiblePromiseinjections_1, injection;\r\n        return __generator(this, function (_a) {\r\n            injections = [];\r\n            for (_i = 0, possiblePromiseinjections_1 = possiblePromiseinjections; _i < possiblePromiseinjections_1.length; _i++) {\r\n                injection = possiblePromiseinjections_1[_i];\r\n                if (Array.isArray(injection)) {\r\n                    injections.push(Promise.all(injection));\r\n                }\r\n                else {\r\n                    injections.push(injection);\r\n                }\r\n            }\r\n            return [2, Promise.all(injections)];\r\n        });\r\n    });\r\n}\r\nfunction _getInstanceAfterPostConstruct(constr, result) {\r\n    var postConstructResult = _postConstruct(constr, result);\r\n    if (isPromise(postConstructResult)) {\r\n        return postConstructResult.then(function () { return result; });\r\n    }\r\n    else {\r\n        return result;\r\n    }\r\n}\r\nfunction _postConstruct(constr, instance) {\r\n    var _a, _b;\r\n    if (Reflect.hasMetadata(METADATA_KEY.POST_CONSTRUCT, constr)) {\r\n        var data = Reflect.getMetadata(METADATA_KEY.POST_CONSTRUCT, constr);\r\n        try {\r\n            return (_b = (_a = instance)[data.value]) === null || _b === void 0 ? void 0 : _b.call(_a);\r\n        }\r\n        catch (e) {\r\n            if (e instanceof Error) {\r\n                throw new Error(POST_CONSTRUCT_ERROR(constr.name, e.message));\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction _validateInstanceResolution(binding, constr) {\r\n    if (binding.scope !== BindingScopeEnum.Singleton) {\r\n        _throwIfHandlingDeactivation(binding, constr);\r\n    }\r\n}\r\nfunction _throwIfHandlingDeactivation(binding, constr) {\r\n    var scopeErrorMessage = \"Class cannot be instantiated in \" + (binding.scope === BindingScopeEnum.Request ?\r\n        'request' :\r\n        'transient') + \" scope.\";\r\n    if (typeof binding.onDeactivation === 'function') {\r\n        throw new Error(ON_DEACTIVATION_ERROR(constr.name, scopeErrorMessage));\r\n    }\r\n    if (Reflect.hasMetadata(METADATA_KEY.PRE_DESTROY, constr)) {\r\n        throw new Error(PRE_DESTROY_ERROR(constr.name, scopeErrorMessage));\r\n    }\r\n}\r\nfunction resolveInstance(binding, constr, childRequests, resolveRequest) {\r\n    _validateInstanceResolution(binding, constr);\r\n    var result = _createInstance(constr, childRequests, resolveRequest);\r\n    if (isPromise(result)) {\r\n        return result.then(function (resolvedResult) { return _getInstanceAfterPostConstruct(constr, resolvedResult); });\r\n    }\r\n    else {\r\n        return _getInstanceAfterPostConstruct(constr, result);\r\n    }\r\n}\r\nexport { resolveInstance };\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as ERROR_MSGS from '../constants/error_msgs';\r\nimport { BindingTypeEnum } from '../constants/literal_types';\r\nimport { getBindingDictionary } from '../planning/planner';\r\nimport { saveToScope, tryGetFromScope } from '../scope/scope';\r\nimport { isPromise } from '../utils/async';\r\nimport { getFactoryDetails, ensureFullyBound } from '../utils/binding_utils';\r\nimport { tryAndThrowErrorIfStackOverflow } from '../utils/exceptions';\r\nimport { resolveInstance } from './instantiation';\r\nvar _resolveRequest = function (requestScope) {\r\n    return function (request) {\r\n        request.parentContext.setCurrentRequest(request);\r\n        var bindings = request.bindings;\r\n        var childRequests = request.childRequests;\r\n        var targetIsAnArray = request.target && request.target.isArray();\r\n        var targetParentIsNotAnArray = !request.parentRequest ||\r\n            !request.parentRequest.target ||\r\n            !request.target ||\r\n            !request.parentRequest.target.matchesArray(request.target.serviceIdentifier);\r\n        if (targetIsAnArray && targetParentIsNotAnArray) {\r\n            return childRequests.map(function (childRequest) {\r\n                var _f = _resolveRequest(requestScope);\r\n                return _f(childRequest);\r\n            });\r\n        }\r\n        else {\r\n            if (request.target.isOptional() && bindings.length === 0) {\r\n                return undefined;\r\n            }\r\n            var binding = bindings[0];\r\n            return _resolveBinding(requestScope, request, binding);\r\n        }\r\n    };\r\n};\r\nvar _resolveFactoryFromBinding = function (binding, context) {\r\n    var factoryDetails = getFactoryDetails(binding);\r\n    return tryAndThrowErrorIfStackOverflow(function () { return factoryDetails.factory.bind(binding)(context); }, function () { return new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY_IN_FACTORY(factoryDetails.factoryType, context.currentRequest.serviceIdentifier.toString())); });\r\n};\r\nvar _getResolvedFromBinding = function (requestScope, request, binding) {\r\n    var result;\r\n    var childRequests = request.childRequests;\r\n    ensureFullyBound(binding);\r\n    switch (binding.type) {\r\n        case BindingTypeEnum.ConstantValue:\r\n        case BindingTypeEnum.Function:\r\n            result = binding.cache;\r\n            break;\r\n        case BindingTypeEnum.Constructor:\r\n            result = binding.implementationType;\r\n            break;\r\n        case BindingTypeEnum.Instance:\r\n            result = resolveInstance(binding, binding.implementationType, childRequests, _resolveRequest(requestScope));\r\n            break;\r\n        default:\r\n            result = _resolveFactoryFromBinding(binding, request.parentContext);\r\n    }\r\n    return result;\r\n};\r\nvar _resolveInScope = function (requestScope, binding, resolveFromBinding) {\r\n    var result = tryGetFromScope(requestScope, binding);\r\n    if (result !== null) {\r\n        return result;\r\n    }\r\n    result = resolveFromBinding();\r\n    saveToScope(requestScope, binding, result);\r\n    return result;\r\n};\r\nvar _resolveBinding = function (requestScope, request, binding) {\r\n    return _resolveInScope(requestScope, binding, function () {\r\n        var result = _getResolvedFromBinding(requestScope, request, binding);\r\n        if (isPromise(result)) {\r\n            result = result.then(function (resolved) { return _onActivation(request, binding, resolved); });\r\n        }\r\n        else {\r\n            result = _onActivation(request, binding, result);\r\n        }\r\n        return result;\r\n    });\r\n};\r\nfunction _onActivation(request, binding, resolved) {\r\n    var result = _bindingActivation(request.parentContext, binding, resolved);\r\n    var containersIterator = _getContainersIterator(request.parentContext.container);\r\n    var container;\r\n    var containersIteratorResult = containersIterator.next();\r\n    do {\r\n        container = containersIteratorResult.value;\r\n        var context_1 = request.parentContext;\r\n        var serviceIdentifier = request.serviceIdentifier;\r\n        var activationsIterator = _getContainerActivationsForService(container, serviceIdentifier);\r\n        if (isPromise(result)) {\r\n            result = _activateContainerAsync(activationsIterator, context_1, result);\r\n        }\r\n        else {\r\n            result = _activateContainer(activationsIterator, context_1, result);\r\n        }\r\n        containersIteratorResult = containersIterator.next();\r\n    } while (containersIteratorResult.done !== true && !getBindingDictionary(container).hasKey(request.serviceIdentifier));\r\n    return result;\r\n}\r\nvar _bindingActivation = function (context, binding, previousResult) {\r\n    var result;\r\n    if (typeof binding.onActivation === 'function') {\r\n        result = binding.onActivation(context, previousResult);\r\n    }\r\n    else {\r\n        result = previousResult;\r\n    }\r\n    return result;\r\n};\r\nvar _activateContainer = function (activationsIterator, context, result) {\r\n    var activation = activationsIterator.next();\r\n    while (!activation.done) {\r\n        result = activation.value(context, result);\r\n        if (isPromise(result)) {\r\n            return _activateContainerAsync(activationsIterator, context, result);\r\n        }\r\n        activation = activationsIterator.next();\r\n    }\r\n    return result;\r\n};\r\nvar _activateContainerAsync = function (activationsIterator, context, resultPromise) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result, activation;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4, resultPromise];\r\n            case 1:\r\n                result = _a.sent();\r\n                activation = activationsIterator.next();\r\n                _a.label = 2;\r\n            case 2:\r\n                if (!!activation.done) return [3, 4];\r\n                return [4, activation.value(context, result)];\r\n            case 3:\r\n                result = _a.sent();\r\n                activation = activationsIterator.next();\r\n                return [3, 2];\r\n            case 4: return [2, result];\r\n        }\r\n    });\r\n}); };\r\nvar _getContainerActivationsForService = function (container, serviceIdentifier) {\r\n    var activations = container._activations;\r\n    return activations.hasKey(serviceIdentifier) ? activations.get(serviceIdentifier).values() : [].values();\r\n};\r\nvar _getContainersIterator = function (container) {\r\n    var containersStack = [container];\r\n    var parent = container.parent;\r\n    while (parent !== null) {\r\n        containersStack.push(parent);\r\n        parent = parent.parent;\r\n    }\r\n    var getNextContainer = function () {\r\n        var nextContainer = containersStack.pop();\r\n        if (nextContainer !== undefined) {\r\n            return { done: false, value: nextContainer };\r\n        }\r\n        else {\r\n            return { done: true, value: undefined };\r\n        }\r\n    };\r\n    var containersIterator = {\r\n        next: getNextContainer,\r\n    };\r\n    return containersIterator;\r\n};\r\nfunction resolve(context) {\r\n    var _f = _resolveRequest(context.plan.rootRequest.requestScope);\r\n    return _f(context.plan.rootRequest);\r\n}\r\nexport { resolve };\r\n","import * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { Metadata } from '../planning/metadata';\r\nvar traverseAncerstors = function (request, constraint) {\r\n    var parent = request.parentRequest;\r\n    if (parent !== null) {\r\n        return constraint(parent) ? true : traverseAncerstors(parent, constraint);\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n};\r\nvar taggedConstraint = function (key) { return function (value) {\r\n    var constraint = function (request) {\r\n        return request !== null && request.target !== null && request.target.matchesTag(key)(value);\r\n    };\r\n    constraint.metaData = new Metadata(key, value);\r\n    return constraint;\r\n}; };\r\nvar namedConstraint = taggedConstraint(METADATA_KEY.NAMED_TAG);\r\nvar typeConstraint = function (type) { return function (request) {\r\n    var binding = null;\r\n    if (request !== null) {\r\n        binding = request.bindings[0];\r\n        if (typeof type === 'string') {\r\n            var serviceIdentifier = binding.serviceIdentifier;\r\n            return serviceIdentifier === type;\r\n        }\r\n        else {\r\n            var constructor = request.bindings[0].implementationType;\r\n            return type === constructor;\r\n        }\r\n    }\r\n    return false;\r\n}; };\r\nexport { traverseAncerstors, taggedConstraint, namedConstraint, typeConstraint };\r\n","import { BindingOnSyntax } from './binding_on_syntax';\r\nimport { namedConstraint, taggedConstraint, traverseAncerstors, typeConstraint } from './constraint_helpers';\r\nvar BindingWhenSyntax = (function () {\r\n    function BindingWhenSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingWhenSyntax.prototype.when = function (constraint) {\r\n        this._binding.constraint = constraint;\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenTargetNamed = function (name) {\r\n        this._binding.constraint = namedConstraint(name);\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenTargetIsDefault = function () {\r\n        this._binding.constraint = function (request) {\r\n            if (request === null) {\r\n                return false;\r\n            }\r\n            var targetIsDefault = (request.target !== null) &&\r\n                (!request.target.isNamed()) &&\r\n                (!request.target.isTagged());\r\n            return targetIsDefault;\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenTargetTagged = function (tag, value) {\r\n        this._binding.constraint = taggedConstraint(tag)(value);\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenInjectedInto = function (parent) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && typeConstraint(parent)(request.parentRequest);\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenParentNamed = function (name) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && namedConstraint(name)(request.parentRequest);\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenParentTagged = function (tag, value) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && taggedConstraint(tag)(value)(request.parentRequest);\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && traverseAncerstors(request, typeConstraint(ancestor));\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorIs = function (ancestor) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !traverseAncerstors(request, typeConstraint(ancestor));\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorNamed = function (name) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && traverseAncerstors(request, namedConstraint(name));\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorNamed = function (name) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !traverseAncerstors(request, namedConstraint(name));\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && traverseAncerstors(request, taggedConstraint(tag)(value));\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !traverseAncerstors(request, taggedConstraint(tag)(value));\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && traverseAncerstors(request, constraint);\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    BindingWhenSyntax.prototype.whenNoAncestorMatches = function (constraint) {\r\n        this._binding.constraint = function (request) {\r\n            return request !== null && !traverseAncerstors(request, constraint);\r\n        };\r\n        return new BindingOnSyntax(this._binding);\r\n    };\r\n    return BindingWhenSyntax;\r\n}());\r\nexport { BindingWhenSyntax };\r\n","import { BindingWhenSyntax } from './binding_when_syntax';\r\nvar BindingOnSyntax = (function () {\r\n    function BindingOnSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingOnSyntax.prototype.onActivation = function (handler) {\r\n        this._binding.onActivation = handler;\r\n        return new BindingWhenSyntax(this._binding);\r\n    };\r\n    BindingOnSyntax.prototype.onDeactivation = function (handler) {\r\n        this._binding.onDeactivation = handler;\r\n        return new BindingWhenSyntax(this._binding);\r\n    };\r\n    return BindingOnSyntax;\r\n}());\r\nexport { BindingOnSyntax };\r\n","import { BindingOnSyntax } from './binding_on_syntax';\r\nimport { BindingWhenSyntax } from './binding_when_syntax';\r\nvar BindingWhenOnSyntax = (function () {\r\n    function BindingWhenOnSyntax(binding) {\r\n        this._binding = binding;\r\n        this._bindingWhenSyntax = new BindingWhenSyntax(this._binding);\r\n        this._bindingOnSyntax = new BindingOnSyntax(this._binding);\r\n    }\r\n    BindingWhenOnSyntax.prototype.when = function (constraint) {\r\n        return this._bindingWhenSyntax.when(constraint);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenTargetNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenTargetNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenTargetIsDefault = function () {\r\n        return this._bindingWhenSyntax.whenTargetIsDefault();\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\r\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenParentNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenParentNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\r\n    };\r\n    BindingWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\r\n    };\r\n    BindingWhenOnSyntax.prototype.onActivation = function (handler) {\r\n        return this._bindingOnSyntax.onActivation(handler);\r\n    };\r\n    BindingWhenOnSyntax.prototype.onDeactivation = function (handler) {\r\n        return this._bindingOnSyntax.onDeactivation(handler);\r\n    };\r\n    return BindingWhenOnSyntax;\r\n}());\r\nexport { BindingWhenOnSyntax };\r\n","import { BindingScopeEnum } from '../constants/literal_types';\r\nimport { BindingWhenOnSyntax } from './binding_when_on_syntax';\r\nvar BindingInSyntax = (function () {\r\n    function BindingInSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingInSyntax.prototype.inRequestScope = function () {\r\n        this._binding.scope = BindingScopeEnum.Request;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingInSyntax.prototype.inSingletonScope = function () {\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingInSyntax.prototype.inTransientScope = function () {\r\n        this._binding.scope = BindingScopeEnum.Transient;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    return BindingInSyntax;\r\n}());\r\nexport { BindingInSyntax };\r\n","import { BindingInSyntax } from './binding_in_syntax';\r\nimport { BindingOnSyntax } from './binding_on_syntax';\r\nimport { BindingWhenSyntax } from './binding_when_syntax';\r\nvar BindingInWhenOnSyntax = (function () {\r\n    function BindingInWhenOnSyntax(binding) {\r\n        this._binding = binding;\r\n        this._bindingWhenSyntax = new BindingWhenSyntax(this._binding);\r\n        this._bindingOnSyntax = new BindingOnSyntax(this._binding);\r\n        this._bindingInSyntax = new BindingInSyntax(binding);\r\n    }\r\n    BindingInWhenOnSyntax.prototype.inRequestScope = function () {\r\n        return this._bindingInSyntax.inRequestScope();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.inSingletonScope = function () {\r\n        return this._bindingInSyntax.inSingletonScope();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.inTransientScope = function () {\r\n        return this._bindingInSyntax.inTransientScope();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.when = function (constraint) {\r\n        return this._bindingWhenSyntax.when(constraint);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenTargetNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenTargetNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenTargetIsDefault = function () {\r\n        return this._bindingWhenSyntax.whenTargetIsDefault();\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenTargetTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenTargetTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenInjectedInto = function (parent) {\r\n        return this._bindingWhenSyntax.whenInjectedInto(parent);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenParentNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenParentNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenParentTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenParentTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorIs(ancestor);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorIs = function (ancestor) {\r\n        return this._bindingWhenSyntax.whenNoAncestorIs(ancestor);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorNamed = function (name) {\r\n        return this._bindingWhenSyntax.whenNoAncestorNamed(name);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorTagged = function (tag, value) {\r\n        return this._bindingWhenSyntax.whenNoAncestorTagged(tag, value);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenAnyAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenAnyAncestorMatches(constraint);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.whenNoAncestorMatches = function (constraint) {\r\n        return this._bindingWhenSyntax.whenNoAncestorMatches(constraint);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.onActivation = function (handler) {\r\n        return this._bindingOnSyntax.onActivation(handler);\r\n    };\r\n    BindingInWhenOnSyntax.prototype.onDeactivation = function (handler) {\r\n        return this._bindingOnSyntax.onDeactivation(handler);\r\n    };\r\n    return BindingInWhenOnSyntax;\r\n}());\r\nexport { BindingInWhenOnSyntax };\r\n","import * as ERROR_MSGS from \"../constants/error_msgs\";\r\nimport { BindingScopeEnum, BindingTypeEnum } from \"../constants/literal_types\";\r\nimport { BindingInWhenOnSyntax } from \"./binding_in_when_on_syntax\";\r\nimport { BindingWhenOnSyntax } from \"./binding_when_on_syntax\";\r\nvar BindingToSyntax = (function () {\r\n    function BindingToSyntax(binding) {\r\n        this._binding = binding;\r\n    }\r\n    BindingToSyntax.prototype.to = function (constructor) {\r\n        this._binding.type = BindingTypeEnum.Instance;\r\n        this._binding.implementationType = constructor;\r\n        return new BindingInWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toSelf = function () {\r\n        if (typeof this._binding.serviceIdentifier !== \"function\") {\r\n            throw new Error(\"\" + ERROR_MSGS.INVALID_TO_SELF_VALUE);\r\n        }\r\n        var self = this._binding.serviceIdentifier;\r\n        return this.to(self);\r\n    };\r\n    BindingToSyntax.prototype.toConstantValue = function (value) {\r\n        this._binding.type = BindingTypeEnum.ConstantValue;\r\n        this._binding.cache = value;\r\n        this._binding.dynamicValue = null;\r\n        this._binding.implementationType = null;\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toDynamicValue = function (func) {\r\n        this._binding.type = BindingTypeEnum.DynamicValue;\r\n        this._binding.cache = null;\r\n        this._binding.dynamicValue = func;\r\n        this._binding.implementationType = null;\r\n        return new BindingInWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toConstructor = function (constructor) {\r\n        this._binding.type = BindingTypeEnum.Constructor;\r\n        this._binding.implementationType = constructor;\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toFactory = function (factory) {\r\n        this._binding.type = BindingTypeEnum.Factory;\r\n        this._binding.factory = factory;\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toFunction = function (func) {\r\n        if (typeof func !== \"function\") {\r\n            throw new Error(ERROR_MSGS.INVALID_FUNCTION_BINDING);\r\n        }\r\n        var bindingWhenOnSyntax = this.toConstantValue(func);\r\n        this._binding.type = BindingTypeEnum.Function;\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return bindingWhenOnSyntax;\r\n    };\r\n    BindingToSyntax.prototype.toAutoFactory = function (serviceIdentifier) {\r\n        this._binding.type = BindingTypeEnum.Factory;\r\n        this._binding.factory = function (context) {\r\n            var autofactory = function () { return context.container.get(serviceIdentifier); };\r\n            return autofactory;\r\n        };\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toAutoNamedFactory = function (serviceIdentifier) {\r\n        this._binding.type = BindingTypeEnum.Factory;\r\n        this._binding.factory = function (context) {\r\n            return function (named) { return context.container.getNamed(serviceIdentifier, named); };\r\n        };\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toProvider = function (provider) {\r\n        this._binding.type = BindingTypeEnum.Provider;\r\n        this._binding.provider = provider;\r\n        this._binding.scope = BindingScopeEnum.Singleton;\r\n        return new BindingWhenOnSyntax(this._binding);\r\n    };\r\n    BindingToSyntax.prototype.toService = function (service) {\r\n        this.toDynamicValue(function (context) { return context.container.get(service); });\r\n    };\r\n    return BindingToSyntax;\r\n}());\r\nexport { BindingToSyntax };\r\n","var ContainerSnapshot = (function () {\r\n    function ContainerSnapshot() {\r\n    }\r\n    ContainerSnapshot.of = function (bindings, middleware, activations, deactivations, moduleActivationStore) {\r\n        var snapshot = new ContainerSnapshot();\r\n        snapshot.bindings = bindings;\r\n        snapshot.middleware = middleware;\r\n        snapshot.deactivations = deactivations;\r\n        snapshot.activations = activations;\r\n        snapshot.moduleActivationStore = moduleActivationStore;\r\n        return snapshot;\r\n    };\r\n    return ContainerSnapshot;\r\n}());\r\nexport { ContainerSnapshot };\r\n","function isClonable(obj) {\r\n    return (typeof obj === 'object')\r\n        && (obj !== null)\r\n        && ('clone' in obj)\r\n        && typeof obj.clone === 'function';\r\n}\r\nexport { isClonable };\r\n","import * as ERROR_MSGS from '../constants/error_msgs';\r\nimport { isClonable } from '../utils/clonable';\r\nvar Lookup = (function () {\r\n    function Lookup() {\r\n        this._map = new Map();\r\n    }\r\n    Lookup.prototype.getMap = function () {\r\n        return this._map;\r\n    };\r\n    Lookup.prototype.add = function (serviceIdentifier, value) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        if (value === null || value === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        var entry = this._map.get(serviceIdentifier);\r\n        if (entry !== undefined) {\r\n            entry.push(value);\r\n        }\r\n        else {\r\n            this._map.set(serviceIdentifier, [value]);\r\n        }\r\n    };\r\n    Lookup.prototype.get = function (serviceIdentifier) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        var entry = this._map.get(serviceIdentifier);\r\n        if (entry !== undefined) {\r\n            return entry;\r\n        }\r\n        else {\r\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\r\n        }\r\n    };\r\n    Lookup.prototype.remove = function (serviceIdentifier) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        if (!this._map.delete(serviceIdentifier)) {\r\n            throw new Error(ERROR_MSGS.KEY_NOT_FOUND);\r\n        }\r\n    };\r\n    Lookup.prototype.removeIntersection = function (lookup) {\r\n        var _this = this;\r\n        this.traverse(function (serviceIdentifier, value) {\r\n            var lookupActivations = lookup.hasKey(serviceIdentifier) ? lookup.get(serviceIdentifier) : undefined;\r\n            if (lookupActivations !== undefined) {\r\n                var filteredValues = value.filter(function (lookupValue) {\r\n                    return !lookupActivations.some(function (moduleActivation) { return lookupValue === moduleActivation; });\r\n                });\r\n                _this._setValue(serviceIdentifier, filteredValues);\r\n            }\r\n        });\r\n    };\r\n    Lookup.prototype.removeByCondition = function (condition) {\r\n        var _this = this;\r\n        var removals = [];\r\n        this._map.forEach(function (entries, key) {\r\n            var updatedEntries = [];\r\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n                var entry = entries_1[_i];\r\n                var remove = condition(entry);\r\n                if (remove) {\r\n                    removals.push(entry);\r\n                }\r\n                else {\r\n                    updatedEntries.push(entry);\r\n                }\r\n            }\r\n            _this._setValue(key, updatedEntries);\r\n        });\r\n        return removals;\r\n    };\r\n    Lookup.prototype.hasKey = function (serviceIdentifier) {\r\n        if (serviceIdentifier === null || serviceIdentifier === undefined) {\r\n            throw new Error(ERROR_MSGS.NULL_ARGUMENT);\r\n        }\r\n        return this._map.has(serviceIdentifier);\r\n    };\r\n    Lookup.prototype.clone = function () {\r\n        var copy = new Lookup();\r\n        this._map.forEach(function (value, key) {\r\n            value.forEach(function (b) { return copy.add(key, isClonable(b) ? b.clone() : b); });\r\n        });\r\n        return copy;\r\n    };\r\n    Lookup.prototype.traverse = function (func) {\r\n        this._map.forEach(function (value, key) {\r\n            func(key, value);\r\n        });\r\n    };\r\n    Lookup.prototype._setValue = function (serviceIdentifier, value) {\r\n        if (value.length > 0) {\r\n            this._map.set(serviceIdentifier, value);\r\n        }\r\n        else {\r\n            this._map.delete(serviceIdentifier);\r\n        }\r\n    };\r\n    return Lookup;\r\n}());\r\nexport { Lookup };\r\n","import { Lookup } from './lookup';\r\nvar ModuleActivationStore = (function () {\r\n    function ModuleActivationStore() {\r\n        this._map = new Map();\r\n    }\r\n    ModuleActivationStore.prototype.remove = function (moduleId) {\r\n        if (this._map.has(moduleId)) {\r\n            var handlers = this._map.get(moduleId);\r\n            this._map.delete(moduleId);\r\n            return handlers;\r\n        }\r\n        return this._getEmptyHandlersStore();\r\n    };\r\n    ModuleActivationStore.prototype.addDeactivation = function (moduleId, serviceIdentifier, onDeactivation) {\r\n        this._getModuleActivationHandlers(moduleId)\r\n            .onDeactivations.add(serviceIdentifier, onDeactivation);\r\n    };\r\n    ModuleActivationStore.prototype.addActivation = function (moduleId, serviceIdentifier, onActivation) {\r\n        this._getModuleActivationHandlers(moduleId)\r\n            .onActivations.add(serviceIdentifier, onActivation);\r\n    };\r\n    ModuleActivationStore.prototype.clone = function () {\r\n        var clone = new ModuleActivationStore();\r\n        this._map.forEach(function (handlersStore, moduleId) {\r\n            clone._map.set(moduleId, {\r\n                onActivations: handlersStore.onActivations.clone(),\r\n                onDeactivations: handlersStore.onDeactivations.clone(),\r\n            });\r\n        });\r\n        return clone;\r\n    };\r\n    ModuleActivationStore.prototype._getModuleActivationHandlers = function (moduleId) {\r\n        var moduleActivationHandlers = this._map.get(moduleId);\r\n        if (moduleActivationHandlers === undefined) {\r\n            moduleActivationHandlers = this._getEmptyHandlersStore();\r\n            this._map.set(moduleId, moduleActivationHandlers);\r\n        }\r\n        return moduleActivationHandlers;\r\n    };\r\n    ModuleActivationStore.prototype._getEmptyHandlersStore = function () {\r\n        var handlersStore = {\r\n            onActivations: new Lookup(),\r\n            onDeactivations: new Lookup()\r\n        };\r\n        return handlersStore;\r\n    };\r\n    return ModuleActivationStore;\r\n}());\r\nexport { ModuleActivationStore };\r\n","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nimport { Binding } from '../bindings/binding';\r\nimport * as ERROR_MSGS from '../constants/error_msgs';\r\nimport { BindingScopeEnum, TargetTypeEnum } from '../constants/literal_types';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { MetadataReader } from '../planning/metadata_reader';\r\nimport { createMockRequest, getBindingDictionary, plan } from '../planning/planner';\r\nimport { resolve } from '../resolution/resolver';\r\nimport { BindingToSyntax } from '../syntax/binding_to_syntax';\r\nimport { isPromise, isPromiseOrContainsPromise } from '../utils/async';\r\nimport { id } from '../utils/id';\r\nimport { getServiceIdentifierAsString } from '../utils/serialization';\r\nimport { ContainerSnapshot } from './container_snapshot';\r\nimport { Lookup } from './lookup';\r\nimport { ModuleActivationStore } from './module_activation_store';\r\nvar Container = (function () {\r\n    function Container(containerOptions) {\r\n        var options = containerOptions || {};\r\n        if (typeof options !== 'object') {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);\r\n        }\r\n        if (options.defaultScope === undefined) {\r\n            options.defaultScope = BindingScopeEnum.Transient;\r\n        }\r\n        else if (options.defaultScope !== BindingScopeEnum.Singleton &&\r\n            options.defaultScope !== BindingScopeEnum.Transient &&\r\n            options.defaultScope !== BindingScopeEnum.Request) {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);\r\n        }\r\n        if (options.autoBindInjectable === undefined) {\r\n            options.autoBindInjectable = false;\r\n        }\r\n        else if (typeof options.autoBindInjectable !== 'boolean') {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);\r\n        }\r\n        if (options.skipBaseClassChecks === undefined) {\r\n            options.skipBaseClassChecks = false;\r\n        }\r\n        else if (typeof options.skipBaseClassChecks !== 'boolean') {\r\n            throw new Error(\"\" + ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);\r\n        }\r\n        this.options = {\r\n            autoBindInjectable: options.autoBindInjectable,\r\n            defaultScope: options.defaultScope,\r\n            skipBaseClassChecks: options.skipBaseClassChecks\r\n        };\r\n        this.id = id();\r\n        this._bindingDictionary = new Lookup();\r\n        this._snapshots = [];\r\n        this._middleware = null;\r\n        this._activations = new Lookup();\r\n        this._deactivations = new Lookup();\r\n        this.parent = null;\r\n        this._metadataReader = new MetadataReader();\r\n        this._moduleActivationStore = new ModuleActivationStore();\r\n    }\r\n    Container.merge = function (container1, container2) {\r\n        var containers = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            containers[_i - 2] = arguments[_i];\r\n        }\r\n        var container = new Container();\r\n        var targetContainers = __spreadArray([container1, container2], containers, true).map(function (targetContainer) { return getBindingDictionary(targetContainer); });\r\n        var bindingDictionary = getBindingDictionary(container);\r\n        function copyDictionary(origin, destination) {\r\n            origin.traverse(function (_key, value) {\r\n                value.forEach(function (binding) {\r\n                    destination.add(binding.serviceIdentifier, binding.clone());\r\n                });\r\n            });\r\n        }\r\n        targetContainers.forEach(function (targetBindingDictionary) {\r\n            copyDictionary(targetBindingDictionary, bindingDictionary);\r\n        });\r\n        return container;\r\n    };\r\n    Container.prototype.load = function () {\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        var getHelpers = this._getContainerModuleHelpersFactory();\r\n        for (var _a = 0, modules_1 = modules; _a < modules_1.length; _a++) {\r\n            var currentModule = modules_1[_a];\r\n            var containerModuleHelpers = getHelpers(currentModule.id);\r\n            currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction, containerModuleHelpers.unbindAsyncFunction, containerModuleHelpers.onActivationFunction, containerModuleHelpers.onDeactivationFunction);\r\n        }\r\n    };\r\n    Container.prototype.loadAsync = function () {\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var getHelpers, _a, modules_2, currentModule, containerModuleHelpers;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        getHelpers = this._getContainerModuleHelpersFactory();\r\n                        _a = 0, modules_2 = modules;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_a < modules_2.length)) return [3, 4];\r\n                        currentModule = modules_2[_a];\r\n                        containerModuleHelpers = getHelpers(currentModule.id);\r\n                        return [4, currentModule.registry(containerModuleHelpers.bindFunction, containerModuleHelpers.unbindFunction, containerModuleHelpers.isboundFunction, containerModuleHelpers.rebindFunction, containerModuleHelpers.unbindAsyncFunction, containerModuleHelpers.onActivationFunction, containerModuleHelpers.onDeactivationFunction)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _a++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.unload = function () {\r\n        var _this = this;\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        modules.forEach(function (module) {\r\n            var deactivations = _this._removeModuleBindings(module.id);\r\n            _this._deactivateSingletons(deactivations);\r\n            _this._removeModuleHandlers(module.id);\r\n        });\r\n    };\r\n    Container.prototype.unloadAsync = function () {\r\n        var modules = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            modules[_i] = arguments[_i];\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, modules_3, module_1, deactivations;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = 0, modules_3 = modules;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(_a < modules_3.length)) return [3, 4];\r\n                        module_1 = modules_3[_a];\r\n                        deactivations = this._removeModuleBindings(module_1.id);\r\n                        return [4, this._deactivateSingletonsAsync(deactivations)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        this._removeModuleHandlers(module_1.id);\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _a++;\r\n                        return [3, 1];\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.bind = function (serviceIdentifier) {\r\n        var scope = this.options.defaultScope || BindingScopeEnum.Transient;\r\n        var binding = new Binding(serviceIdentifier, scope);\r\n        this._bindingDictionary.add(serviceIdentifier, binding);\r\n        return new BindingToSyntax(binding);\r\n    };\r\n    Container.prototype.rebind = function (serviceIdentifier) {\r\n        this.unbind(serviceIdentifier);\r\n        return this.bind(serviceIdentifier);\r\n    };\r\n    Container.prototype.rebindAsync = function (serviceIdentifier) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, this.unbindAsync(serviceIdentifier)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2, this.bind(serviceIdentifier)];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.unbind = function (serviceIdentifier) {\r\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\r\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\r\n            this._deactivateSingletons(bindings);\r\n        }\r\n        this._removeServiceFromDictionary(serviceIdentifier);\r\n    };\r\n    Container.prototype.unbindAsync = function (serviceIdentifier) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var bindings;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._bindingDictionary.hasKey(serviceIdentifier)) return [3, 2];\r\n                        bindings = this._bindingDictionary.get(serviceIdentifier);\r\n                        return [4, this._deactivateSingletonsAsync(bindings)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        this._removeServiceFromDictionary(serviceIdentifier);\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.unbindAll = function () {\r\n        var _this = this;\r\n        this._bindingDictionary.traverse(function (_key, value) {\r\n            _this._deactivateSingletons(value);\r\n        });\r\n        this._bindingDictionary = new Lookup();\r\n    };\r\n    Container.prototype.unbindAllAsync = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        this._bindingDictionary.traverse(function (_key, value) {\r\n                            promises.push(_this._deactivateSingletonsAsync(value));\r\n                        });\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this._bindingDictionary = new Lookup();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.onActivation = function (serviceIdentifier, onActivation) {\r\n        this._activations.add(serviceIdentifier, onActivation);\r\n    };\r\n    Container.prototype.onDeactivation = function (serviceIdentifier, onDeactivation) {\r\n        this._deactivations.add(serviceIdentifier, onDeactivation);\r\n    };\r\n    Container.prototype.isBound = function (serviceIdentifier) {\r\n        var bound = this._bindingDictionary.hasKey(serviceIdentifier);\r\n        if (!bound && this.parent) {\r\n            bound = this.parent.isBound(serviceIdentifier);\r\n        }\r\n        return bound;\r\n    };\r\n    Container.prototype.isCurrentBound = function (serviceIdentifier) {\r\n        return this._bindingDictionary.hasKey(serviceIdentifier);\r\n    };\r\n    Container.prototype.isBoundNamed = function (serviceIdentifier, named) {\r\n        return this.isBoundTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.isBoundTagged = function (serviceIdentifier, key, value) {\r\n        var bound = false;\r\n        if (this._bindingDictionary.hasKey(serviceIdentifier)) {\r\n            var bindings = this._bindingDictionary.get(serviceIdentifier);\r\n            var request_1 = createMockRequest(this, serviceIdentifier, key, value);\r\n            bound = bindings.some(function (b) { return b.constraint(request_1); });\r\n        }\r\n        if (!bound && this.parent) {\r\n            bound = this.parent.isBoundTagged(serviceIdentifier, key, value);\r\n        }\r\n        return bound;\r\n    };\r\n    Container.prototype.snapshot = function () {\r\n        this._snapshots.push(ContainerSnapshot.of(this._bindingDictionary.clone(), this._middleware, this._activations.clone(), this._deactivations.clone(), this._moduleActivationStore.clone()));\r\n    };\r\n    Container.prototype.restore = function () {\r\n        var snapshot = this._snapshots.pop();\r\n        if (snapshot === undefined) {\r\n            throw new Error(ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE);\r\n        }\r\n        this._bindingDictionary = snapshot.bindings;\r\n        this._activations = snapshot.activations;\r\n        this._deactivations = snapshot.deactivations;\r\n        this._middleware = snapshot.middleware;\r\n        this._moduleActivationStore = snapshot.moduleActivationStore;\r\n    };\r\n    Container.prototype.createChild = function (containerOptions) {\r\n        var child = new Container(containerOptions || this.options);\r\n        child.parent = this;\r\n        return child;\r\n    };\r\n    Container.prototype.applyMiddleware = function () {\r\n        var middlewares = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            middlewares[_i] = arguments[_i];\r\n        }\r\n        var initial = (this._middleware) ? this._middleware : this._planAndResolve();\r\n        this._middleware = middlewares.reduce(function (prev, curr) { return curr(prev); }, initial);\r\n    };\r\n    Container.prototype.applyCustomMetadataReader = function (metadataReader) {\r\n        this._metadataReader = metadataReader;\r\n    };\r\n    Container.prototype.get = function (serviceIdentifier) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, false);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getAsync = function (serviceIdentifier) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var getArgs;\r\n            return __generator(this, function (_a) {\r\n                getArgs = this._getNotAllArgs(serviceIdentifier, false);\r\n                return [2, this._get(getArgs)];\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.getTagged = function (serviceIdentifier, key, value) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, false, key, value);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getTaggedAsync = function (serviceIdentifier, key, value) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var getArgs;\r\n            return __generator(this, function (_a) {\r\n                getArgs = this._getNotAllArgs(serviceIdentifier, false, key, value);\r\n                return [2, this._get(getArgs)];\r\n            });\r\n        });\r\n    };\r\n    Container.prototype.getNamed = function (serviceIdentifier, named) {\r\n        return this.getTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.getNamedAsync = function (serviceIdentifier, named) {\r\n        return this.getTaggedAsync(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.getAll = function (serviceIdentifier) {\r\n        var getArgs = this._getAllArgs(serviceIdentifier);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getAllAsync = function (serviceIdentifier) {\r\n        var getArgs = this._getAllArgs(serviceIdentifier);\r\n        return this._getAll(getArgs);\r\n    };\r\n    Container.prototype.getAllTagged = function (serviceIdentifier, key, value) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, true, key, value);\r\n        return this._getButThrowIfAsync(getArgs);\r\n    };\r\n    Container.prototype.getAllTaggedAsync = function (serviceIdentifier, key, value) {\r\n        var getArgs = this._getNotAllArgs(serviceIdentifier, true, key, value);\r\n        return this._getAll(getArgs);\r\n    };\r\n    Container.prototype.getAllNamed = function (serviceIdentifier, named) {\r\n        return this.getAllTagged(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.getAllNamedAsync = function (serviceIdentifier, named) {\r\n        return this.getAllTaggedAsync(serviceIdentifier, METADATA_KEY.NAMED_TAG, named);\r\n    };\r\n    Container.prototype.resolve = function (constructorFunction) {\r\n        var isBound = this.isBound(constructorFunction);\r\n        if (!isBound) {\r\n            this.bind(constructorFunction).toSelf();\r\n        }\r\n        var resolved = this.get(constructorFunction);\r\n        if (!isBound) {\r\n            this.unbind(constructorFunction);\r\n        }\r\n        return resolved;\r\n    };\r\n    Container.prototype._preDestroy = function (constructor, instance) {\r\n        var _a, _b;\r\n        if (Reflect.hasMetadata(METADATA_KEY.PRE_DESTROY, constructor)) {\r\n            var data = Reflect.getMetadata(METADATA_KEY.PRE_DESTROY, constructor);\r\n            return (_b = (_a = instance)[data.value]) === null || _b === void 0 ? void 0 : _b.call(_a);\r\n        }\r\n    };\r\n    Container.prototype._removeModuleHandlers = function (moduleId) {\r\n        var moduleActivationsHandlers = this._moduleActivationStore.remove(moduleId);\r\n        this._activations.removeIntersection(moduleActivationsHandlers.onActivations);\r\n        this._deactivations.removeIntersection(moduleActivationsHandlers.onDeactivations);\r\n    };\r\n    Container.prototype._removeModuleBindings = function (moduleId) {\r\n        return this._bindingDictionary.removeByCondition(function (binding) { return binding.moduleId === moduleId; });\r\n    };\r\n    Container.prototype._deactivate = function (binding, instance) {\r\n        var _this = this;\r\n        var constructor = Object.getPrototypeOf(instance).constructor;\r\n        try {\r\n            if (this._deactivations.hasKey(binding.serviceIdentifier)) {\r\n                var result = this._deactivateContainer(instance, this._deactivations.get(binding.serviceIdentifier).values());\r\n                if (isPromise(result)) {\r\n                    return this._handleDeactivationError(result.then(function () { return _this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(binding, instance, constructor); }), constructor);\r\n                }\r\n            }\r\n            var propagateDeactivationResult = this._propagateContainerDeactivationThenBindingAndPreDestroy(binding, instance, constructor);\r\n            if (isPromise(propagateDeactivationResult)) {\r\n                return this._handleDeactivationError(propagateDeactivationResult, constructor);\r\n            }\r\n        }\r\n        catch (ex) {\r\n            if (ex instanceof Error) {\r\n                throw new Error(ERROR_MSGS.ON_DEACTIVATION_ERROR(constructor.name, ex.message));\r\n            }\r\n        }\r\n    };\r\n    Container.prototype._handleDeactivationError = function (asyncResult, constructor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var ex_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, 2, , 3]);\r\n                        return [4, asyncResult];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [3, 3];\r\n                    case 2:\r\n                        ex_1 = _a.sent();\r\n                        if (ex_1 instanceof Error) {\r\n                            throw new Error(ERROR_MSGS.ON_DEACTIVATION_ERROR(constructor.name, ex_1.message));\r\n                        }\r\n                        return [3, 3];\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._deactivateContainer = function (instance, deactivationsIterator) {\r\n        var _this = this;\r\n        var deactivation = deactivationsIterator.next();\r\n        while (deactivation.value) {\r\n            var result = deactivation.value(instance);\r\n            if (isPromise(result)) {\r\n                return result.then(function () {\r\n                    return _this._deactivateContainerAsync(instance, deactivationsIterator);\r\n                });\r\n            }\r\n            deactivation = deactivationsIterator.next();\r\n        }\r\n    };\r\n    Container.prototype._deactivateContainerAsync = function (instance, deactivationsIterator) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var deactivation;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        deactivation = deactivationsIterator.next();\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        if (!deactivation.value) return [3, 3];\r\n                        return [4, deactivation.value(instance)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        deactivation = deactivationsIterator.next();\r\n                        return [3, 1];\r\n                    case 3: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._getContainerModuleHelpersFactory = function () {\r\n        var _this = this;\r\n        var setModuleId = function (bindingToSyntax, moduleId) {\r\n            bindingToSyntax._binding.moduleId = moduleId;\r\n        };\r\n        var getBindFunction = function (moduleId) {\r\n            return function (serviceIdentifier) {\r\n                var bindingToSyntax = _this.bind(serviceIdentifier);\r\n                setModuleId(bindingToSyntax, moduleId);\r\n                return bindingToSyntax;\r\n            };\r\n        };\r\n        var getUnbindFunction = function () {\r\n            return function (serviceIdentifier) {\r\n                return _this.unbind(serviceIdentifier);\r\n            };\r\n        };\r\n        var getUnbindAsyncFunction = function () {\r\n            return function (serviceIdentifier) {\r\n                return _this.unbindAsync(serviceIdentifier);\r\n            };\r\n        };\r\n        var getIsboundFunction = function () {\r\n            return function (serviceIdentifier) {\r\n                return _this.isBound(serviceIdentifier);\r\n            };\r\n        };\r\n        var getRebindFunction = function (moduleId) {\r\n            return function (serviceIdentifier) {\r\n                var bindingToSyntax = _this.rebind(serviceIdentifier);\r\n                setModuleId(bindingToSyntax, moduleId);\r\n                return bindingToSyntax;\r\n            };\r\n        };\r\n        var getOnActivationFunction = function (moduleId) {\r\n            return function (serviceIdentifier, onActivation) {\r\n                _this._moduleActivationStore.addActivation(moduleId, serviceIdentifier, onActivation);\r\n                _this.onActivation(serviceIdentifier, onActivation);\r\n            };\r\n        };\r\n        var getOnDeactivationFunction = function (moduleId) {\r\n            return function (serviceIdentifier, onDeactivation) {\r\n                _this._moduleActivationStore.addDeactivation(moduleId, serviceIdentifier, onDeactivation);\r\n                _this.onDeactivation(serviceIdentifier, onDeactivation);\r\n            };\r\n        };\r\n        return function (mId) { return ({\r\n            bindFunction: getBindFunction(mId),\r\n            isboundFunction: getIsboundFunction(),\r\n            onActivationFunction: getOnActivationFunction(mId),\r\n            onDeactivationFunction: getOnDeactivationFunction(mId),\r\n            rebindFunction: getRebindFunction(mId),\r\n            unbindFunction: getUnbindFunction(),\r\n            unbindAsyncFunction: getUnbindAsyncFunction()\r\n        }); };\r\n    };\r\n    Container.prototype._getAll = function (getArgs) {\r\n        return Promise.all(this._get(getArgs));\r\n    };\r\n    Container.prototype._get = function (getArgs) {\r\n        var planAndResolveArgs = __assign(__assign({}, getArgs), { contextInterceptor: function (context) { return context; }, targetType: TargetTypeEnum.Variable });\r\n        if (this._middleware) {\r\n            var middlewareResult = this._middleware(planAndResolveArgs);\r\n            if (middlewareResult === undefined || middlewareResult === null) {\r\n                throw new Error(ERROR_MSGS.INVALID_MIDDLEWARE_RETURN);\r\n            }\r\n            return middlewareResult;\r\n        }\r\n        return this._planAndResolve()(planAndResolveArgs);\r\n    };\r\n    Container.prototype._getButThrowIfAsync = function (getArgs) {\r\n        var result = this._get(getArgs);\r\n        if (isPromiseOrContainsPromise(result)) {\r\n            throw new Error(ERROR_MSGS.LAZY_IN_SYNC(getArgs.serviceIdentifier));\r\n        }\r\n        return result;\r\n    };\r\n    Container.prototype._getAllArgs = function (serviceIdentifier) {\r\n        var getAllArgs = {\r\n            avoidConstraints: true,\r\n            isMultiInject: true,\r\n            serviceIdentifier: serviceIdentifier,\r\n        };\r\n        return getAllArgs;\r\n    };\r\n    Container.prototype._getNotAllArgs = function (serviceIdentifier, isMultiInject, key, value) {\r\n        var getNotAllArgs = {\r\n            avoidConstraints: false,\r\n            isMultiInject: isMultiInject,\r\n            serviceIdentifier: serviceIdentifier,\r\n            key: key,\r\n            value: value,\r\n        };\r\n        return getNotAllArgs;\r\n    };\r\n    Container.prototype._planAndResolve = function () {\r\n        var _this = this;\r\n        return function (args) {\r\n            var context = plan(_this._metadataReader, _this, args.isMultiInject, args.targetType, args.serviceIdentifier, args.key, args.value, args.avoidConstraints);\r\n            context = args.contextInterceptor(context);\r\n            var result = resolve(context);\r\n            return result;\r\n        };\r\n    };\r\n    Container.prototype._deactivateIfSingleton = function (binding) {\r\n        var _this = this;\r\n        if (!binding.activated) {\r\n            return;\r\n        }\r\n        if (isPromise(binding.cache)) {\r\n            return binding.cache.then(function (resolved) { return _this._deactivate(binding, resolved); });\r\n        }\r\n        return this._deactivate(binding, binding.cache);\r\n    };\r\n    Container.prototype._deactivateSingletons = function (bindings) {\r\n        for (var _i = 0, bindings_1 = bindings; _i < bindings_1.length; _i++) {\r\n            var binding = bindings_1[_i];\r\n            var result = this._deactivateIfSingleton(binding);\r\n            if (isPromise(result)) {\r\n                throw new Error(ERROR_MSGS.ASYNC_UNBIND_REQUIRED);\r\n            }\r\n        }\r\n    };\r\n    Container.prototype._deactivateSingletonsAsync = function (bindings) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, Promise.all(bindings.map(function (b) { return _this._deactivateIfSingleton(b); }))];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._propagateContainerDeactivationThenBindingAndPreDestroy = function (binding, instance, constructor) {\r\n        if (this.parent) {\r\n            return this._deactivate.bind(this.parent)(binding, instance);\r\n        }\r\n        else {\r\n            return this._bindingDeactivationAndPreDestroy(binding, instance, constructor);\r\n        }\r\n    };\r\n    Container.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync = function (binding, instance, constructor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.parent) return [3, 2];\r\n                        return [4, this._deactivate.bind(this.parent)(binding, instance)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [3, 4];\r\n                    case 2: return [4, this._bindingDeactivationAndPreDestroyAsync(binding, instance, constructor)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        _a.label = 4;\r\n                    case 4: return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Container.prototype._removeServiceFromDictionary = function (serviceIdentifier) {\r\n        try {\r\n            this._bindingDictionary.remove(serviceIdentifier);\r\n        }\r\n        catch (e) {\r\n            throw new Error(ERROR_MSGS.CANNOT_UNBIND + \" \" + getServiceIdentifierAsString(serviceIdentifier));\r\n        }\r\n    };\r\n    Container.prototype._bindingDeactivationAndPreDestroy = function (binding, instance, constructor) {\r\n        var _this = this;\r\n        if (typeof binding.onDeactivation === 'function') {\r\n            var result = binding.onDeactivation(instance);\r\n            if (isPromise(result)) {\r\n                return result.then(function () { return _this._preDestroy(constructor, instance); });\r\n            }\r\n        }\r\n        return this._preDestroy(constructor, instance);\r\n    };\r\n    Container.prototype._bindingDeactivationAndPreDestroyAsync = function (binding, instance, constructor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(typeof binding.onDeactivation === 'function')) return [3, 2];\r\n                        return [4, binding.onDeactivation(instance)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [4, this._preDestroy(constructor, instance)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return Container;\r\n}());\r\nexport { Container };\r\n","export function getFirstArrayDuplicate(array) {\r\n    var seenValues = new Set();\r\n    for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\r\n        var entry = array_1[_i];\r\n        if (seenValues.has(entry)) {\r\n            return entry;\r\n        }\r\n        else {\r\n            seenValues.add(entry);\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n","import * as ERROR_MSGS from '../constants/error_msgs';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { getFirstArrayDuplicate } from '../utils/js';\r\nfunction targetIsConstructorFunction(target) {\r\n    return target.prototype !== undefined;\r\n}\r\nfunction _throwIfMethodParameter(parameterName) {\r\n    if (parameterName !== undefined) {\r\n        throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\r\n    }\r\n}\r\nfunction tagParameter(annotationTarget, parameterName, parameterIndex, metadata) {\r\n    _throwIfMethodParameter(parameterName);\r\n    _tagParameterOrProperty(METADATA_KEY.TAGGED, annotationTarget, parameterIndex.toString(), metadata);\r\n}\r\nfunction tagProperty(annotationTarget, propertyName, metadata) {\r\n    if (targetIsConstructorFunction(annotationTarget)) {\r\n        throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\r\n    }\r\n    _tagParameterOrProperty(METADATA_KEY.TAGGED_PROP, annotationTarget.constructor, propertyName, metadata);\r\n}\r\nfunction _ensureNoMetadataKeyDuplicates(metadata) {\r\n    var metadatas = [];\r\n    if (Array.isArray(metadata)) {\r\n        metadatas = metadata;\r\n        var duplicate = getFirstArrayDuplicate(metadatas.map(function (md) { return md.key; }));\r\n        if (duplicate !== undefined) {\r\n            throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + duplicate.toString());\r\n        }\r\n    }\r\n    else {\r\n        metadatas = [metadata];\r\n    }\r\n    return metadatas;\r\n}\r\nfunction _tagParameterOrProperty(metadataKey, annotationTarget, key, metadata) {\r\n    var metadatas = _ensureNoMetadataKeyDuplicates(metadata);\r\n    var paramsOrPropertiesMetadata = {};\r\n    if (Reflect.hasOwnMetadata(metadataKey, annotationTarget)) {\r\n        paramsOrPropertiesMetadata = Reflect.getMetadata(metadataKey, annotationTarget);\r\n    }\r\n    var paramOrPropertyMetadata = paramsOrPropertiesMetadata[key];\r\n    if (paramOrPropertyMetadata === undefined) {\r\n        paramOrPropertyMetadata = [];\r\n    }\r\n    else {\r\n        var _loop_1 = function (m) {\r\n            if (metadatas.some(function (md) { return md.key === m.key; })) {\r\n                throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + m.key.toString());\r\n            }\r\n        };\r\n        for (var _i = 0, paramOrPropertyMetadata_1 = paramOrPropertyMetadata; _i < paramOrPropertyMetadata_1.length; _i++) {\r\n            var m = paramOrPropertyMetadata_1[_i];\r\n            _loop_1(m);\r\n        }\r\n    }\r\n    paramOrPropertyMetadata.push.apply(paramOrPropertyMetadata, metadatas);\r\n    paramsOrPropertiesMetadata[key] = paramOrPropertyMetadata;\r\n    Reflect.defineMetadata(metadataKey, paramsOrPropertiesMetadata, annotationTarget);\r\n}\r\nfunction createTaggedDecorator(metadata) {\r\n    return function (target, targetKey, indexOrPropertyDescriptor) {\r\n        if (typeof indexOrPropertyDescriptor === 'number') {\r\n            tagParameter(target, targetKey, indexOrPropertyDescriptor, metadata);\r\n        }\r\n        else {\r\n            tagProperty(target, targetKey, metadata);\r\n        }\r\n    };\r\n}\r\nfunction _decorate(decorators, target) {\r\n    Reflect.decorate(decorators, target);\r\n}\r\nfunction _param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); };\r\n}\r\nfunction decorate(decorator, target, parameterIndexOrProperty) {\r\n    if (typeof parameterIndexOrProperty === 'number') {\r\n        _decorate([_param(parameterIndexOrProperty, decorator)], target);\r\n    }\r\n    else if (typeof parameterIndexOrProperty === 'string') {\r\n        Reflect.decorate([decorator], target, parameterIndexOrProperty);\r\n    }\r\n    else {\r\n        _decorate([decorator], target);\r\n    }\r\n}\r\nexport { decorate, tagParameter, tagProperty, createTaggedDecorator };\r\n","import * as ERRORS_MSGS from '../constants/error_msgs';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nfunction injectable() {\r\n    return function (target) {\r\n        if (Reflect.hasOwnMetadata(METADATA_KEY.PARAM_TYPES, target)) {\r\n            throw new Error(ERRORS_MSGS.DUPLICATED_INJECTABLE_DECORATOR);\r\n        }\r\n        var types = Reflect.getMetadata(METADATA_KEY.DESIGN_PARAM_TYPES, target) || [];\r\n        Reflect.defineMetadata(METADATA_KEY.PARAM_TYPES, types, target);\r\n        return target;\r\n    };\r\n}\r\nexport { injectable };\r\n","import { UNDEFINED_INJECT_ANNOTATION } from '../constants/error_msgs';\r\nimport { Metadata } from '../planning/metadata';\r\nimport { createTaggedDecorator } from './decorator_utils';\r\nexport function injectBase(metadataKey) {\r\n    return function (serviceIdentifier) {\r\n        return function (target, targetKey, indexOrPropertyDescriptor) {\r\n            if (serviceIdentifier === undefined) {\r\n                var className = typeof target === 'function' ? target.name : target.constructor.name;\r\n                throw new Error(UNDEFINED_INJECT_ANNOTATION(className));\r\n            }\r\n            return createTaggedDecorator(new Metadata(metadataKey, serviceIdentifier))(target, targetKey, indexOrPropertyDescriptor);\r\n        };\r\n    };\r\n}\r\n","import * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { injectBase } from './inject_base';\r\nvar inject = injectBase(METADATA_KEY.INJECT_TAG);\r\nexport { inject };\r\n","import { Metadata } from '../planning/metadata';\r\nfunction propertyEventDecorator(eventKey, errorMessage) {\r\n    return function () {\r\n        return function (target, propertyKey) {\r\n            var metadata = new Metadata(eventKey, propertyKey);\r\n            if (Reflect.hasOwnMetadata(eventKey, target.constructor)) {\r\n                throw new Error(errorMessage);\r\n            }\r\n            Reflect.defineMetadata(eventKey, metadata, target.constructor);\r\n        };\r\n    };\r\n}\r\nexport { propertyEventDecorator };\r\n","import * as ERRORS_MSGS from '../constants/error_msgs';\r\nimport * as METADATA_KEY from '../constants/metadata_keys';\r\nimport { propertyEventDecorator } from './property_event_decorator';\r\nvar postConstruct = propertyEventDecorator(METADATA_KEY.POST_CONSTRUCT, ERRORS_MSGS.MULTIPLE_POST_CONSTRUCT_METHODS);\r\nexport { postConstruct };\r\n","import type { loggerEvent, LoggerService, logLevel } from \"@/content/core/logger/logger.service\";\nimport { BooleanExtensionSetting, ExtensionSetting } from \"@/content/core/settings/setting\";\nimport { injectable } from \"inversify\";\nimport { Subject, withLatestFrom } from \"rxjs\";\n\n@injectable()\nexport class LoggingService {\n\n  public static defaultLogLevel: logLevel = \"debug\";\n\n  private static readonly styles = {\n    debug: \"color: lightGray; font-weight: bold;\",\n    info: \"color: lightBlue; font-weight: bold;\",\n    warn: \"color: orange; font-weight: bold;\",\n    error: \"color: red; font-weight: bold;\",\n    date: \"color: darkGrey; font-weight: light;\"\n  };\n  private readonly _prefix = \"skribbltypo\";\n  private readonly _printEnabledSetting = new BooleanExtensionSetting(\"logging.printLogEnabled\", true)\n    .withName(\"Print Logs\")\n    .withDescription(\"Print extension event logs to the browser console\");\n\n  private _loggers: LoggerService[] = [];\n  private _logLevelSettings = new Map<LoggerService, ExtensionSetting<logLevel>>();\n  private _events$ = new Subject<loggerEvent>();\n  private _recordedEvents: loggerEvent[] = [];\n\n  constructor() {\n    this._events$.subscribe(event => {\n      this.printEvent(event);\n      this._recordedEvents.push(event);\n    });\n  }\n\n  public trackLoggerInstance(logger: LoggerService){\n    const setting = new ExtensionSetting(`logging.logLevel.${logger.boundTo}`, LoggingService.defaultLogLevel)\n      .withName(`Log level for ${logger.boundTo}`)\n      .withDescription(`The minimum log level filter for the logger bound to ${logger.boundTo}`);\n    setting.changes$.subscribe(level => logger.level = level);\n    this._logLevelSettings.set(logger, setting);\n\n    this._loggers.push(logger);\n    logger.events$.pipe(\n      withLatestFrom(this._printEnabledSetting.changes$)\n    ).subscribe(([event, printEnabled]) => {\n      if(printEnabled) this._events$.next(event);\n    });\n  }\n\n  private getTimestamp(date: Date) {\n    return `${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}.${date.getMilliseconds()}`;\n  }\n\n  private getLevelString(level: logLevel){\n    switch(level){\n      case \"debug\":\n        return \"DEB \";\n      case \"info\":\n        return \"INFO\";\n      case \"warn\":\n        return \"WARN\";\n      case \"error\":\n        return \"ERR \";\n    }\n  }\n\n  private printEvent(event: loggerEvent){\n    console.log(`%c ${this.getTimestamp(event.date)} %c[${this._prefix}] [${this.getLevelString(event.logLevel)}]  (${event.bindingName})`,\n      LoggingService.styles.date,\n      LoggingService.styles[event.logLevel],\n      event.message,\n      ...event.data\n    );\n  }\n\n  public get recordedEvents() {\n    return this._recordedEvents;\n  }\n\n  public get loggers(): readonly LoggerService[] {\n    return this._loggers;\n  }\n\n  public get printEnabledSetting() {\n    return this._printEnabledSetting;\n  }\n\n  public getLogLevelSetting(logger: LoggerService) {\n    const setting = this._logLevelSettings.get(logger);\n    if(!setting) throw new Error(`Logger settings for ${logger.boundTo} not found`);\n    return setting.asFrozen;\n  }\n}","/**\n * Base class for all application events\n */\nexport abstract class ApplicationEvent<TData> {\n\n  /**\n   * Data associated with the event\n   */\n  public abstract readonly data: TData;\n}","import type { LoggerService } from \"./logger.service\";\n\nexport const loggerFactory = Symbol(\"loggerFactory\");\n\nexport type loggerFactory = (context: object) => LoggerService;","import { inject, injectable } from \"inversify\";\nimport { ApplicationEvent } from \"./applicationEvent\";\nimport { Subject } from \"rxjs\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\n\n@injectable()\nexport class EventsService {\n\n  private readonly _logger;\n\n  /**\n   * Subject that contains all application events\n   * @private\n   */\n  private _events$ = new Subject<ApplicationEvent<unknown>>();\n\n  /**\n   * Observable that emits all application events that are recognized by registered event processors\n   */\n  public get events$(){\n    return this._events$.asObservable();\n  }\n\n  constructor(@inject(loggerFactory) loggerFactory: loggerFactory) {\n    this._logger = loggerFactory(this);\n  }\n\n  /**\n   * Publishes an event to the central application event stream\n   * @param event\n   */\n  public publishEvent(event: ApplicationEvent<unknown>) {\n    this._events$.next(event);\n  }\n}\n","import { inject, injectable, postConstruct } from \"inversify\";\nimport { EventsService } from \"./events.service\";\nimport { Observable } from \"rxjs\";\nimport { ApplicationEvent } from \"./applicationEvent\";\nimport type { Type } from \"../../../util/types/type\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\n\nexport type EventProcessorImplementationType<TData> =\n  new (...args: ConstructorParameters<typeof EventProcessor>) => EventProcessor<TData, ApplicationEvent<TData>>;\n\n@injectable()\nexport abstract class EventProcessor<TData, TEvent extends ApplicationEvent<TData>> {\n\n  protected readonly _logger;\n\n  /**\n   * Type of the event this processor emits\n   */\n  public abstract readonly eventType: Type<ApplicationEvent<TData>>;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(EventsService) private readonly _eventsService: EventsService\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  /**\n   * Start listening to events after dependency injection finished\n   */\n  @postConstruct()\n  public start() {\n\n    this._logger.info(\"Starting event processor\");\n\n    /* create event stream from implementation */\n    const events = this.streamEvents();\n    if(events instanceof Promise) {\n      events.then((stream) => this.publishEvents(stream));\n    }\n    else {\n      this.publishEvents(events);\n    }\n  }\n\n  private publishEvents(events$: Observable<TEvent>){\n\n    /* publish events to the central pipe */\n    events$.subscribe((event) => {\n      this._eventsService.publishEvent(event);\n    });\n  }\n\n  /**\n   * Create an observable that streams all events of this type\n   * @protected\n   */\n  protected abstract streamEvents(): Observable<TEvent> | Promise<Observable<TEvent>>;\n\n  /**\n   * Check if an event is of the type this processor emits\n   * @param event\n   */\n  public isProcessorEvent(event: ApplicationEvent<unknown>): event is TEvent {\n    return event instanceof this.eventType;\n  }\n}","import { inject, injectable } from \"inversify\";\nimport { EventsService } from \"./events.service\";\nimport { EventProcessor } from \"./eventProcessor\";\nimport { filter } from \"rxjs\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\nimport { ApplicationEvent } from \"./applicationEvent\";\n\n@injectable()\nexport abstract class EventListener<TData, TEvent extends ApplicationEvent<TData>> {\n\n  protected abstract readonly _processor: EventProcessor<TData, TEvent>;\n\n  /**\n   * Reference to the event observable that filters all events from the event service that are of this type\n   * @private\n   */\n  private readonly _events$;\n\n  private readonly _logger;\n\n  /**\n   * Observable that emits all events of this type\n   */\n  public get events$() {\n    return this._events$;\n  }\n\n  constructor(\n    @inject(EventsService) private readonly _eventsService: EventsService,\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n  ) {\n    this._logger = loggerFactory(this);\n\n    /* filter all events from the central event pipe */\n    this._events$ = _eventsService.events$.pipe(\n      filter((event) => this._processor.isProcessorEvent(event))\n    );\n  }\n}","import { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted after the canvas has been cleared,\n * either after drawer change or clear action.\n * Contains the previous image base64 string of the canvas before the clear.\n */\nexport class CanvasClearedEvent extends ApplicationEvent<string> {\n  constructor(public readonly data: string) { super(); }\n}\n\n@injectable()\nexport class CanvasClearedEventProcessor extends EventProcessor<string, CanvasClearedEvent>\n{\n\n  public readonly eventType = CanvasClearedEvent;\n\n  protected async streamEvents(): Promise<Observable<CanvasClearedEvent>> {\n    const events = new Subject<CanvasClearedEvent>();\n\n    document.addEventListener(\"logCanvasClear\", event => {\n      const data = (event as CustomEvent).detail;\n      events.next(new CanvasClearedEvent(data));\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class CanvasClearedEventListener extends EventListener<string, CanvasClearedEvent> {\n  @inject(CanvasClearedEventProcessor) protected readonly _processor!: CanvasClearedEventProcessor;\n}\n\nexport const canvasClearedEventRegistration: EventRegistration<string, CanvasClearedEvent> = {\n  listenerType: CanvasClearedEventListener,\n  processorType: CanvasClearedEventProcessor\n};","/* Result of an interpretable execution */\nimport type { Interpretable } from \"@/content/core/commands/interpretable\";\n\n/**\n * Base class used for all concrete results of an interpretable execution\n * Can also be thrown as error during interpretation\n */\nexport abstract class InterpretableResult {\n  constructor(\n    readonly interpretable: Interpretable<unknown, unknown, unknown>,\n    readonly message?: string,\n  ) {\n  }\n}","import { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\n\n/**\n * A successful result of an interpretable execution without any other concrete meaning\n */\nexport class InterpretableSuccess extends InterpretableResult {}","import {\n  type Interpretable,\n  type interpretableExecutionResult,\n\n} from \"@/content/core/commands/interpretable\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\n\nexport type executeNextFunction<TResult, TContext> = (result: TResult, context: TContext) => interpretableExecutionResult<TResult, TContext>;\n\n/**\n * Helper class to build chained interpretables\n */\nexport class DeferredInterpretableBuilder<TSource, TResult, TContext> {\n\n  private _execute?: (result: TResult, context: TContext) => interpretableExecutionResult<TResult, TContext>;\n  protected _builtInterpretable?: Interpretable<TSource, TResult, TContext>;\n\n  /**\n   * Create a new interpretable chain builder\n   * @param _interpretableBuilder factory for an interpretable which provides a execution context that can be set later in the builder\n   */\n  constructor(\n    private _interpretableBuilder: (executionContext: executeNextFunction<TResult, TContext>) =>\n      Interpretable<TSource, TResult, TContext>\n  ){ }\n\n  /**\n   * Set the execution function of the interpretable to a new interpretable\n   * and return the new builder\n   * @param nextInterpretableBuilder\n   */\n  chainInterpretable<TNextResult>(\n    nextInterpretableBuilder: (executionContext: executeNextFunction<TNextResult, TContext>) =>\n      Interpretable<TResult, TNextResult, TContext>\n  ){\n    const builder = new DeferredInterpretableBuilder<TResult, TNextResult, TContext>(nextInterpretableBuilder);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    this.setExecute(async (result, context) => {\n      return {next: builder.build(), result: new InterpretableSuccess(this.interpretable)};\n    });\n\n    return builder;\n  }\n\n  /**\n   * Set the execution function of the interpretable to a final function\n   * @param execute\n   */\n  setExecute(execute: (result: TResult, context: TContext) => interpretableExecutionResult<TResult, TContext>){\n    this._execute = execute;\n    return this;\n  }\n\n  /**\n   * Build the current deferred interpretable and return it\n   */\n  build() {\n    if(!this._execute || !this._interpretableBuilder) throw new Error(\"Cannot build interpretable without execute function\");\n    const execute = this._execute;\n    this._builtInterpretable = this._interpretableBuilder((result, context) => execute(result, context));\n    return this._builtInterpretable;\n  }\n\n  /**\n   * The built interpretable, if built, else undefined\n   */\n  get interpretable(){\n    if(!this._builtInterpretable) throw new Error(\"Interpretable has not yet been built\");\n    return this._builtInterpretable;\n  }\n}\n","import type { Interpretable } from \"@/content/core/commands/interpretable\";\nimport { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\n\n/**\n * Result of a successful interpretable execution,\n * declaring that the actual execution of the command should be deferred\n * Contains a parameterless function that will be called to execute the actual execution\n */\nexport class InterpretableDeferResult extends InterpretableSuccess {\n  constructor(\n    interpretable: Interpretable<unknown, unknown, unknown>,\n    message: string | undefined,\n    public readonly run: () => Promise<InterpretableResult>,\n  ) {\n    super(interpretable, message);\n  }\n}","import {\n  type commandExecutionContext,\n  type ExtensionCommand,\n\n} from \"@/content/core/commands/command\";\nimport type { ExtensionCommandParameter } from \"@/content/core/commands/command-parameter\";\nimport {\n  DeferredInterpretableBuilder\n} from \"@/content/core/commands/builder/deferred-interpretable-builder\";\nimport {\n  type Interpretable,\n\n} from \"@/content/core/commands/interpretable\";\nimport { InterpretableDeferResult } from \"@/content/core/commands/results/interpretable-defer-result\";\nimport { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\n\n/***\n  * Simplifies the building of command parameters using a deferred interpretable chain builder\n * The builder is holds a interpretable which will be populated with a execution function\n * @typeparam TSource The source type of the current interpretable\n * @typeparam TParam The parameter type which the builder will add to the source\n  */\nexport class CommandParamsBuilder<TSource, TParam> {\n\n  /**\n   * Create a interpretable chain root for a command\n   * @param command\n   */\n  static forCommand(command: ExtensionCommand) {\n    const deferredBuilder = new DeferredInterpretableBuilder<object, object, commandExecutionContext>(execute => command.setExecute(execute));\n    return new CommandParamsBuilder<object, object>(deferredBuilder);\n  }\n\n  constructor(\n    private _interpretableDeferred: DeferredInterpretableBuilder<TSource, TSource & TParam, commandExecutionContext>,\n    private _precedingParams: ExtensionCommandParameter<unknown, unknown>[] = []\n  ) { }\n\n  /**\n   * Add a parameter to the chain and return the builder to append to the new param\n   * @param param\n   */\n  public addParam<TNextParam>(param: ExtensionCommandParameter<TSource & TParam, TNextParam>){\n    const nextDeferredBuilder = this._interpretableDeferred\n      .chainInterpretable<TSource & TParam & TNextParam>(execute => {\n        return param.withAction(execute);\n      });\n\n    return new CommandParamsBuilder<TSource & TParam, TSource & TParam & TNextParam>(\n      nextDeferredBuilder,\n      [...this._precedingParams, param as ExtensionCommandParameter<unknown, unknown>]\n    );\n  }\n\n  /**\n   * Set the execution of the chain end\n   * @param run\n   */\n  public run(run: (\n    result: TParam & TSource,\n    interpretable: Interpretable<TSource, TSource & TParam, commandExecutionContext>\n                 ) => Promise<InterpretableResult>\n  ):\n    ExtensionCommandParameter<unknown, unknown>[]\n  {\n    this._interpretableDeferred.setExecute(async (result) => {\n      const interpretable = this._interpretableDeferred.interpretable;\n      const response = new InterpretableDeferResult(interpretable, undefined, () => run(result, interpretable));\n      return { result: response };\n    });\n    return this._precedingParams;\n  };\n\n  /**\n   * Build the current chain end or beginning\n   * Can only be used after the whole chain up to this point has been initialized\n   * Returns all arguments in the chain in correct order\n   */\n  public build() {\n    this._interpretableDeferred.build();\n  }\n}","import { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\n\n/**\n * A result of a failed interpretable execution without any other concrete meaning\n * Can be used to indicate a failed interpretation by throwing this during interpretation\n */\nexport class InterpretableError extends InterpretableResult {\n}","import { InterpretableError } from \"@/content/core/commands/results/interpretable-error\";\n\n/**\n * Error that can be thrown during interpretation of a command\n * when the command name is partially matched, instead of returning null\n */\nexport class InterpretableCommandPartialMatch extends InterpretableError {\n}","import { CommandParamsBuilder } from \"@/content/core/commands/builder/command-params-builder\";\nimport type { ExtensionCommandParameter } from \"@/content/core/commands/command-parameter\";\nimport {\n  type Interpretable,\n  type interpretableExecutionResult,\n  type interpretableInterpretationResult,\n} from \"@/content/core/commands/interpretable\";\nimport { InterpretableDeferResult } from \"@/content/core/commands/results/interpretable-defer-result\";\nimport { InterpretableCommandPartialMatch } from \"@/content/core/commands/results/interpretable-command-partial-match\";\nimport { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\nimport { type TypoFeature } from \"@/content/core/feature/feature\";\nimport { ExtensionSetting } from \"@/content/core/settings/setting\";\nimport { firstValueFrom } from \"rxjs\";\n\n/**\n * A context for command and parameter execution\n * Describing the state of the current interpretation chain\n */\nexport interface commandExecutionContext {\n\n  /**\n   * The command that initiated the interpretable chain\n   */\n  command: ExtensionCommand;\n\n  /**\n   * All parameters in the interpretable chain\n   */\n  parameters: ExtensionCommandParameter<unknown, unknown>[];\n\n  /**\n   * The parameter that is currently being interpreted, null if execution has thrown an error\n   */\n  currentInterpretedParameter?: ExtensionCommandParameter<unknown, unknown>;\n}\n\nexport class ExtensionCommand implements Interpretable<object, object, commandExecutionContext> {\n  private _id: ExtensionSetting<string>;\n  private _enabledSetting: ExtensionSetting<boolean>;\n  private _execute?: (\n    result: object,\n    context: commandExecutionContext,\n  ) => interpretableExecutionResult<object, commandExecutionContext>;\n  private _params: ExtensionCommandParameter<unknown, unknown>[] = [];\n\n  constructor(\n    private _defaultId: string,\n    private _feature: TypoFeature,\n    private _name: string,\n    private _description: string,\n    private _defaultEnabled = true,\n  ) {\n    this._id = new ExtensionSetting(`command.${this._defaultId}.name`, this._defaultId, this._feature);\n\n    this._enabledSetting = new ExtensionSetting(\n      `command.${this._defaultId}.enabled`,\n      this._defaultEnabled,\n      this._feature,\n    );\n  }\n\n  /**\n   * The human-readable name of the command\n   */\n  public get name() {\n    return this._name;\n  }\n\n  /**\n   * The default ID of the command\n   */\n  public get defaultId() {\n    return this._defaultId;\n  }\n\n  /**\n   * The description of the command\n   */\n  public get description() {\n    return this._description;\n  }\n\n  /**\n   * The command ID setting, which stores the command interpreter name\n   */\n  public get idSetting() {\n    return this._id.asFrozen;\n  }\n\n  /**\n   * The enabled setting, which stores whether the command is enabled for interpretation\n   */\n  public get enabledSetting() {\n    return this._enabledSetting.asFrozen;\n  }\n\n  /**\n   * The parameters of the command\n   */\n  public get params() {\n    return this._params;\n  }\n\n  /**\n   * Interpret the command by parsing its name and passing down the source context\n   * @param args\n   * @param source\n   * @param context\n   */\n  async interpret(\n    args: string,\n    source: object,\n    context: commandExecutionContext,\n  ): interpretableInterpretationResult<object, commandExecutionContext> {\n    /* get command name cached from setting */\n    const interpreterName = await firstValueFrom(this._id.changes$);\n\n    /* try to interpret */\n    if (args.startsWith(interpreterName)) {\n      const remainder = args.substring(interpreterName.length);\n      return { context, remainder, result: {} };\n    }\n\n    /* if partial match */\n    if (args.length > 0 && interpreterName.startsWith(args)) {\n      throw new InterpretableCommandPartialMatch(this);\n    }\n\n    /* did not match, signalize refused interpretation */\n    return null;\n  }\n\n  /**\n   * Execute the bound action on the result of the interpretation\n   * @param result\n   * @param context\n   */\n  execute(\n    result: object,\n    context: commandExecutionContext,\n  ): interpretableExecutionResult<object, commandExecutionContext> {\n    return (\n      this._execute?.(result, context) ??\n      Promise.resolve({ result: new InterpretableSuccess(this) })\n    );\n  }\n\n  /**\n   * Set the action for the following interpretation chain\n   * @param execute\n   */\n  public setExecute(\n    execute: (\n      result: object,\n      context: commandExecutionContext,\n    ) => interpretableExecutionResult<object, commandExecutionContext>,\n  ) {\n    this._execute = execute;\n    return this;\n  }\n\n  /**\n   * Set an action for immediate execution without further interpretation\n   * @param run\n   */\n  public run(run: (command: ExtensionCommand) => Promise<InterpretableResult>) {\n    this.setExecute(async () => {\n      /* signalize command interpreted successfully, and provide run function for command invocation */\n      const response = new InterpretableDeferResult(this, undefined, () => run(this));\n      return { result: response };\n    });\n    return this;\n  }\n\n  /**\n   * Add arguments to the command interpretation chain using a builder\n   * @param builderAction\n   */\n  public withParameters(\n    builderAction: (\n      builder: CommandParamsBuilder<object, object>,\n    ) => ExtensionCommandParameter<unknown, unknown>[],\n  ) {\n    const builder = CommandParamsBuilder.forCommand(this);\n    this._params = builderAction(builder);\n    builder.build();\n    return this;\n  }\n}","import { type commandExecutionContext, ExtensionCommand } from \"@/content/core/commands/command\";\nimport {\n  type Interpretable,\n  type interpretableExecutionResult,\n} from \"@/content/core/commands/interpretable\";\nimport { InterpretableError } from \"@/content/core/commands/results/interpretable-error\";\nimport { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { inject, injectable } from \"inversify\";\nimport { BehaviorSubject, combineLatest, map, type Observable, switchMap } from \"rxjs\";\n\n/**\n * Result of a command interpretable chain (command and params)\n */\nexport interface CommandExecutionResult {\n\n  /**\n   * The final execution result of the chain\n   */\n  result: InterpretableResult | null;\n\n  /**\n   * The context of the interpretation chain\n   */\n  context: commandExecutionContext;\n}\n\n@injectable()\nexport class CommandsService {\n  private readonly _logger;\n  private _registeredCommands: ExtensionCommand[] = [];\n  private _activeCommands$ = new BehaviorSubject<ExtensionCommand[]>([]);\n\n  constructor(@inject(loggerFactory) loggerFactory: loggerFactory) {\n    this._logger = loggerFactory(this);\n  }\n\n  /**\n   * Register a command to the service\n   * @param command\n   */\n  registerCommand(command: ExtensionCommand) {\n    this._registeredCommands.push(command);\n    this._activeCommands$.next(this._registeredCommands);\n  }\n\n  /**\n   * Remove a command from the service\n   * @param command\n   */\n  removeCommand(command: ExtensionCommand) {\n    this._registeredCommands = this._registeredCommands.filter((c) => c !== command);\n    this._activeCommands$.next(this._registeredCommands);\n  }\n\n  /**\n   * Get an observable containing all registered and active commands\n   */\n  get commands$(): Observable<ExtensionCommand[]> {\n    return this._activeCommands$.pipe(\n      switchMap((commands) => {\n        const values = commands.map((command) =>\n          command.enabledSetting.changes$.pipe(map((enabled) => ({ command, enabled }))),\n        );\n        return combineLatest(...values);\n      }),\n      map((commands) => commands.filter((c) => c.enabled).map((command) => command.command)),\n    );\n  }\n\n  /**\n   * Execute a command with given args as interpretable chain and return with resulting command context\n   * @param command\n   * @param args\n   */\n  async executeCommand(command: ExtensionCommand, args: string): Promise<CommandExecutionResult> {\n    const context: commandExecutionContext = {\n      parameters: command.params,\n      command\n    };\n\n    return { result: await this.executeInterpretable(command, args, {}, context), context };\n  }\n\n  /**\n   * Execute an interpretable chain on given args and context\n   * @param interpretable\n   * @param args\n   * @param source\n   * @param context\n   */\n  async executeInterpretable<TSource, TResult, TContext>(\n    interpretable: Interpretable<TSource, TResult, TContext>,\n    args: string,\n    source: TSource,\n    context: TContext,\n  ): Promise<InterpretableResult | null> {\n\n    /* try to interpret the args */\n    let interpretation;\n    try {\n      interpretation = await interpretable.interpret(args, source, context);\n    } catch (e: unknown) {\n\n      /* if an error is thrown, return it */\n      if (e instanceof InterpretableError) return e;\n      else throw e;\n    }\n\n    /* interpretation was refused, command not matched */\n    if (interpretation === null) {\n      return null;\n    }\n\n    /* execute interpretable action with interpreted args */\n    let result: Awaited<interpretableExecutionResult<TSource & TResult, TContext>>;\n    try {\n      result = await interpretable.execute(interpretation.result, context);\n    } catch (e: unknown) {\n      /* if an error is thrown, return it */\n      if (e instanceof InterpretableError) return e;\n      else throw e;\n    }\n\n    this._logger.debug(\"Interpretable execution result\", interpretable, result);\n\n    /* if interpretable provided chain, follow */\n    if (result.next !== undefined) {\n      return await this.executeInterpretable(\n        result.next,\n        interpretation.remainder,\n        interpretation.result,\n        context,\n      );\n    }\n\n    /* else return the result of the interpretable as result of the chain */\n    else return result.result;\n  }\n}","import type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { inject, injectable } from \"inversify\";\n\n@injectable()\nexport class HotkeysService {\n\n  private readonly _logger;\n  private _registeredHotkeys: HotkeyAction[] = [];\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  /**\n   * Register a hotkey to be executed when the combo is pressed\n   * @param hotkey\n   */\n  public registerHotkey(hotkey: HotkeyAction) {\n    if(this._registeredHotkeys.includes(hotkey)) {\n      this._logger.warn(\"Attempted to register a hotkey that was already registered\", hotkey);\n      return;\n    }\n\n    this._registeredHotkeys.push(hotkey);\n    this._logger.debug(\"Registered hotkey\", hotkey);\n  }\n\n  /**\n   * Remove a hotkey from the registered hotkeys; will no longer be listened for\n   * @param hotkey\n   */\n  public removeHotkey(hotkey: HotkeyAction) {\n    const lengthBefore = this._registeredHotkeys.length;\n    this._registeredHotkeys = this._registeredHotkeys.filter(h => h !== hotkey);\n    if (lengthBefore === this._registeredHotkeys.length) {\n      this._logger.warn(\"Attempted to remove a hotkey that was not registered\", hotkey);\n    }\n\n    this._logger.debug(\"Removed hotkey\", hotkey);\n  }\n\n  public get registeredHotkeys(){\n    return [...this._registeredHotkeys];\n  }\n\n  /**\n   * Set the hotkey combo for a hotkey action\n   * @param hotkey\n   * @param value\n   */\n  public async setHotkeyCombo(hotkey: HotkeyAction, value: string[]){\n    try {\n      if(value.length === 0){\n        this._logger.debug(\"Saving empty hotkey combo; disabling hotkey\");\n        await hotkey.enabledSetting.setValue(false);\n      }\n      await hotkey.comboSetting.setValue(value);\n    }\n    catch (e) {\n      this._logger.error(\"Error updating hotkey combo\", e);\n      throw e;\n    }\n\n    this._logger.info(\"Updated hotkey combo\", hotkey.name, value);\n  }\n\n  /**\n   * Resets the hotkey combo to the default value\n   * @param hotkey\n   */\n  public async resetHotkeyCombo(hotkey: HotkeyAction){\n    try {\n      await hotkey.comboSetting.setValue([...hotkey.defaultCombo ?? []]);\n      if(hotkey.defaultCombo === undefined || hotkey.defaultCombo.length === 0){\n        this._logger.debug(\"Resetting hotkey combo to empty; disabling hotkey\");\n        await hotkey.enabledSetting.setValue(false);\n      }\n    }\n    catch (e) {\n      this._logger.error(\"Error updating hotkey combo\", e);\n      throw e;\n    }\n\n    this._logger.info(\"Reset hotkey combo\", hotkey.name);\n    return [...hotkey.defaultCombo ?? []];\n  }\n}","import type { TypoFeature } from \"@/content/core/feature/feature\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { inject, injectable } from \"inversify\";\nimport { map, startWith, Subject } from \"rxjs\";\n\nexport interface tooltipParams {\n  title: string;\n  lock?: \"X\" | \"Y\";\n}\n\nexport interface registeredTooltip extends tooltipParams {\n  target: HTMLElement;\n  feature: TypoFeature\n}\n\n@injectable()\nexport class TooltipsService {\n\n  private readonly _logger;\n  private _registeredTooltips: Map<HTMLElement,registeredTooltip> = new Map<HTMLElement, registeredTooltip>();\n  private _changes = new Subject<void>();\n  private readonly _tooltipClass = \"typo-tooltip-registered\";\n\n  /**\n   * When elements are removed from the DOM, check if they or their children were registered as tooltips, and remove them\n   * @private\n   */\n  private _observer = new MutationObserver(mutations => {\n    let removed = false;\n\n    mutations.forEach(mutation => {\n      if(mutation.type === \"childList\") {\n        mutation.removedNodes.forEach(node => {\n          if(node instanceof HTMLElement) {\n\n            const tooltips = this.getTooltipsOfElement(node);\n            tooltips.forEach(element => {\n              if(element instanceof HTMLElement) {\n                this._logger.debug(\"Removing tooltip from element\", element);\n                this._registeredTooltips.delete(element);\n                removed = true;\n              }\n            });\n          }\n        });\n      }\n    });\n\n    if(removed) this._changes.next();\n  });\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n    this._observer.observe(document.body, {childList: true, subtree: true});\n  }\n\n  /**\n   * Register a tooltip for an element\n   * If this element has already a tooltip registered, it will be overwritten\n   * @param element\n   * @param params\n   * @param feature\n   */\n  public registerTooltip(element: HTMLElement, params: tooltipParams, feature: TypoFeature) {\n    if(this._registeredTooltips.has(element)) {\n      this._logger.debug(\"Overriding tooltip for element\", element, params, feature);\n    }\n\n    const tooltip: registeredTooltip = {target: element, ...params, feature: feature};\n    this._registeredTooltips.set(element, tooltip);\n    element.classList.toggle(this._tooltipClass, true);\n\n    this._changes.next();\n    this._logger.debug(\"Registered tooltip\", tooltip);\n  }\n\n  public get tooltips$() {\n    return this._changes.pipe(\n      startWith(null),\n      map(() => Array.from(this._registeredTooltips.values()))\n    );\n  }\n\n  /**\n   * Searches for tooltips in the given element and its children\n   * @param element\n   */\n  public getTooltipsOfElement(element: HTMLElement): HTMLElement[] {\n    const isTooltip = element.classList.contains(this._tooltipClass);\n    const childTooltips = [...element.querySelectorAll(`.${this._tooltipClass}`)].filter(e => e instanceof HTMLElement);\n\n    return isTooltip ? [element, ...childTooltips] : childTooltips;\n  }\n\n\n  /**\n   * Searches for tooltips in the given element and its parents\n   * @param element\n   */\n  public getTooltipsUntilElement(element: HTMLElement): HTMLElement[] {\n    const tooltips = [];\n\n    let currentTooltip: HTMLElement | null = element.closest(`.${this._tooltipClass}`);\n    while(currentTooltip != null && currentTooltip.parentElement instanceof HTMLElement){\n      tooltips.push(currentTooltip);\n      currentTooltip = currentTooltip.parentElement.closest(`.${this._tooltipClass}`);\n    }\n\n    return tooltips;\n  }\n}","import type { ExtensionCommand } from \"@/content/core/commands/command\";\nimport { CommandsService } from \"@/content/core/commands/commands.service\";\nimport type { featureBinding } from \"@/content/core/feature/featureBinding\";\nimport { HotkeysService } from \"@/content/core/hotkeys/hotkeys.service\";\nimport {\n  BooleanExtensionSetting, type serializable, SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { type tooltipParams, TooltipsService } from \"@/content/core/tooltips/tooltips.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport type { SvelteComponent } from \"svelte\";\nimport type { Action } from \"svelte/action\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\n\nexport type tooltipAction = Action<HTMLElement, tooltipParams, object>;\n\n@injectable()\nexport abstract class TypoFeature {\n\n  protected readonly featureEnabledDefault: boolean = true;\n\n  /**\n   * Services that are bound to the lifecycle of the feature with init/reset methods\n   * @protected\n   */\n  protected get boundServices(): featureBinding[] { return []; }\n\n  private _isActivated = false;\n  private _hotkeys: HotkeyAction[] = [];\n  private _settings: SettingWithInput<serializable>[] = [];\n  private _commands: ExtensionCommand[] = [];\n\n  public abstract readonly name: string;\n  public abstract readonly description: string;\n  public readonly toggleEnabled: boolean = true;\n  public readonly developerFeature: boolean = false;\n\n  private _isActivatedSetting = new BooleanExtensionSetting(\"isActivated\", this.featureEnabledDefault, this)\n      .withName(\"Activated\")\n      .withDescription(\"Enable or disable the feature. Disabled features will reset and remove every functionality, mods and hotkeys.\");\n\n  /**\n   * Add a hotkey to the user accessible hotkey configuration\n   * @param action\n   * @protected\n   */\n  protected useHotkey(action: HotkeyAction) {\n    this._hotkeys.push(action);\n    return action;\n  }\n\n  /**\n   * Add a command to the feature command configuration\n   * @param command\n   * @protected\n   */\n  protected useCommand(command: ExtensionCommand) {\n    this._commands.push(command);\n    return command;\n  }\n\n  /**\n   * Add a setting to the user accessible setting configuration\n   * @param setting\n   * @protected\n   */\n  protected useSetting<TSetting extends serializable>(\n    setting: SettingWithInput<TSetting>){\n    this._settings.push(setting as unknown as SettingWithInput<serializable>); /* what's wrong with polymorphism here? */\n\n    return setting;\n  }\n\n  /**\n   * All configured hotkeys for this feature\n   */\n  public get hotkeys(): readonly HotkeyAction[] {\n    return this._hotkeys;\n  }\n\n  public get settings(): readonly SettingWithInput<serializable>[] {\n    return this._settings;\n  }\n\n  public get commands(): readonly ExtensionCommand[] {\n    return this._commands;\n  }\n\n  /**\n   * A component to display feature customization settings\n   */\n  public get featureManagementComponent(): componentData<SvelteComponent> | undefined {\n    return undefined;\n  }\n\n  /**\n   * A component to display feature information or tutorial\n   */\n  public get featureInfoComponent(): componentData<SvelteComponent> | undefined {\n    return undefined;\n  }\n\n  public get hasDetailComponents() {\n    return this.hotkeys.length > 0 ||\n      this.commands.length > 0 ||\n      this.featureManagementComponent !== undefined ||\n      this.featureInfoComponent !== undefined ||\n      this._settings.length > 0;\n  }\n\n  /**\n   * unique feature ID, to store settings\n   */\n  public abstract readonly featureId: number;\n\n  protected postConstruct(): Promise<void> | void {\n    this._logger.debug(\"onConstruct not implemented\");\n  };\n\n  protected onActivate(): Promise<void> | void {\n    this._logger.debug(\"onActivate not implemented\");\n  }\n  protected onDestroy(): Promise<void> | void {\n    this._logger.debug(\"onDestroy not implemented\");\n  };\n\n  protected readonly _logger;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(HotkeysService) protected readonly _hotkeysService: HotkeysService,\n    @inject(TooltipsService) protected readonly _tooltipsService: TooltipsService,\n    @inject(CommandsService) protected readonly _commandsService: CommandsService\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  @postConstruct()\n  public init() {\n    this._isActivatedSetting.setDefaultValue(this.featureEnabledDefault); // derived class properties are not earlier available!\n\n    const loadActivation = () => {\n      this._isActivatedSetting.getValue().then((value) => {\n        this._logger.debug(\"Feature loaded with activation state\", value);\n        if(value) this.activate();\n      });\n    };\n\n    const postConstruct = this.postConstruct();\n    if(postConstruct instanceof Promise) postConstruct.then(loadActivation);\n    else loadActivation();\n  }\n\n  /**\n   * Activate the feature.\n   * The feature will be activated and run.\n   */\n  public async activate() {\n    if(this._isActivated) {\n      this._logger.warn(\"Attempted to activate feature while already activated\");\n      throw new Error(\"Feature is already activated\");\n    }\n\n    this._logger.info(\"Activating feature\");\n\n    /* init bound services */\n    await Promise.all(this.boundServices.map((service) => service.onFeatureActivate()));\n\n    const activate = this.onActivate();\n    if(activate instanceof Promise) await activate;\n    this._isActivated = true;\n    await this._isActivatedSetting.setValue(true);\n\n    /* register hotkeys */\n    if(this._hotkeys.length !== 0) {\n      this._logger.debug(\"Registering feature hotkeys\", this._hotkeys);\n      this._hotkeys.forEach((hotkey) => this._hotkeysService.registerHotkey(hotkey));\n    }\n\n    /* register commands */\n    for(const command of this._commands) {\n      this._commandsService.registerCommand(command);\n    }\n  }\n\n  /**\n   * Destroy the feature.\n   * The feature will be frozen and destroyed.\n   * To re-run the feature, it needs to be activated again.\n   */\n  public async destroy() {\n    if(!this._isActivated) {\n      this._logger.warn(\"Attempted to destroy feature without activation\");\n      throw new Error(\"Feature is not activated\");\n    }\n\n    this._logger.info(\"Destroying feature\");\n\n    const destroy = this.onDestroy();\n    if(destroy instanceof Promise) await destroy;\n    this._isActivated = false;\n    await this._isActivatedSetting.setValue(false);\n\n    /* reset bound services */\n    await Promise.all(this.boundServices.map((service) => service.onFeatureDestroy()));\n\n    /* remove hotkeys */\n    if(this._hotkeys.length !== 0) {\n      this._logger.debug(\"Removing feature hotkeys\", this._hotkeys);\n      this._hotkeys.forEach((hotkey) => this._hotkeysService.removeHotkey(hotkey));\n    }\n\n    /* deregister commands */\n    for(const command of this._commands) {\n      this._commandsService.removeCommand(command);\n    }\n  }\n\n  public get activated$() {\n    return this._isActivatedSetting.changes$;\n  }\n\n  private registerTooltip(node: HTMLElement, params: tooltipParams) {\n    this._logger.debug(\"Registering tooltip\", node, params);\n    this._tooltipsService.registerTooltip(node, params, this);\n  }\n\n  public get createTooltip(): tooltipAction {\n    return (node, params) => {\n      this.registerTooltip(node, params);\n\n      /* when action updated, re-register tooltip */\n      return {\n        update: (params: tooltipParams) => {\n          this.registerTooltip(node, params);\n        }\n      };\n    };\n  }\n}","import { TypoFeature } from \"@/content/core/feature/feature\";\nimport { injectable } from \"inversify\";\nimport { Subject } from \"rxjs\";\n\nexport type logLevel = \"debug\" | \"info\" | \"warn\" | \"error\";\n\nexport interface loggerEvent {\n  logLevel: logLevel;\n  message: unknown;\n  data: unknown[];\n  date: Date;\n  bindingName: string;\n}\n\n@injectable()\nexport class LoggerService {\n\n  private _level: logLevel = \"debug\";\n  public set level(level: logLevel) {\n    this._level = level;\n  }\n  public get level(): logLevel {\n    return this._level ;\n  }\n\n  private readonly _levels: {[key in logLevel]: number} = {\n    \"debug\": 1 ,\n    \"info\": 2,\n    \"warn\": 3,\n    \"error\": 4\n  };\n\n  private _boundTo?: object;\n  public bindTo(value: object) {\n    this._boundTo = value;\n    return this;\n  }\n  public get boundTo() {\n    return this._boundTo?.constructor.name ?? \" / \";\n  }\n  public get boundType() {\n    return this._boundTo instanceof TypoFeature ? \"feature\" : \"other\";\n  }\n\n  private _events$ = new Subject<loggerEvent>();\n  public get events$() {\n    return this._events$.asObservable();\n  }\n\n  /**\n   * Logs a message to the console.\n   * @param message The message to log.\n   * @param data Additional data that will be inspectable in the console.\n   */\n  debug(message: unknown, ...data: unknown[]) {\n    if(this._levels[this.level] > this._levels[\"debug\"]) return;\n\n    this._events$.next({\n      logLevel: \"debug\",\n      message: message,\n      data: data,\n      date: new Date(),\n      bindingName: this.boundTo\n    });\n  }\n\n  /**\n   * Logs a message to the console.\n   * @param message The message to log.\n   * @param data Additional data that will be inspectable in the console.\n   */\n  info(message: unknown, ...data: unknown[]) {\n    if(this._levels[this.level] > this._levels[\"info\"]) return;\n\n    this._events$.next({\n      logLevel: \"info\",\n      message: message,\n      data: data,\n      date: new Date(),\n      bindingName: this.boundTo\n    });\n  }\n\n  /**\n   * Logs a warning to the console.\n   * @param message The warning to log.\n   * @param data Additional data that will be inspectable in the console.\n   */\n  warn(message: unknown, ...data: unknown[]) {\n    if(this._levels[this.level] > this._levels[\"warn\"]) return;\n\n    this._events$.next({\n      logLevel: \"warn\",\n      message: message,\n      data: data,\n      date: new Date(),\n      bindingName: this.boundTo\n    });\n  }\n\n  /**\n   * Logs an error to the console.\n   * @param message The error to log.\n   * @param data Additional data that will be inspectable in the console.\n   */\n  error(message: unknown, ...data: unknown[]) {\n    if(this._levels[this.level] > this._levels[\"error\"]) return;\n\n    this._events$.next({\n      logLevel: \"error\",\n      message: message,\n      data: data,\n      date: new Date(),\n      bindingName: this.boundTo\n    });\n  }\n}\n","import { inject, injectable } from \"inversify\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\nimport { LoggerService } from \"../logger/logger.service\";\n\n@injectable()\nexport abstract class Setup<TData>{\n\n  protected readonly _logger: LoggerService;\n  private _setupPromise: Promise<TData> | undefined;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  protected abstract runSetup(): Promise<TData>;\n\n  public complete() {\n    if(this._setupPromise === undefined){\n      this._logger.info(\"Running setup\");\n      this._setupPromise = this.runSetup();\n      this._setupPromise.then(() => {\n        this._logger.info(\"Setup completed\");\n      });\n    }\n\n    return this._setupPromise;\n  }\n}","export const appendElement = (sourceElement: HTMLElement, position: InsertPosition, parentElement: HTMLElement) => {\n  parentElement.insertAdjacentElement(position, sourceElement);\n  return sourceElement;\n};\n\nexport const createElement = (htmlString: string) => {\n  const template = document.createElement(\"template\");\n  template.innerHTML = htmlString.trim();\n  return template.content.firstChild as HTMLElement;\n};","import type { Type } from \"@/util/types/type\";\nimport type { Setup } from \"./setup\";\n\nconst decoratorSymbol = Symbol(\"earlySetup\");\n\n/* type decorator that sets metadata to define a setup that runs immediately without dependency */\nexport function earlySetup() {\n  return function(target: Type<Setup<unknown>>) {\n    Reflect.defineMetadata(decoratorSymbol, true, target);\n  };\n}\n\n/* check if a setup is an early setup */\nexport function isEarlySetup(target: Type<Setup<unknown>>) {\n  return Reflect.getMetadata(decoratorSymbol, target);\n}\n\n","import { Interceptor } from \"@/content/core/interceptor/interceptor\";\nimport { earlySetup } from \"@/content/core/setup/earlySetup.decorator\";\nimport { inject } from \"inversify\";\nimport { firstValueFrom } from \"rxjs\";\nimport { Setup } from \"../../core/setup/setup\";\n\n/**\n * Setup that waits until the game js has been patched\n */\n@earlySetup()\nexport class GamePatchReadySetup extends Setup<void> {\n\n  @inject(Interceptor) private readonly _interceptor!: Interceptor;\n\n  protected async runSetup(): Promise<void> {\n    return firstValueFrom(this._interceptor.patchLoaded$);\n  }\n}","import ChatControls from \"@/content/setups/chat-controls/chat-controls.svelte\";\nimport { requireElement } from \"@/util/document/requiredQuerySelector\";\nimport { inject } from \"inversify\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { createElement, appendElement } from \"@/util/document/appendElement\";\nimport { GamePatchReadySetup } from \"../game-patch-ready/game-patch-ready.setup\";\n\nexport class ChatControlsSetup extends Setup<HTMLElement> {\n\n  @inject(GamePatchReadySetup) private _gameReadySetup!: GamePatchReadySetup;\n\n  protected async runSetup(): Promise<HTMLElement> {\n    await this._gameReadySetup.complete();\n\n    const chatControls = appendElement(createElement(\"<div class='typo-chat-controls'></div>\"), \"afterbegin\", requireElement(\"#game-wrapper\"));\n    new ChatControls({\n      target: chatControls\n    });\n\n    return chatControls;\n  }\n}","import type { TypoFeature } from \"@/content/core/feature/feature\";\nimport { ExtensionSetting } from \"@/content/core/settings/setting\";\nimport { map, of, switchMap, take, withLatestFrom } from \"rxjs\";\nimport { fromPromise } from \"rxjs/internal/observable/innerFrom\";\n\nexport class HotkeyAction {\n\n  private _enabledSetting: ExtensionSetting<boolean>;\n  private _comboSetting: ExtensionSetting<string[]>;\n  private _onceListeners: (() => (void | Promise<void>))[] = [];\n\n  constructor(\n    private _key: string,\n    private _name: string,\n    private _description: string,\n    private _feature: TypoFeature | undefined,\n    private _action: () => (void | Promise<void>),\n    defaultEnabled?: boolean,\n    private _defaultCombo?: string[],\n    private _releaseAction?: () => (void | Promise<void>),\n    private _preventWhenInputActive = true\n  ) {\n    this._enabledSetting = new ExtensionSetting(`\n    hotkey.${this._key}.enabled`,\n      defaultEnabled === true && this._defaultCombo !== undefined && this._defaultCombo.length > 0,\n      this._feature\n    );\n\n    this._comboSetting = new ExtensionSetting(\n      `hotkey.${this._key}.combo`,\n      this._defaultCombo ?? [],\n      this._feature\n    );\n  }\n\n  public get disabledOnInputs(){\n    return this._preventWhenInputActive;\n  }\n\n  public get name() {\n    return this._name;\n  }\n\n  public get description() {\n    return this._description;\n  }\n\n  public get enabledSetting() {\n    return this._enabledSetting.asFrozen;\n  }\n\n  public get comboSetting() {\n    return this._comboSetting.asFrozen;\n  }\n\n  public get defaultCombo(): readonly string[] | undefined {\n    return this._defaultCombo;\n  }\n\n  public once(action: () => (void | Promise<void>)) {\n    this._onceListeners.push(action);\n  }\n\n  /**\n   * checks if a key combination is active and matches, and executes if positive\n   * return observable holds the result, if executed or not\n   * @param keys a combination of key codes, see https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_code_values\n   */\n  public executeIfMatches(keys: string[], inputActive: boolean) {\n    return this._enabledSetting.changes$.pipe(\n      take(1),\n      withLatestFrom(this._comboSetting.changes$),\n      map(([enabled, combo]) => enabled && !(this._preventWhenInputActive && inputActive) && combo.length > 0 ? combo : null),\n      map(combo => combo ? combo.length === keys.length && combo.every(key => keys.includes(key)) : false),\n      switchMap(matches => {\n        if(!matches) return of(false);\n        const result = this._action();\n\n        const onceListeners = [...this._onceListeners];\n        this._onceListeners = [];\n        const results = onceListeners.map(listener => listener());\n        results.push(result);\n\n        return Promise.all(results);\n      })\n    );\n  }\n\n  /**\n   * Release the hotkey action if the current combo does not match the given keys\n   * will also release if the hotkey is disabled\n   * @param keys\n   */\n  public releaseIfNotMatches(keys: string[]) {\n    return this._comboSetting.changes$.pipe(\n      take(1),\n      map(combo => combo ? combo.length === keys.length && combo.every(key => keys.includes(key)) : false),\n      switchMap(matches => {\n        if(matches) return of(false);\n        if(this._releaseAction) {\n          const result = this._releaseAction();\n          return result instanceof Promise ? fromPromise(result).pipe(map(() => true)) : of(true);\n        }\n        return of(true);\n      })\n    );\n  }\n}","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { BooleanExtensionSetting, ChoiceExtensionSetting } from \"@/content/core/settings/setting\";\nimport { inject, injectable } from \"inversify\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\n@injectable()\nexport class GlobalSettingsService {\n\n  private _globalHotkeysList = {\n    exitModal: new HotkeyAction(\n      \"modal_close\",\n      \"Close Modal\",\n      \"Close open modals using a hotkey\",\n      undefined,\n      () => {\n        return void 0;\n      },\n      true,\n      [\"Escape\"]\n    )\n  };\n\n  private _settings = {\n    devMode: new BooleanExtensionSetting(\"devMode\", false)\n      .withName(\"Developer Mode\")\n      .withDescription(\"Enable some developer features & settings\"),\n    controlsPosition: new ChoiceExtensionSetting<\"topright\" | \"topleft\" | \"bottomright\" | \"bottomleft\">(\"controlsPosition\", \"topleft\")\n      .withName(\"Control Icons Position\")\n      .withDescription(\"The position where the typo controls are displayed\")\n      .withChoices([\n        {name: \"Top Right\", choice: \"topright\"},\n        {name: \"Top Left\", choice: \"topleft\"},\n        {name: \"Bottom Right\", choice: \"bottomright\"},\n        {name: \"Bottom Left\", choice: \"bottomleft\"}\n      ]),\n    controlsDirection: new ChoiceExtensionSetting<\"vertical\" | \"horizontal\">(\"controlsDirection\", \"vertical\")\n      .withName(\"Control Icons Direction\")\n      .withDescription(\"The direction where the typo controls are lined up\")\n      .withChoices([\n        {name: \"Horizontal\", choice: \"horizontal\"},\n        {name: \"Vertical\", choice: \"vertical\"},\n      ]),\n    showLandingOutfit: new BooleanExtensionSetting(\"showLandingOutfit\", true)\n      .withName(\"Customizer Outfit\")\n      .withDescription(\"Show your current outfit on the avatar customizer\"),\n  };\n\n  private readonly _logger;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  public get globalHotkeys(){\n    return this._globalHotkeysList;\n  }\n\n  public get globalHotkeysList(){\n    return Object.values(this._globalHotkeysList);\n  }\n\n  public get settings(){\n    return this._settings;\n  }\n\n  public get settingsList(){\n    return Object.values(this._settings);\n  }\n}","<script lang=\"ts\">\n\n  import type { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\n  import { onMount } from \"svelte\";\n\n  let elem: HTMLDivElement;\n  let resolve: (elem: HTMLDivElement) => void;\n\n  export let globalSettings: GlobalSettingsService;\n  export const element = new Promise<HTMLDivElement>((res) => {\n    resolve = res;\n  });\n\n  onMount(() => {\n    resolve(elem);\n  });\n\n  const position = globalSettings.settings.controlsPosition.store;\n  const direction = globalSettings.settings.controlsDirection.store;\n\n</script>\n\n<style lang=\"scss\">\n  .typo-controls {\n    position:fixed;\n    display: flex;\n    align-items: center;\n    gap: .5em;\n    z-index: 100;\n\n    &.topleft {\n      left: .5em;\n      top: .5em;\n    }\n\n    &.topright {\n      right: .5em;\n      top: .5em;\n    }\n\n    &.bottomright {\n      right: .5em;\n      bottom: .5em;\n    }\n\n    &.bottomleft {\n      left: .5em;\n      bottom: .5em;\n    }\n\n    &.vertical {\n      flex-direction: column;\n    }\n\n    &.horizontal {\n      flex-direction: row;\n    }\n\n  }\n</style>\n\n<div bind:this={elem} class='typo-controls {$position} {$direction}'></div>\n\n","import { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { inject } from \"inversify\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { GamePatchReadySetup } from \"../game-patch-ready/game-patch-ready.setup\";\nimport Controls from \"./controls.svelte\";\n\nexport class ControlsSetup extends Setup<HTMLElement> {\n\n  @inject(GamePatchReadySetup) private _gameReadySetup!: GamePatchReadySetup;\n  @inject(GlobalSettingsService) private _settingsService!: GlobalSettingsService;\n\n  protected async runSetup(): Promise<HTMLElement> {\n\n    await this._gameReadySetup.complete();\n\n    const component = new Controls({\n      target: document.body,\n      props:{\n        globalSettings: this._settingsService\n      }\n    });\n\n    return await component.element;\n  }\n}","<script lang=\"ts\">\n  import { onMount } from \"svelte\";\n\n  let elem: HTMLDivElement;\n  let resolve: (elem: HTMLDivElement) => void;\n  export const element = new Promise<HTMLDivElement>((res) => {\n    resolve = res;\n  });\n\n  onMount(() => {\n    resolve(elem);\n  });\n</script>\n\n<style lang=\"scss\">\n  .typo-customizer-actions {\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n    top: 40px;\n    right: 4px;\n  }\n</style>\n\n<div bind:this={elem} class='typo-customizer-actions'></div>\n\n","import { requireElement } from \"@/util/document/requiredQuerySelector\";\nimport { Setup } from \"../../core/setup/setup\";\nimport CustomizerIcons from \"./customizer-actions.svelte\";\n\nexport class CustomizerActionsSetup extends Setup<HTMLElement> {\n\n  protected async runSetup(): Promise<HTMLElement> {\n\n    const component = new CustomizerIcons({\n      target: requireElement(\".avatar-customizer\"),\n    });\n\n    return await component.element;\n  }\n}","import { earlySetup } from \"@/content/core/setup/earlySetup.decorator\";\nimport { Setup } from \"../../core/setup/setup\";\n\n/**\n * Setup that waits until the game js has been run\n */\n@earlySetup()\nexport class SkribblInitializedSetup extends Setup<void> {\n  protected async runSetup(): Promise<void> {\n    return new Promise((resolve) => {\n\n      /* if script already finished */\n      if(document.body.getAttribute(\"typo-skribbl-loaded\") !== null) resolve();\n\n      /* else wait for patcher finished */\n      else document.addEventListener(\"skribblInitialized\", () => resolve());\n    });\n  }\n}","import { inject } from \"inversify\";\nimport { appendElement, createElement } from \"@/util/document/appendElement\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { GamePatchReadySetup } from \"../game-patch-ready/game-patch-ready.setup\";\nimport ToastContainer from \"./toast-container.svelte\";\n\nexport class ToastSetup extends Setup<HTMLElement> {\n\n  @inject(GamePatchReadySetup) private _gameReadySetup!: GamePatchReadySetup;\n\n  protected async runSetup(): Promise<HTMLElement> {\n\n    await this._gameReadySetup.complete();\n\n    const controls = appendElement(createElement(\"<div class='typo-toast-container'></div>\"), \"afterbegin\", document.body);\n    new ToastContainer({\n      target: controls\n    });\n\n    return controls;\n  }\n}","<script lang=\"ts\">\n  export let tabs: {name: string, id: string}[] = [];\n  let activeTab = tabs[0];\n</script>\n\n<style lang=\"scss\">\n\n  /* hide headers that have no tab*/\n  @mixin hide-empty-headers {\n    @for $i from 2 through 5 {\n      :global(#home .panel.typo-panel:has(.typo-panel-tab:empty:nth-child(#{$i}))) .panel-header :nth-child(#{$i - 1}) {\n        display: none;\n      }\n    }\n  }\n  @include hide-empty-headers;\n\n  /* hide panel that has no tabs */\n  :global(#home .panel.typo-panel:not(:has(.typo-panel-tab:not(:empty)))) {\n    display:none;\n  }\n\n  :global(#home .panel.panel-right){\n    margin-left: 20px; /* like skribbl info panels below */\n  }\n\n  :global(#home .panel.panel-left){\n    margin-right: 20px; /* like skribbl info panels below */\n  }\n\n  :global(#home .panel.typo-panel) {\n      flex: 0 0 400px;\n      max-height: calc(400px - 2em);\n      margin-top: 2em;\n      display: flex;\n      flex-direction: column;\n      align-items: normal;\n      justify-content: flex-start;\n      color: var(--COLOR_PANEL_TEXT);\n\n      .panel-header {\n          display:flex;\n          justify-content:space-between;\n          font-weight: 600;\n\n          h2 {\n              cursor: pointer;\n\n              &.inactive {\n                  opacity: 0.5;\n              }\n          }\n      }\n\n    .typo-panel-tab {\n      margin-top: 1rem;\n      /*padding: .5rem;*/\n      overflow: auto;\n      flex-grow: 1;\n    }\n\n    > div:empty {\n      display: none;\n    }\n  }\n</style>\n\n<div class=\"panel-header\">\n  {#each tabs as tab}\n    <h2 class:inactive={tab !== activeTab} tabindex=\"0\" role=\"button\"\n        on:keydown={() => activeTab = tab}\n        on:click={() => activeTab = tab}>{tab.name}</h2>\n  {/each}\n</div>\n\n{#each tabs as tab}\n  <div class=\"typo-panel-tab color-scrollbar panel-tab-{tab.id}\" hidden={tab !== activeTab}> </div>\n{/each}","import { inject } from \"inversify\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { requireElement } from \"../../../util/document/requiredQuerySelector\";\nimport { createElement, appendElement } from \"../../../util/document/appendElement\";\nimport { GamePatchReadySetup } from \"../game-patch-ready/game-patch-ready.setup\";\nimport PanelTabs from \"./panel-tabs.svelte\";\n\nexport class PanelSetup extends Setup<{ leftPanel: HTMLElement, rightPanel: HTMLElement }> {\n\n  @inject(GamePatchReadySetup) private _gameReadySetup!: GamePatchReadySetup;\n\n  protected async runSetup(): Promise<{ leftPanel: HTMLElement; rightPanel: HTMLElement }> {\n\n    await this._gameReadySetup.complete();\n\n    const panels = {\n      rightPanel: appendElement(createElement(\"<div class='panel panel-right typo-panel'></div>\"), \"afterend\", requireElement(\".panel\")),\n      leftPanel: appendElement(createElement(\"<div class='panel panel-left typo-panel'></div>\"), \"beforebegin\", requireElement(\".panel\"))\n    };\n\n    new PanelTabs({\n      target: panels.leftPanel,\n      props: {\n        tabs: [{ name: \"Typo News\", id: \"news\" }, { name: \"Changelog\", id: \"changelog\" }]\n      }\n    });\n\n    new PanelTabs({\n      target: panels.rightPanel,\n      props: {\n        tabs: [{ name: \"Lobbies\", id: \"lobbies\" }, { name: \"Filters\", id: \"filter\" }, { name: \"Outfit\", id: \"cabin\" }]\n      }\n    });\n\n    return panels;\n  }\n}","import { inject } from \"inversify\";\nimport { appendElement, createElement } from \"@/util/document/appendElement\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { requireElement } from \"@/util/document/requiredQuerySelector\";\nimport { GamePatchReadySetup } from \"../game-patch-ready/game-patch-ready.setup\";\nimport Toolbar from \"./toolbar.svelte\";\n\nexport class ToolbarSetup extends Setup<HTMLElement> {\n\n  @inject(GamePatchReadySetup) private _gameReadySetup!: GamePatchReadySetup;\n\n  protected async runSetup(): Promise<HTMLElement> {\n\n    await this._gameReadySetup.complete();\n\n    const toolbar = appendElement(createElement(\"<div class='typo-toolbar'></div>\"), \"afterbegin\", requireElement(\"#game-wrapper\"));\n    new Toolbar({\n      target: toolbar\n    });\n\n    return toolbar;\n  }\n}","import { ChatControlsSetup } from \"@/content/setups/chat-controls/chat-controls.setup\";\nimport { ControlsSetup } from \"@/content/setups/controls/controls.setup\";\nimport { CustomizerActionsSetup } from \"@/content/setups/customizer-actions/customizer-actions.setup\";\nimport { SkribblInitializedSetup } from \"@/content/setups/skribbl-initialized/skribbl-initialized.setup\";\nimport { ToastSetup } from \"@/content/setups/toast/toast.setup\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { requireElement } from \"@/util/document/requiredQuerySelector\";\nimport { inject } from \"inversify\";\nimport { PanelSetup } from \"../panel/panel.setup\";\nimport { ToolbarSetup } from \"../toolbar/toolbar.setup\";\n\n/**\n * Function to make dynamic return type\n * @param panels\n * @param toolbar\n * @param controls\n * @param toastContainer\n * @param chatControls\n * @param customizerActions\n */\nfunction getElements(panels: Awaited<ReturnType<PanelSetup[\"complete\"]>>, toolbar: HTMLElement, controls: HTMLElement, toastContainer: HTMLElement, chatControls: HTMLElement, customizerActions: HTMLElement){\n  return {\n    panelContainer: requireElement(\".panels\"),\n    avatarPanel: requireElement(\".panel:not(.typo-panel)\"),\n    newsTab: requireElement(\".panel-tab-news\"),\n    changelogTab: requireElement(\".panel-tab-changelog\"),\n    lobbiesTab: requireElement(\".panel-tab-lobbies\"),\n    cabinTab: requireElement(\".panel-tab-cabin\"),\n    filterTab: requireElement(\".panel-tab-filter\"),\n    playButton: requireElement(\".panel:not(.typo-panel) .button-play\"),\n    gameBar: requireElement(\"#game-bar\"),\n    gameSettings: requireElement(\"#game-settings\"),\n    home: requireElement(\"#home\"),\n    game: requireElement(\"#game\"),\n    gameWrapper: requireElement(\"#game-wrapper\"),\n    load: requireElement(\"#load\"),\n    chatInput: requireElement(\"#game-chat form.chat-form input\") as HTMLInputElement,\n    chatForm: requireElement(\"#game-chat form.chat-form\"),\n    chatArea: requireElement(\"#game-chat\"),\n    chatContent: requireElement(\"#game-chat .chat-content\"),\n    hints: requireElement(\"#game-word .hints\"),\n    canvasWrapper: requireElement(\"#game-canvas\"),\n    canvas: requireElement(\"#game-canvas canvas\") as HTMLCanvasElement,\n    landingAvatar: requireElement(\".avatar-customizer .avatar\"),\n    landingCustomizeContainer: requireElement(\".avatar-customizer\"),\n    landingAvatarContainer: requireElement(\".avatar-customizer .container\"),\n    skribblTools: requireElement(\".toolbar-group-tools\"),\n    skribblActions: requireElement(\".toolbar-group-actions\"),\n    skribblToolbar: requireElement(\"#game-toolbar\"),\n    skribblBrushTools: requireElement(\".toolbar-group-tools .tool[data-tooltip=\\\"Brush\\\"]\"),\n    colorContainer: requireElement(\"#game-toolbar .colors\"),\n    scoreboardResults: requireElement(\"#game-canvas .overlay-content .result\"),\n    playerPopup: requireElement(\"#modal .modal-content .modal-container-player\"),\n    skribblModal: requireElement(\"#modal\"),\n    canvasOverlay: requireElement(\"#game-canvas .overlay-content\"),\n    textOverlay: requireElement(\"#game-canvas .overlay-content > .text\"),\n    gameRate: requireElement(\"#game-rate\"),\n    inputName: requireElement(\"input.input-name\") as HTMLInputElement,\n    logoIngame: requireElement(\"#game-logo img\"),\n    chatControls,\n    ...panels,\n    toolbar,\n    controls,\n    toastContainer,\n    customizerActions\n  };\n}\nexport type typoElements = ReturnType<typeof getElements>;\n\n/**\n * Setup to get commonly used skribbl element references\n */\nexport class ElementsSetup extends Setup<typoElements> {\n\n  @inject(PanelSetup) private _panelSetup!: PanelSetup;\n  @inject(ToolbarSetup) private _toolbarSetup!: ToolbarSetup;\n  @inject(ControlsSetup) private _controlsSetup!: ControlsSetup;\n  @inject(ChatControlsSetup) private _chatControlsSetup!: ChatControlsSetup;\n  @inject(ToastSetup) private _toastSetup!: ToastSetup;\n  @inject(SkribblInitializedSetup) private _gameReadySetup!: SkribblInitializedSetup;\n  @inject(CustomizerActionsSetup) private _customizerIconsSetup!: CustomizerActionsSetup;\n\n  protected async runSetup(): Promise<ReturnType<typeof getElements>> {\n    await this._gameReadySetup.complete();\n    const panels = await this._panelSetup.complete();\n    const toolbar = await this._toolbarSetup.complete();\n    const controls = await this._controlsSetup.complete();\n    const chatControls = await this._chatControlsSetup.complete();\n    const toastContainer = await this._toastSetup.complete();\n    const customizerActions = await this._customizerIconsSetup.complete();\n    return getElements(panels, toolbar, controls, toastContainer, chatControls, customizerActions);\n  }\n}","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { distinctUntilChanged, Observable, Subject, tap } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event emitted when the content in the chat input changed (user typed)\n */\nexport class ChatTypedEvent extends ApplicationEvent<string> {\n  constructor(public readonly data: string) { super(); }\n}\n\n@injectable()\nexport class ChatTypedEventProcessor extends EventProcessor<string, ChatTypedEvent>\n{\n  @inject(ElementsSetup) _elementsSetup!: ElementsSetup;\n\n  public readonly eventType = ChatTypedEvent;\n\n  protected async streamEvents(): Promise<Observable<ChatTypedEvent>> {\n    const events = new Subject<ChatTypedEvent>();\n    const {chatInput, chatForm} = await this._elementsSetup.complete();\n\n    /* listen for value change */\n    chatInput.addEventListener(\"input\", () => {\n      const value = chatInput.value;\n      events.next(new ChatTypedEvent(value));\n    });\n\n    /* listen for submit */\n    chatForm.addEventListener(\"submit\", () => {\n      events.next(new ChatTypedEvent(\"\"));\n    });\n\n    return events.pipe(\n      distinctUntilChanged((a, b) => a.data === b.data),\n      tap(data => this._logger.debug(\"Chat typed event\", data))\n    );\n  }\n}\n\n@injectable()\nexport class ChatTypedEventListener extends EventListener<string, ChatTypedEvent> {\n  @inject(ChatTypedEventProcessor) protected readonly _processor!: ChatTypedEventProcessor;\n}\n\nexport const chatTypedEventRegistration: EventRegistration<string, ChatTypedEvent> = {\n  listenerType: ChatTypedEventListener,\n  processorType: ChatTypedEventProcessor\n};","import { Color } from \"@/util/color\";\nimport { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted whenever an image is cleared or an action is undone\n * The data is the index of first draw command that has been removed\n */\nexport class ColorChangedEvent extends ApplicationEvent<Color> {\n  constructor(public readonly data: Color) { super(); }\n}\n\n@injectable()\nexport class ColorChangedEventProcessor extends EventProcessor<Color, ColorChangedEvent>\n{\n\n  public readonly eventType = ColorChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<ColorChangedEvent>> {\n    const events = new Subject<ColorChangedEvent>();\n\n    /* listen for custom patched event */\n    document.addEventListener(\"skribblColorChanged\", (event: Event) => {\n      const rgb = (event as CustomEvent<string>).detail;\n      const color = Color.fromRgbString(rgb);\n      events.next(new ColorChangedEvent(color));\n      this._logger.info(\"Color changed\", color);\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class ColorChangedEventListener extends EventListener<Color, ColorChangedEvent> {\n  @inject(ColorChangedEventProcessor) protected readonly _processor!: ColorChangedEventProcessor;\n}\n\nexport const colorChangedEventRegistration: EventRegistration<Color, ColorChangedEvent> = {\n  listenerType: ColorChangedEventListener,\n  processorType: ColorChangedEventProcessor\n};","import { type Observable, Subject } from \"rxjs\";\nimport { earlySetup } from \"../../core/setup/earlySetup.decorator\";\nimport { Setup } from \"../../core/setup/setup\";\n\n/**\n * Setup that waits until the message emit relay has been set up\n */\n@earlySetup()\nexport class SkribblEmitRelaySetup extends Setup<Observable<{event: string, data: any}>> {  // eslint-disable-line @typescript-eslint/no-explicit-any\n  protected async runSetup(): Promise<Observable<{event: string, data: any}>> { // eslint-disable-line @typescript-eslint/no-explicit-any\n    return new Promise<Subject<{   event: string, data: any }>>((resolve) => { // eslint-disable-line @typescript-eslint/no-explicit-any\n      window.addEventListener(\"message\", (data) => {\n        if (data.data === \"skribblEmitPort\") {\n          const ports = data.ports;\n          if(ports.length === 0) return;\n\n          const observable = new Subject<{event: string, data: any}>(); // eslint-disable-line @typescript-eslint/no-explicit-any\n          ports[0].onmessage = (message) => {\n\n            /*this._logger.debug(\"Sent message\", message.data);*/\n            observable.next({event: message.data[0], data: message.data[1]});\n          };\n          resolve(observable);\n        }\n      });\n    });\n  }\n}","import { type Observable, Subject } from \"rxjs\";\nimport { earlySetup } from \"../../core/setup/earlySetup.decorator\";\nimport { Setup } from \"../../core/setup/setup\";\n\n\nexport interface messageRelay {\n  /**\n   * All messages that are received via socket.io\n   */\n  serverMessages$: Observable<any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n\n  /**\n   * Send a message directly over socket.io without further client processing\n   * @param message\n   */\n  insertMessage: (message: any) => void; // eslint-disable-line @typescript-eslint/no-explicit-any\n}\n\n/**\n * Setup that waits until the game js has been patched\n */\n@earlySetup()\nexport class SkribblMessageRelaySetup extends Setup<messageRelay> {\n  protected async runSetup(): Promise<messageRelay> {\n    return new Promise((resolve) => {\n      window.addEventListener(\"message\", (data) => {\n        if (data.data === \"skribblMessagePort\") {\n          const ports = data.ports;\n          if(ports.length === 0) return;\n\n          const observable = new Subject<any>(); // eslint-disable-line @typescript-eslint/no-explicit-any\n\n          /* debug */\n          document.addEventListener(\"insertSkribblEmit\", (e: Event) => {\n            this._logger.debug(\"insertSkribblEmit\", (e as CustomEvent).detail);\n\n            ports[0].postMessage((e as CustomEvent).detail);\n          });\n\n          ports[0].onmessage = (message) => {\n\n            /* log everything except draw commands */\n            if(message.data.id !== 19) {\n              this._logger.debug(\"Received message\", message.data);\n            }\n\n            observable.next(message.data);\n          };\n          resolve({\n            serverMessages$: observable,\n            insertMessage: (message) => ports[0].postMessage(message)\n          });\n        }\n      });\n    });\n  }\n}","import { SkribblEmitRelaySetup } from \"@/content/setups/skribbl-emit-relay/skribbl-emit-relay.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { bufferTime, filter, map, merge, Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\n/**\n * Event that is emitted whenever a draw command is executed/received\n * On lobby join, all missing commands of the current drawing are sent\n */\nexport class DrawEvent extends ApplicationEvent<number[][]> {\n  constructor(public readonly data: number[][]) { super(); }\n}\n\n@injectable()\nexport class DrawEventProcessor extends EventProcessor<number[][], DrawEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n  @inject(SkribblEmitRelaySetup) _skribblEmitRelaySetup!: SkribblEmitRelaySetup;\n\n  public readonly eventType = DrawEvent;\n\n  protected async streamEvents(): Promise<Observable<DrawEvent>> {\n    const events = new Subject<DrawEvent>();\n\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n    const skribblEmit = await this._skribblEmitRelaySetup.complete();\n\n    /* merge own and lobby commands */\n    merge(\n      skribblEmit.pipe(\n        filter(data => data.event === \"data\"),\n        map(data => data.data)),\n      skribblMessages.serverMessages$\n    ).pipe(\n      map(event => {\n        /*draw commands event*/\n        if(event.id === 19){\n          if(typeof event.data[0] === \"number\") {\n            return [event.data as number[]];\n          }\n          else return event.data as number[][];\n        }\n\n        /*draw commands from lobby joined*/\n        if(event.id === 10 && event.data.state.id === 4 && event.data.state.data.drawCommands){\n          return event.data.state.data.drawCommands as number[][];\n        }\n\n        return null;\n      }),\n      filter(data => data !== null),\n      bufferTime(100),  /* debounce to prevent excessive observable spam */\n      filter(data => data.length > 0)\n    ).subscribe((data) => {\n      const flat = data.flat(1);\n      events.next(new DrawEvent(flat));\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class DrawEventListener extends EventListener<number[][], DrawEvent> {\n  @inject(DrawEventProcessor) protected readonly _processor!: DrawEventProcessor;\n}\n\nexport const drawEventRegistration: EventRegistration<number[][], DrawEvent> = {\n  listenerType: DrawEventListener,\n  processorType: DrawEventProcessor\n};","import { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\n/**\n * Event that contains hint characters at their position, when new hints are added\n * On lobby join, already existing hints are emitted\n */\nexport class HintsAddedEvent extends ApplicationEvent<[number, string][]> {\n  constructor(public readonly data: [number, string][]) { super(); }\n}\n\n@injectable()\nexport class HintsAddedEventProcessor extends EventProcessor<[number, string][], HintsAddedEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = HintsAddedEvent;\n\n  protected async streamEvents(): Promise<Observable<HintsAddedEvent>> {\n    const events = new Subject<HintsAddedEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    skribblMessages.serverMessages$.subscribe((event) => {\n\n      /* inital lobby hints */\n      if(event.id === 10 && event.data.state.id === 4 && event.data.state.data.hints){\n        const hints = event.data.state.data.hints as [number, string][];\n        this._logger.info(\"Lobby joined\", hints);\n        events.next(new HintsAddedEvent(hints));\n      }\n\n      /* new hints added */\n      else if (event.id === 13){\n        const hints = (event.data ?? []) as [number, string][];\n        this._logger.info(\"Hints added\", hints);\n        events.next(new HintsAddedEvent(hints));\n      }\n    });\n    return events;\n  }\n}\n\n@injectable()\nexport class HintsAddedEventListener extends EventListener<[number, string][], HintsAddedEvent> {\n  @inject(HintsAddedEventProcessor) protected readonly _processor!: HintsAddedEventProcessor;\n}\n\nexport const hintsAddedEventRegistration: EventRegistration<[number, string][], HintsAddedEvent> = {\n  listenerType: HintsAddedEventListener,\n  processorType: HintsAddedEventProcessor\n};","import { SkribblEmitRelaySetup } from \"@/content/setups/skribbl-emit-relay/skribbl-emit-relay.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { filter, map, merge, Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\n/**\n * Event that is emitted whenever an image is cleared or an action is undone\n * The data is the index of first draw command that has been removed\n */\nexport class ImageResetEvent extends ApplicationEvent<number> {\n  constructor(public readonly data: number) { super(); }\n}\n\n@injectable()\nexport class ImageResetEventProcessor extends EventProcessor<number, ImageResetEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n  @inject(SkribblEmitRelaySetup) _skribblEmitRelaySetup!: SkribblEmitRelaySetup;\n\n  public readonly eventType = ImageResetEvent;\n\n  protected async streamEvents(): Promise<Observable<ImageResetEvent>> {\n    const events = new Subject<ImageResetEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n    const skribblEmit = await this._skribblEmitRelaySetup.complete();\n\n    /* merge own and lobby commands */\n    merge(\n      skribblEmit.pipe(\n        filter(data => data.event === \"data\"),\n        map(data => data.data)),\n      skribblMessages.serverMessages$\n    ).subscribe((event) => {\n\n      /* clear event*/\n      if(event.id === 20){\n        this._logger.info(\"Image cleared\");\n        events.next(new ImageResetEvent(0));\n      }\n\n      /* undo event - did somehow not work, what is the event data? */\n      if(event.id === 21){\n        this._logger.info(\"Undo action\", event.data);\n        events.next(new ImageResetEvent(event.data));\n      }\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class ImageResetEventListener extends EventListener<number, ImageResetEvent> {\n  @inject(ImageResetEventProcessor) protected readonly _processor!: ImageResetEventProcessor;\n}\n\nexport const imageResetEventRegistration: EventRegistration<number, ImageResetEvent> = {\n  listenerType: ImageResetEventListener,\n  processorType: ImageResetEventProcessor\n};","import type { lobbyInteractedEvent } from \"@/content/events/lobby-interacted.event\";\n\n\nexport const parseSkribblLobbyInteractedEvent = (data: any): lobbyInteractedEvent | undefined => { // eslint-disable-line @typescript-eslint/no-explicit-any\n  switch (data.id as number) {\n    case 8:\n      if(data.data.vote === 1) return {\n        likeInteraction: {\n          sourcePlayerId: data.data.id as number\n        }\n      };\n      else return {\n        dislikeInteraction: {\n          sourcePlayerId: data.data.id as number\n        }\n      };\n    case 5:\n      return {\n        votekickInteraction: {\n          targetPlayerId: data.data[1] as number,\n          sourcePlayerId: data.data[0] as number,\n          totalVotes: data.data[2] as number,\n          requiredVotes: data.data[3] as number\n        }\n      };\n  }\n};","import { SkribblMessageRelaySetup } from \"@/content/setups/skribbl-message-relay/skribbl-message-relay.setup\";\nimport { parseSkribblLobbyInteractedEvent } from \"@/util/skribbl/lobbyInteraction\";\nimport { inject, injectable } from \"inversify\";\nimport { filter, map, Observable, tap } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\nexport interface lobbyInteractedEvent {\n  votekickInteraction?: {\n    targetPlayerId: number,\n    sourcePlayerId: number,\n    totalVotes: number,\n    requiredVotes: number\n  },\n  likeInteraction?: {\n    sourcePlayerId: number\n  },\n  dislikeInteraction?: {\n    sourcePlayerId: number\n  },\n}\n\n/**\n * Event that is emitted whenever an interaction in a lobby happened\n * interactions include like, dislike, votekick\n */\nexport class LobbyInteractedEvent extends ApplicationEvent<lobbyInteractedEvent> {\n  constructor(public readonly data: lobbyInteractedEvent) { super(); }\n}\n\n@injectable()\nexport class LobbyInteractedEventProcessor extends EventProcessor<lobbyInteractedEvent, LobbyInteractedEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = LobbyInteractedEvent;\n\n  protected async streamEvents(): Promise<Observable<LobbyInteractedEvent>> {\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    return skribblMessages.serverMessages$.pipe(\n      map(message => parseSkribblLobbyInteractedEvent(message)),\n      filter(event => event !== undefined),\n      map(event => new LobbyInteractedEvent(event)),\n      tap(data => this._logger.debug(\"Lobby interacted\", data)),\n    );\n  }\n}\n\n@injectable()\nexport class LobbyInteractedEventListener extends EventListener<lobbyInteractedEvent, LobbyInteractedEvent> {\n  @inject(LobbyInteractedEventProcessor) protected readonly _processor!: LobbyInteractedEventProcessor;\n}\n\nexport const lobbyInteractedEventRegistration: EventRegistration<lobbyInteractedEvent, LobbyInteractedEvent> = {\n  listenerType: LobbyInteractedEventListener,\n  processorType: LobbyInteractedEventProcessor\n};","import type { skribblPlayer } from \"@/util/skribbl/lobby\";\nimport { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\nexport interface lobbyPlayerChanged {\n  joined?: skribblPlayer,\n  left?: {\n    id: number,\n    reason: \"kicked\" | \"left\";\n  }\n}\n\n/**\n * Event that is emitted when a player joins or leaves the lobby\n */\nexport class LobbyPlayerChangedEvent extends ApplicationEvent<lobbyPlayerChanged> {\n  constructor(public readonly data: lobbyPlayerChanged) { super(); }\n}\n\n@injectable()\nexport class LobbyPlayerChangedEventProcessor extends EventProcessor<lobbyPlayerChanged, LobbyPlayerChangedEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = LobbyPlayerChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<LobbyPlayerChangedEvent>> {\n    const events = new Subject<LobbyPlayerChangedEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    skribblMessages.serverMessages$.subscribe((event) => {\n\n      /* player joined lobby */\n      if(event.id === 1){\n        const data: lobbyPlayerChanged = {\n          joined: event.data as skribblPlayer\n        };\n\n        this._logger.info(\"Player joined\", data);\n        events.next(new LobbyPlayerChangedEvent(data));\n      }\n\n      /* player left lobby */\n      else if (event.id === 2){\n        const data: lobbyPlayerChanged = {\n          left: {\n            id: event.data.id as number,\n            reason: event.data.id === 1 ? \"left\" : \"kicked\"\n          }\n        };\n\n        this._logger.info(\"Player left\", data);\n        events.next(new LobbyPlayerChangedEvent(data));\n      }\n    });\n    return events;\n  }\n}\n\n@injectable()\nexport class LobbyPlayerChangedEventListener extends EventListener<lobbyPlayerChanged, LobbyPlayerChangedEvent> {\n  @inject(LobbyPlayerChangedEventProcessor) protected readonly _processor!: LobbyPlayerChangedEventProcessor;\n}\n\nexport const lobbyPlayerChangedEventRegistration: EventRegistration<lobbyPlayerChanged, LobbyPlayerChangedEvent> = {\n  listenerType: LobbyPlayerChangedEventListener,\n  processorType: LobbyPlayerChangedEventProcessor\n};","export function arrayChunk<T>(array: T[], size: number): T[][] {\n  return array.reduce((acc, _, i) => i % size ? acc : [...acc, array.slice(i, i + size)], [] as T[][]);\n}","import { arrayChunk } from \"@/util/arrayChunk\";\n\nexport interface lobbyStateUpdate {\n  drawingRevealed?: {\n    reason: \"outOfTime\" | \"allGuessed\",\n    word: string,\n    scores: {score: number, rewarded: number, playerId: number}[],\n    time: number\n  },\n  drawingStarted?: {\n    word?: string,\n    characters: [number],\n    maxTime: number,\n    drawerId: number,\n  },\n  drawerChoosingWord?: {\n    maxTime: number,\n    drawerId: number,\n  },\n  roundStarted?: {\n    round: number,\n    startsIn: number\n  },\n  gameEnded?: {\n    ranking: {playerId: number, rank: number}[],\n    displayTime: number\n  }\n}\n\nexport const parseLobbyStateUpdate = (data: any): lobbyStateUpdate | undefined => { // eslint-disable-line  @typescript-eslint/no-explicit-any\n  switch (data.id as number) {\n\n    /* new round has started */\n    case 2: return {\n      roundStarted: {\n        round: data.data as number,\n        startsIn: data.time as number\n      }\n    };\n\n    /* next person is choosing words */\n    case 3: return {\n      drawerChoosingWord: {\n        maxTime: data.time as number,\n        drawerId: data.data.id as number\n      }\n    };\n\n    /* new drawing has started */\n    case 4: {\n      return {\n        drawingStarted: {\n          word: typeof data.data.word === \"string\" ? data.data.word as string : undefined,\n          characters: typeof data.data.word === \"string\" ? data.data.word.length : data.data.word as number[],\n          maxTime: data.time as number,\n          drawerId: data.data.id as number\n        },\n        /*initialDrawerId: data.data.id as number | undefined*/\n      };\n    }\n\n    /* drawing has been revealed */\n    case 5: {\n      return {\n        drawingRevealed: {\n          reason: data.data.reason === 1 ? \"outOfTime\" : \"allGuessed\",\n          word: data.data.word as string,\n          time: data.time as number,\n          scores: arrayChunk(data.data.scores as number[], 3).map(([playerId, score, rewarded]) => ({playerId, score, rewarded}))\n        }\n      };\n    }\n\n    case 6: {\n      return {\n        gameEnded: {\n          ranking: data.data.map(([playerId, rank]: [number, number]) => ({playerId, rank})),\n          displayTime: data.time as number\n        }\n      };\n    }\n\n    default: {\n      return undefined;\n    }\n  } \n};","import { Setup } from \"../../core/setup/setup\";\nimport { requireElements } from \"../../../util/document/requiredQuerySelector\";\n\nfunction getElements(){\n  return {\n    languageSettings: new Map(requireElements(\"#home .container-name-lang > select option\")\n      .map(item => ([Number((item as HTMLOptionElement).value), (item.textContent ?? \"\")]))),\n  };\n}\nexport type typoElements = ReturnType<typeof getElements>;\n\nexport class GameSettingsSetup extends Setup<typoElements> {\n  protected async runSetup(): Promise<ReturnType<typeof getElements>> {\n    return getElements();\n  }\n}","import { type lobbyStateUpdate, parseLobbyStateUpdate } from \"@/util/skribbl/lobbyState\";\nimport { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { GameSettingsSetup } from \"../setups/game-settings/game-settings.setup\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\n/**\n * Event emitted when the lobby state changes\n * The state is eg drawing, choosing words, words revealed, etc.\n */\nexport class LobbyStateChangedEvent extends ApplicationEvent<lobbyStateUpdate> {\n  constructor(public readonly data: lobbyStateUpdate) { super(); }\n}\n\n@injectable()\nexport class LobbyStateChangedEventProcessor extends EventProcessor<lobbyStateUpdate, LobbyStateChangedEvent>\n{\n  @inject(GameSettingsSetup) _gameSettingsSetup!: GameSettingsSetup;\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = LobbyStateChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<LobbyStateChangedEvent>> {\n    const events = new Subject<LobbyStateChangedEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    skribblMessages.serverMessages$.subscribe((event) => {\n\n      /* regular lobby update */\n      if(event.id === 11){\n        const update = parseLobbyStateUpdate(event.data);\n        if(update === undefined) {\n          this._logger.warn(\"Unknown event\", event.data);\n          return;\n        }\n\n        this._logger.info(\"Lobby updated\", update);\n        events.next(new LobbyStateChangedEvent(update));\n      }\n\n      /* lobby joined, new state received */\n      if(event.id === 10){\n        const update = parseLobbyStateUpdate(event.data.state);\n        if(update === undefined) {\n          this._logger.warn(\"Unknown event\", event.data.state);\n          return;\n        }\n\n        this._logger.info(\"Lobby joined\", update);\n        events.next(new LobbyStateChangedEvent(update));\n      }\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class LobbyStateChangedEventListener extends EventListener<lobbyStateUpdate, LobbyStateChangedEvent> {\n  @inject(LobbyStateChangedEventProcessor) protected readonly _processor!: LobbyStateChangedEventProcessor;\n}\n\nexport const lobbyStateChangedEventRegistration: EventRegistration<lobbyStateUpdate, LobbyStateChangedEvent> = {\n  listenerType: LobbyStateChangedEventListener,\n  processorType: LobbyStateChangedEventProcessor\n};","import { SkribblMessageRelaySetup } from \"@/content/setups/skribbl-message-relay/skribbl-message-relay.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { filter, map, Observable, tap } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\nexport interface messageReceivedEvent {\n  message: string;\n  senderId: number;\n}\n\n/**\n * Event that is emitted whenever an incoming chat message from the skribbl server is received\n * Note that these also include own messages!\n */\nexport class MessageReceivedEvent extends ApplicationEvent<messageReceivedEvent> {\n  constructor(public readonly data: messageReceivedEvent) { super(); }\n}\n\n@injectable()\nexport class MessageReceivedEventProcessor extends EventProcessor<messageReceivedEvent, MessageReceivedEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = MessageReceivedEvent;\n\n  protected async streamEvents(): Promise<Observable<MessageReceivedEvent>> {\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    return skribblMessages.serverMessages$.pipe(\n      filter((event) => event.id == 30),\n      map((event) => new MessageReceivedEvent({message: event.data.msg, senderId: event.data.id})),\n      tap((data) => this._logger.debug(\"Message received\", data)),\n    );\n  }\n}\n\n@injectable()\nexport class MessageReceivedEventListener extends EventListener<messageReceivedEvent, MessageReceivedEvent> {\n  @inject(MessageReceivedEventProcessor) protected readonly _processor!: MessageReceivedEventProcessor;\n}\n\nexport const messageReceivedEventRegistration: EventRegistration<messageReceivedEvent, MessageReceivedEvent> = {\n  listenerType: MessageReceivedEventListener,\n  processorType: MessageReceivedEventProcessor\n};","import { SkribblEmitRelaySetup } from \"@/content/setups/skribbl-emit-relay/skribbl-emit-relay.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { filter, map, Observable } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted whenever the user sent a message to the skribbl socket server\n */\nexport class MessageSentEvent extends ApplicationEvent<string> {\n  constructor(public readonly data: string) { super(); }\n}\n\n@injectable()\nexport class MessageSentEventProcessor extends EventProcessor<string, MessageSentEvent>\n{\n  @inject(SkribblEmitRelaySetup) _skribblEmitRelaySetup!: SkribblEmitRelaySetup;\n\n  public readonly eventType = MessageSentEvent;\n\n  protected async streamEvents(): Promise<Observable<MessageSentEvent>> {\n    const skribblEmit = await this._skribblEmitRelaySetup.complete();\n    return skribblEmit.pipe(\n      filter((event) => event.event === \"data\" && event.data.id == 30),\n      map((emit) => new MessageSentEvent(emit.data.data))\n    );\n  }\n}\n\n@injectable()\nexport class MessageSentEventListener extends EventListener<string, MessageSentEvent> {\n  @inject(MessageSentEventProcessor) protected readonly _processor!: MessageSentEventProcessor;\n}\n\nexport const messageSentEventRegistration: EventRegistration<string, MessageSentEvent> = {\n  listenerType: MessageSentEventListener,\n  processorType: MessageSentEventProcessor\n};","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { debounceTime, distinctUntilChanged, Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted when the scoreboard visibility changes\n */\nexport class PlayerPopupVisibilityChangedEvent extends ApplicationEvent<boolean> {\n  constructor(public readonly data: boolean) { super(); }\n}\n\n@injectable()\nexport class PlayerPopupVisibilityChangedEventProcessor extends EventProcessor<boolean, PlayerPopupVisibilityChangedEvent>\n{\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly eventType = PlayerPopupVisibilityChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<PlayerPopupVisibilityChangedEvent>> {\n    const events = new Subject<PlayerPopupVisibilityChangedEvent>();\n    const elements = await this._elementsSetup.complete();\n\n    const observer = new MutationObserver(() => {\n      if(elements.skribblModal.style.display !== \"none\" && elements.playerPopup.style.display === \"flex\") {\n        events.next(new PlayerPopupVisibilityChangedEvent(true));\n      }\n      else events.next(new PlayerPopupVisibilityChangedEvent(false));\n    });\n\n    observer.observe(elements.playerPopup, { attributes: true });\n\n    return events.pipe(\n      distinctUntilChanged(),\n      debounceTime(50)\n    );\n  }\n}\n\n@injectable()\nexport class PlayerPopupVisibilityChangedEventListener extends EventListener<boolean, PlayerPopupVisibilityChangedEvent> {\n  @inject(PlayerPopupVisibilityChangedEventProcessor) protected readonly _processor!: PlayerPopupVisibilityChangedEventProcessor;\n}\n\nexport const playerPopupVisibilityChangedEventRegistration: EventRegistration<boolean, PlayerPopupVisibilityChangedEvent> = {\n  listenerType: PlayerPopupVisibilityChangedEventListener,\n  processorType: PlayerPopupVisibilityChangedEventProcessor\n};","import { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\n/**\n * Event that is emitted when a new round starts.\n * Data is the new round number.\n */\nexport class RoundStartedEvent extends ApplicationEvent<number> {\n  constructor(public readonly data: number) { super(); }\n}\n\n@injectable()\nexport class RoundStartedEventProcessor extends EventProcessor<number, RoundStartedEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = RoundStartedEvent;\n\n  protected async streamEvents(): Promise<Observable<RoundStartedEvent>> {\n    const events = new Subject<RoundStartedEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    skribblMessages.serverMessages$.subscribe((event) => {\n      if(event.id === 11 && event.data.id == 2){\n        const round =( event.data.data as number) + 1;\n        this._logger.info(\"Round started\", round);\n        events.next(new RoundStartedEvent(round));\n      }\n    });\n    return events;\n  }\n}\n\n@injectable()\nexport class RoundStartedEventListener extends EventListener<number, RoundStartedEvent> {\n  @inject(RoundStartedEventProcessor) protected readonly _processor!: RoundStartedEventProcessor;\n}\n\nexport const roundStartedEventRegistration: EventRegistration<number, RoundStartedEvent> = {\n  listenerType: RoundStartedEventListener,\n  processorType: RoundStartedEventProcessor\n};","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { debounceTime, distinctUntilChanged, Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted when the scoreboard visibility changes\n */\nexport class ScoreboardVisibilityChangedEvent extends ApplicationEvent<boolean> {\n  constructor(public readonly data: boolean) { super(); }\n}\n\n@injectable()\nexport class ScoreboardVisibilityChangedEventProcessor extends EventProcessor<boolean, ScoreboardVisibilityChangedEvent>\n{\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly eventType = ScoreboardVisibilityChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<ScoreboardVisibilityChangedEvent>> {\n    const events = new Subject<ScoreboardVisibilityChangedEvent>();\n    const elements = await this._elementsSetup.complete();\n\n    const observer = new MutationObserver(() => {\n      if(elements.scoreboardResults.classList.contains(\"show\")) events.next(new ScoreboardVisibilityChangedEvent(true));\n      else events.next(new ScoreboardVisibilityChangedEvent(false));\n    });\n\n    observer.observe(elements.scoreboardResults, { attributes: true });\n\n    return events.pipe(\n      distinctUntilChanged(),\n      debounceTime(50)\n    );\n  }\n}\n\n@injectable()\nexport class ScoreboardVisibilityChangedEventListener extends EventListener<boolean, ScoreboardVisibilityChangedEvent> {\n  @inject(ScoreboardVisibilityChangedEventProcessor) protected readonly _processor!: ScoreboardVisibilityChangedEventProcessor;\n}\n\nexport const scoreboardVisibilityChangedEventRegistration: EventRegistration<boolean, ScoreboardVisibilityChangedEvent> = {\n  listenerType: ScoreboardVisibilityChangedEventListener,\n  processorType: ScoreboardVisibilityChangedEventProcessor\n};","import { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted whenever an image is cleared or an action is undone\n * The data is the index of first draw command that has been removed\n */\nexport class SizeChangedEvent extends ApplicationEvent<number> {\n  constructor(public readonly data: number) { super(); }\n}\n\n@injectable()\nexport class SizeChangedEventProcessor extends EventProcessor<number, SizeChangedEvent>\n{\n\n  public readonly eventType = SizeChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<SizeChangedEvent>> {\n    const events = new Subject<SizeChangedEvent>();\n\n    /* listen for custom patched event */\n    document.addEventListener(\"skribblSizeChanged\", (event: Event) => {\n      const size = Number((event as CustomEvent<number>).detail);\n      events.next(new SizeChangedEvent(size));\n      this._logger.info(\"Size changed\", size);\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class SizeChangedEventListener extends EventListener<number, SizeChangedEvent> {\n  @inject(SizeChangedEventProcessor) protected readonly _processor!: SizeChangedEventProcessor;\n}\n\nexport const sizeChangedEventRegistration: EventRegistration<number, SizeChangedEvent> = {\n  listenerType: SizeChangedEventListener,\n  processorType: SizeChangedEventProcessor\n};","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { debounceTime, distinctUntilChanged, Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event that is emitted when the scoreboard visibility changes\n */\nexport class TextOverlayVisibilityChangedEvent extends ApplicationEvent<boolean> {\n  constructor(public readonly data: boolean) { super(); }\n}\n\n@injectable()\nexport class TextOverlayVisibilityChangedEventProcessor extends EventProcessor<boolean, TextOverlayVisibilityChangedEvent>\n{\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly eventType = TextOverlayVisibilityChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<TextOverlayVisibilityChangedEvent>> {\n    const events = new Subject<TextOverlayVisibilityChangedEvent>();\n    const elements = await this._elementsSetup.complete();\n\n    const observer = new MutationObserver(() => {\n      if(elements.canvasOverlay.style.top !== \"100%\" && elements.textOverlay.classList.contains(\"show\")) {\n        events.next(new TextOverlayVisibilityChangedEvent(true));\n      }\n      else events.next(new TextOverlayVisibilityChangedEvent(false));\n    });\n\n    observer.observe(elements.textOverlay, { attributes: true });\n\n    return events.pipe(\n      distinctUntilChanged(),\n      debounceTime(50)\n    );\n  }\n}\n\n@injectable()\nexport class TextOverlayVisibilityChangedEventListener extends EventListener<boolean, TextOverlayVisibilityChangedEvent> {\n  @inject(TextOverlayVisibilityChangedEventProcessor) protected readonly _processor!: TextOverlayVisibilityChangedEventProcessor;\n}\n\nexport const textOverlayVisibilityChangedEventRegistration: EventRegistration<boolean, TextOverlayVisibilityChangedEvent> = {\n  listenerType: TextOverlayVisibilityChangedEventListener,\n  processorType: TextOverlayVisibilityChangedEventProcessor\n};","import { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\nexport enum skribblTool {\n  brush = 0,\n  fill = 1,\n  deselected = -1,\n  other = 2\n}\n\n/**\n * Event that is emitted whenever an image is cleared or an action is undone\n * The data is the index of first draw command that has been removed\n */\nexport class ToolChangedEvent extends ApplicationEvent<skribblTool> {\n  constructor(public readonly data: skribblTool) { super(); }\n}\n\n@injectable()\nexport class ToolChangedEventProcessor extends EventProcessor<skribblTool, ToolChangedEvent>\n{\n\n  public readonly eventType = ToolChangedEvent;\n\n  protected async streamEvents(): Promise<Observable<ToolChangedEvent>> {\n    const events = new Subject<ToolChangedEvent>();\n\n    /* listen for custom patched event */\n    document.addEventListener(\"skribblToolChanged\", (event: Event) => {\n      const tool = (event as CustomEvent<number>).detail;\n      const toolEnum = (tool > 2) ? skribblTool.other : tool;\n      events.next(new ToolChangedEvent(toolEnum));\n      this._logger.info(\"Tool changed\", toolEnum);\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class ToolChangedEventListener extends EventListener<skribblTool, ToolChangedEvent> {\n  @inject(ToolChangedEventProcessor) protected readonly _processor!: ToolChangedEventProcessor;\n}\n\nexport const toolChangedEventRegistration: EventRegistration<skribblTool, ToolChangedEvent> = {\n  listenerType: ToolChangedEventListener,\n  processorType: ToolChangedEventProcessor\n};","import type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\nexport interface wordGuessed {\n  playerId: number,\n  word?: string\n}\n\n/**\n * Event that is emitted when a player guesses a word.\n * If the client is the player, the result is also included.\n */\nexport class WordGuessedEvent extends ApplicationEvent<wordGuessed> {\n  constructor(public readonly data: wordGuessed) { super(); }\n}\n\n@injectable()\nexport class WordGuessedEventProcessor extends EventProcessor<wordGuessed, WordGuessedEvent>\n{\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = WordGuessedEvent;\n\n  protected async streamEvents(): Promise<Observable<WordGuessedEvent>> {\n    const events = new Subject<WordGuessedEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n\n    skribblMessages.serverMessages$.subscribe((event) => {\n      if(event.id === 15){\n        const guessed: wordGuessed = {\n          playerId: event.data.id,\n          word: event.data.word ?? undefined\n        };\n\n        this._logger.info(\"Word guessed\", guessed);\n        events.next(new WordGuessedEvent(guessed));\n      }\n    });\n    return events;\n  }\n}\n\n@injectable()\nexport class WordGuessedEventListener extends EventListener<wordGuessed, WordGuessedEvent> {\n  @inject(WordGuessedEventProcessor) protected readonly _processor!: WordGuessedEventProcessor;\n}\n\nexport const wordGuessedEventRegistration: EventRegistration<wordGuessed, WordGuessedEvent> = {\n  listenerType: WordGuessedEventListener,\n  processorType: WordGuessedEventProcessor\n};","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport CanvasRateIconsComponent from \"./canvas-rate-icons.svelte\";\n\nexport class CanvasRateIconsFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly name = \"Improved Like Icons\";\n  public readonly description = \"Sets new like/dislike icons which better fit the skribbl style.\";\n  public readonly featureId = 46;\n\n  private _component?: CanvasRateIconsComponent;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n    elements.gameRate.classList.add(\"typo-icons\");\n    this._component = new CanvasRateIconsComponent({\n      target: document.body,\n    });\n  }\n\n  protected override async onDestroy() {\n    const elements = await this._elementsSetup.complete();\n    elements.gameRate.classList.remove(\"typo-icons\");\n    this._component?.$destroy();\n    this._component = undefined;\n  }\n}","import { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\n\n/**\n * Event emitted when the user leaves a lobby\n * Practice leave is also emitted as synthetic event\n */\nexport class LobbyLeftEvent extends ApplicationEvent<null> {\n  constructor(public readonly data: null) { super(); }\n}\n\n@injectable()\nexport class LobbyLeftEventProcessor extends EventProcessor<null, LobbyLeftEvent>\n{\n  public readonly eventType = LobbyLeftEvent;\n\n  protected streamEvents(): Observable<LobbyLeftEvent> {\n    const events = new Subject<LobbyLeftEvent>();\n\n    /* listen for skribbl lobby left events from patched game */\n    document.addEventListener(\"leftLobby\", async () => {\n\n      this._logger.info(\"Lobby left\");\n      events.next(new LobbyLeftEvent(null));\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class LobbyLeftEventListener extends EventListener<null, LobbyLeftEvent> {\n  @inject(LobbyLeftEventProcessor) protected readonly _processor!: LobbyLeftEventProcessor;\n}\n\nexport const lobbyLeftEventRegistration: EventRegistration<null, LobbyLeftEvent> = {\n  listenerType: LobbyLeftEventListener,\n  processorType: LobbyLeftEventProcessor\n};","export interface skribblLobby {\n  settings: {\n    language: string, // [0]\n    players: number, // [1]\n    drawTime: number, // [2]\n    rounds: number, // [3]\n  },\n  id: string | null, // null if practice\n  private: boolean,\n  meId: number,\n  ownerId: number | null,\n  drawerId: number | null,\n  players: skribblPlayer[],\n  round: number,\n  /*state: {\n    id: number,\n    time: number,\n    data: unknown\n  }*/\n}\n\nexport interface skribblPlayer {\n  id: number,\n  name: string,\n  avatar: [number, number, number, number],\n  score: number,\n  guessed: boolean,\n  flags: number\n}\n\nexport const parseSkribblLobbyDataEvent = (data: any, languages: Map<number, string>): skribblLobby => { // eslint-disable-line @typescript-eslint/no-explicit-any\n  return {\n    id: data.id ?? null,\n    private: data.type === 1,\n    meId: data.me,\n    ownerId: data.owner == -1 ? null : data.owner,\n    drawerId: null,\n    round: data.round + 1,\n    settings: {\n      language: languages.get(data.settings[0]) ?? \"Unknown\",\n      players: data.settings[1],\n      drawTime: data.settings[2],\n      rounds: data.settings[3]\n    },\n    players: data.users as never\n  };\n};","import { parseLobbyStateUpdate } from \"@/util/skribbl/lobbyState\";\nimport { inject, injectable } from \"inversify\";\nimport { Observable, Subject } from \"rxjs\";\nimport { parseSkribblLobbyDataEvent, type skribblLobby } from \"../../util/skribbl/lobby\";\nimport { ApplicationEvent } from \"../core/event/applicationEvent\";\nimport { EventListener } from \"../core/event/eventListener\";\nimport { EventProcessor } from \"../core/event/eventProcessor\";\nimport type { EventRegistration } from \"@/content/core/extension-container/extension-container\";\nimport { GameSettingsSetup } from \"../setups/game-settings/game-settings.setup\";\nimport { SkribblMessageRelaySetup } from \"../setups/skribbl-message-relay/skribbl-message-relay.setup\";\n\n/**\n * Event emitted when a lobby is joined\n * Practice lobbies are emitted as a synthetic event\n */\nexport class LobbyJoinedEvent extends ApplicationEvent<skribblLobby> {\n  constructor(public readonly data: skribblLobby) { super(); }\n}\n\n@injectable()\nexport class LobbyJoinedEventProcessor extends EventProcessor<skribblLobby, LobbyJoinedEvent>\n{\n  @inject(GameSettingsSetup) _gameSettingsSetup!: GameSettingsSetup;\n  @inject(SkribblMessageRelaySetup) _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  public readonly eventType = LobbyJoinedEvent;\n\n  protected async streamEvents(): Promise<Observable<LobbyJoinedEvent>> {\n    const events = new Subject<LobbyJoinedEvent>();\n    const skribblMessages = await this._skribblMessageRelaySetup.complete();\n    const gameSettings = await this._gameSettingsSetup.complete();\n\n    skribblMessages.serverMessages$.subscribe((event) => {\n      if(event.id === 10){\n        const lobby = parseSkribblLobbyDataEvent(event.data, gameSettings.languageSettings);\n        const initialUpdate = parseLobbyStateUpdate(event.data.state);\n\n        /* only drawer id relevant for lobby from initial state */\n        lobby.drawerId = initialUpdate?.drawingStarted?.drawerId ?? null;\n\n        this._logger.info(\"Lobby joined\", lobby);\n        events.next(new LobbyJoinedEvent(lobby));\n      }\n    });\n\n    /* listen for practice lobby joined events from patched game */\n    document.addEventListener(\"practiceJoined\", async (data) => {\n      const gameSettings = await this._gameSettingsSetup.complete();\n      const lobby = parseSkribblLobbyDataEvent((data as CustomEvent).detail, gameSettings.languageSettings);\n\n      this._logger.info(\"Practice lobby joined\", lobby);\n      events.next(new LobbyJoinedEvent(lobby));\n    });\n\n    return events;\n  }\n}\n\n@injectable()\nexport class LobbyJoinedEventListener extends EventListener<skribblLobby, LobbyJoinedEvent> {\n  @inject(LobbyJoinedEventProcessor) protected readonly _processor!: LobbyJoinedEventProcessor;\n}\n\nexport const lobbyJoinedEventRegistration: EventRegistration<skribblLobby, LobbyJoinedEvent> = {\n  listenerType: LobbyJoinedEventListener,\n  processorType: LobbyJoinedEventProcessor\n};","import {\n  LobbyPlayerChangedEvent,\n  LobbyPlayerChangedEventListener,\n} from \"@/content/events/lobby-player-changed.event\";\nimport { LobbyStateChangedEvent, LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport { RoundStartedEvent, RoundStartedEventListener } from \"@/content/events/round-started.event\";\nimport { WordGuessedEvent, WordGuessedEventListener } from \"@/content/events/word-guessed.event\";\nimport { inject, injectable } from \"inversify\";\nimport { BehaviorSubject, debounceTime, distinctUntilChanged, map, merge, tap, withLatestFrom } from \"rxjs\";\nimport type { skribblLobby } from \"@/util/skribbl/lobby\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\nimport { LobbyJoinedEvent, LobbyJoinedEventListener } from \"../../events/lobby-joined.event\";\nimport { LobbyLeftEvent, LobbyLeftEventListener } from \"../../events/lobby-left.event\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\n@injectable()\nexport class LobbyService {\n\n  private readonly _logger;\n\n  private _currentLobby$ = new BehaviorSubject<skribblLobby | null>(null);\n  private _currentLobbyDebounced$ = new BehaviorSubject<skribblLobby | null>(null);\n  private _discoveredLobbies$ = new BehaviorSubject<Map<string, skribblLobby & {seenAt: number}>>(new Map());\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(LobbyJoinedEventListener) private readonly lobbyJoined: LobbyJoinedEventListener,\n    @inject(LobbyLeftEventListener) private readonly lobbyLeft: LobbyLeftEventListener,\n    @inject(LobbyPlayerChangedEventListener) private readonly lobbyPlayerChanged: LobbyPlayerChangedEventListener,\n    @inject(LobbyStateChangedEventListener) private readonly lobbyStateChanged: LobbyStateChangedEventListener,\n    @inject(RoundStartedEventListener) private readonly roundStarted: RoundStartedEventListener,\n    @inject(WordGuessedEventListener) private readonly wordGuessed: WordGuessedEventListener,\n    @inject(ElementsSetup) private readonly elementsSetup: ElementsSetup\n  ) {\n    this._logger = loggerFactory(this);\n\n    /* combine updates and calculate updated lobby state */\n    merge(\n      lobbyLeft.events$,\n      lobbyJoined.events$,\n      lobbyPlayerChanged.events$,\n      lobbyStateChanged.events$,\n      roundStarted.events$,\n      wordGuessed.events$\n    ).pipe(\n      withLatestFrom(this._currentLobby$), /* compare updates with current lobby */\n      map(data => ({update: data[0], currentLobby: data[1]})),\n      map(({update, currentLobby}) => {\n        this._logger.debug(\"Lobby update\", update, currentLobby);\n\n        /* prevent reference issues */\n        currentLobby = currentLobby === null ? null : structuredClone(currentLobby);\n\n        /* lobby left, reset lobby */\n        if(update instanceof LobbyLeftEvent) {\n          currentLobby = null;\n        }\n\n        /* lobby joined, set new lobby */\n        else if(update instanceof LobbyJoinedEvent) {\n          currentLobby = update.data;\n        }\n\n        /* round ended, update round */\n        else if(currentLobby !== null && update instanceof RoundStartedEvent) {\n          currentLobby.round = update.data;\n        }\n\n        /* word guessed, update players */\n        else if(currentLobby !== null && update instanceof WordGuessedEvent) {\n          const guessed = update.data;\n          currentLobby.players.forEach(player => {\n            if(player.id === guessed.playerId) {\n              player.guessed = true;\n            }\n          });\n        }\n\n        /* lobby state updated */\n        else if (currentLobby !== null && update instanceof LobbyStateChangedEvent) {\n          const data = update.data;\n          if(data.drawingRevealed) {\n            const scores = new Map<number, number>(data.drawingRevealed.scores.map(score => [score.playerId, score.score]));\n            currentLobby.players.forEach((player) => {\n              player.guessed = false;\n              player.score = scores.get(player.id) ?? player.score;\n            });\n            currentLobby.drawerId = null;\n          }\n\n          if(data.drawingStarted !== undefined) {\n            currentLobby.drawerId = data.drawingStarted.drawerId;\n          }\n        }\n\n        /* player changed, update list */\n        else if(currentLobby !== null && update instanceof LobbyPlayerChangedEvent) {\n          const data = update.data;\n          if(data.left) {\n            const left = data.left;\n            currentLobby.players = currentLobby.players.filter(user => user.id !== left.id);\n          }\n          else if(data.joined) {\n            currentLobby.players.push(data.joined);\n          }\n        }\n\n        /* emit updated lobby */\n        this._logger.debug(\"Lobby update processed\", currentLobby);\n        return currentLobby;\n      }),\n\n      /* emit to processing stream */\n      tap(lobby => this._currentLobby$.next(lobby)),\n\n      /* emit debounced to publishing stream */\n      debounceTime(100), /* debounce to prevent spamming */\n      distinctUntilChanged((curr, prev) => JSON.stringify(curr) === JSON.stringify(prev)) /* if join-leave spam debounced, take only changes */\n    ).subscribe(data => this._currentLobbyDebounced$.next(data));\n\n    this.lobby$.subscribe(data => {\n      this._logger.info(\"Lobby changed\", data);\n      const map = this._discoveredLobbies$.value;\n      if(data !== null && data.id !== null) map.set(data.id, { ...data, seenAt: Date.now() });\n      this._discoveredLobbies$.next(map);\n    });\n  }\n\n  public async joinLobby(id?: string){\n\n    if(this._currentLobby$.value !== null) {\n      this._logger.warn(\"Attempted to join a lobby while already in one\");\n      throw new Error(\"Already in a lobby\");\n    }\n\n    /* show loading */\n    const elements = await this.elementsSetup.complete();\n    elements.load.style.display = \"block\";\n    elements.home.style.display = \"none\";\n\n    document.dispatchEvent(new CustomEvent(\"joinLobby\", {detail: id}));\n  }\n\n  public leaveLobby(){\n    if(this._currentLobby$.value === null) {\n      this._logger.warn(\"Attempted to leave a lobby while not in one\");\n      throw new Error(\"Not in a lobby\");\n    }\n    document.dispatchEvent(new CustomEvent(\"leaveLobby\"));\n  }\n\n  public get lobby$(){\n    return this._currentLobbyDebounced$.asObservable();\n  }\n\n  public get discoveredLobbies$(){\n    return this._discoveredLobbies$.pipe(\n      map(map => Array.from(map.values()))\n    );\n  }\n}","<script>\n  export let content = \"Loading...\";\n</script>\n\n<style lang=\"scss\">\n    @keyframes bounceload {\n        from {\n            transform: scale(0.5)\n        }\n\n        to {\n            transform: translateX(-40%) scale(1.5)\n        }\n    }\n\n    div {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        gap: .5em;\n        padding:.8em;\n\n        .icon {\n            display: inline-block;\n            height: 1.5em;\n            aspect-ratio: 1;\n            background-image: url(/img/size.gif);\n            background-size: 1em;\n            background-repeat: no-repeat;\n            background-position: center;\n            transform: scale(1.5);\n            filter: drop-shadow(3px 3px 0 rgba(0, 0, 0, .3));\n            animation: bounceload .5s infinite;\n            animation-direction: alternate;\n            animation-timing-function: ease-in-out;\n            transform-origin: center;\n            margin-right: .5em;\n            margin-left: .5em;\n        }\n\n        span {\n          color: var(--COLOR_PANEL_TEXT);\n          font-weight: bold;\n        }\n    }\n</style>\n\n<div>\n  <div class=\"icon\"></div>\n  <span>{content}</span>\n</div>","<script lang=\"ts\">\n  import type { tooltipAction } from \"@/content/core/feature/feature\";\n  import type { tooltipParams } from \"@/content/core/tooltips/tooltips.service\";\n  import { Subject } from \"rxjs\";\n\n  export let disabled: boolean = false;\n  export let icon: string;\n  export let name: string;\n  export let hoverMove: boolean = true;\n  export let greyscaleInactive: boolean = false;\n  export let size: string = \"37px\"\n  export let order: undefined | number = undefined;\n  export let tooltipAction: tooltipAction = () => {};\n  export let lockTooltip: tooltipParams[\"lock\"] = undefined;\n  const click = new Subject<void>();\n  export const click$ = click.asObservable();\n</script>\n\n<style lang=\"scss\">\n  .typo-icon-button {\n    user-select: none;\n    display: block;\n    cursor: pointer;\n    filter: drop-shadow(3px 3px 0px rgba(0, 0, 0, .3));\n\n    &.disabled {\n      pointer-events: none;\n      opacity: .5;\n    }\n\n    img {\n      aspect-ratio: 1;\n      transform: translateY(0);\n      transition: transform 65ms ease-in-out;\n    }\n\n    &:hover img.effect {\n      transform: translateY(-3px);\n    }\n\n    &.greyscale img {\n      filter: grayscale(0.7);\n      opacity: .7;\n\n      &:hover {\n        filter: grayscale(0);\n        opacity: 1;\n      }\n    }\n  }\n</style>\n\n<div class=\"typo-icon-button\" style=\"order: {order ?? 'auto'}\" role=\"button\" data-name=\"{name}\" tabindex=\"0\" use:tooltipAction={{title: name, lock: lockTooltip}}\n     class:greyscale={greyscaleInactive} class:disabled={disabled}\n     on:click\n     on:click={() => click.next(void 0)}\n     on:keypress={evt => evt.code === \"Enter\" && click.next(void 0)}\n>\n  <img class=\"typo-icon-button-graphic\" class:effect={hoverMove} src=\"\" style=\"content: var(--{icon}); width: {size}\" alt=\"{name}\"/>\n</div>","<script lang=\"ts\">\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\n  export let content: string | undefined;\n  export let title: string | undefined;\n  export let closeHandler: () => void;\n  export let confirmHandler: ((result: boolean) => void) | undefined = undefined;\n  export let promptHandler: ((result: string) => void) | undefined = undefined;\n  export let showLoading = false;\n  export let allowClose = true;\n  \n  let promptContent = \"\";\n\n  let closing = false;\n  export const close = () => {\n    setTimeout(() => closeHandler(), 150);\n    closing = true;\n  }\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-50vh);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 100;\n    }\n  }\n\n  @keyframes slideOut {\n    from {\n      transform: translateY(0);\n      opacity: 100;\n    }\n    to {\n      transform: translateY(-50vh);\n      opacity: 0;\n    }\n  }\n\n  .typo-toast {\n    padding: 1rem 3rem 1rem 1rem;\n    background-color: var(--COLOR_PANEL_HI);\n    border-radius: 5px;\n    color: var(--COLOR_PANEL_TEXT);\n    filter: drop-shadow(0 5px 10px rgba(0, 0, 0, .3));\n    min-width: clamp(20rem, 20rem, 80%);\n    position: relative;\n    animation: slideIn 0.15s ease-out;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    white-space-collapse: preserve;\n    gap: .5rem;\n\n    &.closing {\n      animation: slideOut 0.15s ease-out forwards;\n    }\n\n    &.loading {\n      cursor: progress;\n    }\n\n    form {\n      display: flex;\n      width: 100%;\n\n      input[type=submit]{\n        display: none;\n      }\n    }\n\n    .typo-toast-confirm {\n      width:100%;\n      display: flex;\n      flex-direction: row;\n      gap: 1rem;\n    }\n\n    .close-toast {\n      position: absolute;\n      right: .5rem;\n      top: 0;\n      font-weight: 900;\n      opacity: .7;\n      cursor:pointer;\n      font-size: 2rem;\n    }\n  }\n\n</style>\n\n<div class=\"typo-toast\" class:closing={closing} class:loading={showLoading}>\n\n  {#if title !== undefined}\n    <h3>{title}</h3>\n  {/if}\n\n  {#if showLoading}\n    <Bounceload content=\"{content}\" />\n  {:else }\n\n    <!--close button-->\n    {#if allowClose}\n      <span class=\"close-toast\" on:click={() => close()}>\n          ×\n      </span>\n    {/if}\n\n    {#if content !== undefined && promptHandler === undefined}\n      <span>{content}</span>\n    {/if}\n\n    {#if promptHandler !== undefined}\n      <form on:submit={(e) =>{\n        e.preventDefault();\n        promptHandler(promptContent);\n      }}>\n        <input type=\"submit\" hidden />\n        <input bind:value={promptContent} type=\"text\" placeholder=\"{content}\">\n      </form>\n    {/if}\n\n    {#if confirmHandler !== undefined}\n      <div class=\"typo-toast-confirm\">\n        <IconButton icon=\"file-img-enabled-gif\" name=\"Confirm\" hoverMove=\"{false}\" size=\"1.5rem\" on:click={() => confirmHandler(true)} />\n        <IconButton icon=\"file-img-disabled-gif\" name=\"Abort\" hoverMove=\"{false}\" size=\"1.5rem\" on:click={() => confirmHandler(false)} />\n      </div>\n    {/if}\n  {/if}\n</div>","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject, injectable } from \"inversify\";\nimport { firstValueFrom, type Observable, Subject } from \"rxjs\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\nimport Toast from \"./toast.svelte\";\n\nexport interface loadingToastHandle {\n  close: () => void;\n  resolve: (message?: string, timeout?: number) => void;\n  reject: (message?: string, title?: string, timeout?: number) => void;\n}\n\nexport interface promptToastHandle {\n  close: () => void;\n  result: Promise<string | null>;\n}\n\nexport interface confirmToastHandle {\n  close: () => void;\n  result: Promise<boolean>;\n}\n\nexport interface stickyToastHandle {\n  close: () => void;\n  update: (title?: string, content?: string) => void;\n  closed$: Observable<void>;\n  resolve: (message?: string, timeout?: number) => void;\n}\n\n@injectable()\nexport class ToastService {\n\n  private readonly _logger;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(ElementsSetup) private readonly _elementsSetup: ElementsSetup\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  /**\n   * Show a toast with a title and message for a timespan\n   * @param title\n   * @param content\n   * @param timeout\n   */\n  public async showToast(title?: string, content?: string, timeout?: number) {\n    const elements = await this._elementsSetup.complete();\n    const toast = new Toast({\n      target: elements.toastContainer,\n      props: {\n        closeHandler: () => {\n          toast.$destroy();\n        },\n        title,\n        content,\n        showLoading: false\n      }\n    });\n\n    setTimeout(() => toast.close(), timeout ?? 3000);\n  }\n\n  /**\n   * Show a sticky toast with a title and message\n   * Will be kept open until manually closed\n   * @param title\n   * @param content\n   * @param allowClose\n   */\n  public async showStickyToast(title?: string, content?: string, allowClose?: boolean): Promise<stickyToastHandle> {\n    const elements = await this._elementsSetup.complete();\n    const closed = new Subject<void>();\n    const toast = new Toast({\n      target: elements.toastContainer,\n      props: {\n        closeHandler: () => {\n          toast.$destroy();\n          closed.next();\n        },\n        title,\n        content,\n        showLoading: false,\n        allowClose: allowClose === undefined ? false : allowClose\n      }\n    });\n\n\n    return {\n      close: () => toast.close(),\n      update: (title?: string, content?: string) => {\n        toast.$set({title, content});\n      },\n      closed$: closed.asObservable(),\n      resolve: (message?: string, timeout?: number) => {\n        toast.$set({showLoading: false, title: message ?? \"Done\"});\n        setTimeout(() => toast.close(), timeout ?? 3000);\n      }\n    };\n  }\n\n  /**\n   * Show a toast with a loading spinner and message\n   * Returns a handler object which can be used to resolve the toast to a normal toast\n   * with title/content, or an error toast with title/content, or defaults for error/success.\n   * @param content\n   */\n  public async showLoadingToast(content: string): Promise<loadingToastHandle> {\n    const elements = await this._elementsSetup.complete();\n    const toast = new Toast({\n      target: elements.toastContainer,\n      props: {\n        closeHandler: () => {\n          toast.$destroy();\n        },\n        title: undefined as string | undefined,\n        content,\n        showLoading: true\n      }\n    });\n\n    return {\n      close: () => toast.close(),\n      resolve: (message?: string, timeout?: number) => {\n        toast.$set({showLoading: false, title: message ?? \"Done\"});\n        setTimeout(() => toast.close(), timeout ?? 3000);\n      },\n      reject: (message?: string, title?: string, timeout?: number) => {\n        toast.$set({showLoading: false, title: title ?? \"Error\"});\n        if(message !== undefined) toast.$set({content: message});\n        setTimeout(() => toast.close(), timeout ?? 3000);\n      }\n    };\n  }\n\n  public async showPromptToast(title: string, content: string | undefined = undefined, timeout: number | undefined = 10000): Promise<promptToastHandle> {\n    const elements = await this._elementsSetup.complete();\n\n    const result = new Subject<string | null>();\n    const toast = new Toast({\n      target: elements.toastContainer,\n      props: {\n        closeHandler: () => {\n          toast.$destroy();\n          if(!result.closed) result.next(null);\n          result.complete();\n        },\n        promptHandler: (value: string) => {\n          result.next(value);\n          toast.close();\n        },\n        title,\n        content,\n        showLoading: false\n      }\n    });\n\n    if (timeout) {\n      setTimeout(() => {\n        toast.close();\n      }, timeout);\n    }\n\n    return {\n      close: () => toast.close(),\n      result: firstValueFrom(result)\n    };\n  }\n\n  public async showConfirmToast(title: string, content: string | undefined = undefined, timeout: number | undefined = 10000): Promise<confirmToastHandle> {\n    const elements = await this._elementsSetup.complete();\n\n    const result = new Subject<boolean>();\n    const toast = new Toast({\n      target: elements.toastContainer,\n      props: {\n        closeHandler: () => {\n          toast.$destroy();\n          if(!result.closed) result.next(false);\n          result.complete();\n        },\n        confirmHandler: (value: boolean) => {\n          result.next(value);\n          toast.close();\n        },\n        title,\n        content,\n        showLoading: false\n      }\n    });\n\n    if (timeout) {\n      setTimeout(() => {\n        toast.close();\n      }, timeout);\n    }\n\n    return {\n      close: () => toast.close(),\n      result: firstValueFrom(result)\n    };\n  }\n}","import { Interceptor, type prioritizedCanvasEvents } from \"@/content/core/interceptor/interceptor\";\nimport { earlySetup } from \"@/content/core/setup/earlySetup.decorator\";\nimport { inject } from \"inversify\";\nimport { Setup } from \"../../core/setup/setup\";\n\n/**\n * Setup that waits until prioritized canvas events are set up in the interceptor\n */\n@earlySetup()\nexport class PrioritizedCanvasEventsSetup extends Setup<prioritizedCanvasEvents> {\n\n  @inject(Interceptor) private readonly _interceptor!: Interceptor;\n\n  protected async runSetup(): Promise<prioritizedCanvasEvents> {\n    return this._interceptor.canvasPrioritizedEventsReady;\n  }\n}","Canvas Zoom lets you zoom the drawing canvas, so you can work on details more easily. <br>\nTo start zooming, press the \"Zoom Toggle\" hotkey.<br>\nThe center of the zoomed area will be at your last mouse position. The mouse has to be on the canvas when you enable zoom. <br><br>\nTo adjust the zoom level, you can press the Zoom Level hotkeys.<br>\nYou can exit the zoom by pressing the \"Zoom Toggle\" hotkey again. <br>","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { ImageResetEventListener } from \"@/content/events/image-reset.event\";\nimport { LobbyLeftEventListener } from \"@/content/events/lobby-left.event\";\nimport { LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { type stickyToastHandle, ToastService } from \"@/content/services/toast/toast.service\";\nimport {\n  PrioritizedCanvasEventsSetup\n} from \"@/content/setups/prioritized-canvas-events/prioritized-canvas-events.setup\";\nimport { inject } from \"inversify\";\nimport {\n  BehaviorSubject,\n  combineLatestWith, distinctUntilChanged, filter, mergeWith,\n  pairwise,\n  type Subscription, take,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport CanvasZoomInfo from \"./canvas-zoom-info.svelte\";\n\nexport class CanvasZoomFeature extends TypoFeature {\n\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(PrioritizedCanvasEventsSetup) private readonly _prioritizedCanvasEventsSetup!: PrioritizedCanvasEventsSetup;\n  @inject(LobbyStateChangedEventListener) private readonly _lobbyStateChangedEventListener!: LobbyStateChangedEventListener;\n  @inject(LobbyLeftEventListener) private readonly _lobbyLeftEventListener!: LobbyLeftEventListener;\n  @inject(ImageResetEventListener) private readonly _imageResetEventListener!: ImageResetEventListener;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n\n  public override get featureInfoComponent(): componentData<CanvasZoomInfo> {\n    return {componentType: CanvasZoomInfo, props: { }};\n  }\n\n  public readonly name = \"Canvas Zoom\";\n  public readonly description = \"Lets you zoom a section of the canvas when you're drawing\";\n  public readonly featureId = 26;\n\n  private readonly _enableOnlyWhenDrawingSetting = this.useSetting(new BooleanExtensionSetting(\"trigger_require_drawing\", true, this)\n    .withName(\"Zoom Only When Drawing\")\n    .withDescription(\"Only allow start zooming with the hotkey when you're currently drawing\"));\n\n  private readonly _toggleZoomHotkey = this.useHotkey(new HotkeyAction(\n    \"toggle_zoom\",\n    \"Toggle Zoom\",\n    \"Toggles canvas zooming on or off\",\n    this,\n    () => {\n      this._currentMouseoverCoordinates$.pipe(\n        combineLatestWith(this._zoomActive$, this._enableOnlyWhenDrawingSetting.changes$, this._lobbyService.lobby$),\n        take(1),\n      ).subscribe(([coords, active, onlyWhenDrawing, lobby]) => {\n        if(onlyWhenDrawing && (lobby === null || lobby.drawerId !== lobby.meId)) {\n          this._zoomActive$.next(false);\n        }\n        else {\n          this._zoomActive$.next((active !== false || coords === null) ? false : coords);\n        }\n      });\n    },\n    true,\n    [\"ControlLeft\"]\n  ));\n\n  private readonly _zoomLevelHotkeys = [1,2,3,4,5].map(level => this.useHotkey(new HotkeyAction(\n    `zoom_level_${level}`,\n    `Zoom Level ${level}`,\n    `Set the zoom level to ${level}`,\n    this,\n    () => this._zoomLevel$.next(level),\n    true,\n    [`Digit${level}`],\n  )));\n\n  private _currentMouseoverCoordinates$ = new BehaviorSubject<[number, number] | null>(null);\n  private _zoomActive$ = new BehaviorSubject<[number, number] | false>(false);\n  private _zoomLevel$ = new BehaviorSubject<number>(1);\n  private _toastHandle?: stickyToastHandle;\n  private _zoomStateSubscription?: Subscription;\n  private _zoomResetSubscription?: Subscription;\n  private _zoomStyle?: CSSStyleSheet;\n\n  private readonly _canvasPointermoveListener = this.onCanvasPointermove.bind(this);\n  private readonly _canvasPointeroutListener = this.onCanvasPointerout.bind(this);\n\n  protected override async onActivate() {\n    const { add } =  await this._prioritizedCanvasEventsSetup.complete();\n    add(\"postDraw\")(\"pointermove\", this._canvasPointermoveListener);\n    add(\"postDraw\")(\"pointerout\", this._canvasPointeroutListener);\n\n    this._zoomStyle = new CSSStyleSheet();\n    document.adoptedStyleSheets = [...document.adoptedStyleSheets, this._zoomStyle];\n\n    /* reset zoom */\n    this._zoomResetSubscription = this._imageResetEventListener.events$.pipe( /* on image clear */\n      mergeWith(\n        this._lobbyStateChangedEventListener.events$.pipe( /* when drawing revealed or started */\n          filter(\n            (event) =>\n              event.data.drawingRevealed !== undefined ||\n              event.data.drawingStarted !== undefined,\n          )\n        ),\n        this._lobbyLeftEventListener.events$ /* when leaving the lobby */\n      )\n    ).subscribe(() => {\n      this._zoomActive$.next(false);\n    });\n\n    this._zoomStateSubscription = this._zoomActive$.pipe(\n      distinctUntilChanged(),\n      combineLatestWith(this._zoomLevel$),\n      pairwise()\n    ).subscribe(state => this.processZoomStateUpdate(state));\n  }\n\n  protected override async onDestroy() {\n    const { remove } = await this._prioritizedCanvasEventsSetup.complete();\n    remove(\"pointermove\", this._canvasPointermoveListener);\n    remove(\"pointerout\", this._canvasPointeroutListener);\n\n    document.adoptedStyleSheets = document.adoptedStyleSheets.filter(s => s !== this._zoomStyle);\n    this._zoomStyle = undefined;\n\n    this._toastHandle?.close();\n    this._zoomStateSubscription?.unsubscribe();\n    this._zoomResetSubscription?.unsubscribe();\n    this._zoomStateSubscription = undefined;\n    this._zoomResetSubscription = undefined;\n    this._toastHandle = undefined;\n    this._zoomActive$.next(false);\n    this._currentMouseoverCoordinates$.next(null);\n  }\n\n  private async setZoom(level: number | undefined, position: [number, number] | undefined){\n    this._logger.debug(\"Setting zoom level\", level);\n\n    const sheet = this._zoomStyle;\n    if(!sheet) {\n      this._logger.error(\"Zoom style element not found\");\n      return;\n    }\n\n    if(level === undefined || position === undefined) {\n      await sheet.replace(\"\");\n      return;\n    }\n\n    await sheet.replace(`\n      #game-canvas {\n        width: 800px;\n        aspect-ratio: 8/6;\n      }\n   \n      #game-canvas canvas {\n        position: absolute;\n        width: calc(${level * 2} * 100%);\n        top: calc(-100% * (${position[1]} / 600 * ${level * 2 - 1}));\n        left: calc(-100% * (${position[0]} / 800 * ${level * 2 - 1}));\n      }\n    `);\n  }\n\n  private onCanvasPointermove(event: MouseEvent){\n     if(this._zoomActive$.value === false) this._currentMouseoverCoordinates$.next([event.offsetX, event.offsetY]);\n  }\n\n  private onCanvasPointerout(){\n    this._currentMouseoverCoordinates$.next(null);\n  }\n\n  private async processZoomStateUpdate([[prevState, prevLevel], [state, level]]: [[false | [number, number], number], [false | [number, number], number]]){\n    this._logger.debug(\"Zoom state processing\", {prevState, prevLevel}, {state, level}, this._toastHandle);\n\n    /* update canvas element */\n    await this.setZoom(state !== false ? level : undefined, state !== false ? state : undefined);\n\n    /* if just triggered, show toast */\n    if(state !== false && prevState === false){\n      if(this._toastHandle !== undefined){\n        this._logger.warn(\"Toast handle unexpected existing when just triggered\");\n        this._toastHandle.close();\n      }\n      this._toastHandle = await this._toastService.showStickyToast(\"Canvas zoom\", \"Click one of the zoom level hotkeys to set the zoom level\");\n    }\n\n    /* if just stopped, remove toast */\n    if(state === false && prevState !== false){\n      if(this._toastHandle === undefined){\n        this._logger.warn(\"Toast handle unexpected not existing when just stopped\");\n      }\n      this._toastHandle?.close();\n      this._toastHandle = undefined;\n    }\n\n    return;\n  }\n\n  public get onlyWhenDrawingStore(){\n    return this._enableOnlyWhenDrawingSetting.store;\n  }\n}","export const replaceOrAddCssRule = (styleSheet: HTMLStyleElement, cssText: string | undefined, index: number | undefined) => {\n  if (cssText === undefined) {\n    if (index !== undefined) {\n      const rule = styleSheet.sheet?.cssRules[index];\n      if(rule) {\n        styleSheet.sheet?.deleteRule(index);\n        styleSheet.sheet?.insertRule(\".placeholder-empty-rule:not(*) {color: unset;}\", index);\n      }\n    }\n    return index;\n  }\n\n  if (index !== undefined) {\n    const rule = styleSheet.sheet?.cssRules[index];\n    if(rule) {\n      styleSheet.sheet?.deleteRule(index);\n      styleSheet.sheet?.insertRule(cssText, index);\n    }\n    return index;\n  }\n\n  return styleSheet.sheet?.insertRule(cssText, styleSheet.sheet?.cssRules.length);\n};","import type { concretePlayerIdentification, SkribblPlayerDisplay } from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { replaceOrAddCssRule } from \"@/util/document/replaceOrAddCssRule\";\n\nexport class SkribblLandingPlayer implements SkribblPlayerDisplay {\n  private _playerHideAvatarRuleIndex: number | undefined;\n  private readonly _playerStyle: HTMLStyleElement;\n  private readonly _containerId = \"typo-customize-player-display\";\n\n  constructor(\n    private readonly _login: number,\n    private _customizerContainer: HTMLElement,\n    private _avatarContainer: HTMLElement,\n  ) {\n    this._customizerContainer.classList.add(this._containerId);\n    this._playerStyle = document.createElement(\"style\");\n    this._customizerContainer.appendChild(this._playerStyle);\n  }\n\n  destroy() {\n    this._playerStyle.remove();\n    this._customizerContainer.classList.remove(this._containerId);\n  }\n\n  get typoId(): concretePlayerIdentification {\n    return { login: this._login };\n  }\n\n  get avatarContainer(): HTMLElement {\n    return this._avatarContainer;\n  }\n\n  get backgroundContainer(): HTMLElement {\n    return this._customizerContainer;\n  }\n\n  get container(): HTMLElement {\n    return this._customizerContainer;\n  }\n\n  readonly iconsContainer = null;\n\n  set useBackground(value: boolean) {\n    this._customizerContainer.style.backgroundColor = value ? \"\" : \"transparent\";\n    this._customizerContainer.style.zIndex = value ? \"\" : \"1\";\n  }\n\n  set useSafeColor(value: boolean) {\n    /* no implementation */\n  }\n\n  set adjustToContainSprites(value: boolean) {\n    /* no implementation */\n  }\n\n  set viewPlayerId(value: boolean) {\n    /* no implementation */\n  }\n\n  public set hideAvatar(value: boolean) {\n    this._playerHideAvatarRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n      .${this._containerId} .avatar > :is(.eyes, .mouth, .color) { display: ${value ? \"none\" : \"block\"}\n      }`\n        : undefined,\n      this._playerHideAvatarRuleIndex,\n    );\n  }\n}","import { replaceOrAddCssRule } from \"@/util/document/replaceOrAddCssRule\";\nimport { requireElement } from \"@/util/document/requiredQuerySelector\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\nimport type {\n  SkribblPlayerDisplay,\n  typoPlayerIdentification,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\n\n/**\n * Implementation of the skribblplayerdisplay\n * for the lobby player containers in-game\n */\nexport class SkribblLobbyPlayer implements SkribblPlayerDisplay {\n  private static idCounter = 0;\n\n  private readonly _elementId;\n\n  private readonly _playerContainer: HTMLElement;\n  private readonly _avatarContainer: HTMLElement;\n  private readonly _backgroundContainer: HTMLElement;\n  private readonly _iconsContainer: HTMLElement;\n\n  private readonly _playerStyle: HTMLStyleElement;\n\n  private _backgroundRuleIndex: number | undefined;\n  private _fontColorRuleIndex: number | undefined;\n  private _fontColorGuessedRuleIndex: number | undefined;\n  private _fontShadowRuleIndex: number | undefined;\n  private _resizeRuleIndex: number | undefined;\n  private _elevateDrawingRuleIndex: number | undefined;\n  private _alignRuleIndex: number | undefined;\n  private _playerIdRuleIndex: number | undefined;\n  private _playerInfoRuleIndex: number | undefined;\n  private _playerHideAvatarRuleIndex: number | undefined;\n\n  public constructor(\n    private readonly _player: skribblPlayer,\n    private readonly _lobbyKey?: string,\n    private readonly _playerLogin?: number,\n  ) {\n    if (_lobbyKey === undefined && _playerLogin === undefined)\n      throw new Error(\"No identification provided\");\n\n    this._playerContainer = requireElement(`#game-players .player[playerid='${this._player.id}']`);\n    this._avatarContainer = requireElement(\".avatar\", this._playerContainer);\n    this._backgroundContainer = requireElement(\".player-background\", this._playerContainer);\n    this._iconsContainer = requireElement(\".player-icons\", this._playerContainer);\n\n    this._elementId = \"typo-lobby-player-\" + SkribblLobbyPlayer.idCounter++;\n    this._playerStyle = document.createElement(\"style\");\n    this._playerContainer.classList.add(this._elementId);\n    this._playerContainer.appendChild(this._playerStyle);\n  }\n\n  destroy() {\n    this._playerContainer.classList.remove(this._elementId);\n    this._playerStyle.remove();\n  }\n\n  public get typoId(): typoPlayerIdentification {\n    if (this._playerLogin !== undefined) return { login: this._playerLogin };\n    if (this._lobbyKey !== undefined)\n      return { lobbyKey: this._lobbyKey, lobbyPlayerId: this._player.id };\n    throw new Error(\"No identification provided\");\n  }\n\n  public get lobbyPlayerId() {\n    return this._player.id;\n  }\n\n  public get name() {\n    return this._player.name;\n  }\n\n  public get container() {\n    return this._playerContainer;\n  }\n\n  public get avatarContainer() {\n    return this._avatarContainer;\n  }\n\n  public get backgroundContainer() {\n    return this._backgroundContainer;\n  }\n\n  get iconsContainer(): HTMLElement {\n    return this._iconsContainer;\n  }\n\n  public set useBackground(value: boolean) {\n    this._backgroundRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      !value\n        ? `.${this._elementId} .player-background { background-color: transparent !important; }`\n        : undefined,\n      this._backgroundRuleIndex,\n    );\n  }\n\n  public set useSafeColor(value: boolean) {\n    this._fontColorRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n      .${this._elementId}:not(.guessed) > :not(.player-bubble) *, .${this._elementId}:not(.guessed) .player-info:after { \n        color: White !important; \n      }`\n        : undefined,\n      this._fontColorRuleIndex,\n    );\n\n    this._fontColorGuessedRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n      .${this._elementId}:is(.guessed) > :not(.player-bubble) *, .${this._elementId}:is(.guessed) .player-info:after { \n        color: #56ce27 !important;\n      }`\n        : undefined,\n      this._fontColorGuessedRuleIndex,\n    );\n\n    this._fontShadowRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n      .${this._elementId} > :not(.player-bubble) *, .${this._elementId} .player-info:after { \n        text-shadow: 0px 0px 25px black, 0px 0px 10px black, 0px 0px 5px black !important;\n      }`\n        : undefined,\n      this._fontShadowRuleIndex,\n    );\n  }\n\n  public set adjustToContainSprites(value: boolean) {\n    this._resizeRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value ? `.${this._elementId} { height: 56px !important; }` : undefined,\n      this._resizeRuleIndex,\n    );\n\n    this._alignRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `.${this._elementId} .player-avatar-container { top: calc((100% - var(--UNIT)) / 2) !important; }`\n        : undefined,\n      this._alignRuleIndex,\n    );\n\n    this._elevateDrawingRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `#game-players .${this._elementId} .player-avatar-container .avatar .drawing { z-index: 100; }`\n        : undefined,\n      this._elevateDrawingRuleIndex,\n    );\n  }\n\n  public set viewPlayerId(value: boolean) {\n    this._playerIdRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n       .${this._elementId} .player-score { \n          display: none; \n       }`\n        : undefined,\n      this._playerIdRuleIndex,\n    );\n\n    this._playerInfoRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n       .${this._elementId} .player-info:after { \n          content: \"#${this._player.id}\"; \n       }`\n        : undefined,\n      this._playerInfoRuleIndex,\n    );\n  }\n\n  public set hideAvatar(value: boolean) {\n    this._playerHideAvatarRuleIndex = replaceOrAddCssRule(\n      this._playerStyle,\n      value\n        ? `\n      .${this._elementId} .avatar > :is(.eyes, .mouth, .color) { display: ${value ? \"none\" : \"block\"}\n      }`\n        : undefined,\n      this._playerHideAvatarRuleIndex,\n    );\n  }\n}","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nexport const BASE_PATH = \"http://localhost\".replace(/\\/+$/, \"\");\n\nexport interface ConfigurationParameters {\n    basePath?: string; // override base path\n    fetchApi?: FetchAPI; // override for fetch implementation\n    middleware?: Middleware[]; // middleware to apply before/after fetch requests\n    queryParamsStringify?: (params: HTTPQuery) => string; // stringify function for query strings\n    username?: string; // parameter for basic security\n    password?: string; // parameter for basic security\n    apiKey?: string | Promise<string> | ((name: string) => string | Promise<string>); // parameter for apiKey security\n    accessToken?: string | Promise<string> | ((name?: string, scopes?: string[]) => string | Promise<string>); // parameter for oauth2 security\n    headers?: HTTPHeaders; //header params we want to use on every request\n    credentials?: RequestCredentials; //value for the credentials param we want to use on each request\n}\n\nexport class Configuration {\n    constructor(private configuration: ConfigurationParameters = {}) {}\n\n    set config(configuration: Configuration) {\n        this.configuration = configuration;\n    }\n\n    get basePath(): string {\n        return this.configuration.basePath != null ? this.configuration.basePath : BASE_PATH;\n    }\n\n    get fetchApi(): FetchAPI | undefined {\n        return this.configuration.fetchApi;\n    }\n\n    get middleware(): Middleware[] {\n        return this.configuration.middleware || [];\n    }\n\n    get queryParamsStringify(): (params: HTTPQuery) => string {\n        return this.configuration.queryParamsStringify || querystring;\n    }\n\n    get username(): string | undefined {\n        return this.configuration.username;\n    }\n\n    get password(): string | undefined {\n        return this.configuration.password;\n    }\n\n    get apiKey(): ((name: string) => string | Promise<string>) | undefined {\n        const apiKey = this.configuration.apiKey;\n        if (apiKey) {\n            return typeof apiKey === 'function' ? apiKey : () => apiKey;\n        }\n        return undefined;\n    }\n\n    get accessToken(): ((name?: string, scopes?: string[]) => string | Promise<string>) | undefined {\n        const accessToken = this.configuration.accessToken;\n        if (accessToken) {\n            return typeof accessToken === 'function' ? accessToken : async () => accessToken;\n        }\n        return undefined;\n    }\n\n    get headers(): HTTPHeaders | undefined {\n        return this.configuration.headers;\n    }\n\n    get credentials(): RequestCredentials | undefined {\n        return this.configuration.credentials;\n    }\n}\n\nexport const DefaultConfig = new Configuration();\n\n/**\n * This is the base class for all generated API classes.\n */\nexport class BaseAPI {\n\n    private static readonly jsonRegex = new RegExp('^(:?application\\/json|[^;/ \\t]+\\/[^;/ \\t]+[+]json)[ \\t]*(:?;.*)?$', 'i');\n    private middleware: Middleware[];\n\n    constructor(protected configuration = DefaultConfig) {\n        this.middleware = configuration.middleware;\n    }\n\n    withMiddleware<T extends BaseAPI>(this: T, ...middlewares: Middleware[]) {\n        const next = this.clone<T>();\n        next.middleware = next.middleware.concat(...middlewares);\n        return next;\n    }\n\n    withPreMiddleware<T extends BaseAPI>(this: T, ...preMiddlewares: Array<Middleware['pre']>) {\n        const middlewares = preMiddlewares.map((pre) => ({ pre }));\n        return this.withMiddleware<T>(...middlewares);\n    }\n\n    withPostMiddleware<T extends BaseAPI>(this: T, ...postMiddlewares: Array<Middleware['post']>) {\n        const middlewares = postMiddlewares.map((post) => ({ post }));\n        return this.withMiddleware<T>(...middlewares);\n    }\n\n    /**\n     * Check if the given MIME is a JSON MIME.\n     * JSON MIME examples:\n     *   application/json\n     *   application/json; charset=UTF8\n     *   APPLICATION/JSON\n     *   application/vnd.company+json\n     * @param mime - MIME (Multipurpose Internet Mail Extensions)\n     * @return True if the given MIME is JSON, false otherwise.\n     */\n    protected isJsonMime(mime: string | null | undefined): boolean {\n        if (!mime) {\n            return false;\n        }\n        return BaseAPI.jsonRegex.test(mime);\n    }\n\n    protected async request(context: RequestOpts, initOverrides?: RequestInit | InitOverrideFunction): Promise<Response> {\n        const { url, init } = await this.createFetchParams(context, initOverrides);\n        const response = await this.fetchApi(url, init);\n        if (response && (response.status >= 200 && response.status < 300)) {\n            return response;\n        }\n        throw new ResponseError(response, 'Response returned an error code');\n    }\n\n    private async createFetchParams(context: RequestOpts, initOverrides?: RequestInit | InitOverrideFunction) {\n        let url = this.configuration.basePath + context.path;\n        if (context.query !== undefined && Object.keys(context.query).length !== 0) {\n            // only add the querystring to the URL if there are query parameters.\n            // this is done to avoid urls ending with a \"?\" character which buggy webservers\n            // do not handle correctly sometimes.\n            url += '?' + this.configuration.queryParamsStringify(context.query);\n        }\n\n        const headers = Object.assign({}, this.configuration.headers, context.headers);\n        Object.keys(headers).forEach(key => headers[key] === undefined ? delete headers[key] : {});\n\n        const initOverrideFn =\n            typeof initOverrides === \"function\"\n                ? initOverrides\n                : async () => initOverrides;\n\n        const initParams = {\n            method: context.method,\n            headers,\n            body: context.body,\n            credentials: this.configuration.credentials,\n        };\n\n        const overriddenInit: RequestInit = {\n            ...initParams,\n            ...(await initOverrideFn({\n                init: initParams,\n                context,\n            }))\n        };\n\n        let body: any;\n        if (isFormData(overriddenInit.body)\n            || (overriddenInit.body instanceof URLSearchParams)\n            || isBlob(overriddenInit.body)) {\n          body = overriddenInit.body;\n        } else if (this.isJsonMime(headers['Content-Type'])) {\n          body = JSON.stringify(overriddenInit.body);\n        } else {\n          body = overriddenInit.body;\n        }\n\n        const init: RequestInit = {\n            ...overriddenInit,\n            body\n        };\n\n        return { url, init };\n    }\n\n    private fetchApi = async (url: string, init: RequestInit) => {\n        let fetchParams = { url, init };\n        for (const middleware of this.middleware) {\n            if (middleware.pre) {\n                fetchParams = await middleware.pre({\n                    fetch: this.fetchApi,\n                    ...fetchParams,\n                }) || fetchParams;\n            }\n        }\n        let response: Response | undefined = undefined;\n        try {\n            response = await (this.configuration.fetchApi || fetch)(fetchParams.url, fetchParams.init);\n        } catch (e) {\n            for (const middleware of this.middleware) {\n                if (middleware.onError) {\n                    response = await middleware.onError({\n                        fetch: this.fetchApi,\n                        url: fetchParams.url,\n                        init: fetchParams.init,\n                        error: e,\n                        response: response ? response.clone() : undefined,\n                    }) || response;\n                }\n            }\n            if (response === undefined) {\n              if (e instanceof Error) {\n                throw new FetchError(e, 'The request failed and the interceptors did not return an alternative response');\n              } else {\n                throw e;\n              }\n            }\n        }\n        for (const middleware of this.middleware) {\n            if (middleware.post) {\n                response = await middleware.post({\n                    fetch: this.fetchApi,\n                    url: fetchParams.url,\n                    init: fetchParams.init,\n                    response: response.clone(),\n                }) || response;\n            }\n        }\n        return response;\n    }\n\n    /**\n     * Create a shallow clone of `this` by constructing a new instance\n     * and then shallow cloning data members.\n     */\n    private clone<T extends BaseAPI>(this: T): T {\n        const constructor = this.constructor as any;\n        const next = new constructor(this.configuration);\n        next.middleware = this.middleware.slice();\n        return next;\n    }\n};\n\nfunction isBlob(value: any): value is Blob {\n    return typeof Blob !== 'undefined' && value instanceof Blob;\n}\n\nfunction isFormData(value: any): value is FormData {\n    return typeof FormData !== \"undefined\" && value instanceof FormData;\n}\n\nexport class ResponseError extends Error {\n    override name: \"ResponseError\" = \"ResponseError\";\n    constructor(public response: Response, msg?: string) {\n        super(msg);\n    }\n}\n\nexport class FetchError extends Error {\n  override name: \"FetchError\" = \"FetchError\";\n  constructor(\n    public override cause: Error,\n    msg?: string,\n  ) {\n    super(msg);\n  }\n}\n\nexport class RequiredError extends Error {\n    override name: \"RequiredError\" = \"RequiredError\";\n    constructor(public field: string, msg?: string) {\n        super(msg);\n    }\n}\n\nexport const COLLECTION_FORMATS = {\n    csv: \",\",\n    ssv: \" \",\n    tsv: \"\\t\",\n    pipes: \"|\",\n};\n\nexport type FetchAPI = WindowOrWorkerGlobalScope['fetch'];\n\nexport type Json = any;\nexport type HTTPMethod = 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE' | 'OPTIONS' | 'HEAD';\nexport type HTTPHeaders = { [key: string]: string };\nexport type HTTPQuery = { [key: string]: string | number | null | boolean | Array<string | number | null | boolean> | Set<string | number | null | boolean> | HTTPQuery };\nexport type HTTPBody = Json | FormData | URLSearchParams;\nexport type HTTPRequestInit = { headers?: HTTPHeaders; method: HTTPMethod; credentials?: RequestCredentials; body?: HTTPBody };\nexport type ModelPropertyNaming = 'camelCase' | 'snake_case' | 'PascalCase' | 'original';\n\nexport type InitOverrideFunction = (requestContext: { init: HTTPRequestInit, context: RequestOpts }) => Promise<RequestInit>\n\nexport interface FetchParams {\n    url: string;\n    init: RequestInit;\n}\n\nexport interface RequestOpts {\n    path: string;\n    method: HTTPMethod;\n    headers: HTTPHeaders;\n    query?: HTTPQuery;\n    body?: HTTPBody;\n}\n\nexport function querystring(params: HTTPQuery, prefix: string = ''): string {\n    return Object.keys(params)\n        .map(key => querystringSingleKey(key, params[key], prefix))\n        .filter(part => part.length > 0)\n        .join('&');\n}\n\nfunction querystringSingleKey(key: string, value: string | number | null | undefined | boolean | Array<string | number | null | boolean> | Set<string | number | null | boolean> | HTTPQuery, keyPrefix: string = ''): string {\n    const fullKey = keyPrefix + (keyPrefix.length ? `[${key}]` : key);\n    if (value instanceof Array) {\n        const multiValue = value.map(singleValue => encodeURIComponent(String(singleValue)))\n            .join(`&${encodeURIComponent(fullKey)}=`);\n        return `${encodeURIComponent(fullKey)}=${multiValue}`;\n    }\n    if (value instanceof Set) {\n        const valueAsArray = Array.from(value);\n        return querystringSingleKey(key, valueAsArray, keyPrefix);\n    }\n    if (value instanceof Date) {\n        return `${encodeURIComponent(fullKey)}=${encodeURIComponent(value.toISOString())}`;\n    }\n    if (value instanceof Object) {\n        return querystring(value as HTTPQuery, fullKey);\n    }\n    return `${encodeURIComponent(fullKey)}=${encodeURIComponent(String(value))}`;\n}\n\nexport function mapValues(data: any, fn: (item: any) => any) {\n  return Object.keys(data).reduce(\n    (acc, key) => ({ ...acc, [key]: fn(data[key]) }),\n    {}\n  );\n}\n\nexport function canConsumeForm(consumes: Consume[]): boolean {\n    for (const consume of consumes) {\n        if ('multipart/form-data' === consume.contentType) {\n            return true;\n        }\n    }\n    return false;\n}\n\nexport interface Consume {\n    contentType: string;\n}\n\nexport interface RequestContext {\n    fetch: FetchAPI;\n    url: string;\n    init: RequestInit;\n}\n\nexport interface ResponseContext {\n    fetch: FetchAPI;\n    url: string;\n    init: RequestInit;\n    response: Response;\n}\n\nexport interface ErrorContext {\n    fetch: FetchAPI;\n    url: string;\n    init: RequestInit;\n    error: unknown;\n    response?: Response;\n}\n\nexport interface Middleware {\n    pre?(context: RequestContext): Promise<FetchParams | void>;\n    post?(context: ResponseContext): Promise<Response | void>;\n    onError?(context: ErrorContext): Promise<Response | void>;\n}\n\nexport interface ApiResponse<T> {\n    raw: Response;\n    value(): Promise<T>;\n}\n\nexport interface ResponseTransformer<T> {\n    (json: any): T;\n}\n\nexport class JSONApiResponse<T> {\n    constructor(public raw: Response, private transformer: ResponseTransformer<T> = (jsonValue: any) => jsonValue) {}\n\n    async value(): Promise<T> {\n        return this.transformer(await this.raw.json());\n    }\n}\n\nexport class VoidApiResponse {\n    constructor(public raw: Response) {}\n\n    async value(): Promise<void> {\n        return undefined;\n    }\n}\n\nexport class BlobApiResponse {\n    constructor(public raw: Response) {}\n\n    async value(): Promise<Blob> {\n        return await this.raw.blob();\n    };\n}\n\nexport class TextApiResponse {\n    constructor(public raw: Response) {}\n\n    async value(): Promise<string> {\n        return await this.raw.text();\n    };\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface AccessTokenDto\n */\nexport interface AccessTokenDto {\n    /**\n     * The access token of an user\n     * @type {string}\n     * @memberof AccessTokenDto\n     */\n    token: string;\n}\n\n/**\n * Check if a given object implements the AccessTokenDto interface.\n */\nexport function instanceOfAccessTokenDto(value: object): value is AccessTokenDto {\n    if (!('token' in value) || value['token'] === undefined) return false;\n    return true;\n}\n\nexport function AccessTokenDtoFromJSON(json: any): AccessTokenDto {\n    return AccessTokenDtoFromJSONTyped(json, false);\n}\n\nexport function AccessTokenDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): AccessTokenDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'token': json['Token'],\n    };\n}\n\nexport function AccessTokenDtoToJSON(value?: AccessTokenDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'Token': value['token'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface AnnouncementDto\n */\nexport interface AnnouncementDto {\n    /**\n     * Announcement title\n     * @type {string}\n     * @memberof AnnouncementDto\n     */\n    title: string;\n    /**\n     * Announcement content\n     * @type {string}\n     * @memberof AnnouncementDto\n     */\n    content: string;\n    /**\n     * Announcement type\n     * @type {string}\n     * @memberof AnnouncementDto\n     */\n    affectedTypoVersion?: string;\n    /**\n     * Announcement creation ms\n     * @type {string}\n     * @memberof AnnouncementDto\n     */\n    date: string;\n    /**\n     * Announcement type\n     * @type {string}\n     * @memberof AnnouncementDto\n     */\n    type: AnnouncementDtoTypeEnum;\n}\n\n\n/**\n * @export\n */\nexport const AnnouncementDtoTypeEnum = {\n    Announcement: 'Announcement',\n    Changelog: 'Changelog'\n} as const;\nexport type AnnouncementDtoTypeEnum = typeof AnnouncementDtoTypeEnum[keyof typeof AnnouncementDtoTypeEnum];\n\n\n/**\n * Check if a given object implements the AnnouncementDto interface.\n */\nexport function instanceOfAnnouncementDto(value: object): value is AnnouncementDto {\n    if (!('title' in value) || value['title'] === undefined) return false;\n    if (!('content' in value) || value['content'] === undefined) return false;\n    if (!('date' in value) || value['date'] === undefined) return false;\n    if (!('type' in value) || value['type'] === undefined) return false;\n    return true;\n}\n\nexport function AnnouncementDtoFromJSON(json: any): AnnouncementDto {\n    return AnnouncementDtoFromJSONTyped(json, false);\n}\n\nexport function AnnouncementDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): AnnouncementDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'title': json['title'],\n        'content': json['content'],\n        'affectedTypoVersion': json['affectedTypoVersion'] == null ? undefined : json['affectedTypoVersion'],\n        'date': json['date'],\n        'type': json['type'],\n    };\n}\n\nexport function AnnouncementDtoToJSON(value?: AnnouncementDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'title': value['title'],\n        'content': value['content'],\n        'affectedTypoVersion': value['affectedTypoVersion'],\n        'date': value['date'],\n        'type': value['type'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface AwardDto\n */\nexport interface AwardDto {\n    /**\n     * Award name\n     * @type {string}\n     * @memberof AwardDto\n     */\n    name: string;\n    /**\n     * Award unique ID\n     * @type {number}\n     * @memberof AwardDto\n     */\n    id: number;\n    /**\n     * Award description\n     * @type {string}\n     * @memberof AwardDto\n     */\n    description: string;\n    /**\n     * Award icon url\n     * @type {string}\n     * @memberof AwardDto\n     */\n    url: string;\n    /**\n     * Rarity level\n     * @type {number}\n     * @memberof AwardDto\n     */\n    rarity: number;\n}\n\n/**\n * Check if a given object implements the AwardDto interface.\n */\nexport function instanceOfAwardDto(value: object): value is AwardDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('description' in value) || value['description'] === undefined) return false;\n    if (!('url' in value) || value['url'] === undefined) return false;\n    if (!('rarity' in value) || value['rarity'] === undefined) return false;\n    return true;\n}\n\nexport function AwardDtoFromJSON(json: any): AwardDto {\n    return AwardDtoFromJSONTyped(json, false);\n}\n\nexport function AwardDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): AwardDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'id': json['id'],\n        'description': json['description'],\n        'url': json['url'],\n        'rarity': json['rarity'],\n    };\n}\n\nexport function AwardDtoToJSON(value?: AwardDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'id': value['id'],\n        'description': value['description'],\n        'url': value['url'],\n        'rarity': value['rarity'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { AwardDto } from './AwardDto';\nimport {\n    AwardDtoFromJSON,\n    AwardDtoFromJSONTyped,\n    AwardDtoToJSON,\n} from './AwardDto';\n\n/**\n * \n * @export\n * @interface AwardInventoryDto\n */\nexport interface AwardInventoryDto {\n    /**\n     * The award type\n     * @type {AwardDto}\n     * @memberof AwardInventoryDto\n     */\n    award: AwardDto;\n    /**\n     * The award inventory ids of this award type\n     * @type {Array<number>}\n     * @memberof AwardInventoryDto\n     */\n    inventoryIds: Array<number>;\n}\n\n/**\n * Check if a given object implements the AwardInventoryDto interface.\n */\nexport function instanceOfAwardInventoryDto(value: object): value is AwardInventoryDto {\n    if (!('award' in value) || value['award'] === undefined) return false;\n    if (!('inventoryIds' in value) || value['inventoryIds'] === undefined) return false;\n    return true;\n}\n\nexport function AwardInventoryDtoFromJSON(json: any): AwardInventoryDto {\n    return AwardInventoryDtoFromJSONTyped(json, false);\n}\n\nexport function AwardInventoryDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): AwardInventoryDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'award': AwardDtoFromJSON(json['award']),\n        'inventoryIds': json['inventoryIds'],\n    };\n}\n\nexport function AwardInventoryDtoToJSON(value?: AwardInventoryDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'award': AwardDtoToJSON(value['award']),\n        'inventoryIds': value['inventoryIds'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface CloudDeleteDto\n */\nexport interface CloudDeleteDto {\n    /**\n     * Ids that will be removed from the cloud\n     * @type {Array<string>}\n     * @memberof CloudDeleteDto\n     */\n    ids: Array<string>;\n}\n\n/**\n * Check if a given object implements the CloudDeleteDto interface.\n */\nexport function instanceOfCloudDeleteDto(value: object): value is CloudDeleteDto {\n    if (!('ids' in value) || value['ids'] === undefined) return false;\n    return true;\n}\n\nexport function CloudDeleteDtoFromJSON(json: any): CloudDeleteDto {\n    return CloudDeleteDtoFromJSONTyped(json, false);\n}\n\nexport function CloudDeleteDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): CloudDeleteDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'ids': json['ids'],\n    };\n}\n\nexport function CloudDeleteDtoToJSON(value?: CloudDeleteDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'ids': value['ids'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface CloudImageDto\n */\nexport interface CloudImageDto {\n    /**\n     * Image name\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    name: string;\n    /**\n     * Image author\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    author: string;\n    /**\n     * Image creation timestamp ms\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    createdAt: string;\n    /**\n     * Image Id\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    id: string;\n    /**\n     * Meta Url\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    metaUrl: string;\n    /**\n     * Draw commands Url\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    commandsUrl: string;\n    /**\n     * Image Url\n     * @type {string}\n     * @memberof CloudImageDto\n     */\n    imageUrl: string;\n}\n\n/**\n * Check if a given object implements the CloudImageDto interface.\n */\nexport function instanceOfCloudImageDto(value: object): value is CloudImageDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('author' in value) || value['author'] === undefined) return false;\n    if (!('createdAt' in value) || value['createdAt'] === undefined) return false;\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('metaUrl' in value) || value['metaUrl'] === undefined) return false;\n    if (!('commandsUrl' in value) || value['commandsUrl'] === undefined) return false;\n    if (!('imageUrl' in value) || value['imageUrl'] === undefined) return false;\n    return true;\n}\n\nexport function CloudImageDtoFromJSON(json: any): CloudImageDto {\n    return CloudImageDtoFromJSONTyped(json, false);\n}\n\nexport function CloudImageDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): CloudImageDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'author': json['author'],\n        'createdAt': json['createdAt'],\n        'id': json['id'],\n        'metaUrl': json['metaUrl'],\n        'commandsUrl': json['commandsUrl'],\n        'imageUrl': json['imageUrl'],\n    };\n}\n\nexport function CloudImageDtoToJSON(value?: CloudImageDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'author': value['author'],\n        'createdAt': value['createdAt'],\n        'id': value['id'],\n        'metaUrl': value['metaUrl'],\n        'commandsUrl': value['commandsUrl'],\n        'imageUrl': value['imageUrl'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface CloudSearchDto\n */\nexport interface CloudSearchDto {\n    /**\n     * The size of a single search result page\n     * @type {number}\n     * @memberof CloudSearchDto\n     */\n    pageSize: number;\n    /**\n     * The current pagination index for given search criteria\n     * @type {number}\n     * @memberof CloudSearchDto\n     */\n    page: number;\n    /**\n     * Exact name of the author\n     * @type {string}\n     * @memberof CloudSearchDto\n     */\n    authorQuery?: string;\n    /**\n     * Exact language of the lobby\n     * @type {string}\n     * @memberof CloudSearchDto\n     */\n    languageQuery?: string;\n    /**\n     * Oldest creation date filter\n     * @type {string}\n     * @memberof CloudSearchDto\n     */\n    createdBeforeQuery?: string;\n    /**\n     * Most recent creation date filter\n     * @type {string}\n     * @memberof CloudSearchDto\n     */\n    createdAfterQuery?: string;\n    /**\n     * Filter for private lobbies\n     * @type {boolean}\n     * @memberof CloudSearchDto\n     */\n    createdInPrivateLobbyQuery?: boolean;\n    /**\n     * Filter for own drawings\n     * @type {boolean}\n     * @memberof CloudSearchDto\n     */\n    isOwnQuery?: boolean;\n    /**\n     * Exact title of the drawing\n     * @type {string}\n     * @memberof CloudSearchDto\n     */\n    titleQuery?: string;\n}\n\n/**\n * Check if a given object implements the CloudSearchDto interface.\n */\nexport function instanceOfCloudSearchDto(value: object): value is CloudSearchDto {\n    if (!('pageSize' in value) || value['pageSize'] === undefined) return false;\n    if (!('page' in value) || value['page'] === undefined) return false;\n    return true;\n}\n\nexport function CloudSearchDtoFromJSON(json: any): CloudSearchDto {\n    return CloudSearchDtoFromJSONTyped(json, false);\n}\n\nexport function CloudSearchDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): CloudSearchDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'pageSize': json['pageSize'],\n        'page': json['page'],\n        'authorQuery': json['authorQuery'] == null ? undefined : json['authorQuery'],\n        'languageQuery': json['languageQuery'] == null ? undefined : json['languageQuery'],\n        'createdBeforeQuery': json['createdBeforeQuery'] == null ? undefined : json['createdBeforeQuery'],\n        'createdAfterQuery': json['createdAfterQuery'] == null ? undefined : json['createdAfterQuery'],\n        'createdInPrivateLobbyQuery': json['createdInPrivateLobbyQuery'] == null ? undefined : json['createdInPrivateLobbyQuery'],\n        'isOwnQuery': json['isOwnQuery'] == null ? undefined : json['isOwnQuery'],\n        'titleQuery': json['titleQuery'] == null ? undefined : json['titleQuery'],\n    };\n}\n\nexport function CloudSearchDtoToJSON(value?: CloudSearchDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'pageSize': value['pageSize'],\n        'page': value['page'],\n        'authorQuery': value['authorQuery'],\n        'languageQuery': value['languageQuery'],\n        'createdBeforeQuery': value['createdBeforeQuery'],\n        'createdAfterQuery': value['createdAfterQuery'],\n        'createdInPrivateLobbyQuery': value['createdInPrivateLobbyQuery'],\n        'isOwnQuery': value['isOwnQuery'],\n        'titleQuery': value['titleQuery'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface CloudUploadDto\n */\nexport interface CloudUploadDto {\n    /**\n     * Image name\n     * @type {string}\n     * @memberof CloudUploadDto\n     */\n    name: string;\n    /**\n     * Image author name\n     * @type {string}\n     * @memberof CloudUploadDto\n     */\n    author: string;\n    /**\n     * Whether the image was created in a private lobby\n     * @type {boolean}\n     * @memberof CloudUploadDto\n     */\n    inPrivate: boolean;\n    /**\n     * If the image author is the cloud owner\n     * @type {boolean}\n     * @memberof CloudUploadDto\n     */\n    isOwn: boolean;\n    /**\n     * Lobby language where the image was created\n     * @type {string}\n     * @memberof CloudUploadDto\n     */\n    language: string;\n    /**\n     * Commands of the image for skribbl recreation\n     * @type {Array<object>}\n     * @memberof CloudUploadDto\n     */\n    commands: Array<object>;\n    /**\n     * base64 representation of the image\n     * @type {string}\n     * @memberof CloudUploadDto\n     */\n    imageBase64: string;\n}\n\n/**\n * Check if a given object implements the CloudUploadDto interface.\n */\nexport function instanceOfCloudUploadDto(value: object): value is CloudUploadDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('author' in value) || value['author'] === undefined) return false;\n    if (!('inPrivate' in value) || value['inPrivate'] === undefined) return false;\n    if (!('isOwn' in value) || value['isOwn'] === undefined) return false;\n    if (!('language' in value) || value['language'] === undefined) return false;\n    if (!('commands' in value) || value['commands'] === undefined) return false;\n    if (!('imageBase64' in value) || value['imageBase64'] === undefined) return false;\n    return true;\n}\n\nexport function CloudUploadDtoFromJSON(json: any): CloudUploadDto {\n    return CloudUploadDtoFromJSONTyped(json, false);\n}\n\nexport function CloudUploadDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): CloudUploadDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'author': json['author'],\n        'inPrivate': json['inPrivate'],\n        'isOwn': json['isOwn'],\n        'language': json['language'],\n        'commands': json['commands'],\n        'imageBase64': json['imageBase64'],\n    };\n}\n\nexport function CloudUploadDtoToJSON(value?: CloudUploadDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'author': value['author'],\n        'inPrivate': value['inPrivate'],\n        'isOwn': value['isOwn'],\n        'language': value['language'],\n        'commands': value['commands'],\n        'imageBase64': value['imageBase64'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface CloudUploadedDto\n */\nexport interface CloudUploadedDto {\n    /**\n     * ID of the uploaded image\n     * @type {string}\n     * @memberof CloudUploadedDto\n     */\n    id: string;\n}\n\n/**\n * Check if a given object implements the CloudUploadedDto interface.\n */\nexport function instanceOfCloudUploadedDto(value: object): value is CloudUploadedDto {\n    if (!('id' in value) || value['id'] === undefined) return false;\n    return true;\n}\n\nexport function CloudUploadedDtoFromJSON(json: any): CloudUploadedDto {\n    return CloudUploadedDtoFromJSONTyped(json, false);\n}\n\nexport function CloudUploadedDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): CloudUploadedDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'id': json['id'],\n    };\n}\n\nexport function CloudUploadedDtoToJSON(value?: CloudUploadedDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'id': value['id'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface EmojiCandidateDto\n */\nexport interface EmojiCandidateDto {\n    /**\n     * Emoji name\n     * @type {string}\n     * @memberof EmojiCandidateDto\n     */\n    name: string;\n    /**\n     * Emoji url\n     * @type {string}\n     * @memberof EmojiCandidateDto\n     */\n    url: string;\n    /**\n     * Whether emoji is animated or static\n     * @type {boolean}\n     * @memberof EmojiCandidateDto\n     */\n    animated: boolean;\n}\n\n/**\n * Check if a given object implements the EmojiCandidateDto interface.\n */\nexport function instanceOfEmojiCandidateDto(value: object): value is EmojiCandidateDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('url' in value) || value['url'] === undefined) return false;\n    if (!('animated' in value) || value['animated'] === undefined) return false;\n    return true;\n}\n\nexport function EmojiCandidateDtoFromJSON(json: any): EmojiCandidateDto {\n    return EmojiCandidateDtoFromJSONTyped(json, false);\n}\n\nexport function EmojiCandidateDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): EmojiCandidateDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'url': json['url'],\n        'animated': json['animated'],\n    };\n}\n\nexport function EmojiCandidateDtoToJSON(value?: EmojiCandidateDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'url': value['url'],\n        'animated': value['animated'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface EmojiDto\n */\nexport interface EmojiDto {\n    /**\n     * Emoji name\n     * @type {string}\n     * @memberof EmojiDto\n     */\n    name: string;\n    /**\n     * Emoji url\n     * @type {string}\n     * @memberof EmojiDto\n     */\n    url: string;\n    /**\n     * Whether emoji is animated or static\n     * @type {boolean}\n     * @memberof EmojiDto\n     */\n    animated: boolean;\n    /**\n     * Emoji name id appendix\n     * @type {number}\n     * @memberof EmojiDto\n     */\n    nameId: number;\n}\n\n/**\n * Check if a given object implements the EmojiDto interface.\n */\nexport function instanceOfEmojiDto(value: object): value is EmojiDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('url' in value) || value['url'] === undefined) return false;\n    if (!('animated' in value) || value['animated'] === undefined) return false;\n    if (!('nameId' in value) || value['nameId'] === undefined) return false;\n    return true;\n}\n\nexport function EmojiDtoFromJSON(json: any): EmojiDto {\n    return EmojiDtoFromJSONTyped(json, false);\n}\n\nexport function EmojiDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): EmojiDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'url': json['url'],\n        'animated': json['animated'],\n        'nameId': json['nameId'],\n    };\n}\n\nexport function EmojiDtoToJSON(value?: EmojiDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'url': value['url'],\n        'animated': value['animated'],\n        'nameId': value['nameId'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface EventDto\n */\nexport interface EventDto {\n    /**\n     * Event name\n     * @type {string}\n     * @memberof EventDto\n     */\n    name: string;\n    /**\n     * Event unique ID\n     * @type {number}\n     * @memberof EventDto\n     */\n    id: number;\n    /**\n     * Event description\n     * @type {string}\n     * @memberof EventDto\n     */\n    description: string;\n    /**\n     * Event start date\n     * @type {string}\n     * @memberof EventDto\n     */\n    eventStart: string;\n    /**\n     * Event length in days\n     * @type {number}\n     * @memberof EventDto\n     */\n    eventLength: number;\n}\n\n/**\n * Check if a given object implements the EventDto interface.\n */\nexport function instanceOfEventDto(value: object): value is EventDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('description' in value) || value['description'] === undefined) return false;\n    if (!('eventStart' in value) || value['eventStart'] === undefined) return false;\n    if (!('eventLength' in value) || value['eventLength'] === undefined) return false;\n    return true;\n}\n\nexport function EventDtoFromJSON(json: any): EventDto {\n    return EventDtoFromJSONTyped(json, false);\n}\n\nexport function EventDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): EventDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'id': json['id'],\n        'description': json['description'],\n        'eventStart': json['eventStart'],\n        'eventLength': json['eventLength'],\n    };\n}\n\nexport function EventDtoToJSON(value?: EventDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'id': value['id'],\n        'description': value['description'],\n        'eventStart': value['eventStart'],\n        'eventLength': value['eventLength'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { EventDto } from './EventDto';\nimport {\n    EventDtoFromJSON,\n    EventDtoFromJSONTyped,\n    EventDtoToJSON,\n} from './EventDto';\n\n/**\n * \n * @export\n * @interface EventDropDto\n */\nexport interface EventDropDto {\n    /**\n     * Unique event drop ID\n     * @type {number}\n     * @memberof EventDropDto\n     */\n    id: number;\n    /**\n     * Drop name\n     * @type {string}\n     * @memberof EventDropDto\n     */\n    name: string;\n    /**\n     * Drop URL\n     * @type {string}\n     * @memberof EventDropDto\n     */\n    url: string;\n    /**\n     * Associated event\n     * @type {EventDto}\n     * @memberof EventDropDto\n     */\n    event: EventDto;\n}\n\n/**\n * Check if a given object implements the EventDropDto interface.\n */\nexport function instanceOfEventDropDto(value: object): value is EventDropDto {\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('url' in value) || value['url'] === undefined) return false;\n    if (!('event' in value) || value['event'] === undefined) return false;\n    return true;\n}\n\nexport function EventDropDtoFromJSON(json: any): EventDropDto {\n    return EventDropDtoFromJSONTyped(json, false);\n}\n\nexport function EventDropDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): EventDropDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'id': json['id'],\n        'name': json['name'],\n        'url': json['url'],\n        'event': EventDtoFromJSON(json['event']),\n    };\n}\n\nexport function EventDropDtoToJSON(value?: EventDropDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'id': value['id'],\n        'name': value['name'],\n        'url': value['url'],\n        'event': EventDtoToJSON(value['event']),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface GuildDto\n */\nexport interface GuildDto {\n    /**\n     * The guild's ID\n     * @type {string}\n     * @memberof GuildDto\n     */\n    guildID: string;\n    /**\n     * The guild's Palantir token\n     * @type {number}\n     * @memberof GuildDto\n     */\n    invite: number;\n    /**\n     * The guild's name\n     * @type {string}\n     * @memberof GuildDto\n     */\n    guildName: string;\n}\n\n/**\n * Check if a given object implements the GuildDto interface.\n */\nexport function instanceOfGuildDto(value: object): value is GuildDto {\n    if (!('guildID' in value) || value['guildID'] === undefined) return false;\n    if (!('invite' in value) || value['invite'] === undefined) return false;\n    if (!('guildName' in value) || value['guildName'] === undefined) return false;\n    return true;\n}\n\nexport function GuildDtoFromJSON(json: any): GuildDto {\n    return GuildDtoFromJSONTyped(json, false);\n}\n\nexport function GuildDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): GuildDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'guildID': json['GuildID'],\n        'invite': json['Invite'],\n        'guildName': json['GuildName'],\n    };\n}\n\nexport function GuildDtoToJSON(value?: GuildDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'GuildID': value['guildID'],\n        'Invite': value['invite'],\n        'GuildName': value['guildName'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface GuildInviteDto\n */\nexport interface GuildInviteDto {\n    /**\n     * Name of the server\n     * @type {string}\n     * @memberof GuildInviteDto\n     */\n    name: string;\n    /**\n     * Palantir connection token of the server\n     * @type {number}\n     * @memberof GuildInviteDto\n     */\n    token: number;\n    /**\n     * Current icon url of the guild\n     * @type {string}\n     * @memberof GuildInviteDto\n     */\n    iconUrl: string;\n    /**\n     * Amount of connected members\n     * @type {number}\n     * @memberof GuildInviteDto\n     */\n    connectedMembers: number;\n}\n\n/**\n * Check if a given object implements the GuildInviteDto interface.\n */\nexport function instanceOfGuildInviteDto(value: object): value is GuildInviteDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('token' in value) || value['token'] === undefined) return false;\n    if (!('iconUrl' in value) || value['iconUrl'] === undefined) return false;\n    if (!('connectedMembers' in value) || value['connectedMembers'] === undefined) return false;\n    return true;\n}\n\nexport function GuildInviteDtoFromJSON(json: any): GuildInviteDto {\n    return GuildInviteDtoFromJSONTyped(json, false);\n}\n\nexport function GuildInviteDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): GuildInviteDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'token': json['token'],\n        'iconUrl': json['iconUrl'],\n        'connectedMembers': json['connectedMembers'],\n    };\n}\n\nexport function GuildInviteDtoToJSON(value?: GuildInviteDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'token': value['token'],\n        'iconUrl': value['iconUrl'],\n        'connectedMembers': value['connectedMembers'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { GuildDto } from './GuildDto';\nimport {\n    GuildDtoFromJSON,\n    GuildDtoFromJSONTyped,\n    GuildDtoToJSON,\n} from './GuildDto';\n\n/**\n * \n * @export\n * @interface MemberDto\n */\nexport interface MemberDto {\n    /**\n     * The member's plain bubbles\n     * @type {number}\n     * @memberof MemberDto\n     */\n    bubbles: number;\n    /**\n     * The member's regular drops\n     * @type {number}\n     * @memberof MemberDto\n     */\n    drops: number;\n    /**\n     * The member's sprite inventory\n     * @type {string}\n     * @memberof MemberDto\n     */\n    sprites: string;\n    /**\n     * The member's scene inventory\n     * @type {string}\n     * @memberof MemberDto\n     */\n    scenes: string;\n    /**\n     * The member's flag config\n     * @type {number}\n     * @memberof MemberDto\n     */\n    flags: number;\n    /**\n     * The member's rainbow sprite config\n     * @type {string}\n     * @memberof MemberDto\n     */\n    rainbowSprites: string;\n    /**\n     * The member's connected discord account id\n     * @type {string}\n     * @memberof MemberDto\n     */\n    discordID: string;\n    /**\n     * The member's palantir accunt user name\n     * @type {string}\n     * @memberof MemberDto\n     */\n    userName: string;\n    /**\n     * The member's palantir identification\n     * @type {string}\n     * @memberof MemberDto\n     */\n    userLogin: string;\n    /**\n     * The member's palantir identification\n     * @type {Array<GuildDto>}\n     * @memberof MemberDto\n     */\n    guilds: Array<GuildDto>;\n    /**\n     * The raw database member result\n     * @type {object}\n     * @memberof MemberDto\n     */\n    rawMember: object;\n    /**\n     * Enum array containing the flags of the member\n     * @type {Array<string>}\n     * @memberof MemberDto\n     */\n    memberFlags: Array<MemberDtoMemberFlagsEnum>;\n}\n\n\n/**\n * @export\n */\nexport const MemberDtoMemberFlagsEnum = {\n    Admin: 'Admin',\n    Moderator: 'Moderator',\n    Patron: 'Patron',\n    Patronizer: 'Patronizer',\n    Booster: 'Booster',\n    DropBan: 'DropBan',\n    PermaBan: 'PermaBan',\n    Beta: 'Beta',\n    BubbleFarming: 'BubbleFarming',\n    UnlimitedCloud: 'UnlimitedCloud',\n    ContentModerator: 'ContentModerator',\n    EmojiManagement: 'EmojiManagement'\n} as const;\nexport type MemberDtoMemberFlagsEnum = typeof MemberDtoMemberFlagsEnum[keyof typeof MemberDtoMemberFlagsEnum];\n\n\n/**\n * Check if a given object implements the MemberDto interface.\n */\nexport function instanceOfMemberDto(value: object): value is MemberDto {\n    if (!('bubbles' in value) || value['bubbles'] === undefined) return false;\n    if (!('drops' in value) || value['drops'] === undefined) return false;\n    if (!('sprites' in value) || value['sprites'] === undefined) return false;\n    if (!('scenes' in value) || value['scenes'] === undefined) return false;\n    if (!('flags' in value) || value['flags'] === undefined) return false;\n    if (!('rainbowSprites' in value) || value['rainbowSprites'] === undefined) return false;\n    if (!('discordID' in value) || value['discordID'] === undefined) return false;\n    if (!('userName' in value) || value['userName'] === undefined) return false;\n    if (!('userLogin' in value) || value['userLogin'] === undefined) return false;\n    if (!('guilds' in value) || value['guilds'] === undefined) return false;\n    if (!('rawMember' in value) || value['rawMember'] === undefined) return false;\n    if (!('memberFlags' in value) || value['memberFlags'] === undefined) return false;\n    return true;\n}\n\nexport function MemberDtoFromJSON(json: any): MemberDto {\n    return MemberDtoFromJSONTyped(json, false);\n}\n\nexport function MemberDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): MemberDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'bubbles': json['bubbles'],\n        'drops': json['drops'],\n        'sprites': json['sprites'],\n        'scenes': json['scenes'],\n        'flags': json['flags'],\n        'rainbowSprites': json['rainbowSprites'],\n        'discordID': json['discordID'],\n        'userName': json['userName'],\n        'userLogin': json['userLogin'],\n        'guilds': ((json['guilds'] as Array<any>).map(GuildDtoFromJSON)),\n        'rawMember': json['rawMember'],\n        'memberFlags': json['memberFlags'],\n    };\n}\n\nexport function MemberDtoToJSON(value?: MemberDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'bubbles': value['bubbles'],\n        'drops': value['drops'],\n        'sprites': value['sprites'],\n        'scenes': value['scenes'],\n        'flags': value['flags'],\n        'rainbowSprites': value['rainbowSprites'],\n        'discordID': value['discordID'],\n        'userName': value['userName'],\n        'userLogin': value['userLogin'],\n        'guilds': ((value['guilds'] as Array<any>).map(GuildDtoToJSON)),\n        'rawMember': value['rawMember'],\n        'memberFlags': value['memberFlags'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface MemberSearchDto\n */\nexport interface MemberSearchDto {\n    /**\n     * The member's palantir accunt user name\n     * @type {string}\n     * @memberof MemberSearchDto\n     */\n    userName: string;\n    /**\n     * The member's palantir identification\n     * @type {string}\n     * @memberof MemberSearchDto\n     */\n    userLogin: string;\n    /**\n     * The raw database member result\n     * @type {object}\n     * @memberof MemberSearchDto\n     */\n    rawMember: object;\n}\n\n/**\n * Check if a given object implements the MemberSearchDto interface.\n */\nexport function instanceOfMemberSearchDto(value: object): value is MemberSearchDto {\n    if (!('userName' in value) || value['userName'] === undefined) return false;\n    if (!('userLogin' in value) || value['userLogin'] === undefined) return false;\n    if (!('rawMember' in value) || value['rawMember'] === undefined) return false;\n    return true;\n}\n\nexport function MemberSearchDtoFromJSON(json: any): MemberSearchDto {\n    return MemberSearchDtoFromJSONTyped(json, false);\n}\n\nexport function MemberSearchDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): MemberSearchDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'userName': json['userName'],\n        'userLogin': json['userLogin'],\n        'rawMember': json['rawMember'],\n    };\n}\n\nexport function MemberSearchDtoToJSON(value?: MemberSearchDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'userName': value['userName'],\n        'userLogin': value['userLogin'],\n        'rawMember': value['rawMember'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { GuildDto } from './GuildDto';\nimport {\n    GuildDtoFromJSON,\n    GuildDtoFromJSONTyped,\n    GuildDtoToJSON,\n} from './GuildDto';\n\n/**\n * \n * @export\n * @interface MemberWebhookDto\n */\nexport interface MemberWebhookDto {\n    /**\n     * The webhook name\n     * @type {string}\n     * @memberof MemberWebhookDto\n     */\n    name: string;\n    /**\n     * The webhook's guild\n     * @type {GuildDto}\n     * @memberof MemberWebhookDto\n     */\n    guild: GuildDto;\n}\n\n/**\n * Check if a given object implements the MemberWebhookDto interface.\n */\nexport function instanceOfMemberWebhookDto(value: object): value is MemberWebhookDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('guild' in value) || value['guild'] === undefined) return false;\n    return true;\n}\n\nexport function MemberWebhookDtoFromJSON(json: any): MemberWebhookDto {\n    return MemberWebhookDtoFromJSONTyped(json, false);\n}\n\nexport function MemberWebhookDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): MemberWebhookDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['Name'],\n        'guild': GuildDtoFromJSON(json['Guild']),\n    };\n}\n\nexport function MemberWebhookDtoToJSON(value?: MemberWebhookDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'Name': value['name'],\n        'Guild': GuildDtoToJSON(value['guild']),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface PostImageDto\n */\nexport interface PostImageDto {\n    /**\n     * Image title\n     * @type {string}\n     * @memberof PostImageDto\n     */\n    title: string;\n    /**\n     * Image author\n     * @type {string}\n     * @memberof PostImageDto\n     */\n    author: string;\n    /**\n     * Image poster name\n     * @type {string}\n     * @memberof PostImageDto\n     */\n    posterName: string;\n    /**\n     * Post only image without embed\n     * @type {boolean}\n     * @memberof PostImageDto\n     */\n    onlyImage: boolean;\n    /**\n     * Base64 url representation of the image\n     * @type {string}\n     * @memberof PostImageDto\n     */\n    imageBase64: string;\n}\n\n/**\n * Check if a given object implements the PostImageDto interface.\n */\nexport function instanceOfPostImageDto(value: object): value is PostImageDto {\n    if (!('title' in value) || value['title'] === undefined) return false;\n    if (!('author' in value) || value['author'] === undefined) return false;\n    if (!('posterName' in value) || value['posterName'] === undefined) return false;\n    if (!('onlyImage' in value) || value['onlyImage'] === undefined) return false;\n    if (!('imageBase64' in value) || value['imageBase64'] === undefined) return false;\n    return true;\n}\n\nexport function PostImageDtoFromJSON(json: any): PostImageDto {\n    return PostImageDtoFromJSONTyped(json, false);\n}\n\nexport function PostImageDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): PostImageDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'title': json['title'],\n        'author': json['author'],\n        'posterName': json['posterName'],\n        'onlyImage': json['onlyImage'],\n        'imageBase64': json['imageBase64'],\n    };\n}\n\nexport function PostImageDtoToJSON(value?: PostImageDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'title': value['title'],\n        'author': value['author'],\n        'posterName': value['posterName'],\n        'onlyImage': value['onlyImage'],\n        'imageBase64': value['imageBase64'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface SceneThemeDto\n */\nexport interface SceneThemeDto {\n    /**\n     * Scene theme name\n     * @type {string}\n     * @memberof SceneThemeDto\n     */\n    name: string;\n    /**\n     * Scene shift identification\n     * @type {number}\n     * @memberof SceneThemeDto\n     */\n    shift: number;\n}\n\n/**\n * Check if a given object implements the SceneThemeDto interface.\n */\nexport function instanceOfSceneThemeDto(value: object): value is SceneThemeDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('shift' in value) || value['shift'] === undefined) return false;\n    return true;\n}\n\nexport function SceneThemeDtoFromJSON(json: any): SceneThemeDto {\n    return SceneThemeDtoFromJSONTyped(json, false);\n}\n\nexport function SceneThemeDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SceneThemeDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'shift': json['shift'],\n    };\n}\n\nexport function SceneThemeDtoToJSON(value?: SceneThemeDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'shift': value['shift'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { EventDto } from './EventDto';\nimport {\n    EventDtoFromJSON,\n    EventDtoFromJSONTyped,\n    EventDtoToJSON,\n} from './EventDto';\nimport type { SceneThemeDto } from './SceneThemeDto';\nimport {\n    SceneThemeDtoFromJSON,\n    SceneThemeDtoFromJSONTyped,\n    SceneThemeDtoToJSON,\n} from './SceneThemeDto';\n\n/**\n * \n * @export\n * @interface SceneDto\n */\nexport interface SceneDto {\n    /**\n     * Scene name\n     * @type {string}\n     * @memberof SceneDto\n     */\n    name: string;\n    /**\n     * Scene unique ID\n     * @type {number}\n     * @memberof SceneDto\n     */\n    id: number;\n    /**\n     * Scene url\n     * @type {string}\n     * @memberof SceneDto\n     */\n    url: string;\n    /**\n     * Scene exclusiveness flag, cant be bought regulary or as event scene\n     * @type {boolean}\n     * @memberof SceneDto\n     */\n    exclusive: boolean;\n    /**\n     * Associated event\n     * @type {EventDto}\n     * @memberof SceneDto\n     */\n    event?: EventDto;\n    /**\n     * Primary text color\n     * @type {string}\n     * @memberof SceneDto\n     */\n    primaryColor?: string;\n    /**\n     * Guessed text color\n     * @type {string}\n     * @memberof SceneDto\n     */\n    guessedColor?: string;\n    /**\n     * Scene artist name\n     * @type {string}\n     * @memberof SceneDto\n     */\n    artist?: string;\n    /**\n     * Available themes for the scene\n     * @type {Array<SceneThemeDto>}\n     * @memberof SceneDto\n     */\n    themes: Array<SceneThemeDto>;\n}\n\n/**\n * Check if a given object implements the SceneDto interface.\n */\nexport function instanceOfSceneDto(value: object): value is SceneDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('url' in value) || value['url'] === undefined) return false;\n    if (!('exclusive' in value) || value['exclusive'] === undefined) return false;\n    if (!('themes' in value) || value['themes'] === undefined) return false;\n    return true;\n}\n\nexport function SceneDtoFromJSON(json: any): SceneDto {\n    return SceneDtoFromJSONTyped(json, false);\n}\n\nexport function SceneDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SceneDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'id': json['id'],\n        'url': json['url'],\n        'exclusive': json['exclusive'],\n        'event': json['event'] == null ? undefined : EventDtoFromJSON(json['event']),\n        'primaryColor': json['primaryColor'] == null ? undefined : json['primaryColor'],\n        'guessedColor': json['guessedColor'] == null ? undefined : json['guessedColor'],\n        'artist': json['artist'] == null ? undefined : json['artist'],\n        'themes': ((json['themes'] as Array<any>).map(SceneThemeDtoFromJSON)),\n    };\n}\n\nexport function SceneDtoToJSON(value?: SceneDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'id': value['id'],\n        'url': value['url'],\n        'exclusive': value['exclusive'],\n        'event': EventDtoToJSON(value['event']),\n        'primaryColor': value['primaryColor'],\n        'guessedColor': value['guessedColor'],\n        'artist': value['artist'],\n        'themes': ((value['themes'] as Array<any>).map(SceneThemeDtoToJSON)),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface SceneInventoryItemDto\n */\nexport interface SceneInventoryItemDto {\n    /**\n     * A scene Id\n     * @type {number}\n     * @memberof SceneInventoryItemDto\n     */\n    sceneId: number;\n    /**\n     * A scene theme shift identification\n     * @type {number}\n     * @memberof SceneInventoryItemDto\n     */\n    sceneShift?: number;\n}\n\n/**\n * Check if a given object implements the SceneInventoryItemDto interface.\n */\nexport function instanceOfSceneInventoryItemDto(value: object): value is SceneInventoryItemDto {\n    if (!('sceneId' in value) || value['sceneId'] === undefined) return false;\n    return true;\n}\n\nexport function SceneInventoryItemDtoFromJSON(json: any): SceneInventoryItemDto {\n    return SceneInventoryItemDtoFromJSONTyped(json, false);\n}\n\nexport function SceneInventoryItemDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SceneInventoryItemDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'sceneId': json['sceneId'],\n        'sceneShift': json['sceneShift'] == null ? undefined : json['sceneShift'],\n    };\n}\n\nexport function SceneInventoryItemDtoToJSON(value?: SceneInventoryItemDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'sceneId': value['sceneId'],\n        'sceneShift': value['sceneShift'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { SceneInventoryItemDto } from './SceneInventoryItemDto';\nimport {\n    SceneInventoryItemDtoFromJSON,\n    SceneInventoryItemDtoFromJSONTyped,\n    SceneInventoryItemDtoToJSON,\n} from './SceneInventoryItemDto';\n\n/**\n * \n * @export\n * @interface SceneInventoryDto\n */\nexport interface SceneInventoryDto {\n    /**\n     * The activated scene Id\n     * @type {number}\n     * @memberof SceneInventoryDto\n     */\n    activeId?: number;\n    /**\n     * The activated scene theme Id\n     * @type {number}\n     * @memberof SceneInventoryDto\n     */\n    activeShift?: number;\n    /**\n     * The scenes in the inventory\n     * @type {Array<SceneInventoryItemDto>}\n     * @memberof SceneInventoryDto\n     */\n    scenes: Array<SceneInventoryItemDto>;\n}\n\n/**\n * Check if a given object implements the SceneInventoryDto interface.\n */\nexport function instanceOfSceneInventoryDto(value: object): value is SceneInventoryDto {\n    if (!('scenes' in value) || value['scenes'] === undefined) return false;\n    return true;\n}\n\nexport function SceneInventoryDtoFromJSON(json: any): SceneInventoryDto {\n    return SceneInventoryDtoFromJSONTyped(json, false);\n}\n\nexport function SceneInventoryDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SceneInventoryDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'activeId': json['activeId'] == null ? undefined : json['activeId'],\n        'activeShift': json['activeShift'] == null ? undefined : json['activeShift'],\n        'scenes': ((json['scenes'] as Array<any>).map(SceneInventoryItemDtoFromJSON)),\n    };\n}\n\nexport function SceneInventoryDtoToJSON(value?: SceneInventoryDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'activeId': value['activeId'],\n        'activeShift': value['activeShift'],\n        'scenes': ((value['scenes'] as Array<any>).map(SceneInventoryItemDtoToJSON)),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { SceneInventoryItemDto } from './SceneInventoryItemDto';\nimport {\n    SceneInventoryItemDtoFromJSON,\n    SceneInventoryItemDtoFromJSONTyped,\n    SceneInventoryItemDtoToJSON,\n} from './SceneInventoryItemDto';\n\n/**\n * \n * @export\n * @interface SetActiveSceneDto\n */\nexport interface SetActiveSceneDto {\n    /**\n     * The scene to activate\n     * @type {SceneInventoryItemDto}\n     * @memberof SetActiveSceneDto\n     */\n    scene?: SceneInventoryItemDto;\n}\n\n/**\n * Check if a given object implements the SetActiveSceneDto interface.\n */\nexport function instanceOfSetActiveSceneDto(value: object): value is SetActiveSceneDto {\n    return true;\n}\n\nexport function SetActiveSceneDtoFromJSON(json: any): SetActiveSceneDto {\n    return SetActiveSceneDtoFromJSONTyped(json, false);\n}\n\nexport function SetActiveSceneDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SetActiveSceneDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'scene': json['scene'] == null ? undefined : SceneInventoryItemDtoFromJSON(json['scene']),\n    };\n}\n\nexport function SetActiveSceneDtoToJSON(value?: SetActiveSceneDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'scene': SceneInventoryItemDtoToJSON(value['scene']),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface SpriteSlotDto\n */\nexport interface SpriteSlotDto {\n    /**\n     * A sprite slot number, starting at 1\n     * @type {number}\n     * @memberof SpriteSlotDto\n     */\n    slotId: number;\n    /**\n     * The target sprite Id, undefined to use no sprite\n     * @type {number}\n     * @memberof SpriteSlotDto\n     */\n    spriteId?: number;\n}\n\n/**\n * Check if a given object implements the SpriteSlotDto interface.\n */\nexport function instanceOfSpriteSlotDto(value: object): value is SpriteSlotDto {\n    if (!('slotId' in value) || value['slotId'] === undefined) return false;\n    return true;\n}\n\nexport function SpriteSlotDtoFromJSON(json: any): SpriteSlotDto {\n    return SpriteSlotDtoFromJSONTyped(json, false);\n}\n\nexport function SpriteSlotDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SpriteSlotDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'slotId': json['slotId'],\n        'spriteId': json['spriteId'] == null ? undefined : json['spriteId'],\n    };\n}\n\nexport function SpriteSlotDtoToJSON(value?: SpriteSlotDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'slotId': value['slotId'],\n        'spriteId': value['spriteId'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { SpriteSlotDto } from './SpriteSlotDto';\nimport {\n    SpriteSlotDtoFromJSON,\n    SpriteSlotDtoFromJSONTyped,\n    SpriteSlotDtoToJSON,\n} from './SpriteSlotDto';\n\n/**\n * \n * @export\n * @interface SpriteComboDto\n */\nexport interface SpriteComboDto {\n    /**\n     * The sprite slots that will be the new user sprite combo\n     * @type {Array<SpriteSlotDto>}\n     * @memberof SpriteComboDto\n     */\n    slots: Array<SpriteSlotDto>;\n}\n\n/**\n * Check if a given object implements the SpriteComboDto interface.\n */\nexport function instanceOfSpriteComboDto(value: object): value is SpriteComboDto {\n    if (!('slots' in value) || value['slots'] === undefined) return false;\n    return true;\n}\n\nexport function SpriteComboDtoFromJSON(json: any): SpriteComboDto {\n    return SpriteComboDtoFromJSONTyped(json, false);\n}\n\nexport function SpriteComboDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SpriteComboDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'slots': ((json['slots'] as Array<any>).map(SpriteSlotDtoFromJSON)),\n    };\n}\n\nexport function SpriteComboDtoToJSON(value?: SpriteComboDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'slots': ((value['slots'] as Array<any>).map(SpriteSlotDtoToJSON)),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { EventDropDto } from './EventDropDto';\nimport {\n    EventDropDtoFromJSON,\n    EventDropDtoFromJSONTyped,\n    EventDropDtoToJSON,\n} from './EventDropDto';\n\n/**\n * \n * @export\n * @interface SpriteDto\n */\nexport interface SpriteDto {\n    /**\n     * Sprite name\n     * @type {string}\n     * @memberof SpriteDto\n     */\n    name: string;\n    /**\n     * Sprite unique ID\n     * @type {number}\n     * @memberof SpriteDto\n     */\n    id: number;\n    /**\n     * Sprite cost in bubbles or eventdrops\n     * @type {number}\n     * @memberof SpriteDto\n     */\n    cost: number;\n    /**\n     * Sprite url\n     * @type {string}\n     * @memberof SpriteDto\n     */\n    url: string;\n    /**\n     * Associated event drop\n     * @type {EventDropDto}\n     * @memberof SpriteDto\n     */\n    eventDrop?: EventDropDto;\n    /**\n     * Flag for rainbow shift\n     * @type {boolean}\n     * @memberof SpriteDto\n     */\n    isRainbowAllowed: boolean;\n    /**\n     * Flag for special sprite\n     * @type {boolean}\n     * @memberof SpriteDto\n     */\n    isSpecial: boolean;\n    /**\n     * Sprite artist name\n     * @type {string}\n     * @memberof SpriteDto\n     */\n    artist?: string;\n    /**\n     * Flags where at least one must be fulfilled to buy the sprite\n     * @type {Array<string>}\n     * @memberof SpriteDto\n     */\n    requiredFlags: Array<string>;\n}\n\n/**\n * Check if a given object implements the SpriteDto interface.\n */\nexport function instanceOfSpriteDto(value: object): value is SpriteDto {\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('cost' in value) || value['cost'] === undefined) return false;\n    if (!('url' in value) || value['url'] === undefined) return false;\n    if (!('isRainbowAllowed' in value) || value['isRainbowAllowed'] === undefined) return false;\n    if (!('isSpecial' in value) || value['isSpecial'] === undefined) return false;\n    if (!('requiredFlags' in value) || value['requiredFlags'] === undefined) return false;\n    return true;\n}\n\nexport function SpriteDtoFromJSON(json: any): SpriteDto {\n    return SpriteDtoFromJSONTyped(json, false);\n}\n\nexport function SpriteDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SpriteDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'name': json['name'],\n        'id': json['id'],\n        'cost': json['cost'],\n        'url': json['url'],\n        'eventDrop': json['eventDrop'] == null ? undefined : EventDropDtoFromJSON(json['eventDrop']),\n        'isRainbowAllowed': json['isRainbowAllowed'],\n        'isSpecial': json['isSpecial'],\n        'artist': json['artist'] == null ? undefined : json['artist'],\n        'requiredFlags': json['requiredFlags'],\n    };\n}\n\nexport function SpriteDtoToJSON(value?: SpriteDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'name': value['name'],\n        'id': value['id'],\n        'cost': value['cost'],\n        'url': value['url'],\n        'eventDrop': EventDropDtoToJSON(value['eventDrop']),\n        'isRainbowAllowed': value['isRainbowAllowed'],\n        'isSpecial': value['isSpecial'],\n        'artist': value['artist'],\n        'requiredFlags': value['requiredFlags'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface SpriteInventoryDto\n */\nexport interface SpriteInventoryDto {\n    /**\n     * A sprite slot number, starting at 1, or undefined if sprite is not active\n     * @type {number}\n     * @memberof SpriteInventoryDto\n     */\n    slot?: number;\n    /**\n     * A sprite Id\n     * @type {number}\n     * @memberof SpriteInventoryDto\n     */\n    spriteId: number;\n    /**\n     * A rainbow sprite color shift\n     * @type {number}\n     * @memberof SpriteInventoryDto\n     */\n    colorShift?: number;\n}\n\n/**\n * Check if a given object implements the SpriteInventoryDto interface.\n */\nexport function instanceOfSpriteInventoryDto(value: object): value is SpriteInventoryDto {\n    if (!('spriteId' in value) || value['spriteId'] === undefined) return false;\n    return true;\n}\n\nexport function SpriteInventoryDtoFromJSON(json: any): SpriteInventoryDto {\n    return SpriteInventoryDtoFromJSONTyped(json, false);\n}\n\nexport function SpriteInventoryDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SpriteInventoryDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'slot': json['slot'] == null ? undefined : json['slot'],\n        'spriteId': json['spriteId'],\n        'colorShift': json['colorShift'] == null ? undefined : json['colorShift'],\n    };\n}\n\nexport function SpriteInventoryDtoToJSON(value?: SpriteInventoryDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'slot': value['slot'],\n        'spriteId': value['spriteId'],\n        'colorShift': value['colorShift'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface SpriteSlotCountDto\n */\nexport interface SpriteSlotCountDto {\n    /**\n     * The amount of unlocked srite slots\n     * @type {number}\n     * @memberof SpriteSlotCountDto\n     */\n    unlockedSlots: number;\n}\n\n/**\n * Check if a given object implements the SpriteSlotCountDto interface.\n */\nexport function instanceOfSpriteSlotCountDto(value: object): value is SpriteSlotCountDto {\n    if (!('unlockedSlots' in value) || value['unlockedSlots'] === undefined) return false;\n    return true;\n}\n\nexport function SpriteSlotCountDtoFromJSON(json: any): SpriteSlotCountDto {\n    return SpriteSlotCountDtoFromJSONTyped(json, false);\n}\n\nexport function SpriteSlotCountDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): SpriteSlotCountDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'unlockedSlots': json['unlockedSlots'],\n    };\n}\n\nexport function SpriteSlotCountDtoToJSON(value?: SpriteSlotCountDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'unlockedSlots': value['unlockedSlots'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface ThemeMetaDto\n */\nexport interface ThemeMetaDto {\n    /**\n     * Name of the theme creator\n     * @type {string}\n     * @memberof ThemeMetaDto\n     */\n    author: string;\n    /**\n     * Unix epoch ms representing the creation date\n     * @type {number}\n     * @memberof ThemeMetaDto\n     */\n    created: number;\n    /**\n     * Item type\n     * @type {string}\n     * @memberof ThemeMetaDto\n     */\n    type: string;\n    /**\n     * Local item id\n     * @type {number}\n     * @memberof ThemeMetaDto\n     */\n    id: number;\n    /**\n     * Name of the theme\n     * @type {string}\n     * @memberof ThemeMetaDto\n     */\n    name: string;\n}\n\n/**\n * Check if a given object implements the ThemeMetaDto interface.\n */\nexport function instanceOfThemeMetaDto(value: object): value is ThemeMetaDto {\n    if (!('author' in value) || value['author'] === undefined) return false;\n    if (!('created' in value) || value['created'] === undefined) return false;\n    if (!('type' in value) || value['type'] === undefined) return false;\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('name' in value) || value['name'] === undefined) return false;\n    return true;\n}\n\nexport function ThemeMetaDtoFromJSON(json: any): ThemeMetaDto {\n    return ThemeMetaDtoFromJSONTyped(json, false);\n}\n\nexport function ThemeMetaDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): ThemeMetaDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'author': json['author'],\n        'created': json['created'],\n        'type': json['type'],\n        'id': json['id'],\n        'name': json['name'],\n    };\n}\n\nexport function ThemeMetaDtoToJSON(value?: ThemeMetaDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'author': value['author'],\n        'created': value['created'],\n        'type': value['type'],\n        'id': value['id'],\n        'name': value['name'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\nimport type { ThemeMetaDto } from './ThemeMetaDto';\nimport {\n    ThemeMetaDtoFromJSON,\n    ThemeMetaDtoFromJSONTyped,\n    ThemeMetaDtoToJSON,\n} from './ThemeMetaDto';\n\n/**\n * \n * @export\n * @interface ThemeDto\n */\nexport interface ThemeDto {\n    /**\n     * Skribbl color hooks settings\n     * @type {object}\n     * @memberof ThemeDto\n     */\n    colors: object;\n    /**\n     * Skribbl color hooks additional styles\n     * @type {object}\n     * @memberof ThemeDto\n     */\n    hooks: object;\n    /**\n     * Image settings\n     * @type {object}\n     * @memberof ThemeDto\n     */\n    images: object;\n    /**\n     * Miscellaneous settings\n     * @type {object}\n     * @memberof ThemeDto\n     */\n    misc: object;\n    /**\n     * Theme metadata\n     * @type {ThemeMetaDto}\n     * @memberof ThemeDto\n     */\n    meta: ThemeMetaDto;\n}\n\n/**\n * Check if a given object implements the ThemeDto interface.\n */\nexport function instanceOfThemeDto(value: object): value is ThemeDto {\n    if (!('colors' in value) || value['colors'] === undefined) return false;\n    if (!('hooks' in value) || value['hooks'] === undefined) return false;\n    if (!('images' in value) || value['images'] === undefined) return false;\n    if (!('misc' in value) || value['misc'] === undefined) return false;\n    if (!('meta' in value) || value['meta'] === undefined) return false;\n    return true;\n}\n\nexport function ThemeDtoFromJSON(json: any): ThemeDto {\n    return ThemeDtoFromJSONTyped(json, false);\n}\n\nexport function ThemeDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): ThemeDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'colors': json['colors'],\n        'hooks': json['hooks'],\n        'images': json['images'],\n        'misc': json['misc'],\n        'meta': ThemeMetaDtoFromJSON(json['meta']),\n    };\n}\n\nexport function ThemeDtoToJSON(value?: ThemeDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'colors': value['colors'],\n        'hooks': value['hooks'],\n        'images': value['images'],\n        'misc': value['misc'],\n        'meta': ThemeMetaDtoToJSON(value['meta']),\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface ThemeListingDto\n */\nexport interface ThemeListingDto {\n    /**\n     * Public theme id / share\n     * @type {string}\n     * @memberof ThemeListingDto\n     */\n    id: string;\n    /**\n     * Amount of downloads\n     * @type {number}\n     * @memberof ThemeListingDto\n     */\n    downloads: number;\n    /**\n     * Version counter\n     * @type {number}\n     * @memberof ThemeListingDto\n     */\n    version: number;\n    /**\n     * Name of the theme\n     * @type {string}\n     * @memberof ThemeListingDto\n     */\n    name: string;\n    /**\n     * Name of the theme creator\n     * @type {string}\n     * @memberof ThemeListingDto\n     */\n    author: string;\n}\n\n/**\n * Check if a given object implements the ThemeListingDto interface.\n */\nexport function instanceOfThemeListingDto(value: object): value is ThemeListingDto {\n    if (!('id' in value) || value['id'] === undefined) return false;\n    if (!('downloads' in value) || value['downloads'] === undefined) return false;\n    if (!('version' in value) || value['version'] === undefined) return false;\n    if (!('name' in value) || value['name'] === undefined) return false;\n    if (!('author' in value) || value['author'] === undefined) return false;\n    return true;\n}\n\nexport function ThemeListingDtoFromJSON(json: any): ThemeListingDto {\n    return ThemeListingDtoFromJSONTyped(json, false);\n}\n\nexport function ThemeListingDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): ThemeListingDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'id': json['id'],\n        'downloads': json['downloads'],\n        'version': json['version'],\n        'name': json['name'],\n        'author': json['author'],\n    };\n}\n\nexport function ThemeListingDtoToJSON(value?: ThemeListingDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'id': value['id'],\n        'downloads': value['downloads'],\n        'version': value['version'],\n        'name': value['name'],\n        'author': value['author'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface ThemePublishRequestDto\n */\nexport interface ThemePublishRequestDto {\n    /**\n     * Creator discord id\n     * @type {string}\n     * @memberof ThemePublishRequestDto\n     */\n    owner: string;\n}\n\n/**\n * Check if a given object implements the ThemePublishRequestDto interface.\n */\nexport function instanceOfThemePublishRequestDto(value: object): value is ThemePublishRequestDto {\n    if (!('owner' in value) || value['owner'] === undefined) return false;\n    return true;\n}\n\nexport function ThemePublishRequestDtoFromJSON(json: any): ThemePublishRequestDto {\n    return ThemePublishRequestDtoFromJSONTyped(json, false);\n}\n\nexport function ThemePublishRequestDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): ThemePublishRequestDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'owner': json['owner'],\n    };\n}\n\nexport function ThemePublishRequestDtoToJSON(value?: ThemePublishRequestDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'owner': value['owner'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface ThemeShareDto\n */\nexport interface ThemeShareDto {\n    /**\n     * Public theme id / share\n     * @type {string}\n     * @memberof ThemeShareDto\n     */\n    id: string;\n}\n\n/**\n * Check if a given object implements the ThemeShareDto interface.\n */\nexport function instanceOfThemeShareDto(value: object): value is ThemeShareDto {\n    if (!('id' in value) || value['id'] === undefined) return false;\n    return true;\n}\n\nexport function ThemeShareDtoFromJSON(json: any): ThemeShareDto {\n    return ThemeShareDtoFromJSONTyped(json, false);\n}\n\nexport function ThemeShareDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): ThemeShareDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'id': json['id'],\n    };\n}\n\nexport function ThemeShareDtoToJSON(value?: ThemeShareDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'id': value['id'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface ThemeUpdateRequestDto\n */\nexport interface ThemeUpdateRequestDto {\n    /**\n     * The theme id of the updated theme\n     * @type {string}\n     * @memberof ThemeUpdateRequestDto\n     */\n    newId: string;\n}\n\n/**\n * Check if a given object implements the ThemeUpdateRequestDto interface.\n */\nexport function instanceOfThemeUpdateRequestDto(value: object): value is ThemeUpdateRequestDto {\n    if (!('newId' in value) || value['newId'] === undefined) return false;\n    return true;\n}\n\nexport function ThemeUpdateRequestDtoFromJSON(json: any): ThemeUpdateRequestDto {\n    return ThemeUpdateRequestDtoFromJSONTyped(json, false);\n}\n\nexport function ThemeUpdateRequestDtoFromJSONTyped(json: any, ignoreDiscriminator: boolean): ThemeUpdateRequestDto {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'newId': json['newId'],\n    };\n}\n\nexport function ThemeUpdateRequestDtoToJSON(value?: ThemeUpdateRequestDto | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'newId': value['newId'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\nimport { mapValues } from '../runtime';\n/**\n * \n * @export\n * @interface UpdateDiscordID\n */\nexport interface UpdateDiscordID {\n    /**\n     * The id of the new linked discord account\n     * @type {string}\n     * @memberof UpdateDiscordID\n     */\n    id: string;\n}\n\n/**\n * Check if a given object implements the UpdateDiscordID interface.\n */\nexport function instanceOfUpdateDiscordID(value: object): value is UpdateDiscordID {\n    if (!('id' in value) || value['id'] === undefined) return false;\n    return true;\n}\n\nexport function UpdateDiscordIDFromJSON(json: any): UpdateDiscordID {\n    return UpdateDiscordIDFromJSONTyped(json, false);\n}\n\nexport function UpdateDiscordIDFromJSONTyped(json: any, ignoreDiscriminator: boolean): UpdateDiscordID {\n    if (json == null) {\n        return json;\n    }\n    return {\n        \n        'id': json['id'],\n    };\n}\n\nexport function UpdateDiscordIDToJSON(value?: UpdateDiscordID | null): any {\n    if (value == null) {\n        return value;\n    }\n    return {\n        \n        'id': value['id'],\n    };\n}\n\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  AnnouncementDto,\n} from '../models/index';\nimport {\n    AnnouncementDtoFromJSON,\n    AnnouncementDtoToJSON,\n} from '../models/index';\n\n/**\n * \n */\nexport class AnnouncementsApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all announcements\n     */\n    async getAnnouncementsRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<AnnouncementDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/announcements`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(AnnouncementDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all announcements\n     */\n    async getAnnouncements(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<AnnouncementDto>> {\n        const response = await this.getAnnouncementsRaw(initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  AwardDto,\n} from '../models/index';\nimport {\n    AwardDtoFromJSON,\n    AwardDtoToJSON,\n} from '../models/index';\n\n/**\n * \n */\nexport class AwardsApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all awards\n     */\n    async getAllAwardsRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<AwardDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/awards`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(AwardDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all awards\n     */\n    async getAllAwards(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<AwardDto>> {\n        const response = await this.getAllAwardsRaw(initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  CloudDeleteDto,\n  CloudImageDto,\n  CloudSearchDto,\n  CloudUploadDto,\n  CloudUploadedDto,\n} from '../models/index';\nimport {\n    CloudDeleteDtoFromJSON,\n    CloudDeleteDtoToJSON,\n    CloudImageDtoFromJSON,\n    CloudImageDtoToJSON,\n    CloudSearchDtoFromJSON,\n    CloudSearchDtoToJSON,\n    CloudUploadDtoFromJSON,\n    CloudUploadDtoToJSON,\n    CloudUploadedDtoFromJSON,\n    CloudUploadedDtoToJSON,\n} from '../models/index';\n\nexport interface BulkDeleteFromUserCloudRequest {\n    login: number;\n    cloudDeleteDto: CloudDeleteDto;\n}\n\nexport interface DeleteImageFromUserCloudRequest {\n    login: number;\n    id: string;\n}\n\nexport interface GetImageFromUserCloudRequest {\n    login: number;\n    id: string;\n}\n\nexport interface LinkImageToAwardRequest {\n    login: number;\n    id: string;\n    token: number;\n}\n\nexport interface SearchUserCloudRequest {\n    login: number;\n    cloudSearchDto: CloudSearchDto;\n}\n\nexport interface UploadToUserCloudRequest {\n    login: number;\n    cloudUploadDto: CloudUploadDto;\n}\n\n/**\n * \n */\nexport class CloudApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Delete multiple images from the user\\'s cloud\n     */\n    async bulkDeleteFromUserCloudRaw(requestParameters: BulkDeleteFromUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling bulkDeleteFromUserCloud().'\n            );\n        }\n\n        if (requestParameters['cloudDeleteDto'] == null) {\n            throw new runtime.RequiredError(\n                'cloudDeleteDto',\n                'Required parameter \"cloudDeleteDto\" was null or undefined when calling bulkDeleteFromUserCloud().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/cloud/{login}/delete`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: CloudDeleteDtoToJSON(requestParameters['cloudDeleteDto']),\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Delete multiple images from the user\\'s cloud\n     */\n    async bulkDeleteFromUserCloud(requestParameters: BulkDeleteFromUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.bulkDeleteFromUserCloudRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Delete a image by id from the cloud\n     */\n    async deleteImageFromUserCloudRaw(requestParameters: DeleteImageFromUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling deleteImageFromUserCloud().'\n            );\n        }\n\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling deleteImageFromUserCloud().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/cloud/{login}/{id}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))).replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'DELETE',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Delete a image by id from the cloud\n     */\n    async deleteImageFromUserCloud(requestParameters: DeleteImageFromUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.deleteImageFromUserCloudRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get a image by id from the cloud\n     */\n    async getImageFromUserCloudRaw(requestParameters: GetImageFromUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<CloudImageDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getImageFromUserCloud().'\n            );\n        }\n\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getImageFromUserCloud().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/cloud/{login}/{id}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))).replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => CloudImageDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get a image by id from the cloud\n     */\n    async getImageFromUserCloud(requestParameters: GetImageFromUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<CloudImageDto> {\n        const response = await this.getImageFromUserCloudRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Link an image of the user to an award in their received inventory, which has no linked image yet\n     */\n    async linkImageToAwardRaw(requestParameters: LinkImageToAwardRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling linkImageToAward().'\n            );\n        }\n\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling linkImageToAward().'\n            );\n        }\n\n        if (requestParameters['token'] == null) {\n            throw new runtime.RequiredError(\n                'token',\n                'Required parameter \"token\" was null or undefined when calling linkImageToAward().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/cloud/{login}/{id}/award/{token}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))).replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))).replace(`{${\"token\"}}`, encodeURIComponent(String(requestParameters['token']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Link an image of the user to an award in their received inventory, which has no linked image yet\n     */\n    async linkImageToAward(requestParameters: LinkImageToAwardRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.linkImageToAwardRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search for cloud images\n     */\n    async searchUserCloudRaw(requestParameters: SearchUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<CloudImageDto>>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling searchUserCloud().'\n            );\n        }\n\n        if (requestParameters['cloudSearchDto'] == null) {\n            throw new runtime.RequiredError(\n                'cloudSearchDto',\n                'Required parameter \"cloudSearchDto\" was null or undefined when calling searchUserCloud().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/cloud/{login}/search`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: CloudSearchDtoToJSON(requestParameters['cloudSearchDto']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(CloudImageDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search for cloud images\n     */\n    async searchUserCloud(requestParameters: SearchUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<CloudImageDto>> {\n        const response = await this.searchUserCloudRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Upload a new image to the user\\'s cloud\n     */\n    async uploadToUserCloudRaw(requestParameters: UploadToUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<CloudUploadedDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling uploadToUserCloud().'\n            );\n        }\n\n        if (requestParameters['cloudUploadDto'] == null) {\n            throw new runtime.RequiredError(\n                'cloudUploadDto',\n                'Required parameter \"cloudUploadDto\" was null or undefined when calling uploadToUserCloud().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/cloud/{login}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: CloudUploadDtoToJSON(requestParameters['cloudUploadDto']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => CloudUploadedDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Member - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Upload a new image to the user\\'s cloud\n     */\n    async uploadToUserCloud(requestParameters: UploadToUserCloudRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<CloudUploadedDto> {\n        const response = await this.uploadToUserCloudRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  EmojiCandidateDto,\n  EmojiDto,\n} from '../models/index';\nimport {\n    EmojiCandidateDtoFromJSON,\n    EmojiCandidateDtoToJSON,\n    EmojiDtoFromJSON,\n    EmojiDtoToJSON,\n} from '../models/index';\n\nexport interface AddEmojiRequest {\n    emojiCandidateDto: EmojiCandidateDto;\n}\n\nexport interface DeleteEmojiRequest {\n    id: string;\n    nameId?: number;\n}\n\nexport interface GetAllEmojisRequest {\n    limit: number;\n    animated: boolean;\n    statics: boolean;\n    query?: string;\n}\n\nexport interface GetAllEmojisCachedRequest {\n    limit: number;\n    animated: boolean;\n    statics: boolean;\n    query?: string;\n}\n\nexport interface GetEmojiRequest {\n    id: string;\n    nameId?: number;\n}\n\nexport interface GetNewEmojisRequest {\n    limit: number;\n    animated: boolean;\n    statics: boolean;\n    query?: string;\n}\n\n/**\n * \n */\nexport class EmojisApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: Admin | EmojiManagement | ContentModerator  Rate limit default: 30 Requests / 60000 ms TTL\n     * Add a new emoji\n     */\n    async addEmojiRaw(requestParameters: AddEmojiRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<EmojiDto>> {\n        if (requestParameters['emojiCandidateDto'] == null) {\n            throw new runtime.RequiredError(\n                'emojiCandidateDto',\n                'Required parameter \"emojiCandidateDto\" was null or undefined when calling addEmoji().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/emojis`,\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: EmojiCandidateDtoToJSON(requestParameters['emojiCandidateDto']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => EmojiDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Admin | EmojiManagement | ContentModerator  Rate limit default: 30 Requests / 60000 ms TTL\n     * Add a new emoji\n     */\n    async addEmoji(requestParameters: AddEmojiRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<EmojiDto> {\n        const response = await this.addEmojiRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Admin | ContentModerator | Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Delete a saved emoji  by name (id) and nameId\n     */\n    async deleteEmojiRaw(requestParameters: DeleteEmojiRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling deleteEmoji().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        if (requestParameters['nameId'] != null) {\n            queryParameters['nameId'] = requestParameters['nameId'];\n        }\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/emojis/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'DELETE',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Admin | ContentModerator | Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Delete a saved emoji  by name (id) and nameId\n     */\n    async deleteEmoji(requestParameters: DeleteEmojiRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.deleteEmojiRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search all emojis\n     */\n    async getAllEmojisRaw(requestParameters: GetAllEmojisRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<EmojiDto>>> {\n        if (requestParameters['limit'] == null) {\n            throw new runtime.RequiredError(\n                'limit',\n                'Required parameter \"limit\" was null or undefined when calling getAllEmojis().'\n            );\n        }\n\n        if (requestParameters['animated'] == null) {\n            throw new runtime.RequiredError(\n                'animated',\n                'Required parameter \"animated\" was null or undefined when calling getAllEmojis().'\n            );\n        }\n\n        if (requestParameters['statics'] == null) {\n            throw new runtime.RequiredError(\n                'statics',\n                'Required parameter \"statics\" was null or undefined when calling getAllEmojis().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        if (requestParameters['query'] != null) {\n            queryParameters['query'] = requestParameters['query'];\n        }\n\n        if (requestParameters['limit'] != null) {\n            queryParameters['limit'] = requestParameters['limit'];\n        }\n\n        if (requestParameters['animated'] != null) {\n            queryParameters['animated'] = requestParameters['animated'];\n        }\n\n        if (requestParameters['statics'] != null) {\n            queryParameters['statics'] = requestParameters['statics'];\n        }\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/emojis`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(EmojiDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search all emojis\n     */\n    async getAllEmojis(requestParameters: GetAllEmojisRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<EmojiDto>> {\n        const response = await this.getAllEmojisRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search all emojis with cache enabled\n     */\n    async getAllEmojisCachedRaw(requestParameters: GetAllEmojisCachedRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<EmojiDto>>> {\n        if (requestParameters['limit'] == null) {\n            throw new runtime.RequiredError(\n                'limit',\n                'Required parameter \"limit\" was null or undefined when calling getAllEmojisCached().'\n            );\n        }\n\n        if (requestParameters['animated'] == null) {\n            throw new runtime.RequiredError(\n                'animated',\n                'Required parameter \"animated\" was null or undefined when calling getAllEmojisCached().'\n            );\n        }\n\n        if (requestParameters['statics'] == null) {\n            throw new runtime.RequiredError(\n                'statics',\n                'Required parameter \"statics\" was null or undefined when calling getAllEmojisCached().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        if (requestParameters['query'] != null) {\n            queryParameters['query'] = requestParameters['query'];\n        }\n\n        if (requestParameters['limit'] != null) {\n            queryParameters['limit'] = requestParameters['limit'];\n        }\n\n        if (requestParameters['animated'] != null) {\n            queryParameters['animated'] = requestParameters['animated'];\n        }\n\n        if (requestParameters['statics'] != null) {\n            queryParameters['statics'] = requestParameters['statics'];\n        }\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/emojis/cache`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(EmojiDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search all emojis with cache enabled\n     */\n    async getAllEmojisCached(requestParameters: GetAllEmojisCachedRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<EmojiDto>> {\n        const response = await this.getAllEmojisCachedRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a single saved emoji by name (id) and nameId\n     */\n    async getEmojiRaw(requestParameters: GetEmojiRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<EmojiDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getEmoji().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        if (requestParameters['nameId'] != null) {\n            queryParameters['nameId'] = requestParameters['nameId'];\n        }\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/emojis/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => EmojiDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a single saved emoji by name (id) and nameId\n     */\n    async getEmoji(requestParameters: GetEmojiRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<EmojiDto> {\n        const response = await this.getEmojiRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Admin | EmojiManagement | ContentModerator  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search for new emojis that are not yet in the database\n     */\n    async getNewEmojisRaw(requestParameters: GetNewEmojisRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<EmojiDto>>> {\n        if (requestParameters['limit'] == null) {\n            throw new runtime.RequiredError(\n                'limit',\n                'Required parameter \"limit\" was null or undefined when calling getNewEmojis().'\n            );\n        }\n\n        if (requestParameters['animated'] == null) {\n            throw new runtime.RequiredError(\n                'animated',\n                'Required parameter \"animated\" was null or undefined when calling getNewEmojis().'\n            );\n        }\n\n        if (requestParameters['statics'] == null) {\n            throw new runtime.RequiredError(\n                'statics',\n                'Required parameter \"statics\" was null or undefined when calling getNewEmojis().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        if (requestParameters['query'] != null) {\n            queryParameters['query'] = requestParameters['query'];\n        }\n\n        if (requestParameters['limit'] != null) {\n            queryParameters['limit'] = requestParameters['limit'];\n        }\n\n        if (requestParameters['animated'] != null) {\n            queryParameters['animated'] = requestParameters['animated'];\n        }\n\n        if (requestParameters['statics'] != null) {\n            queryParameters['statics'] = requestParameters['statics'];\n        }\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/emojis/discover`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(EmojiDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: Admin | EmojiManagement | ContentModerator  Rate limit default: 30 Requests / 60000 ms TTL\n     * Search for new emojis that are not yet in the database\n     */\n    async getNewEmojis(requestParameters: GetNewEmojisRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<EmojiDto>> {\n        const response = await this.getNewEmojisRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  EventDropDto,\n  EventDto,\n} from '../models/index';\nimport {\n    EventDropDtoFromJSON,\n    EventDropDtoToJSON,\n    EventDtoFromJSON,\n    EventDtoToJSON,\n} from '../models/index';\n\nexport interface GetEventByIdRequest {\n    id: number;\n}\n\nexport interface GetEventDropRequest {\n    id: number;\n}\n\nexport interface GetEventDropsOfEventRequest {\n    id: number;\n}\n\n/**\n * \n */\nexport class EventsApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all event drops\n     */\n    async getAllEventDropsRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<EventDropDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/events/drops`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(EventDropDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all event drops\n     */\n    async getAllEventDrops(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<EventDropDto>> {\n        const response = await this.getAllEventDropsRaw(initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all events\n     */\n    async getAllEventsRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<EventDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/events`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(EventDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all events\n     */\n    async getAllEvents(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<EventDto>> {\n        const response = await this.getAllEventsRaw(initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get an event by ID\n     */\n    async getEventByIdRaw(requestParameters: GetEventByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<EventDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getEventById().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/events/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => EventDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get an event by ID\n     */\n    async getEventById(requestParameters: GetEventByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<EventDto> {\n        const response = await this.getEventByIdRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get an event drop by ID\n     */\n    async getEventDropRaw(requestParameters: GetEventDropRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<EventDropDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getEventDrop().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/events/drops/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => EventDropDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get an event drop by ID\n     */\n    async getEventDrop(requestParameters: GetEventDropRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<EventDropDto> {\n        const response = await this.getEventDropRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all event drops of an event\n     */\n    async getEventDropsOfEventRaw(requestParameters: GetEventDropsOfEventRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<EventDropDto>>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getEventDropsOfEvent().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/events/{id}/drops`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(EventDropDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all event drops of an event\n     */\n    async getEventDropsOfEvent(requestParameters: GetEventDropsOfEventRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<EventDropDto>> {\n        const response = await this.getEventDropsOfEventRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  GuildInviteDto,\n  PostImageDto,\n} from '../models/index';\nimport {\n    GuildInviteDtoFromJSON,\n    GuildInviteDtoToJSON,\n    PostImageDtoFromJSON,\n    PostImageDtoToJSON,\n} from '../models/index';\n\nexport interface GetGuildInviteRequest {\n    token: number;\n}\n\nexport interface PostImageToGuildRequest {\n    token: number;\n    id: string;\n    postImageDto: PostImageDto;\n}\n\n/**\n * \n */\nexport class GuildsApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get invite information of a guild\n     */\n    async getGuildInviteRaw(requestParameters: GetGuildInviteRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<GuildInviteDto>> {\n        if (requestParameters['token'] == null) {\n            throw new runtime.RequiredError(\n                'token',\n                'Required parameter \"token\" was null or undefined when calling getGuildInvite().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/guilds/{token}/invite`.replace(`{${\"token\"}}`, encodeURIComponent(String(requestParameters['token']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => GuildInviteDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get invite information of a guild\n     */\n    async getGuildInvite(requestParameters: GetGuildInviteRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<GuildInviteDto> {\n        const response = await this.getGuildInviteRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Member  Rate limit default: 10 Requests / 600000 ms TTL\n     * Post an image to a guild channel\n     */\n    async postImageToGuildRaw(requestParameters: PostImageToGuildRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['token'] == null) {\n            throw new runtime.RequiredError(\n                'token',\n                'Required parameter \"token\" was null or undefined when calling postImageToGuild().'\n            );\n        }\n\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling postImageToGuild().'\n            );\n        }\n\n        if (requestParameters['postImageDto'] == null) {\n            throw new runtime.RequiredError(\n                'postImageDto',\n                'Required parameter \"postImageDto\" was null or undefined when calling postImageToGuild().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/guilds/{token}/imagepost/{id}`.replace(`{${\"token\"}}`, encodeURIComponent(String(requestParameters['token']))).replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: PostImageDtoToJSON(requestParameters['postImageDto']),\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Member  Rate limit default: 10 Requests / 600000 ms TTL\n     * Post an image to a guild channel\n     */\n    async postImageToGuild(requestParameters: PostImageToGuildRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.postImageToGuildRaw(requestParameters, initOverrides);\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  AwardInventoryDto,\n  SceneInventoryDto,\n  SetActiveSceneDto,\n  SpriteComboDto,\n  SpriteInventoryDto,\n  SpriteSlotCountDto,\n  SpriteSlotDto,\n} from '../models/index';\nimport {\n    AwardInventoryDtoFromJSON,\n    AwardInventoryDtoToJSON,\n    SceneInventoryDtoFromJSON,\n    SceneInventoryDtoToJSON,\n    SetActiveSceneDtoFromJSON,\n    SetActiveSceneDtoToJSON,\n    SpriteComboDtoFromJSON,\n    SpriteComboDtoToJSON,\n    SpriteInventoryDtoFromJSON,\n    SpriteInventoryDtoToJSON,\n    SpriteSlotCountDtoFromJSON,\n    SpriteSlotCountDtoToJSON,\n    SpriteSlotDtoFromJSON,\n    SpriteSlotDtoToJSON,\n} from '../models/index';\n\nexport interface GetMemberAvailableAwardInventoryRequest {\n    login: number;\n}\n\nexport interface GetMemberSceneInventoryRequest {\n    login: number;\n}\n\nexport interface GetMemberSpriteInventoryRequest {\n    login: number;\n}\n\nexport interface GetMemberSpriteSlotCountRequest {\n    login: number;\n}\n\nexport interface SetMemberSceneRequest {\n    login: number;\n    setActiveSceneDto: SetActiveSceneDto;\n}\n\nexport interface SetMemberSpriteComboRequest {\n    login: number;\n    spriteComboDto: SpriteComboDto;\n}\n\nexport interface SetMemberSpriteSlotRequest {\n    login: number;\n    spriteSlotDto: SpriteSlotDto;\n}\n\n/**\n * \n */\nexport class InventoryApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get all awards in the inventory of a member which are available to gift\n     */\n    async getMemberAvailableAwardInventoryRaw(requestParameters: GetMemberAvailableAwardInventoryRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<AwardInventoryDto>>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberAvailableAwardInventory().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/awards/available`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(AwardInventoryDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get all awards in the inventory of a member which are available to gift\n     */\n    async getMemberAvailableAwardInventory(requestParameters: GetMemberAvailableAwardInventoryRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<AwardInventoryDto>> {\n        const response = await this.getMemberAvailableAwardInventoryRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get all scenes in the inventory of a member, and the currently activated scene\n     */\n    async getMemberSceneInventoryRaw(requestParameters: GetMemberSceneInventoryRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<SceneInventoryDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberSceneInventory().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/scenes`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => SceneInventoryDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get all scenes in the inventory of a member, and the currently activated scene\n     */\n    async getMemberSceneInventory(requestParameters: GetMemberSceneInventoryRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<SceneInventoryDto> {\n        const response = await this.getMemberSceneInventoryRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get all sprites in the inventory of a member\n     */\n    async getMemberSpriteInventoryRaw(requestParameters: GetMemberSpriteInventoryRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<SpriteInventoryDto>>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberSpriteInventory().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/sprites`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(SpriteInventoryDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get all sprites in the inventory of a member\n     */\n    async getMemberSpriteInventory(requestParameters: GetMemberSpriteInventoryRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<SpriteInventoryDto>> {\n        const response = await this.getMemberSpriteInventoryRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get the amount of unlocked sprite slots of a member\n     */\n    async getMemberSpriteSlotCountRaw(requestParameters: GetMemberSpriteSlotCountRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<SpriteSlotCountDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberSpriteSlotCount().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/sprites/slots`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => SpriteSlotCountDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get the amount of unlocked sprite slots of a member\n     */\n    async getMemberSpriteSlotCount(requestParameters: GetMemberSpriteSlotCountRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<SpriteSlotCountDto> {\n        const response = await this.getMemberSpriteSlotCountRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Set the activated scene for a member\n     */\n    async setMemberSceneRaw(requestParameters: SetMemberSceneRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling setMemberScene().'\n            );\n        }\n\n        if (requestParameters['setActiveSceneDto'] == null) {\n            throw new runtime.RequiredError(\n                'setActiveSceneDto',\n                'Required parameter \"setActiveSceneDto\" was null or undefined when calling setMemberScene().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/scenes`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n            body: SetActiveSceneDtoToJSON(requestParameters['setActiveSceneDto']),\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Set the activated scene for a member\n     */\n    async setMemberScene(requestParameters: SetMemberSceneRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.setMemberSceneRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Set the sprite combo of a member\n     */\n    async setMemberSpriteComboRaw(requestParameters: SetMemberSpriteComboRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling setMemberSpriteCombo().'\n            );\n        }\n\n        if (requestParameters['spriteComboDto'] == null) {\n            throw new runtime.RequiredError(\n                'spriteComboDto',\n                'Required parameter \"spriteComboDto\" was null or undefined when calling setMemberSpriteCombo().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/sprites/combo`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n            body: SpriteComboDtoToJSON(requestParameters['spriteComboDto']),\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Set the sprite combo of a member\n     */\n    async setMemberSpriteCombo(requestParameters: SetMemberSpriteComboRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.setMemberSpriteComboRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Set a sprite slot of a member\n     */\n    async setMemberSpriteSlotRaw(requestParameters: SetMemberSpriteSlotRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling setMemberSpriteSlot().'\n            );\n        }\n\n        if (requestParameters['spriteSlotDto'] == null) {\n            throw new runtime.RequiredError(\n                'spriteSlotDto',\n                'Required parameter \"spriteSlotDto\" was null or undefined when calling setMemberSpriteSlot().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/member/{login}/inventory/sprites/slot`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n            body: SpriteSlotDtoToJSON(requestParameters['spriteSlotDto']),\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 30 Requests / 60000 ms TTL\n     * Set a sprite slot of a member\n     */\n    async setMemberSpriteSlot(requestParameters: SetMemberSpriteSlotRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.setMemberSpriteSlotRaw(requestParameters, initOverrides);\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  AccessTokenDto,\n  MemberDto,\n  MemberSearchDto,\n  MemberWebhookDto,\n  UpdateDiscordID,\n} from '../models/index';\nimport {\n    AccessTokenDtoFromJSON,\n    AccessTokenDtoToJSON,\n    MemberDtoFromJSON,\n    MemberDtoToJSON,\n    MemberSearchDtoFromJSON,\n    MemberSearchDtoToJSON,\n    MemberWebhookDtoFromJSON,\n    MemberWebhookDtoToJSON,\n    UpdateDiscordIDFromJSON,\n    UpdateDiscordIDToJSON,\n} from '../models/index';\n\nexport interface ClearMemberDropboostRequest {\n    login: number;\n}\n\nexport interface ConnectMemberToGuildRequest {\n    login: number;\n    token: number;\n}\n\nexport interface FindMembersWildcardSearchRequest {\n    content: string;\n}\n\nexport interface GetMemberAccessTokenRequest {\n    login: number;\n}\n\nexport interface GetMemberByDiscordIDRequest {\n    id: string;\n}\n\nexport interface GetMemberByLoginRequest {\n    login: number;\n}\n\nexport interface GetMemberGuildWebhooksRequest {\n    login: number;\n}\n\nexport interface RemoveConnectedGuildRequest {\n    login: number;\n    token: number;\n}\n\nexport interface UpdateMemberDiscordIDRequest {\n    login: number;\n    updateDiscordID: UpdateDiscordID;\n}\n\n/**\n * \n */\nexport class MembersApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Delete a dropboost of a member\n     */\n    async clearMemberDropboostRaw(requestParameters: ClearMemberDropboostRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling clearMemberDropboost().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}/dropboost`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'DELETE',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Delete a dropboost of a member\n     */\n    async clearMemberDropboost(requestParameters: ClearMemberDropboostRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.clearMemberDropboostRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Connect a user to a guild with given server token\n     */\n    async connectMemberToGuildRaw(requestParameters: ConnectMemberToGuildRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling connectMemberToGuild().'\n            );\n        }\n\n        if (requestParameters['token'] == null) {\n            throw new runtime.RequiredError(\n                'token',\n                'Required parameter \"token\" was null or undefined when calling connectMemberToGuild().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}/guilds/{token}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))).replace(`{${\"token\"}}`, encodeURIComponent(String(requestParameters['token']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Connect a user to a guild with given server token\n     */\n    async connectMemberToGuild(requestParameters: ConnectMemberToGuildRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.connectMemberToGuildRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Find members that contain a string\n     */\n    async findMembersWildcardSearchRaw(requestParameters: FindMembersWildcardSearchRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<MemberSearchDto>>> {\n        if (requestParameters['content'] == null) {\n            throw new runtime.RequiredError(\n                'content',\n                'Required parameter \"content\" was null or undefined when calling findMembersWildcardSearch().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        if (requestParameters['content'] != null) {\n            queryParameters['content'] = requestParameters['content'];\n        }\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/search`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(MemberSearchDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Find members that contain a string\n     */\n    async findMembersWildcardSearch(requestParameters: FindMembersWildcardSearchRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<MemberSearchDto>> {\n        const response = await this.findMembersWildcardSearchRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Member  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get the currently authenticated member\n     */\n    async getAuthenticatedMemberRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<MemberDto>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/me`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => MemberDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Member  Rate limit default: 30 Requests / 60000 ms TTL\n     * Get the currently authenticated member\n     */\n    async getAuthenticatedMember(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<MemberDto> {\n        const response = await this.getAuthenticatedMemberRaw(initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get an access token of a member\n     */\n    async getMemberAccessTokenRaw(requestParameters: GetMemberAccessTokenRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<AccessTokenDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberAccessToken().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}/token`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => AccessTokenDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get an access token of a member\n     */\n    async getMemberAccessToken(requestParameters: GetMemberAccessTokenRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<AccessTokenDto> {\n        const response = await this.getMemberAccessTokenRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a member by their discord id\n     */\n    async getMemberByDiscordIDRaw(requestParameters: GetMemberByDiscordIDRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<MemberDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getMemberByDiscordID().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/discord/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => MemberDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a member by their discord id\n     */\n    async getMemberByDiscordID(requestParameters: GetMemberByDiscordIDRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<MemberDto> {\n        const response = await this.getMemberByDiscordIDRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a member by their login\n     */\n    async getMemberByLoginRaw(requestParameters: GetMemberByLoginRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<MemberDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberByLogin().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => MemberDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a member by their login\n     */\n    async getMemberByLogin(requestParameters: GetMemberByLoginRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<MemberDto> {\n        const response = await this.getMemberByLoginRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all webhooks of a member\n     */\n    async getMemberGuildWebhooksRaw(requestParameters: GetMemberGuildWebhooksRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<MemberWebhookDto>>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling getMemberGuildWebhooks().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}/webhooks`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(MemberWebhookDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all webhooks of a member\n     */\n    async getMemberGuildWebhooks(requestParameters: GetMemberGuildWebhooksRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<MemberWebhookDto>> {\n        const response = await this.getMemberGuildWebhooksRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Delete a server from a member\\'s connected guilds\n     */\n    async removeConnectedGuildRaw(requestParameters: RemoveConnectedGuildRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<void>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling removeConnectedGuild().'\n            );\n        }\n\n        if (requestParameters['token'] == null) {\n            throw new runtime.RequiredError(\n                'token',\n                'Required parameter \"token\" was null or undefined when calling removeConnectedGuild().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}/guilds/{token}`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))).replace(`{${\"token\"}}`, encodeURIComponent(String(requestParameters['token']))),\n            method: 'DELETE',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.VoidApiResponse(response);\n    }\n\n    /**\n     *   Required Roles: Moderator - Role override if {login} matches the client login.  Rate limit default: 10 Requests / 60000 ms TTL\n     * Delete a server from a member\\'s connected guilds\n     */\n    async removeConnectedGuild(requestParameters: RemoveConnectedGuildRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<void> {\n        await this.removeConnectedGuildRaw(requestParameters, initOverrides);\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Update a member\\'s discord ID and merge with other if present\n     */\n    async updateMemberDiscordIDRaw(requestParameters: UpdateMemberDiscordIDRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<MemberDto>> {\n        if (requestParameters['login'] == null) {\n            throw new runtime.RequiredError(\n                'login',\n                'Required parameter \"login\" was null or undefined when calling updateMemberDiscordID().'\n            );\n        }\n\n        if (requestParameters['updateDiscordID'] == null) {\n            throw new runtime.RequiredError(\n                'updateDiscordID',\n                'Required parameter \"updateDiscordID\" was null or undefined when calling updateMemberDiscordID().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/members/{login}/discord`.replace(`{${\"login\"}}`, encodeURIComponent(String(requestParameters['login']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n            body: UpdateDiscordIDToJSON(requestParameters['updateDiscordID']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => MemberDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Update a member\\'s discord ID and merge with other if present\n     */\n    async updateMemberDiscordID(requestParameters: UpdateMemberDiscordIDRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<MemberDto> {\n        const response = await this.updateMemberDiscordIDRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  SceneDto,\n} from '../models/index';\nimport {\n    SceneDtoFromJSON,\n    SceneDtoToJSON,\n} from '../models/index';\n\nexport interface GetSceneByIdRequest {\n    id: number;\n}\n\n/**\n * \n */\nexport class ScenesApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all scenes\n     */\n    async getAllScenesRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<SceneDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/scenes`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(SceneDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all scenes\n     */\n    async getAllScenes(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<SceneDto>> {\n        const response = await this.getAllScenesRaw(initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a scene by ID\n     */\n    async getSceneByIdRaw(requestParameters: GetSceneByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<SceneDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getSceneById().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/scenes/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => SceneDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a scene by ID\n     */\n    async getSceneById(requestParameters: GetSceneByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<SceneDto> {\n        const response = await this.getSceneByIdRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  SpriteDto,\n} from '../models/index';\nimport {\n    SpriteDtoFromJSON,\n    SpriteDtoToJSON,\n} from '../models/index';\n\nexport interface GetSpriteByIdRequest {\n    id: number;\n}\n\n/**\n * \n */\nexport class SpritesApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all sprites\n     */\n    async getAllSpritesRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<SpriteDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/sprites`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(SpriteDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all sprites\n     */\n    async getAllSprites(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<SpriteDto>> {\n        const response = await this.getAllSpritesRaw(initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a sprite by ID\n     */\n    async getSpriteByIdRaw(requestParameters: GetSpriteByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<SpriteDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getSpriteById().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/sprites/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => SpriteDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a sprite by ID\n     */\n    async getSpriteById(requestParameters: GetSpriteByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<SpriteDto> {\n        const response = await this.getSpriteByIdRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","/* tslint:disable */\n/* eslint-disable */\n/**\n * Skribbl Typo API\n * Skribbl Typo API for resources, admin tools and authentification.\n *\n * The version of the OpenAPI document: 1.0\n * \n *\n * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).\n * https://openapi-generator.tech\n * Do not edit the class manually.\n */\n\n\nimport * as runtime from '../runtime';\nimport type {\n  ThemeDto,\n  ThemeListingDto,\n  ThemePublishRequestDto,\n  ThemeShareDto,\n  ThemeUpdateRequestDto,\n} from '../models/index';\nimport {\n    ThemeDtoFromJSON,\n    ThemeDtoToJSON,\n    ThemeListingDtoFromJSON,\n    ThemeListingDtoToJSON,\n    ThemePublishRequestDtoFromJSON,\n    ThemePublishRequestDtoToJSON,\n    ThemeShareDtoFromJSON,\n    ThemeShareDtoToJSON,\n    ThemeUpdateRequestDtoFromJSON,\n    ThemeUpdateRequestDtoToJSON,\n} from '../models/index';\n\nexport interface GetThemeByIdRequest {\n    id: string;\n}\n\nexport interface PublishThemeRequest {\n    id: string;\n    themePublishRequestDto: ThemePublishRequestDto;\n}\n\nexport interface ShareThemeRequest {\n    themeDto: ThemeDto;\n}\n\nexport interface UpdateThemeRequest {\n    id: string;\n    themeUpdateRequestDto: ThemeUpdateRequestDto;\n}\n\nexport interface UseThemeByIdRequest {\n    id: string;\n}\n\n/**\n * \n */\nexport class ThemesApi extends runtime.BaseAPI {\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all published themes\n     */\n    async getAllThemesRaw(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<Array<ThemeListingDto>>> {\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/themes`,\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => jsonValue.map(ThemeListingDtoFromJSON));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get all published themes\n     */\n    async getAllThemes(initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<Array<ThemeListingDto>> {\n        const response = await this.getAllThemesRaw(initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a theme by ID\n     */\n    async getThemeByIdRaw(requestParameters: GetThemeByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ThemeDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling getThemeById().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/themes/{id}`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => ThemeDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Get a theme by ID\n     */\n    async getThemeById(requestParameters: GetThemeByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ThemeDto> {\n        const response = await this.getThemeByIdRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Publish a theme to the public theme list\n     */\n    async publishThemeRaw(requestParameters: PublishThemeRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ThemeShareDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling publishTheme().'\n            );\n        }\n\n        if (requestParameters['themePublishRequestDto'] == null) {\n            throw new runtime.RequiredError(\n                'themePublishRequestDto',\n                'Required parameter \"themePublishRequestDto\" was null or undefined when calling publishTheme().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/themes/{id}/public`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: ThemePublishRequestDtoToJSON(requestParameters['themePublishRequestDto']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => ThemeShareDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Publish a theme to the public theme list\n     */\n    async publishTheme(requestParameters: PublishThemeRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ThemeShareDto> {\n        const response = await this.publishThemeRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Share a theme to be used by others\n     */\n    async shareThemeRaw(requestParameters: ShareThemeRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ThemeShareDto>> {\n        if (requestParameters['themeDto'] == null) {\n            throw new runtime.RequiredError(\n                'themeDto',\n                'Required parameter \"themeDto\" was null or undefined when calling shareTheme().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        const response = await this.request({\n            path: `/themes/share`,\n            method: 'POST',\n            headers: headerParameters,\n            query: queryParameters,\n            body: ThemeDtoToJSON(requestParameters['themeDto']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => ThemeShareDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 10 Requests / 60000 ms TTL\n     * Share a theme to be used by others\n     */\n    async shareTheme(requestParameters: ShareThemeRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ThemeShareDto> {\n        const response = await this.shareThemeRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Update the theme content from the provided new share and increment version\n     */\n    async updateThemeRaw(requestParameters: UpdateThemeRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ThemeShareDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling updateTheme().'\n            );\n        }\n\n        if (requestParameters['themeUpdateRequestDto'] == null) {\n            throw new runtime.RequiredError(\n                'themeUpdateRequestDto',\n                'Required parameter \"themeUpdateRequestDto\" was null or undefined when calling updateTheme().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        headerParameters['Content-Type'] = 'application/json';\n\n        if (this.configuration && this.configuration.accessToken) {\n            const token = this.configuration.accessToken;\n            const tokenString = await token(\"bearer\", []);\n\n            if (tokenString) {\n                headerParameters[\"Authorization\"] = `Bearer ${tokenString}`;\n            }\n        }\n        const response = await this.request({\n            path: `/themes/{id}/public`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'PATCH',\n            headers: headerParameters,\n            query: queryParameters,\n            body: ThemeUpdateRequestDtoToJSON(requestParameters['themeUpdateRequestDto']),\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => ThemeShareDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: Moderator  Rate limit default: 10 Requests / 60000 ms TTL\n     * Update the theme content from the provided new share and increment version\n     */\n    async updateTheme(requestParameters: UpdateThemeRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ThemeShareDto> {\n        const response = await this.updateThemeRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 100 Requests / 86400000 ms TTL\n     * Get a theme by ID and increment use counter\n     */\n    async useThemeByIdRaw(requestParameters: UseThemeByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<runtime.ApiResponse<ThemeDto>> {\n        if (requestParameters['id'] == null) {\n            throw new runtime.RequiredError(\n                'id',\n                'Required parameter \"id\" was null or undefined when calling useThemeById().'\n            );\n        }\n\n        const queryParameters: any = {};\n\n        const headerParameters: runtime.HTTPHeaders = {};\n\n        const response = await this.request({\n            path: `/themes/{id}/use`.replace(`{${\"id\"}}`, encodeURIComponent(String(requestParameters['id']))),\n            method: 'GET',\n            headers: headerParameters,\n            query: queryParameters,\n        }, initOverrides);\n\n        return new runtime.JSONApiResponse(response, (jsonValue) => ThemeDtoFromJSON(jsonValue));\n    }\n\n    /**\n     *   Required Roles: None  Rate limit default: 100 Requests / 86400000 ms TTL\n     * Get a theme by ID and increment use counter\n     */\n    async useThemeById(requestParameters: UseThemeByIdRequest, initOverrides?: RequestInit | runtime.InitOverrideFunction): Promise<ThemeDto> {\n        const response = await this.useThemeByIdRaw(requestParameters, initOverrides);\n        return await response.value();\n    }\n\n}\n","import { inject, injectable } from \"inversify\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\n\n@injectable()\nexport class TokenService {\n\n  private readonly _logger;\n  private readonly _token = new BehaviorSubject<string | null | undefined>(undefined);\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n    this.initToken();\n  }\n\n  private async initToken() {\n    const token = await chrome.runtime.sendMessage({ type: \"get token\" });\n    this._logger.info(\"Authenticated\", token);\n    this._token.next(token);\n  }\n\n  /**\n   * Observable which emits the current token.\n   */\n  public get token() {\n    return this._token.asObservable();\n  }\n\n  public async removeToken(){\n    await chrome.runtime.sendMessage({ type: \"set token\", token: null });\n    this._token.next(null);\n  }\n}","import { TokenService } from \"@/content/core/token/token.service\";\nimport { inject, injectable } from \"inversify\";\nimport { BaseAPI, Configuration } from \"../../../api\";\nimport type { Type } from \"../../../util/types/type\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\n@injectable()\nexport class ApiService {\n\n  private readonly _logger;\n\n  private _baseUrl = \"https://api.typo.rip\";\n  private _token = \"\";\n  private instances = new Map<Type<BaseAPI>, BaseAPI>();\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(TokenService) tokenService: TokenService\n  ) {\n    this._logger = loggerFactory(this);\n    tokenService.token.subscribe(token => this._token = token ?? \"\");\n  }\n\n  /**\n   * creates a new api config based on set options\n   * @private\n   */\n  private createApiConfig() {\n    return new Configuration({\n      basePath: this._baseUrl,\n      accessToken: () => this._token\n    });\n  }\n\n  /**\n   * create a new api client of given type\n   * @param apiClass\n   * @returns\n   */\n  getApi<TApi extends BaseAPI>(apiClass: Type<TApi>): TApi {\n    let instance = this.instances.get(apiClass) as TApi | undefined;\n    if(instance === undefined){\n      instance = new apiClass(this.createApiConfig());\n      this.instances.set(apiClass, instance);\n    }\n    return instance;\n  }\n\n  /**\n   * Set the base url which will be used for api calls\n   * @param url\n   */\n  public set baseUrl(url: string) {\n    this._baseUrl = url;\n  }\n}","import { inject, injectable } from \"inversify\";\nimport { BehaviorSubject, filter, firstValueFrom, forkJoin, of, switchMap, take } from \"rxjs\";\nimport { fromPromise } from \"rxjs/internal/observable/innerFrom\";\nimport {\n  InventoryApi,\n  type MemberDto,\n  MembersApi,\n  type MemberWebhookDto, type SceneInventoryDto,\n  type SpriteInventoryDto,\n  type SpriteSlotCountDto,\n} from \"@/api\";\nimport { ApiService } from \"../api/api.service\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\nimport { TokenService } from \"@/content/core/token/token.service\";\n\nexport interface memberData {\n  member: MemberDto,\n  webhooks: MemberWebhookDto[],\n  slots: SpriteSlotCountDto,\n  spriteInventory: SpriteInventoryDto[],\n  sceneInventory: SceneInventoryDto\n}\n\n@injectable()\nexport class MemberService {\n\n  private readonly _logger;\n  private readonly _member$ = new BehaviorSubject<MemberDto | null | undefined>(undefined);\n  private readonly _memberData$ = new BehaviorSubject<memberData | null | undefined>(undefined);\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(ApiService) private readonly _apiService: ApiService,\n    @inject(TokenService) private readonly _tokenService: TokenService\n  ) {\n    this._logger = loggerFactory(this);\n    this._tokenService.token\n      .pipe(\n        filter(token => token !== undefined), // only when token is loaded\n      )\n      .subscribe(token => this.loadMember(token === null));\n\n    /* create stream for additional member data, loads when member changes */\n    this._member$.pipe(\n      switchMap(member => {\n        if(member === null || member === undefined) {\n          return of(member);\n        }\n\n        return forkJoin({\n          webhooks: fromPromise(_apiService.getApi(MembersApi).getMemberGuildWebhooks({ login: Number(member.userLogin) })),\n          member: of(member),\n          slots: fromPromise(_apiService.getApi(InventoryApi).getMemberSpriteSlotCount({ login: Number(member.userLogin) })),\n          spriteInventory: fromPromise(_apiService.getApi(InventoryApi).getMemberSpriteInventory({ login: Number(member.userLogin) })),\n          sceneInventory: fromPromise(_apiService.getApi(InventoryApi).getMemberSceneInventory({ login: Number(member.userLogin) }))\n        });\n      })\n    ).subscribe(data => {\n      this._memberData$.next(data);\n    });\n  }\n\n  private async loadMember(reset = false): Promise<MemberDto | null> {\n\n    if (reset) {\n      this._member$.next(null);\n      return Promise.resolve(null);\n    }\n\n    const promise = this._apiService.getApi(MembersApi).getAuthenticatedMember();\n    promise.then(member => {\n      this._member$.next(member);\n    }).catch(() => {\n      if(this._member$.value !== null) {\n        this._member$.next(null);\n      }\n    });\n\n    return promise;\n  }\n\n  /**\n   * trigger a refresh that loads the member inventory and\n   * results in a new emit of the memberdata observable\n   */\n  public async refreshInventory() {\n    await firstValueFrom(this.memberData$.pipe(\n      take(1),\n      switchMap(async data => {\n        if(data !== null && data !== undefined) {\n          const spriteInv = await this._apiService.getApi(InventoryApi).getMemberSpriteInventory({ login: Number(data.member.userLogin) });\n          const sceneInv = await this._apiService.getApi(InventoryApi).getMemberSceneInventory({ login: Number(data.member.userLogin) });\n          data.spriteInventory = spriteInv;\n          data.sceneInventory = sceneInv;\n          this._memberData$.next(data);\n        }\n      })\n    ));\n  }\n\n  /**\n   * Observable which emits the current member.\n   */\n  public get member$() {\n    return this._member$.asObservable();\n  }\n\n  /**\n   * Observable which emits the current member and additional data.\n   */\n  public get memberData$() {\n    return this._memberData$.asObservable();\n  }\n\n  /**\n   * Redirects the user to the login page.\n   */\n  public login() {\n    window.location.href = \"https://www.typo.rip/auth?redirect=\" + encodeURI(window.location.href);\n  }\n\n  /**\n   * Removes the token from the storage and the service.\n   */\n  public async logout() {\n    await this._tokenService.removeToken();\n  }\n\n  public async refreshMember() {\n    return this.loadMember();\n  }\n}","import type {\n  anonymousPlayerIdentification,\n  SkribblPlayerDisplay,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { createElement } from \"@/util/document/appendElement\";\nimport { elements, requireElement } from \"@/util/document/requiredQuerySelector\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\n\nexport class SkribblOverlayPlayer implements SkribblPlayerDisplay {\n  private readonly _avatarContainer: HTMLElement;\n  private _placeholderBackgroundContainer: HTMLElement;\n\n  constructor(\n    private readonly _player: skribblPlayer,\n    private readonly _lobbyKey: string,\n    private readonly _overlayContainer: HTMLElement,\n  ) {\n    this._avatarContainer = requireElement(\".avatar\", this._overlayContainer);\n    this._placeholderBackgroundContainer = createElement(\"<div style=\\\"display: none;\\\"></div>\");\n    this._overlayContainer.appendChild(this._placeholderBackgroundContainer);\n  }\n\n  destroy() {\n    this._placeholderBackgroundContainer.remove();\n  }\n\n  get typoId(): anonymousPlayerIdentification {\n    return { lobbyKey: this._lobbyKey, lobbyPlayerId: this._player.id };\n  }\n\n  get avatarContainer(): HTMLElement {\n    return this._avatarContainer;\n  }\n\n  get backgroundContainer(): HTMLElement {\n    return this._placeholderBackgroundContainer;\n  }\n\n  get container(): HTMLElement {\n    return this._overlayContainer;\n  }\n\n  readonly iconsContainer = null;\n\n  set useBackground(value: boolean) {\n    /* no implementation */\n  }\n\n  set useSafeColor(value: boolean) {\n    /* no implementation */\n  }\n\n  set adjustToContainSprites(value: boolean) {\n    /* no implementation */\n  }\n\n  set viewPlayerId(value: boolean) {\n    /* no implementation */\n  }\n\n  /**\n   * remove the elements; as container is disposable and updates in the short timespan it is shown can be ignored\n   * @param value\n   */\n  set hideAvatar(value: boolean) {\n    if (value) {\n      elements(\":is(.eyes, .mouth, .color)\", this._avatarContainer).forEach((element) =>\n        element.remove(),\n      );\n    }\n  }\n}","import type {\n  SkribblPlayerDisplay, typoPlayerIdentification,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { createElement } from \"@/util/document/appendElement\";\nimport { elements, requireElement } from \"@/util/document/requiredQuerySelector\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\n\nexport class SkribblPopupPlayer implements SkribblPlayerDisplay {\n  private readonly _avatarContainer: HTMLElement;\n  private _placeholderBackgroundContainer: HTMLElement;\n\n  constructor(\n    private readonly _player: skribblPlayer,\n    private readonly _playerPopup: HTMLElement,\n    private readonly _lobbyKey?: string,\n    private readonly _playerLogin?: number,\n  ) {\n    if (_lobbyKey === undefined && _playerLogin === undefined)\n      throw new Error(\"No identification provided\");\n\n    this._avatarContainer = requireElement(\".avatar\", this._playerPopup);\n    this._placeholderBackgroundContainer = createElement(\"<div style=\\\"display: none;\\\"></div>\");\n    this._playerPopup.appendChild(this._placeholderBackgroundContainer);\n  }\n\n  destroy() {\n    this._placeholderBackgroundContainer.remove();\n  }\n\n  get typoId(): typoPlayerIdentification {\n    if (this._playerLogin !== undefined) return { login: this._playerLogin };\n    if (this._lobbyKey !== undefined)\n      return { lobbyKey: this._lobbyKey, lobbyPlayerId: this._player.id };\n    throw new Error(\"No identification provided\");\n  }\n\n  get avatarContainer(): HTMLElement {\n    return this._avatarContainer;\n  }\n\n  get backgroundContainer(): HTMLElement {\n    return this._placeholderBackgroundContainer;\n  }\n\n  get container(): HTMLElement {\n    return this._playerPopup;\n  }\n\n  readonly iconsContainer = null;\n\n  set useBackground(value: boolean) {\n    /* no implementation */\n  }\n\n  set useSafeColor(value: boolean) {\n    /* no implementation */\n  }\n\n  set adjustToContainSprites(value: boolean) {\n    /* no implementation */\n  }\n\n  set viewPlayerId(value: boolean) {\n    /* no implementation */\n  }\n\n  /**\n   * remove the elements; as container is disposable and updates in the short timespan it is shown can be ignored\n   * @param value\n   */\n  set hideAvatar(value: boolean) {\n    if (value) {\n      elements(\":is(.eyes, .mouth, .color)\", this._avatarContainer).forEach((element) =>\n        element.remove(),\n      );\n    }\n  }\n}","import type {\n  anonymousPlayerIdentification,\n  SkribblPlayerDisplay,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { createElement } from \"@/util/document/appendElement\";\nimport { elements, requireElement } from \"@/util/document/requiredQuerySelector\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\n\nexport class SkribblScoreboardPodiumPlayer implements SkribblPlayerDisplay {\n  private readonly _playerContainer: HTMLElement;\n  private readonly _avatarContainer: HTMLElement;\n  private _placeholderBackgroundContainer: HTMLElement;\n\n  constructor(\n    private readonly _player: skribblPlayer,\n    private readonly _lobbyKey: string,\n  ) {\n    this._playerContainer = requireElement(\n      `.overlay-content .result.show .podests > div:has(.avatar[playerid='${this._player.id}'])`,\n    );\n    this._avatarContainer = requireElement(\".avatar\", this._playerContainer);\n    this._placeholderBackgroundContainer = createElement(\"<div style=\\\"display: none;\\\"></div>\");\n    this._playerContainer.appendChild(this._placeholderBackgroundContainer);\n  }\n\n  destroy() {\n    this._placeholderBackgroundContainer.remove();\n  }\n\n  get typoId(): anonymousPlayerIdentification {\n    return { lobbyKey: this._lobbyKey, lobbyPlayerId: this._player.id };\n  }\n\n  get avatarContainer(): HTMLElement {\n    return this._avatarContainer;\n  }\n\n  get backgroundContainer(): HTMLElement {\n    return this._placeholderBackgroundContainer;\n  }\n\n  get container(): HTMLElement {\n    return this._playerContainer;\n  }\n\n  readonly iconsContainer = null;\n\n  set useBackground(value: boolean) {\n    /* no implementation */\n  }\n\n  set useSafeColor(value: boolean) {\n    /* no implementation */\n  }\n\n  set adjustToContainSprites(value: boolean) {\n    /* no implementation */\n  }\n\n  set viewPlayerId(value: boolean) {\n    /* no implementation */\n  }\n\n  /**\n   * remove the elements; as container is disposable and updates in the short timespan it is shown can be ignored\n   * @param value\n   */\n  set hideAvatar(value: boolean) {\n    if (value) {\n      elements(\":is(.eyes, .mouth, .color)\", this._avatarContainer).forEach((element) =>\n        element.remove(),\n      );\n    }\n  }\n}","import type {\n  anonymousPlayerIdentification,\n  SkribblPlayerDisplay,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { createElement } from \"@/util/document/appendElement\";\nimport { elements, requireElement } from \"@/util/document/requiredQuerySelector\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\n\nexport class SkribblScoreboardRegularPlayer implements SkribblPlayerDisplay {\n  private readonly _playerContainer: HTMLElement;\n  private readonly _avatarContainer: HTMLElement;\n  private _placeholderBackgroundContainer: HTMLElement;\n\n  constructor(\n    private readonly _player: skribblPlayer,\n    private readonly _lobbyKey: string,\n  ) {\n    this._playerContainer = requireElement(\n      `.overlay-content .result.show .ranks .rank[playerid='${this._player.id}']`,\n    );\n    this._avatarContainer = requireElement(\".avatar\", this._playerContainer);\n    this._placeholderBackgroundContainer = createElement(\"<div style=\\\"display: none;\\\"></div>\");\n    this._playerContainer.appendChild(this._placeholderBackgroundContainer);\n  }\n\n  destroy() {\n    this._placeholderBackgroundContainer.remove();\n  }\n\n  get typoId(): anonymousPlayerIdentification {\n    return { lobbyKey: this._lobbyKey, lobbyPlayerId: this._player.id };\n  }\n\n  get avatarContainer(): HTMLElement {\n    return this._avatarContainer;\n  }\n\n  get backgroundContainer(): HTMLElement {\n    return this._placeholderBackgroundContainer;\n  }\n\n  get container(): HTMLElement {\n    return this._playerContainer;\n  }\n\n  readonly iconsContainer = null;\n\n  set useBackground(value: boolean) {\n    /* no implementation */\n  }\n\n  set useSafeColor(value: boolean) {\n    /* no implementation */\n  }\n\n  set adjustToContainSprites(value: boolean) {\n    /* no implementation */\n  }\n\n  set viewPlayerId(value: boolean) {\n    /* no implementation */\n  }\n\n  /**\n   * remove the elements; as container is disposable and updates in the short timespan it is shown can be ignored\n   * @param value\n   */\n  set hideAvatar(value: boolean) {\n    if (value) {\n      elements(\":is(.eyes, .mouth, .color)\", this._avatarContainer).forEach((element) =>\n        element.remove(),\n      );\n    }\n  }\n}","import { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { SkribblLandingPlayer } from \"@/content/services/players/skribblLandingPlayer\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport {\n  combineLatestWith,\n  map,\n  type Observable,\n} from \"rxjs\";\nimport { Setup } from \"../../core/setup/setup\";\n\nexport class LandingPlayerSetup extends Setup<Observable<SkribblLandingPlayer | undefined>> {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(GlobalSettingsService) private readonly _globalSettingsService!: GlobalSettingsService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n\n  protected async runSetup(): Promise<Observable<SkribblLandingPlayer | undefined>> {\n    const elements = await this._elementsSetup.complete();\n\n    return this._memberService.member$.pipe(\n      combineLatestWith(this._globalSettingsService.settings.showLandingOutfit.changes$),\n      map(([member, enabled]) => {\n        if(member === undefined || member === null || elements === undefined || !enabled) return undefined;\n        return new SkribblLandingPlayer(Number(member.userLogin), elements.landingCustomizeContainer, elements.landingAvatar);\n      })\n    );\n  }\n}","/**\n * Generate a string by a key, that is hashed by its own value. Can be used to identify a public group token (the hash)\n * @param {String} key The key that is hashed against itself\n * @returns A hash that can be used for match check\n */\nexport const calculateLobbyKey = (key: string) => {\n  const sum = [...key].reduce((sum, char) => sum + char.charCodeAt(0), 0);\n  const hashed = [...key].map(char => String.fromCharCode(char.charCodeAt(0) + sum));\n  const newKey = hashed.join(\"\");\n  return newKey;\n};\n","import { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { LobbyJoinedEventListener } from \"@/content/events/lobby-joined.event\";\nimport { LobbyLeftEventListener } from \"@/content/events/lobby-left.event\";\nimport { LobbyPlayerChangedEventListener } from \"@/content/events/lobby-player-changed.event\";\nimport { LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport { PlayerPopupVisibilityChangedEventListener } from \"@/content/events/player-popup-visible.event\";\nimport { ScoreboardVisibilityChangedEventListener } from \"@/content/events/scoreboard-visible.event\";\nimport { TextOverlayVisibilityChangedEventListener } from \"@/content/events/text-overlay-visible.event\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { SkribblLandingPlayer } from \"@/content/services/players/skribblLandingPlayer\";\nimport { SkribblLobbyPlayer } from \"@/content/services/players/skribblLobbyPlayer\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { SkribblOverlayPlayer } from \"@/content/services/players/skribblOverlayPlayer\";\nimport { SkribblPopupPlayer } from \"@/content/services/players/skribblPopupPlayer\";\nimport { SkribblScoreboardPodiumPlayer } from \"@/content/services/players/skribblScoreboardPodiumPlayer\";\nimport { SkribblScoreboardRegularPlayer } from \"@/content/services/players/skribblScoreboardRegularPlayer\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport type { SkribblPlayerDisplay } from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { LandingPlayerSetup } from \"@/content/setups/landing-player/landing-player.setup\";\nimport { element } from \"@/util/document/requiredQuerySelector\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\nimport { calculateLobbyKey } from \"@/util/typo/lobbyKey\";\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport {\n  BehaviorSubject,\n  combineLatestWith,\n  distinctUntilChanged, filter, from,\n  map,\n  mergeWith, of, pairwise,\n  startWith, switchMap,\n  withLatestFrom,\n} from \"rxjs\";\n\n@injectable()\nexport class PlayersService {\n\n  @inject(ElementsSetup) private _elementsSetup!: ElementsSetup;\n  @inject(LobbyJoinedEventListener) private readonly _lobbyJoinedEvent!: LobbyJoinedEventListener;\n  @inject(LobbyLeftEventListener) private readonly _lobbyLeftEvent!: LobbyLeftEventListener;\n  @inject(LobbyStateChangedEventListener) private readonly _lobbyStateChangedEvent!: LobbyStateChangedEventListener;\n  @inject(LobbyPlayerChangedEventListener) private readonly _playerChangedEvent!: LobbyPlayerChangedEventListener;\n  @inject(ScoreboardVisibilityChangedEventListener) private readonly _scoreboardVisibleEvent!: ScoreboardVisibilityChangedEventListener;\n  @inject(TextOverlayVisibilityChangedEventListener) private readonly _textOverlayVisibleEvent!: TextOverlayVisibilityChangedEventListener;\n  @inject(PlayerPopupVisibilityChangedEventListener) private readonly _popupVisibleEvent!: PlayerPopupVisibilityChangedEventListener;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(LandingPlayerSetup) private readonly _landingPlayerSetup!: LandingPlayerSetup;\n\n  private readonly _logger;\n  private readonly _lobbyPlayers$ = new BehaviorSubject<SkribblLobbyPlayer[]>([]);\n  private readonly _landingPlayer$ = new BehaviorSubject<SkribblLandingPlayer | undefined>(undefined);\n  private readonly _scoreboardPlayers$ = new BehaviorSubject<SkribblPlayerDisplay[]>([]);\n  private readonly _popupPlayer$ = new BehaviorSubject<SkribblPlayerDisplay | undefined>(undefined);\n  private readonly _overlayPlayer$ = new BehaviorSubject<SkribblPlayerDisplay | undefined>(undefined);\n  private readonly _players$ = new BehaviorSubject<SkribblPlayerDisplay[]>([]);\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  @postConstruct()\n  private postConstruct() {\n    this.setupLandingPlayer();\n    this.setupLobbyPlayers();\n    this.setupScoreboardPlayers();\n    this.setupPopupPlayer();\n    this.setupOverlayPlayer();\n    this.setupCombinedPlayers();\n  }\n\n  private setupCombinedPlayers(){\n    this._lobbyPlayers$.pipe(\n      startWith([]),\n      combineLatestWith(\n        this.landingPlayer$,\n        this.scoreboardPlayers$,\n        this.popupPlayer$,\n        this.overlayPlayer$\n      ),\n      map(([players, landing, scoreboard, popup, overlay]) => [\n        ...players,\n        landing,\n        ...scoreboard,\n        popup,\n        overlay\n      ]\n        .filter(player => player !== undefined) as SkribblPlayerDisplay[])\n    ).subscribe(this._players$);\n\n    /* destroy when removed */\n    this.players$.pipe(\n      pairwise()\n    ).subscribe(([oldPlayers, newPlayers]) => {\n      oldPlayers.filter(player => !newPlayers.includes(player)).forEach(player => player.destroy());\n    });\n  }\n\n  private setupLandingPlayer(){\n    of(undefined).pipe(\n      mergeWith(from(this._landingPlayerSetup.complete()).pipe(\n        switchMap(player => player)\n      ))\n    ).subscribe(player => this._landingPlayer$.next(player));\n  }\n\n  private setupLobbyPlayers() {\n\n    /* create on lobby join */\n    this._lobbyJoinedEvent.events$.pipe(\n      combineLatestWith(this._memberService.member$)\n    ).subscribe(([event, member]) => {\n\n      const players = event.data.players.map((player) => {\n        try {\n          /* create lobby player, identify by lobby id or login if practice lobby */\n          const key = event.data.id ? calculateLobbyKey(event.data.id) : undefined;\n          return new SkribblLobbyPlayer(\n            player,\n            key, key === undefined && member ? Number(member.userLogin) : undefined);\n        }\n        catch (e) {\n          this._logger.error(\"Failed to create player\", player, e);\n          return null;\n        }\n      }).filter(player => player !== null);\n\n      this._lobbyPlayers$.next(players);\n      this._logger.info(\"Lobby joined\", players);\n    });\n\n    /* update on player change event */\n    this._playerChangedEvent.events$.pipe(\n      withLatestFrom(this._lobbyJoinedEvent.events$.pipe(\n        map((event) => event.data.id),\n        mergeWith(this._lobbyLeftEvent.events$.pipe(map(() => undefined)))\n      )),\n      combineLatestWith(this._memberService.member$),\n    ).subscribe(([[event, lobbyId], member]) => {\n\n      // if no lobby joined, clear all players\n      if(lobbyId === undefined){\n        this._lobbyPlayers$.next([]);\n        return;\n      }\n\n      // if practice lobby but member not logged in, clear all players\n      if(lobbyId === null && member === null || member === undefined){\n        this._lobbyPlayers$.next([]);\n        return;\n      }\n\n      /* add new player to players */\n      if(event.data.joined){\n        const current = this._lobbyPlayers$.value;\n\n        let newPlayer: SkribblLobbyPlayer;\n        try {\n\n          /* create lobby player, identify by lobby id or login if practice lobby */\n          const key = lobbyId ? calculateLobbyKey(lobbyId) : undefined;\n          newPlayer = new SkribblLobbyPlayer(\n            event.data.joined,\n            key, key === undefined && member ? Number(member.userLogin) : undefined);\n        }\n        catch (e) {\n          this._logger.error(\"Failed to create player\", event.data.joined, e);\n          return;\n        }\n\n        current.push(newPlayer);\n        this._lobbyPlayers$.next(current);\n        this._logger.info(\"Player joined\", newPlayer);\n      }\n\n      /* remove player from players */\n      if(event.data.left){\n\n        const id = event.data.left.id;\n        const left = this._lobbyPlayers$.value.find((player) => player.lobbyPlayerId === id);\n        const current = this._lobbyPlayers$.value.filter((player) => player != left);\n        this._lobbyPlayers$.next(current);\n        this._logger.info(\"Player left\", left);\n      }\n    });\n\n    /* reset players on lobby left */\n    this._lobbyLeftEvent.events$.subscribe(() => {\n      this._lobbyPlayers$.next([]);\n      this._logger.info(\"Lobby left\");\n    });\n  }\n\n  private setupScoreboardPlayers() {\n    this._lobbyStateChangedEvent.events$.pipe(\n      combineLatestWith(this._lobbyService.lobby$, this._scoreboardVisibleEvent.events$),\n      filter(data => data[2].data === true),  /* wait until scoreboard visible */\n      map((data) => data[1] === null || data[0].data.gameEnded === undefined ? undefined : data),\n      distinctUntilChanged(),\n    ).subscribe(data => {\n      const event = data?.[0].data?.gameEnded;\n      const lobby = data?.[1] ?? undefined;\n      const lobbyId = lobby?.id ?? null;\n      if(event === undefined || lobby === undefined || lobbyId === null) {\n        this._logger.info(\"Lobby changed, no scoreboard data\");\n        this._scoreboardPlayers$.next([]);\n        return;\n      }\n\n      const players = event.ranking\n        .map((player) => ({ player: lobby.players.find(p => p.id === player.playerId), rank: player.rank }))\n        .filter(player => player.player !== undefined)\n        .map(player => player.rank < 3 ?\n          new SkribblScoreboardPodiumPlayer(player.player as skribblPlayer, calculateLobbyKey(lobbyId)) :\n          new SkribblScoreboardRegularPlayer(player.player as skribblPlayer, calculateLobbyKey(lobbyId))\n        );\n\n      this._logger.info(\"Scoreboard visible, scoreboard data\", players);\n      this._scoreboardPlayers$.next(players);\n    });\n  }\n\n  private setupPopupPlayer() {\n    this._popupVisibleEvent.events$.pipe(\n      withLatestFrom(this._memberService.member$, this._lobbyService.lobby$, this._elementsSetup.complete()),\n    ).subscribe(([visible, member, lobby, elements]) => {\n      if(!visible || lobby === null){\n        this._logger.info(\"Popup player hidden\");\n        this._popupPlayer$.next(undefined);\n        return;\n      }\n\n      const playerId = element(\".player\", elements.playerPopup)?.getAttribute(\"playerid\") ?? undefined;\n      if(playerId === undefined) {\n        this._logger.error(\"No player id in popup\");\n        this._popupPlayer$.next(undefined);\n        return;\n      }\n\n      const player = lobby.players.find(p => p.id === Number(playerId));\n      if(player === undefined){\n        this._logger.error(\"Player not found in lobby\", playerId);\n        this._popupPlayer$.next(undefined);\n        return;\n      }\n\n      const lobbyKey = lobby.id ? calculateLobbyKey(lobby.id) : undefined;\n      const playerDisplay = new SkribblPopupPlayer(player, elements.playerPopup, lobbyKey, lobbyKey === undefined && member ? Number(member.userLogin) : undefined);\n      this._popupPlayer$.next(playerDisplay);\n      this._logger.info(\"Popup player visible\", playerDisplay);\n    });\n  }\n\n  private setupOverlayPlayer() {\n\n    this._textOverlayVisibleEvent.events$.pipe(\n      withLatestFrom(this._lobbyService.lobby$, this._elementsSetup.complete()),\n    ).subscribe(([visible, lobby, elements]) => {\n      if(!visible || lobby === null || lobby.id === null){\n        this._logger.info(\"Overlay player hidden\");\n        this._overlayPlayer$.next(undefined);\n        return;\n      }\n\n      const playerId = elements.textOverlay.getAttribute(\"playerid\") ?? undefined;\n      if(element(\".avatar\", elements.textOverlay) === undefined || playerId === undefined) {\n        this._logger.info(\"No player or playerid in overlay, probably not a choosing info\");\n        this._popupPlayer$.next(undefined);\n        return;\n      }\n\n      const player = lobby.players.find(p => p.id === Number(playerId));\n      if(player === undefined){\n        this._logger.error(\"Player not found in lobby\", playerId);\n        this._popupPlayer$.next(undefined);\n        return;\n      }\n\n      const lobbyKey = calculateLobbyKey(lobby.id);\n      const playerDisplay = new SkribblOverlayPlayer(player, lobbyKey,elements.textOverlay);\n      this._popupPlayer$.next(playerDisplay);\n      this._logger.info(\"Overlay player visible\", playerDisplay);\n    });\n  }\n\n  public get lobbyPlayers$() {\n    return this._lobbyPlayers$.asObservable();\n  }\n\n  public get landingPlayer$() {\n    return this._landingPlayer$.asObservable();\n  }\n\n  public get scoreboardPlayers$() {\n    return this._scoreboardPlayers$.asObservable();\n  }\n\n  public get popupPlayer$() {\n    return this._popupPlayer$.asObservable();\n  }\n\n  public get overlayPlayer$() {\n    return this._overlayPlayer$.asObservable();\n  }\n\n  public get players$() {\n    return this._players$.asObservable();\n  }\n}","<script lang=\"ts\">\n\n  import type { pendingElement } from \"@/content/services/chat/chat.service\";\n  import { onMount } from \"svelte\";\n\n  export let content: string = \"\";\n  export let title: string = \"\";\n  export let style: \"info\" | \"success\" | \"warn\" | \"normal\" = \"normal\"\n\n  let resolve: (value: pendingElement) => void;\n  export const message = new Promise<pendingElement>((res) => resolve = res);\n\n  let messageElement: HTMLElement;\n  let titleElement: HTMLElement;\n  let contentElement: HTMLElement;\n\n  onMount(() => {\n    resolve({\n      element: messageElement,\n      title,\n      content,\n      contentElement,\n      titleElement\n    });\n  });\n\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-chat-message{\n\n    b {\n      &.info{\n        color: var(--COLOR_CHAT_TEXT_DRAWING);\n      }\n\n      &.error {\n        color: var(--COLOR_CHAT_TEXT_LEAVE);\n      }\n\n      &.success {\n        color: var(--COLOR_CHAT_TEXT_GUESSED);\n      }\n\n      &.normal {\n        color: var(--COLOR_CHAT_TEXT_BASE);\n      }\n    }\n\n    span {\n      white-space: preserve;\n    }\n\n  }\n\n</style>\n\n<p bind:this={messageElement} class=\"typo-chat-message\" >\n  <b bind:this={titleElement} class=\"{style}\">{title}</b>\n  <span bind:this={contentElement}>{content}</span>\n</p>","import { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { MessageReceivedEventListener } from \"@/content/events/message-received.event\";\nimport { PlayersService } from \"@/content/services/players/players.service\";\nimport type { SkribblLobbyPlayer } from \"@/content/services/players/skribblLobbyPlayer\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { SkribblMessageRelaySetup } from \"@/content/setups/skribbl-message-relay/skribbl-message-relay.setup\";\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport { filter, map, mergeWith, Subject, withLatestFrom } from \"rxjs\";\nimport MessageComponent from \"./message.svelte\";\n\nexport interface pendingMessage {\n  player: SkribblLobbyPlayer;\n  content: string;\n}\n\nexport interface pendingElement {\n  title: string;\n  content: string;\n  element: HTMLElement;\n  titleElement: HTMLElement;\n  contentElement: HTMLElement;\n}\n\n@injectable()\nexport class ChatService {\n\n  @inject(ElementsSetup) private _elementsSetup!: ElementsSetup;\n  @inject(PlayersService) private _lobbyPlayersService!: PlayersService;\n  @inject(MessageReceivedEventListener) private _messageReceivedEventListener!: MessageReceivedEventListener;\n  @inject(SkribblMessageRelaySetup) private _messageRelaySetup!: SkribblMessageRelaySetup;\n\n  private readonly _logger;\n\n  private _elementDiscovered$ = new Subject<pendingElement>();\n  private _messageDiscovered$ = new Subject<pendingMessage>();\n  private _playerMessageReceived$ = new Subject<pendingMessage & pendingElement>();\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  @postConstruct()\n  private postConstruct() {\n    this._logger.debug(\"Initializing chat service\");\n    this.setupMessageObserver();\n  }\n\n  /**\n   * Setup the message observer to link chat messages with lobby players\n   * @private\n   */\n  private async setupMessageObserver() {\n\n    /* listen for new message nodes to link with message event */\n    const elements = await this._elementsSetup.complete();\n    const elementObserver = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.addedNodes.length > 0) {\n          const addedNode = mutation.addedNodes[0] as HTMLElement;\n          if (addedNode.tagName !== \"P\" || addedNode.children.length != 2) return;\n          const title = addedNode.children[0];\n          const content = addedNode.children[1];\n\n          if(title.tagName !== \"B\" || content.tagName !== \"SPAN\") return;\n          this._elementDiscovered$.next({\n            title: title.textContent ?? \"\",\n            content: content.textContent ?? \"\",\n            element: addedNode,\n            titleElement: addedNode.children[0] as HTMLElement,\n            contentElement: addedNode.children[1] as HTMLElement\n          });\n        }\n      });\n    });\n    elementObserver.observe(elements.chatContent, { childList: true, subtree: false });\n\n    /* listen for new received messages and match with lobby player */\n    this._messageReceivedEventListener.events$.pipe(\n      withLatestFrom(this._lobbyPlayersService.lobbyPlayers$),\n      map(([event, players]) => {\n        const player = players.find(p => p.lobbyPlayerId === event.data.senderId);\n\n        if (!player) {\n          this._logger.warn(\"Player not found for message\", event.data);\n          return;\n        }\n\n        return {player, content: event.data.message};\n      }),\n      filter(data => data !== undefined)\n    ).subscribe(data => this._messageDiscovered$.next(data));\n\n    /* link lobby players, message content and element */\n    const pendingMessages: pendingMessage[] = [];\n    const pendingElements: pendingElement[] = [];\n\n    this._messageDiscovered$.pipe(\n      map(data =>pendingMessages.push(data)),\n      mergeWith(this._elementDiscovered$.pipe(\n        filter(element => element.content.length !== 0),\n        map(data => pendingElements.push(data)))\n      )\n    ).subscribe(() => {\n      const matches = this.findMessageMatches(pendingMessages, pendingElements);\n      for(const match of matches){\n        this._playerMessageReceived$.next(match);\n        this._logger.debug(\"Message match found\", match);\n      }\n    });\n  }\n\n  /**\n   * Find matches between recorded messages and chat elements\n   * @param messages\n   * @param elements\n   * @private\n   */\n  private findMessageMatches(messages: pendingMessage[], elements: pendingElement[]){\n    const matches = [];\n    for(const message of messages){\n      for(const element of elements){\n        if(`${message.player.name}: ` === element.title && message.content === element.content){\n          matches.push({...message, ...element});\n          messages.splice(messages.indexOf(message), 1);\n          elements.splice(elements.indexOf(element), 1);\n          break;\n        }\n      }\n    }\n    return matches;\n  }\n\n  public get chatMessageAdded$() {\n    return this._elementDiscovered$.asObservable();\n  }\n\n  public get playerMessageReceived$() {\n    return this._playerMessageReceived$.asObservable();\n  }\n\n  /**\n   * Sends a chat message over socket.io as the player\n   */\n  public async sendChatMessage(content: string){\n    this._logger.debug(\"Sending chat message\", content);\n\n    const relay = await this._messageRelaySetup.complete();\n    relay.insertMessage({id: 30, data: {msg: content}});\n  }\n\n  /**\n   * Add a chat message to the local chat history\n   * @param content\n   * @param title\n   * @param style\n   */\n  public async addChatMessage(content?: string, title?: string, style: \"normal\" |\"info\" | \"success\" | \"warn\" = \"normal\"){\n    const elements = await this._elementsSetup.complete();\n\n    const container = elements.chatContent;\n    const isScrolledDown = container.scrollHeight - container.scrollTop - container.clientHeight < 50; // allow small margin to scroll down\n\n    const message = new MessageComponent({\n      target: container,\n      props: { title: title ?? \"\", content, style }\n    });\n\n    const chatMessage = await message.message;\n    if(isScrolledDown) container.scrollTo({ top: container.scrollHeight, behavior: \"instant\" });\n\n    this._elementDiscovered$.next(chatMessage);\n    return message;\n  }\n}","\nimport { ExtensionCommand } from \"@/content/core/commands/command\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\nimport { NumericExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyJoinedEventListener } from \"@/content/events/lobby-joined.event\";\nimport { ChatService } from \"@/content/services/chat/chat.service\";\nimport { scan, Subject, type Subscription, switchMap, tap, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\n\nexport class ChatClearFeature extends TypoFeature {\n  @inject(LobbyJoinedEventListener)\n  private readonly _lobbyJoinedEventListener!: LobbyJoinedEventListener;\n  @inject(ChatService) private readonly _chatService!: ChatService;\n\n  public readonly name = \"Chat Clear\";\n  public readonly description = \"Clears old messages in the chat for better performance\";\n  public readonly featureId = 42;\n\n  private _chatSubscription?: Subscription;\n  private _chatCleared$ = new Subject<void>();\n\n  private _clearChatCommand = this.useCommand(\n    new ExtensionCommand(\"clear\", this, \"Clear Chat\", \"Clears the chat messages\"),\n  ).run(async (command) => {\n    this._chatCleared$.next(undefined);\n    return new InterpretableSuccess(command, \"Chat cleared\");\n  });\n\n  private _autoFocusChatInputSetting = this.useSetting(\n    new NumericExtensionSetting(\"clear_quota\", 100, this)\n      .withName(\"Message Limit\")\n      .withDescription(\n        \"When the chat contains more than this limit, old messages are deleted. Set to 0 to disable.\",\n      ),\n  );\n\n  protected override async onActivate() {\n    this._chatSubscription = this._lobbyJoinedEventListener.events$\n      .pipe(\n        switchMap(() =>\n          this._chatService.chatMessageAdded$.pipe(\n            withLatestFrom(this._autoFocusChatInputSetting.changes$),\n            scan((acc, [message, limit]) => {\n\n              /* no limit set or limit not reached, accumulate */\n              if (limit <= 0 || acc.length < limit) return [...acc, message.element];\n\n              /* else limit reached, delete last and add new */\n              acc[0].remove();\n              return [...acc.slice(1), message.element];\n            }, [] as HTMLElement[]),\n\n            /* lsiten for clear and modify reduced array in-place */\n            switchMap(elements => this._chatCleared$.pipe(\n              tap(() => {\n                elements.forEach(element => element.remove());\n                elements.slice(0, elements.length);\n              })\n            ))\n          ),\n        ),\n      ).subscribe();\n  }\n\n  protected override async onDestroy() {\n    this._chatSubscription?.unsubscribe();\n    this._chatSubscription = undefined;\n  }\n}","import { InterpretableError } from \"@/content/core/commands/results/interpretable-error\";\n\n/**\n * Error to be thrown during interpretation when the remainder arg string is empty\n */\nexport class InterpretableEmptyRemainder extends InterpretableError {\n}","import type { commandExecutionContext } from \"@/content/core/commands/command\";\nimport {\n  type Interpretable,\n  type interpretableExecutionResult,\n  type interpretableInterpretationResult,\n} from \"@/content/core/commands/interpretable\";\nimport { InterpretableEmptyRemainder } from \"@/content/core/commands/results/interpretable-empty-remainder\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\n\n\n/**\n * An interpretable that represents a command parameter\n * @typeparam TSource The type of all previous interpretable (parameters) in the chain\n * @typeparam TParam The type of the parameter that this interpretable represents and adds to the source\n */\nexport abstract class ExtensionCommandParameter<TSource, TParam>\n  implements Interpretable<TSource, TSource & TParam, commandExecutionContext>\n{\n  private _execute?: (\n    result: TParam & TSource,\n    context: commandExecutionContext,\n  ) => interpretableExecutionResult<TSource & TParam, commandExecutionContext>;\n\n  protected constructor(\n    private _name: string,\n    private _description: string,\n  ) {}\n\n  public get name() {\n    return this._name;\n  }\n\n  public get description() {\n    return this._description;\n  }\n\n  public abstract readonly typeName: string;\n  public abstract readonly typeDescription: string;\n\n  /**\n   * Set the action to be executed after interpretation\n   * @param action\n   */\n  public withAction(\n    action: (\n      result: TParam & TSource,\n      context: commandExecutionContext,\n    ) => interpretableExecutionResult<TSource & TParam, commandExecutionContext>,\n  ) {\n    this._execute = action;\n    return this;\n  }\n\n  interpret(\n    args: string,\n    source: TSource,\n    context: commandExecutionContext,\n  ): interpretableInterpretationResult<TSource & TParam, commandExecutionContext> {\n\n    let skipMarkAsInterpreting = false;\n\n    /* parse arg */\n    try {\n      const { argument, remainder } = this.readArg(args, () => skipMarkAsInterpreting = true);\n\n      /* set param as interpreting in context */\n      if(!skipMarkAsInterpreting) context.currentInterpretedParameter = this as ExtensionCommandParameter<unknown, unknown>;\n\n      return Promise.resolve({\n        result: { ...source, ...argument },\n        context,\n        remainder,\n      });\n    }\n    catch(e){\n\n      /* if param did not signalize empty, set as being interpreted regardless of error */\n      if(!(e instanceof InterpretableEmptyRemainder)){\n        context.currentInterpretedParameter = this as ExtensionCommandParameter<unknown, unknown>;\n      }\n\n      throw e;\n    }\n  }\n\n  execute(\n    result: TParam & TSource,\n    context: commandExecutionContext,\n  ): interpretableExecutionResult<TSource & TParam, commandExecutionContext> {\n    return (\n      this._execute?.(result, context) ??\n      Promise.resolve({ result: new InterpretableSuccess(this) })\n    );\n  }\n\n\n  /**\n   * Parse arguments for this parameter type during interpretable interpretation\n   * Return null when argument was not found but optional\n   * @param args\n   * @param dontMarkInterpreting skip marking this param as interpreting in context\n   * @protected\n   */\n  protected abstract readArg(args: string, dontMarkInterpreting: () => void): { argument: TParam; remainder: string };\n}","import {\n  ExtensionCommandParameter,\n} from \"@/content/core/commands/command-parameter\";\nimport { InterpretableEmptyRemainder } from \"@/content/core/commands/results/interpretable-empty-remainder\";\n\nexport class StringCommandParameter<TSource, TMapped> extends ExtensionCommandParameter<TSource, TMapped>{\n\n  constructor(name: string, description: string, private _mapping: (number: string) => TMapped){\n    super(name, description);\n  }\n\n  public readonly typeName = \"text\";\n  public readonly typeDescription = \"a single word or text wrapped in quotes\";\n\n  protected readArg(args: string): { argument: TMapped; remainder: string } {\n\n    /* get next arg */\n    const regex = /^\\s*([\"'])(.*?)\\1/;\n\n    let arg = \"\";\n    let remainder = \"\";\n    const matchQuoted = args.trim().match(regex);\n\n    if(matchQuoted !== null){\n      arg = matchQuoted[2];\n      remainder = args.trim().slice(matchQuoted[0].length).trim();\n    }\n    else {\n      const split = args.trim().split(\" \");\n      arg = split[0].trim();\n      remainder = split.slice(1).join(\" \");\n    }\n\n    /* check if whitespace */\n    if(arg.length < 1 ){\n      throw new InterpretableEmptyRemainder(this);\n    }\n\n    /* parse arg */\n    const argument = this._mapping(arg);\n\n    /* return with remainder args */\n    return { remainder, argument };\n  }\n}","import { InterpretableError } from \"@/content/core/commands/results/interpretable-error\";\n\n/**\n * Error to be thrown during interpretation of a command parameter,\n * indicating the interpretation was not successful, instead of returning null\n */\nexport class InterpretableArgumentParsingError extends InterpretableError {\n}","import type { Interpretable } from \"@/content/core/commands/interpretable\";\nimport { InterpretableResult } from \"@/content/core/commands/results/interpretable-result\";\n\n/**\n * A successful result of an interpretable execution, indicating that the command does not need UI feedback\n */\nexport class InterpretableSilentSuccess extends InterpretableResult {\n  constructor(interpretable: Interpretable<unknown, unknown, unknown>) {\n    super(interpretable, undefined);\n  }\n}","<script lang=\"ts\">\n  import type { componentData } from \"@/content/services/modal/modal.service\";\n  import { Subject } from \"rxjs\";\n  import { onDestroy, onMount, type SvelteComponent } from \"svelte\";\n\n  /* explicit: close via close button, implicit: outbound click */\n  export let closeStrategy: \"implicit\" | \"explicit\" = \"implicit\";\n\n  export let alignment: \"top\" | \"bottom\" = \"bottom\";\n  export let marginY = \".5em\";\n  export let marginX = \"1em\";\n  export let areaName: string;\n  export let maxHeight: string | undefined = undefined;\n  export let maxWidth: string | undefined = undefined;\n  export let componentData: componentData<SvelteComponent>;\n  export let title: string | undefined = undefined;\n  export let iconName: string | undefined = undefined;\n\n  const clickedOutside = new Subject<void>();\n  export const closed$ = clickedOutside.asObservable();\n\n  let self: HTMLElement | undefined;\n  let closing = false;\n\n  /**\n   * Listen for clicks outside and emit event\n   * @param event\n   */\n  const clickListener = (event: MouseEvent) => {\n    if(!self || closeStrategy !== \"implicit\") return;\n    const target = event.target as HTMLElement;\n    if(!(self === target) && !self.contains(target)) {\n      close();\n    }\n  };\n\n  /**\n   * Init closing of the flyout\n   */\n  export const close = () => {\n    closing = true;\n    setTimeout(() => {\n      clickedOutside.next();\n    }, 80);\n  }\n\n  /**\n   * Remove event listener on destroy\n   */\n  onDestroy(() => {\n    document.removeEventListener(\"click\", clickListener);\n  });\n\n  /**\n   * Add event listener on mount\n   */\n  onMount(() => {\n\n    // hack to escape immediately closing on event that opened the flyout???\n    setTimeout(()=>document.addEventListener(\"click\", clickListener), 1);\n  });\n\n  const getMaxHeightCss = () => {\n    return maxHeight ? `calc(${maxHeight} - (2 * ${marginY}))` : 'auto';\n  }\n\n  const getMaxWidthCss = () => {\n    return maxWidth ? `calc(${maxWidth} - (2 * ${marginX}))` : 'auto';\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes slideIn {\n    from {\n      transform: scaleY(0);\n      opacity: 0;\n    }\n    to {\n      transform: scaleY(100%);\n      opacity: 100;\n    }\n  }\n\n  @keyframes slideOut {\n    from {\n      transform: scaleY(100%);\n      opacity: 100;\n    }\n    to {\n      transform: scaleY(0);\n      opacity: 0;\n    }\n  }\n\n  .typo-area-flyout {\n    position: relative;\n    color: var(--COLOR_PANEL_TEXT);\n    z-index: 1;\n    /*margin: .5em 1em;*/\n    border-radius: 10px;\n    padding: 1em;\n    animation: slideIn .08s ease-out;\n    display: flex;\n    gap:1rem;\n    flex-direction: column;\n    align-items: center;\n\n    &.align-top  {\n      align-self: start;\n      transform-origin: top;\n    }\n\n    &.align-bottom {\n      align-self: end;\n      transform-origin: bottom;\n    }\n\n    &.closing {\n      animation: slideOut .08s ease-out forwards;\n    }\n\n    /* background on separate after element because backdrop blur fucks rendering up */\n    &:after {\n      animation: slideIn .08s ease-out;\n      background: var(--COLOR_PANEL_BG);\n      content: \"\";\n      position: absolute;\n      inset: 0;\n      border-radius: 10px;\n      z-index: -1;\n      transform: none !important; // dont use transform from animation\n      backdrop-filter: blur(2px);\n    }\n\n    &.closing:after {\n      animation: slideOut .08s ease-out forwards;\n    }\n\n    .close-explicit {\n      position: absolute;\n      top: 0;\n      right: .5rem;\n      font-size: 1.5rem;\n      font-weight: 900;\n      cursor: pointer;\n      z-index: 1;\n    }\n\n    > h3 {\n      display: flex;\n      gap: 1em;\n      align-items: center;\n\n      > img {\n        user-select: none;\n        height: 1.8em;\n        width: 1.8em;\n        filter: drop-shadow(3px 3px 0px rgba(0, 0, 0, .3));\n      }\n    }\n\n    > .content {\n      width: 100%;\n      overflow-y: auto;\n      padding: 0 1em;\n    }\n  }\n\n</style>\n\n<div class=\"typo-area-flyout color-scrollbar\" class:closing={closing} class:align-top={alignment === \"top\"} class:align-bottom={alignment === \"bottom\"}\n     style=\"max-height: {getMaxHeightCss()}; max-width: {getMaxWidthCss()}; grid-area: {areaName}; margin: {marginY} {marginX};\"\n  bind:this={self}\n>\n  {#if title}\n    <h3>\n      {#if iconName}\n        <img src=\"\" alt=\"Icon\" style=\"content: var(--{iconName})\" />\n      {/if}\n      <span>{title}</span>\n    </h3>\n  {/if}\n\n  <div class=\"content\">\n    <svelte:component this={componentData.componentType} {...componentData.props} />\n  </div>\n\n\n  <!-- close button -->\n  {#if closeStrategy === \"explicit\"}\n    <span class=\"close-explicit\" on:click={() => close()}>\n        ×\n    </span>\n  {/if}\n</div>","<script lang=\"ts\">\n  import type { EmojiDto } from \"@/api\";\n  import { NumericCommandParameter } from \"@/content/core/commands/params/numeric-command-parameter\";\n  import {\n    InterpretableCommandPartialMatch\n  } from \"@/content/core/commands/results/interpretable-command-partial-match\";\n  import type { ChatCommandsFeature } from \"@/content/features/chat-commands/chat-commands.feature\";\n  import type { ChatEmojisFeature } from \"@/content/features/chat-emojis/chat-emojis.feature\";\n  import { firstValueFrom } from \"rxjs\";\n\n  export let feature: ChatCommandsFeature;\n\n  const currentCommands = feature.commandResultStore;\n  const combo = feature.submitHotkeyStore;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-command-preview {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n\n    &:not(:has(.typo-command-result)) {\n      gap: .2rem;\n    }\n\n    .typo-command-result {\n      display: flex;\n      flex-direction: column;\n      gap: .2rem;\n\n      .typo-command-result-synopsis {\n        display: flex;\n        gap: .4rem;\n        flex-wrap: wrap;\n        align-items: center;\n\n        .typo-command-result-arg {\n          background-color: var(--COLOR_PANEL_BG);\n          padding: .2rem;\n          border-radius: 3px;\n          opacity: .5;\n\n          &.current {\n            opacity: 1;\n          }\n        }\n\n        .typo-command-result-id {\n          padding: .2rem;\n          border-radius: 3px;\n          font-weight: bolder;\n\n          &.current {\n            background-color: var(--COLOR_PANEL_BG);\n          }\n        }\n      }\n\n      .typo-command-result-description {\n        .typo-command-result-param-type {\n          display: block;\n          opacity: .7;\n        }\n      }\n\n      .typo-command-result-state {\n        display: flex;\n        gap: .5rem;\n        align-items: center;\n        margin-top: .3rem;\n        opacity: .7;\n\n        img {\n          height: 1.3rem;\n        }\n      }\n\n    }\n  }\n\n</style>\n\n\n<div class=\"typo-command-preview\">\n  {#each $currentCommands as result}\n    {#if result.result !== null}\n\n      <div class=\"typo-command-result\">\n\n        <div class=\"typo-command-result-synopsis\">\n          <div class=\"typo-command-result-id\" class:current={feature.isActiveTypingId(result)}>\n            /\n            {#await firstValueFrom(result.context.command.idSetting.changes$)}\n            {:then res}\n              {res}\n            {/await}\n          </div>\n\n          {#each result.context.parameters as param}\n            <div class=\"typo-command-result-arg\" class:current={feature.isActiveTypingParam(result, param)}>\n              {param.typeName}\n            </div>\n          {/each}\n        </div>\n\n        <div class=\"typo-command-result-description\">\n          {#if result.context.currentInterpretedParameter === undefined}\n            {result.context.command.description}\n          {:else if !feature.otherHasExecutionTarget(result, $currentCommands)}\n            <b>{result.context.currentInterpretedParameter.name}:</b> {result.context.currentInterpretedParameter.description}<br>\n            <span class=\"typo-command-result-param-type\">\n              <b>Content: </b>{result.context.currentInterpretedParameter.typeDescription}\n            </span>\n          {/if}\n        </div>\n\n        {#if !(result.result instanceof InterpretableCommandPartialMatch)}\n          <div class=\"typo-command-result-state\">\n            {#if feature.otherHasExecutionTarget(result, $currentCommands)}\n              <span>Another command is prioritized</span>\n            {:else }\n              <img src=\"\" alt=\"icon\" style=\"content: var(--{feature.isValidCommand(result) ? 'file-img-enabled-gif' : 'file-img-disabled-gif'})\">\n              <span>{feature.getResultStateMessage(result, $combo)}</span>\n            {/if}\n\n          </div>\n        {/if}\n\n      </div>\n\n    {/if}\n  {/each}\n\n  {#if $currentCommands.every(result => result.result === null)}\n    <div>Type a command id..</div>\n    {#each $currentCommands as result}\n      <b>/\n        {#await firstValueFrom(result.context.command.idSetting.changes$)}\n        {:then res}\n          {res}\n        {/await}\n      </b>\n    {/each}\n  {/if}\n</div>\n\n","<script lang=\"ts\">\n  export let onInput: (args: string) => void;\n</script>\n\n\n<style lang=\"scss\">\n\n  :global(.chat-form:has(#typo-command-input) input:not(#typo-command-input)){\n    display: none;\n  }\n\n</style>\n\n<input id=\"typo-command-input\" autofocus type=\"text\" value=\"/\" placeholder=\"Type your command here..\"\n   on:input={e => {\n     onInput(e.currentTarget.value);\n   }}\n   on:submit={e => {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n   }}\n/>","import { ExtensionCommand } from \"@/content/core/commands/command\";\nimport {\n  type ExtensionCommandParameter,\n\n} from \"@/content/core/commands/command-parameter\";\nimport { type CommandExecutionResult } from \"@/content/core/commands/commands.service\";\nimport { StringCommandParameter } from \"@/content/core/commands/params/string-command-parameter\";\nimport {\n  InterpretableArgumentParsingError\n} from \"@/content/core/commands/results/interpretable-argument-parsing-error\";\nimport { InterpretableDeferResult } from \"@/content/core/commands/results/interpretable-defer-result\";\nimport { InterpretableCommandPartialMatch } from \"@/content/core/commands/results/interpretable-command-partial-match\";\nimport { InterpretableEmptyRemainder } from \"@/content/core/commands/results/interpretable-empty-remainder\";\nimport { InterpretableError } from \"@/content/core/commands/results/interpretable-error\";\nimport { InterpretableSilentSuccess } from \"@/content/core/commands/results/interpretable-silent-success\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\nimport { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { TextExtensionSetting } from \"@/content/core/settings/setting\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { filter, Subject, type Subscription, switchMap, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport CommandPreview from \"./command-preview.svelte\";\nimport CommandInput from \"./command-input.svelte\";\n\nexport class ChatCommandsFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  public readonly name = \"Chat Commands\";\n  public readonly description = \"Execute actions of other features with chat commands\";\n  public readonly featureId = 38;\n\n  private _interpreterSubscription?: Subscription;\n  private _submitSubscription?: Subscription;\n  private _commandArgs$ = new Subject<string>();\n  private _hotkeySubmitted$ = new Subject();\n  private _commandResults$ = new Subject<CommandExecutionResult[]>();\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n  private _commandInput?: CommandInput;\n  private readonly _inputChangeListener = this.handleInputEvent.bind(this);\n\n  private readonly _submitCommandHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"submit_command\",\n      \"Submit Command\",\n      \"When pressed, the currently typed command will be submitted\",\n      this,\n      async () => {\n        const elements = await this._elements.complete();\n        elements.chatInput.value = \"\";\n        this._hotkeySubmitted$.next(undefined);\n      },\n      true,\n      [\"Enter\"],\n      undefined,\n      false\n    ),\n  );\n\n  private readonly _customPrefixSetting = this.useSetting(\n    new TextExtensionSetting(\"custom_prefix\", \"\", this)\n      .withName(\"Custom Command Prefix\")\n      .withDescription(\"Set a custom prefix for chat commands that will trigger the command prompt, additionally to ' / '\")\n  );\n\n  private readonly _echoCommand = this.useCommand(\n    new ExtensionCommand(\"echo\", this, \"Echo\", \"Echo a text :)\"),\n  ).withParameters(params => params\n    .addParam(new StringCommandParameter(\"text\", \"The text to echo\", text => ({text})))\n    .run(async ({text}, command) => {\n          return new InterpretableSuccess(command, text);\n    })\n  );\n\n  protected override async onActivate() {\n\n    const elements = await this._elements.complete();\n    elements.chatInput.addEventListener(\"input\", this._inputChangeListener);\n\n    /* listen for new command arguments, interpret them and set flyout state */\n    this._interpreterSubscription = this._commandArgs$\n      .pipe(\n        withLatestFrom(this._commandsService.commands$),\n        switchMap(async ([args, commands]) => {\n\n          /* command is still being entered */\n          if (args.startsWith(\"/\")) {\n            args = args.substring(1);\n            return Promise.all(\n              commands.map(async (command) => this._commandsService.executeCommand(command, args)),\n            );\n          }\n\n          /* / has been deleted, close input */\n          else {\n            this._commandInput?.$destroy();\n            this._commandInput = undefined;\n            elements.chatInput.focus();\n            return [];\n          }\n        }),\n      )\n      .subscribe((results) => {\n        this._logger.debug(\"Command results changed\", results);\n        this.setFlyoutState(results.length > 0, elements);\n        const sorted = [...results]\n          .sort((a, b) => {\n            const aIsSuccess = a.result instanceof InterpretableSuccess;\n            const bIsSuccess = b.result instanceof InterpretableSuccess;\n\n            if (aIsSuccess === bIsSuccess) return 0;\n            return aIsSuccess ? -1 : 1;\n          });\n        this._commandResults$.next(sorted);\n      });\n\n    /**\n     * execute interpreted command on hotkey submission\n     */\n    this._submitSubscription = this._hotkeySubmitted$\n      .pipe(\n        withLatestFrom(this._commandResults$, this._commandArgs$),\n        filter(([, , args]) => args.startsWith(\"/\")),\n      )\n      .subscribe(async ([, results]) => this.commandSubmitted(results));\n  }\n\n  protected override async onDestroy() {\n    const elements = await this._elements.complete();\n    elements.chatInput.removeEventListener(\"input\", this._inputChangeListener);\n    this._interpreterSubscription?.unsubscribe();\n    this._interpreterSubscription = undefined;\n    this._submitSubscription?.unsubscribe();\n    this._submitSubscription = undefined;\n    this._commandInput?.$destroy();\n    this._commandInput = undefined;\n    this.setFlyoutState(false, elements);\n  }\n\n  public get commandResultStore() {\n    return fromObservable(this._commandResults$, []);\n  }\n\n  public get submitHotkeyStore(){\n    return this._submitCommandHotkey.comboSetting.store;\n  }\n\n  /**\n   * chat received input\n   * check if starts with / and show command input instead\n   */\n  async handleInputEvent(event: Event ) {\n    const target = event.currentTarget as HTMLInputElement | null;\n    const customPrefix = await this._customPrefixSetting.getValue();\n    if(target !== null && (target.value === \"/\" || customPrefix !== \"\" && target.value === customPrefix)){\n      await this.switchToCommandMode();\n    }\n  }\n\n  /**\n   * Hide the original chat input and open the command input\n   * @private\n   */\n  private async switchToCommandMode() {\n    const elements = await this._elements.complete();\n    elements.chatInput.value = \"\";\n    elements.chatInput.dispatchEvent(new Event(\"input\"));\n    if(!this._commandInput){\n      this._commandInput = new CommandInput({\n        target: elements.chatForm,\n        props: {\n          onInput: (args: string) => this._commandArgs$.next(args),\n        },\n      });\n      this._commandArgs$.next(\"/\");\n    }\n  }\n\n  /**\n   * Callback when the command submit hotkey has been pressed\n   * Check interpretation results and run valid command\n   * @param interpretationResults\n   */\n  public async commandSubmitted(interpretationResults: CommandExecutionResult[]) {\n    this._logger.info(\"Commands submitted\", interpretationResults);\n\n    this._commandInput?.$destroy();\n    this._commandArgs$.next(\"\");\n    const match = interpretationResults.find((result) => result.result instanceof InterpretableSuccess);\n    if(match !== undefined && match.result instanceof InterpretableSuccess){\n\n      /* match returned an action to be executed later */\n      if(match.result instanceof InterpretableDeferResult){\n        const toast = await this._toastService.showLoadingToast(`Command: ${match.context.command.name}`);\n        const result = await match.result.run();\n\n        if(!(result instanceof InterpretableSilentSuccess)) toast.resolve(result.message);\n        else toast.close();\n      }\n\n      /* match executed during interpretation resolution.\n        should actually not be used for commands; would execute on every type event */\n      else {\n        if(match.result.message) await this._toastService.showToast(`${match.result.message}`);\n        else if(!(match.result instanceof InterpretableSilentSuccess)) await this._toastService.showToast(`${match.context.command.name}`);\n      }\n    }\n    else {\n      await this._toastService.showToast(\"No valid command entered\");\n    }\n  }\n\n  /**\n   * Create or destroy the command preview flyout\n   * @param state\n   * @param elements\n   */\n  setFlyoutState(\n    state: boolean,\n    elements: Awaited<ReturnType<(typeof this._elements)[\"complete\"]>>,\n  ) {\n    if (state && this._flyoutComponent === undefined) {\n\n      /* create fly out content */\n      const flyoutContent: componentData<CommandPreview> = {\n        componentType: CommandPreview,\n        props: {\n          feature: this,\n        },\n      };\n\n      /* open flyout and destroy when clicked out */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          marginY: \"2.5rem\",\n          title: \"Command Preview\",\n          closeStrategy: \"implicit\",\n\n        },\n      });\n\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(() => {\n        this._logger.info(\"Destroyed flyout\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutComponent = undefined;\n      });\n    } else if (this._flyoutComponent !== undefined && !state) {\n      this._flyoutComponent.close();\n    }\n  }\n\n  /**\n   * Check if the parameter is currently interpreting the user input\n   * @param result\n   * @param param\n   */\n  public isActiveTypingParam(\n    result: CommandExecutionResult,\n    param: ExtensionCommandParameter<unknown, unknown>,\n  ) {\n    this._logger.debug(\"Checking if param is active\", result, param);\n    return result.context.currentInterpretedParameter === param;\n  }\n\n  /**\n   * Check if the command (name) is currently interpreting the user input\n   * @param result\n   */\n  public isActiveTypingId(result: CommandExecutionResult) {\n    return result.result === undefined;\n  }\n\n  /**\n   * Check if the command is currently interpreting\n   * @param result\n   */\n  public isValidCommand(result: CommandExecutionResult) {\n    return result.result instanceof InterpretableSuccess;\n  }\n\n  /**\n   * Check if there are other commands that are the current execution target\n   * @param result\n   * @param commands\n   */\n  public otherHasExecutionTarget(result: CommandExecutionResult, commands: CommandExecutionResult[]) {\n    const successes = commands.filter((command) => command.result instanceof InterpretableSuccess);\n    return successes.length == 0 || successes[0] !== result;\n  }\n\n  /**\n   * Get a human readable status message of a command interpretation context\n   * @param result\n   * @param hotkeys\n   */\n  public getResultStateMessage(result: CommandExecutionResult, hotkeys: string[]) {\n    if (result.result instanceof InterpretableSuccess) {\n      return `Press ${hotkeys.join(\" + \")} to submit`;\n    }\n    if (result.result instanceof InterpretableArgumentParsingError) {\n      return \"The current argument is invalid\";\n    }\n    if (result.result instanceof InterpretableCommandPartialMatch) {\n      return \"The command id is incomplete\";\n    }\n    if (result.result instanceof InterpretableEmptyRemainder) {\n      return \"Some arguments are missing\";\n    }\n    if (result.result instanceof InterpretableError) {\n      return result.result.message;\n    }\n  }\n}","import { ToastService } from \"@/content/services/toast/toast.service\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport { BehaviorSubject, distinctUntilChanged, type Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\nexport class ChatCopyFormattedFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  private _iconElement?: IconButton;\n\n  public readonly name = \"Copy Chat Formatted\";\n  public readonly description = \"Enables to copy selected chat messages formatted for discord messages\";\n  public readonly featureId = 36;\n\n  private selectedText$ = new BehaviorSubject<string | null>(null); /* current chat message selection */\n  private readonly _selectionChangeListener = this.onSelectionChange.bind(this); /* bind listener for context, needed to make unsubscription possible */\n  private _selectedTextSubscription?: Subscription;\n  private _iconClickSubscription?: Subscription;\n\n  protected override async onActivate() {\n\n    /* listen for dom event */\n    document.addEventListener(\"selectionchange\", this._selectionChangeListener);\n\n    /* process changed selected text */\n    this._selectedTextSubscription = this.selectedText$.pipe(\n      distinctUntilChanged()\n    ).subscribe(text => {\n      this.processChangedChatSelection(text);\n    });\n  }\n\n  protected override onDestroy() {\n    document.removeEventListener(\"selectionchange\", this._selectionChangeListener);\n    this._selectedTextSubscription?.unsubscribe();\n    this._iconClickSubscription?.unsubscribe();\n    this._iconClickSubscription = undefined;\n    this._iconElement?.$destroy();\n    this._iconElement = undefined;\n  }\n\n  /**\n   * Callback for DOM selection change event\n   * @private\n   */\n  private async onSelectionChange() {\n    this._logger.debug(\"Selection changed\");\n    const elements = await this._elementsSetup.complete();\n\n    const selection = document.getSelection();\n    if(!selection || selection.rangeCount === 0) {\n      this.selectedText$.next(null);\n      return;\n    }\n\n    const range = selection.getRangeAt(0);\n    if(range.commonAncestorContainer instanceof HTMLElement && range.commonAncestorContainer === elements.chatContent) {\n\n      /* get start/end nodes - take parent elem if node is text*/\n      let start = (range.startContainer.nodeName === \"#text\" ? range.startContainer.parentElement : range.startContainer);\n      let end = (range.endContainer.nodeName === \"#text\" ? range.endContainer.parentElement : range.endContainer);\n\n      /*if(start?.nodeType === 3) start = start.parentNode;\n      if(end?.nodeType === 3) end = end.parentNode;*/\n\n      if(!(end instanceof HTMLElement && start instanceof HTMLElement)) {\n        this._logger.warn(\"Could not find start or end element\", start, end);\n        this.selectedText$.next(null);\n        return;\n      }\n\n      /* find closest p, indicating the message wrapper */\n      start = start.closest(\"p\") as HTMLElement | null;\n      end = end.closest(\"p\") as HTMLElement | null;\n      if(!(start instanceof HTMLElement && end instanceof HTMLElement)) {\n        this._logger.warn(\"Could not find start or end paragraph\", start, end);\n        this.selectedText$.next(null);\n        return;\n      }\n\n      /* take all messages between start and end, and crate chat string from it */\n      const ps = [...document.querySelectorAll(\".chat-content p\")];\n      const elems = ps.slice(ps.indexOf(start), ps.indexOf(end)+1);\n      console.log(elems.length);\n      const text = elems.map(e => e.textContent).join(\"\\n\");\n      this.selectedText$.next(text);\n    }\n    else this.selectedText$.next(null);\n  }\n\n  private async processChangedChatSelection(text: string | null) {\n    this._logger.info(\"Selected text changed\", text);\n\n    const elements = await this._elementsSetup.complete();\n\n    /* if copy button exists, but no selection made, remove it */\n    if(this._iconElement && text === null){\n      this._iconElement?.$destroy();\n      this._iconElement = undefined;\n      this._iconClickSubscription?.unsubscribe();\n      this._iconClickSubscription = undefined;\n    }\n\n    /* if selection exists, but no button present, create it */\n    if(text !== null && !this._iconElement){\n      this._iconElement = new IconButton({\n        target: elements.chatControls,\n        props: {\n          icon: \"file-img-discord-gif\",\n          name: \"Copy Chat for Discord\",\n          order: 3,\n          size: \"2rem\",\n          hoverMove: false,\n          greyscaleInactive: true,\n          tooltipAction: this.createTooltip\n        }\n      });\n\n      this._iconClickSubscription = this._iconElement.click$.subscribe(async () => {\n        const currentText = this.selectedText$.value;\n        if(currentText === null) {\n          this._logger.warn(\"No text selected, but copy button clicked - illegal state\");\n          return;\n        }\n\n        const formatted = this.formatChatForDiscord(currentText);\n        this._logger.info(\"Copy button clicked for selection\", formatted);\n        await navigator.clipboard.writeText(formatted);\n        await this._toastService.showToast(\"Chat copied to clipboard\");\n        document.getSelection()?.removeAllRanges();\n      });\n    }\n  }\n\n  /**\n   * Create discord code block from text\n   * @param text\n   * @private\n   */\n  private formatChatForDiscord(text: string): string {\n    const chat = text.replace(/(\\n)(?=.*? guessed the word!)/g, \"\\n+ \")\n      .replace(/(\\n)(?=.*? joined.)/g, \"\\n+ \")\n      .replace(/(\\n)(?=The word was)/g, \"\\n+ \")\n      .replace(/(\\n)(?=.*? is drawing now!)/g, \"\\n+ \")\n      .replace(/(\\n)(?=.*? is now the room owner!)/g, \"\\n+ \")\n      .replace(/(\\n)(?=.*? left.)/g, \"\\n- \")\n      .replace(/(\\n)(?=.*? is voting to kick.)/g, \"\\n- \")\n      .replace(/(\\n)(?=.*? was kicked.)/g, \"\\n- \")\n      .replace(/(\\n)(?=Whoops.*? caught the drop before you.)/g, \"\\n--- \")\n      .replace(/(\\n)(?=Yeee.*? and caught the drop!)/g, \"\\n--- \");\n\n    return \"```diff\\n\" + chat + \"\\n```\";\n  }\n}","// https://stackoverflow.com/a/60689307\n\nexport function promiseAllObject<T extends Record<keyof T, unknown>>(obj: T): Promise<{ [K in keyof T]: Awaited<T[K]> }> {\n  return Promise.all(\n    Object.entries(obj).map(async ([k, v]) => [k, await v])\n  ).then(Object.fromEntries);\n}","import { AnnouncementsApi, AwardsApi, EmojisApi, EventsApi, ScenesApi, SpritesApi, ThemesApi } from \"@/api\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { promiseAllObject } from \"@/util/promiseAllObject\";\nimport { Setup } from \"../../core/setup/setup\";\nimport { inject } from \"inversify\";\n\n/**\n * Function to make dynamic return type\n */\nfunction getData(\n  spritesApi: SpritesApi,\n  scenesApi: ScenesApi,\n  eventsApi: EventsApi,\n  emojisApi: EmojisApi,\n  announcementsApi: AnnouncementsApi,\n  themesApi: ThemesApi,\n  awardsApi: AwardsApi\n) {\n  return {\n    sprites: spritesApi.getAllSprites(),\n    scenes: scenesApi.getAllScenes(),\n    emojis: emojisApi.getAllEmojisCached({ limit: 100000, animated: true, statics: true }),\n    announcements: announcementsApi.getAnnouncements(),\n    themes: themesApi.getAllThemes(),\n    drops: eventsApi.getAllEventDrops(),\n    awards: awardsApi.getAllAwards()\n  };\n}\nexport type apiData = ReturnType<typeof promiseAllObject<ReturnType<typeof getData>>>;\n\n/**\n * Setup to fetch common resources from the API\n */\nexport class ApiDataSetup extends Setup<apiData> {\n  @inject(ApiService) private _apiService!: ApiService;\n  @inject(ToastService) private _toastService!: ToastService;\n  @inject(loggerFactory) private _loggerFactory!: loggerFactory;\n\n  protected async runSetup(): Promise<apiData> {\n    const logger = this._loggerFactory(this);\n\n    const promise = promiseAllObject(getData(\n      this._apiService.getApi(SpritesApi),\n      this._apiService.getApi(ScenesApi),\n      this._apiService.getApi(EventsApi),\n      this._apiService.getApi(EmojisApi),\n      this._apiService.getApi(AnnouncementsApi),\n      this._apiService.getApi(ThemesApi),\n      this._apiService.getApi(AwardsApi)\n    ));\n\n    promise.catch((e) => {\n      this._toastService.showToast(\"Fatal error\", \"Failed to fetch data from the typo servers. \\nPlease ask for support on the typo discord server.\");\n      logger.error(\"Failed to fetch data from the typo servers\", e);\n    });\n\n    return promise;\n  }\n}","<script lang=\"ts\">\n\n</script>\n\n<style lang=\"scss\">\n  :global(#game-chat:has(.typo-emojis-enabled)) :global(.typo-emoji-container){\n    display: inline-flex;\n    flex-wrap: wrap;\n    align-items: center;\n    gap: 1ex;\n\n    :global(.typo-emoji) {\n      background-image: var(--typo-emoji-url);\n      color: transparent;\n      overflow: hidden;\n      width: 1.5em;\n      height: 1.5em;\n      background-size: contain;\n      background-repeat: no-repeat;\n      display: inline-block;\n      image-rendering: auto;\n\n      &::selection {\n        background-color: transparent;\n        color: transparent;\n      }\n    }\n  }\n\n  .typo-command-preview {\n    position: absolute;\n    bottom: 100%;\n    height: 1em;\n    left: 0;\n    right: 0;\n  }\n</style>\n\n<div class=\"typo-emojis-enabled\"></div>\n\n","<script lang=\"ts\">\n  import type { EmojiDto } from \"@/api\";\n  import type { ChatEmojisFeature } from \"@/content/features/chat-emojis/chat-emojis.feature\";\n\n  export let feature: ChatEmojisFeature;\n  export let onSelected: ((emoji: EmojiDto) => void) | undefined = undefined;\n\n  let hoverEmoji: EmojiDto | undefined;\n  const emojiCandidates = feature.emojiCandidatesStore;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-command-preview {\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: row;\n    gap: .5ex;\n    justify-content: space-evenly;\n\n    .emoji-picker-candidate {\n      height: 2.5em;\n      aspect-ratio: 1;\n      image-rendering: auto;\n      cursor: pointer;\n      transition: transform .1s;\n\n      &:hover {\n        transform: scale(.9);\n      }\n    }\n  }\n\n  .typo-emoji-picker-hint {\n    text-align: center;\n    margin-bottom: 1em;\n    font-weight: 600;\n    text-overflow: ellipsis;\n    overflow: hidden;\n  }\n\n</style>\n\n<div class=\"typo-emoji-picker-hint\">\n  {#if $emojiCandidates.length === 0}\n    No matching emojis.<br>Type something else to search again!\n  {:else }\n    {#if hoverEmoji !== undefined}\n      :{hoverEmoji.name}:\n    {:else}\n      Hover emojis & click to pick\n    {/if}\n  {/if}\n</div>\n\n<div class=\"typo-command-preview\" on:mouseleave={() => hoverEmoji = undefined}>\n  {#each $emojiCandidates as emoji}\n    <img class=\"emoji-picker-candidate\" src={emoji.url} alt={emoji.name}\n      on:mouseenter={() => hoverEmoji = emoji}\n      on:click={() => onSelected?.(emoji)}\n    >\n  {/each}\n</div>\n\n","import type { EmojiDto } from \"@/api\";\nimport { ChatService } from \"@/content/services/chat/chat.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport { BehaviorSubject, type Subscription } from \"rxjs\";\nimport ChatEmojis from \"./chat-emojis.svelte\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\nimport EmojiPicker from \"./emoji-picker.svelte\";\n\nexport class ChatEmojisFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(ChatService) private readonly _chatService!: ChatService;\n\n  public readonly name = \"Chat Emojis\";\n  public readonly description = \"Adds support for emojis using ':emoji-name:' format in the chat.\";\n  public readonly featureId = 22;\n\n  private _inputListener = this.handleInputEvent.bind(this);\n\n  private _subscription?: Subscription;\n  private _component?: ChatEmojis;\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n  private _emojiCandidates$ = new BehaviorSubject<EmojiDto[]>([]);\n\n  protected override async onActivate() {\n\n    /* add handler for typing and picker */\n    const elements = await this._elements.complete();\n    elements.chatInput.addEventListener(\"keyup\", this._inputListener);\n\n    /* process received messages */\n    const emojis = (await this._apiDataSetup.complete()).emojis;\n    this._subscription = this._chatService.playerMessageReceived$.subscribe(({ contentElement }) => {\n      this.processAddedMessage(contentElement, emojis);\n    });\n\n    /* add styles */\n    this._component = new ChatEmojis({ target: elements.chatArea });\n  }\n\n  protected override async onDestroy() {\n    const elements = await this._elements.complete();\n    elements.chatInput.removeEventListener(\"keyup\", this._inputListener);\n\n    this._subscription?.unsubscribe();\n    this._component?.$destroy();\n    this._component = undefined;\n    this._subscription = undefined;\n\n    this._flyoutSubscription?.unsubscribe();\n    this._flyoutComponent?.$destroy();\n    this._flyoutComponent = undefined;\n    this._flyoutSubscription = undefined;\n  }\n\n  async handleInputEvent() {\n    const emojis = (await this._apiDataSetup.complete()).emojis;\n    const elements = await this._elements.complete();\n\n    /* get emoji candidates and emit event */\n    this._logger.debug(\"Finding emoji candidates for: \", elements.chatInput.value);\n    const emojiHead = this.parseUnfinishedEmoji(elements.chatInput.value);\n    const emojiCandidates = emojiHead !== undefined ? emojis.filter(e => e.name.includes(emojiHead)) : [];\n    this._emojiCandidates$.next(emojiCandidates);\n\n    /* show popout if head exists, else close if open */\n    if(emojiHead !== undefined && this._flyoutComponent === undefined){\n\n      /* create fly out content */\n      const flyoutContent: componentData<EmojiPicker> = {\n        componentType: EmojiPicker,\n        props: {\n          feature: this,\n          onSelected: (emoji: EmojiDto) => {\n            const text = elements.chatInput.value;\n            elements.chatInput.value = text.slice(0, text.lastIndexOf(\":\")) + `:${this.getEmojiId(emoji)}:`;\n            this._flyoutComponent?.close();\n            elements.chatInput.focus();\n          }\n        },\n      };\n\n      /* open flyout and destroy when clicked out */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          marginY: \"2.5rem\",\n          title: \"Emoji Picker\",\n          closeStrategy: \"explicit\"\n        },\n      });\n\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(() => {\n        this._logger.info(\"Destroyed flyout\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutComponent = undefined;\n      });\n    }\n    else if (this._flyoutComponent !== undefined && emojiHead === undefined){\n      this._flyoutComponent.close();\n    }\n  }\n\n  processAddedMessage(message: HTMLElement, emojis: EmojiDto[]) {\n    const textNodes = Array.from(message.childNodes).filter(node => node.nodeType === Node.TEXT_NODE) as Text[];\n    textNodes.forEach(node => {\n      const parsedEmojis = this.parseTextWithEmojis(node.textContent ?? \"\");\n      if(parsedEmojis.filter(e => e.emoji !== undefined).length === 0) return; // no emojis found\n\n      const newTextNode = document.createElement(\"span\");\n      newTextNode.classList.add(\"typo-emoji-container\");\n\n      parsedEmojis.forEach(({emoji, plain}) => {\n        if(plain) {\n          newTextNode.appendChild(document.createTextNode(plain));\n        }\n\n        if(emoji) {\n          const emojiDto = emojis.find(e => `:${this.getEmojiId(e)}:` === emoji);\n          if(emojiDto) {\n            const emojiElement = document.createElement(\"span\");\n            emojiElement.textContent = emoji;\n            emojiElement.style.setProperty(\"--typo-emoji-url\", `url(${emojiDto.url})`);\n            emojiElement.style.setProperty(\"--typo-emoji-name\", emojiDto.name);\n            emojiElement.classList.add(\"typo-emoji\");\n            newTextNode.appendChild(emojiElement);\n            // todo: add tooltips\n          }\n          else {\n            newTextNode.appendChild(document.createTextNode(emoji));\n          }\n        }\n      });\n\n      node.replaceWith(newTextNode);\n    });\n  }\n\n  parseTextWithEmojis(text: string) {\n    const emojiPattern = /:([a-zA-Z0-9_-]+):/g;\n    const result: {emoji?: string, plain?: string}[] = [];\n    let lastIndex = 0;\n\n    let match;\n    while ((match = emojiPattern.exec(text)) !== null) {\n      // Add plain text before the emoji\n      if (match.index > lastIndex) {\n        result.push({plain: text.slice(lastIndex, match.index)});\n      }\n\n      // Add the matched emoji placeholder, including the colons\n      result.push({emoji: match[0]});\n\n      // Update lastIndex to the end of the current match\n      lastIndex = match.index + match[0].length;\n    }\n\n    // Add any remaining plain text after the last emoji\n    if (lastIndex < text.length) {\n      result.push({ plain: text.slice(lastIndex) });\n    }\n\n    return result;\n  }\n\n  parseUnfinishedEmoji(text: string) {\n\n    /* remove all parsed emotes */\n    const parsedEmojiPattern = /:([a-zA-Z0-9_-]+):/g;\n    text = text.replace(parsedEmojiPattern, \"\");\n\n    const emojiPattern = /:([a-zA-Z0-9_-]*)$/;\n    const match = emojiPattern.exec(text);\n    return match?.[1];\n  }\n\n  getEmojiId(emoji: EmojiDto){\n    return emoji.nameId > 0 ? `${emoji.name}-${emoji.nameId}` : emoji.name;\n  }\n\n  public get emojiCandidatesStore() {\n    return fromObservable(this._emojiCandidates$, this._emojiCandidates$.value);\n  }\n}","Add a hotkey to quickly focus the chat input, so you can start guessing right away. <br>\nIf the auto-focus setting is enabled, the chat input will be focused automatically when someone else starts drawing. <br>","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { filter, type Subscription, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport ChatFocusInfo from \"./chat-focus-info.svelte\";\n\nexport class ChatFocusFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly elementsSetup!: ElementsSetup;\n  @inject(LobbyStateChangedEventListener) private readonly _lobbyStateChangedEventListener!: LobbyStateChangedEventListener;\n\n  public readonly name = \"Chat Focus\";\n  public readonly description = \"Quickly focus the chat input with a hotkey or when someone starts drawing\";\n  public readonly featureId = 28;\n\n  public override get featureInfoComponent(): componentData<ChatFocusInfo>{\n    return { componentType: ChatFocusInfo, props: {}};\n  }\n\n  private readonly _chatFocusHotkey = this.useHotkey(new HotkeyAction(\n    \"chat_focus\",\n    \"Chat Focus\",\n    \"Focus the chat input\",\n    this,\n    async () => (await this.elementsSetup.complete()).chatInput.focus(),\n    true,\n    [\"Tab\"],\n    undefined,\n    false\n  ));\n\n  private _autoFocusChatInputSetting = this.useSetting(\n    new BooleanExtensionSetting(\"auto_focus_chat_input\", true, this)\n      .withName(\"Auto Focus Chat Input\")\n      .withDescription(\"Automatically focus the chat input when someone else starts drawing\")\n  );\n\n  private _autoFocusSubscription?: Subscription;\n\n\n  protected override async onActivate() {\n    this._autoFocusSubscription = this._lobbyStateChangedEventListener.events$.pipe(\n      filter(event => event.data.drawingStarted !== undefined && event.data.drawingStarted.word === undefined),\n      withLatestFrom(this._autoFocusChatInputSetting.changes$, this.elementsSetup.complete()),\n      filter(([, enabled]) => enabled)\n    ).subscribe(([, ,elements]) => elements.chatInput.focus());\n  }\n\n  protected override async onDestroy() {\n    this._autoFocusSubscription?.unsubscribe();\n    this._autoFocusSubscription = undefined;\n  }\n\n  public get chatAutoFocusStore() {\n    return this._autoFocusChatInputSetting.store;\n  }\n}","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport ChatMessageSplitsComponent from \"./chat-message-splits.svelte\";\n\nexport class ChatMessageSplitsFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly name = \"Longer Chat Messages\";\n  public readonly description = \"Allows typing longer chat messages and splits them\";\n  public readonly featureId = 43;\n\n  private _component?: ChatMessageSplitsComponent;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    this._component = new ChatMessageSplitsComponent({\n      target: elements.chatForm,\n    });\n\n    elements.chatForm.classList.add(\"typo-extended\");\n    elements.chatInput.maxLength = 300; /* functionality is actually implemented in gamepatch */\n  }\n\n  protected override async onDestroy() {\n    const elements = await this._elementsSetup.complete();\n    elements.chatForm.classList.remove(\"typo-extended\");\n    elements.chatInput.maxLength = 100;\n    this._component?.$destroy();\n    this._component = undefined;\n  }\n}","import { ChatService } from \"@/content/services/chat/chat.service\";\nimport type { SkribblLobbyPlayer } from \"@/content/services/players/skribblLobbyPlayer\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport type { Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport ChatProfileLink from \"./chat-profile-link.svelte\";\n\nexport class ChatProfileLinkFeature extends TypoFeature {\n\n  @inject(ChatService) private readonly _chatService!: ChatService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(ElementsSetup) private _elementsSetup!: ElementsSetup;\n\n  public readonly name = \"Chat Profile Link\";\n  public readonly description = \"Open player profiles by clicking their name in the chat.\";\n  public readonly featureId = 23;\n\n  private _subscription?: Subscription;\n  private _addedElements: {titleElement: HTMLElement, player: SkribblLobbyPlayer}[] = [];\n  private _component?: ChatProfileLink;\n  private _clickHandler = this.chatClicked.bind(this);\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n    this._component = new ChatProfileLink({target: elements.chatContent});\n\n    /* listen for messages and add handler for click */\n    this._subscription = this._chatService.playerMessageReceived$.subscribe(({titleElement, player}) => {\n      titleElement.classList.add(\"typo-chat-profile-link\");\n      this._addedElements.push({ titleElement, player });\n    });\n    elements.chatContent.addEventListener(\"click\", this._clickHandler);\n  }\n\n  protected override async onDestroy() {\n    const elements = await this._elementsSetup.complete();\n    elements.chatContent.removeEventListener(\"click\", this._clickHandler);\n    this._subscription?.unsubscribe();\n\n    this._addedElements.forEach(({titleElement}) => titleElement.classList.remove(\"typo-chat-profile-link\"));\n    this._addedElements = [];\n    this._component?.$destroy();\n  }\n\n  private async chatClicked(event: MouseEvent) {\n    if(event.target instanceof HTMLElement && event.target.classList.contains(\"typo-chat-profile-link\")) {\n      const element = this._addedElements.find(e => e.titleElement === event.target);\n      if (element) {\n        element.player.container.click();\n      }\n      else {\n        await this._toastService.showToast(\"Player Profile not found\");\n      }\n    }\n  }\n}","import {\n  ExtensionCommandParameter,\n\n} from \"@/content/core/commands/command-parameter\";\nimport {\n  InterpretableArgumentParsingError\n} from \"@/content/core/commands/results/interpretable-argument-parsing-error\";\n\nexport class NumericOptionalCommandParameter<TSource, TMapped> extends ExtensionCommandParameter<TSource, TMapped>{\n\n  constructor(name: string, description: string, private _mapping: (number: number | undefined) => TMapped){\n    super(name, description);\n  }\n\n  public readonly typeName = \"number?\";\n  public readonly typeDescription = \"empty or any number\";\n\n  protected readArg(args: string, dontMarkAsInterpreting: () => void): { argument: TMapped; remainder: string } {\n\n    /* get next arg */\n    const split = args.trim().split(\" \");\n\n    /* check if whitespace - return undefined */\n    const arg = split[0].trim();\n    if(arg.length < 1 ){\n      dontMarkAsInterpreting();\n      return {remainder: \"\", argument: this._mapping(undefined)};\n    }\n\n    /* parse arg */\n    const number = Number(arg);\n    if(isNaN(number)){\n      throw new InterpretableArgumentParsingError(this, \"Failed to parse number from args: \" + args);\n    }\n    const argument = this._mapping(number);\n\n    /* return with remainder args */\n    const remainder = split.slice(1).join(\" \");\n    return { remainder, argument };\n  }\n}","import {\n  ExtensionCommandParameter,\n} from \"@/content/core/commands/command-parameter\";\n\nexport class StringOptionalCommandParameter<TSource, TMapped> extends ExtensionCommandParameter<TSource, TMapped>{\n\n  constructor(name: string, description: string, private _mapping: (string: string | undefined) => TMapped){\n    super(name, description);\n  }\n\n  public readonly typeName = \"text?\";\n  public readonly typeDescription = \"empty, a single word or text wrapped in quotes\";\n\n  protected readArg(args: string, dontMarkAsInterpreting: () => void): { argument: TMapped; remainder: string } {\n    /* get next arg */\n    const regex = /^\\s*([\"'])(.*?)\\1/;\n\n    let arg = \"\";\n    let remainder = \"\";\n    const matchQuoted = args.trim().match(regex);\n\n    if(matchQuoted !== null){\n      arg = matchQuoted[2];\n      remainder = args.trim().slice(matchQuoted[0].length).trim();\n    }\n    else {\n      const split = args.trim().split(\" \");\n      arg = split[0].trim();\n      remainder = split.slice(1).join(\" \");\n    }\n\n    /* check if whitespace - return undefined */\n    if(arg.length < 1 ){\n      dontMarkAsInterpreting();\n      return {remainder: \"\", argument: this._mapping(undefined)};\n    }\n\n    /* parse arg */\n    const argument = this._mapping(arg);\n\n    /* return with remainder args */\n    return { remainder, argument };\n  }\n}","import { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { LobbyInteractedEventListener } from \"@/content/events/lobby-interacted.event\";\nimport { LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { SkribblMessageRelaySetup } from \"@/content/setups/skribbl-message-relay/skribbl-message-relay.setup\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport {\n  BehaviorSubject, distinctUntilChanged,\n  filter,\n  map,\n  pairwise,\n  withLatestFrom,\n} from \"rxjs\";\n\nexport interface lobbyAvailableInteractions {\n  rateAvailable: boolean;\n  votekickAvailable: boolean;\n  interactionTarget: skribblPlayer | undefined;\n}\n\n@injectable()\nexport class LobbyInteractionsService {\n\n  @inject(LobbyService) private _lobbyService!: LobbyService;\n  @inject(LobbyInteractedEventListener) private _lobbyInteractedEvent!: LobbyInteractedEventListener;\n  @inject(LobbyStateChangedEventListener) private _lobbyStateChangedEvent!: LobbyStateChangedEventListener;\n  @inject(SkribblMessageRelaySetup) private _skribblMessageRelaySetup!: SkribblMessageRelaySetup;\n\n  private _availableInteractions$ = new BehaviorSubject<lobbyAvailableInteractions | undefined>(undefined);\n\n  private readonly _logger;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n\n  }\n\n  @postConstruct()\n  private postConstruct() {\n    this._logger.debug(\"Initializing lobby interactions service\");\n    this.setupAvailableInteractions();\n  }\n\n  private setupAvailableInteractions(){\n\n    /* reset state on lobby join, left */\n    this._lobbyService.lobby$.pipe(\n      distinctUntilChanged(),\n      pairwise(),\n      map(([last, current]) => {\n        if(last === null && current === null || last !== null && current === null) return undefined;\n        if(last === null && current !== null) return {\n          rateAvailable: true,\n          votekickAvailable: true,\n          interactionTarget: current.players.find(p => p.id === current.drawerId && p.id !== current.meId)\n        };\n        return null;\n      })\n    ).subscribe(update => {\n      if(update !== null) {\n        this._logger.info(\"Interactions reset on lobby join\", update);\n        this._availableInteractions$.next(update);\n      }\n    });\n\n    /*reset on drawing start*/\n    this._lobbyStateChangedEvent.events$.pipe(\n      map(evt => evt.data.drawingStarted),\n      filter(started => started !== undefined),\n      withLatestFrom(this._availableInteractions$, this._lobbyService.lobby$),\n      filter(([, state, lobby]) => state !== undefined && lobby !== null),\n    ).subscribe(([drawer, state, lobby]) => {\n      if(lobby === null || state === undefined) return;\n      state.rateAvailable = true;\n      state.votekickAvailable = true;\n      state.interactionTarget = lobby.players.find(p => p.id === drawer.drawerId && p.id !== lobby.meId);\n\n      this._logger.info(\"Interactions update on lobby change\", state);\n      this._availableInteractions$.next(state);\n    });\n\n    /* modify state on interaction */\n    this._lobbyInteractedEvent.events$.pipe(\n      withLatestFrom(this._availableInteractions$, this._lobbyService.lobby$),\n      filter(([, state, lobby]) => state !== undefined && lobby !== null),\n    ).subscribe(([event, state, lobby]) => {\n      if(lobby === null || state === undefined) return;\n\n      const {likeInteraction, dislikeInteraction, votekickInteraction} = event.data;\n      if(likeInteraction?.sourcePlayerId === lobby.meId || lobby.drawerId === null) state.rateAvailable = false;\n      if(dislikeInteraction?.sourcePlayerId === lobby.meId || lobby.drawerId === null) state.rateAvailable = false;\n      if(votekickInteraction?.sourcePlayerId === lobby.meId) state.votekickAvailable = false;\n\n      this._logger.info(\"Interactions update on interaction\", state);\n      this._availableInteractions$.next(state);\n    });\n\n    this._availableInteractions$.subscribe(state => this._logger.info(\"Available interactions\", state));\n  }\n\n  public get availableInteractions$() {\n    return this._availableInteractions$.asObservable();\n  }\n\n  public async likePlayer(){\n    const relay = await this._skribblMessageRelaySetup.complete();\n    relay.insertMessage({data: 1, id: 8});\n  }\n\n  public async dislikePlayer(){\n    const relay = await this._skribblMessageRelaySetup.complete();\n    relay.insertMessage({data: 0, id: 8});\n  }\n\n  public async votekickPlayer(id: number){\n    const relay = await this._skribblMessageRelaySetup.complete();\n    relay.insertMessage({data: id, id: 5});\n  }\n\n}","<script lang=\"ts\">\n  import { Subject } from \"rxjs\";\n\n  export let content: string;\n  export let color: \"green\" | \"orange\" | \"blue\";\n  export let disabled: boolean = false;\n\n  const click = new Subject<void>();\n  export const click$ = click.asObservable();\n</script>\n\n<style lang=\"scss\">\n\n  .typo-flat-button {\n    padding: .5rem;\n    border-radius: .5em;\n    position: relative;\n    user-select: none;\n    font-weight: 700;\n    text-shadow: 1px 1px 0 #0000002b;\n\n    &.disabled {\n      pointer-events: none;\n      opacity: .5;\n    }\n\n    &.green {\n      background-color: var(--COLOR_BUTTON_SUBMIT_BG);\n      color: var(--COLOR_BUTTON_SUBMIT_TEXT);\n    }\n\n    &.orange {\n      background-color: var(--COLOR_BUTTON_DANGER_BG);\n      color: var(--COLOR_BUTTON_DANGER_TEXT);\n    }\n\n    &.blue {\n      background-color: var(--COLOR_BUTTON_NORMAL_BG);\n      color: var(--COLOR_BUTTON_NORMAL_TEXT);\n    }\n\n    > span {\n      z-index: 2;\n      position: relative;\n    }\n\n    /* change brightness of background, but not text */\n    &:after {\n      position: absolute;\n      inset: 0;\n      content: \"\";\n      z-index: 0;\n      opacity: 0;\n      background: black;\n      transition: opacity .1s;\n      border-radius: .5em;\n    }\n\n    &:hover:after {\n      opacity: .1;\n    }\n\n  }\n</style>\n\n<button on:click={() => click.next(void 0)} on:click class=\"typo-flat-button flatUI {color}\" class:disabled={disabled}> <!-- flatUI for legacy theming -->\n  <span>{content}</span>\n</button>","<script lang=\"ts\">\n  import type { ChatQuickReactFeature } from \"@/content/features/chat-quick-react/chat-quick-react.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import { onMount } from \"svelte\";\n\n  export let feature: ChatQuickReactFeature;\n  let wrapper: HTMLDivElement;\n  const availableInteractions = feature.availableInteractionsStore;\n\n  const onKeyPress = (event: KeyboardEvent) => {\n    if ($availableInteractions !== undefined && $availableInteractions.interactionTarget !== undefined) {\n      switch (event.key) {\n        case \"ArrowLeft\":\n          feature.votekickPlayer($availableInteractions.interactionTarget);\n          feature.toggleQuickReactMenu();\n          break;\n        case \"ArrowRight\":\n          feature.toggleQuickReactMenu();\n          break;\n        case \"ArrowUp\":\n          feature.likeCurrentPlayer();\n          feature.toggleQuickReactMenu();\n          break;\n        case \"ArrowDown\":\n          feature.dislikeCurrentPlayer();\n          feature.toggleQuickReactMenu();\n          break;\n      }\n    }\n  };\n\n  onMount(() => {\n    wrapper.focus();\n  });\n</script>\n\n<style lang=\"scss\">\n  .typo-quickreact-focus:focus {\n    outline: none;\n  }\n\n  .typo-quickreact-keys {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n\n    b {\n      grid-column: span 2;\n      text-align: center;\n    }\n  }\n</style>\n\n<div class=\"typo-quickreact-focus\" tabindex=\"0\" bind:this={wrapper} on:keydown={event => onKeyPress(event)}>\n  {#if $availableInteractions !== undefined && $availableInteractions.interactionTarget !== undefined}\n\n    <div class=\"typo-quickreact-keys\">\n      <b>Press an arrow key to react to {$availableInteractions.interactionTarget.name}</b>\n      <FlatButton content=\"⬅️ Kick\" disabled=\"{!$availableInteractions.votekickAvailable}\" on:click={() => feature.votekickPlayer($availableInteractions.interactionTarget)} color=\"blue\" />\n      <FlatButton content=\"➡️ Close\" color=\"blue\" />\n      <FlatButton content=\"⬆️ Like\" disabled=\"{!$availableInteractions.rateAvailable}\" color=\"blue\" on:click={() => feature.likeCurrentPlayer()} />\n      <FlatButton content=\"⬇️ Dislike\" disabled=\"{!$availableInteractions.rateAvailable}\" color=\"blue\" on:click={() => feature.dislikeCurrentPlayer()} />\n    </div>\n\n  {:else}\n\n    <div class=\"typo-quickreact-keys\">\n      <b>No interactions available</b>\n    </div>\n\n  {/if}\n</div>\n\n\n","import { ExtensionCommand } from \"@/content/core/commands/command\";\nimport { NumericOptionalCommandParameter } from \"@/content/core/commands/params/numeric-optional-command-parameter\";\nimport { StringOptionalCommandParameter } from \"@/content/core/commands/params/string-optional-command-parameter\";\nimport { InterpretableError } from \"@/content/core/commands/results/interpretable-error\";\nimport { InterpretableSilentSuccess } from \"@/content/core/commands/results/interpretable-silent-success\";\nimport { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport {\n  type lobbyAvailableInteractions,\n  LobbyInteractionsService,\n} from \"@/content/services/lobby-interactions/lobby-interactions.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { createElement } from \"@/util/document/appendElement\";\nimport type { skribblPlayer } from \"@/util/skribbl/lobby\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport { firstValueFrom, map, type Subscription } from \"rxjs\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\nimport QuickReact from \"./quick-react.svelte\";\n\nexport class ChatQuickReactFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(LobbyInteractionsService) private readonly _lobbyInteractionsService!: LobbyInteractionsService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n\n  public readonly name = \"Quick React\";\n  public readonly description =\n    \"Adds accessibility to kick, like, and dislike via keyboard by pressing CTRL in the chat box.\";\n  public readonly featureId = 33;\n\n  private readonly _likeCommand = this.useCommand(\n    new ExtensionCommand(\"like\", this, \"Like\", \"Like the current drawing\"),\n  ).run(async command => {\n    await this.likeCurrentPlayer();\n    return new InterpretableSilentSuccess(command);\n  });\n\n  private readonly _dislikeCommand = this.useCommand(\n    new ExtensionCommand(\"dislike\", this, \"Dislike\", \"Dislike the current drawing\"),\n  ).run(async command => {\n    await this.dislikeCurrentPlayer();\n    return new InterpretableSilentSuccess(command);\n  });\n\n  private readonly _kickCommand = this.useCommand(\n    new ExtensionCommand(\"kick\", this, \"Votekick by ID\", \"Kick the current (default) or another player by ID\"),\n  ).withParameters(params => params\n    .addParam(new NumericOptionalCommandParameter(\"Player ID\", \"The ID of the player to votekick, leave empty for current drawer\", id => ({ id })))\n    .run(async (args, command) => {\n      const lobby = await firstValueFrom(this._lobbyService.lobby$);\n\n      /* set player id to current drawer to default */\n      if(args.id === undefined) args.id = lobby?.drawerId ?? undefined;\n\n      /* check if current player is self */\n      if(args.id !== undefined && args.id === lobby?.meId) {\n        return new InterpretableError(command, \"You can't votekick yourself :(\");\n      }\n\n      /* find player by id */\n      const target = lobby?.players.find(player => player.id === args.id);\n      if(target === undefined && args.id !== undefined) return new InterpretableError(command, \"Selected player not found\");\n      else if (target === undefined) return new InterpretableError(command, \"No default player to votekick\");\n\n      await this.votekickPlayer(target);\n      return new InterpretableSilentSuccess(command);\n    })\n  );\n\n  private readonly _kickByNameCommand = this.useCommand(\n    new ExtensionCommand(\"kick\", this, \"Votekick by name\", \"Kick the current (default) or another player by name\"),\n  ).withParameters(params => params\n    .addParam(new StringOptionalCommandParameter(\"Player Name\", \"The name of the player to votekick\", name => ({ name })))\n    .run(async (args, command) => {\n      const lobby = await firstValueFrom(this._lobbyService.lobby$);\n\n      /* find player by name, or default current drawer */\n      const target = args.name === undefined ? lobby?.players.find(p => p.id === lobby?.drawerId) : lobby?.players.find(player => player.name.toLowerCase() === args.name?.toLowerCase());\n      if(target === undefined && args.name !== undefined) return new InterpretableError(command, \"Selected player not found\");\n      else if (target === undefined) return new InterpretableError(command, \"No default player to votekick\");\n\n      /* check if current player is self */\n      if(target.id === lobby?.meId) {\n        return new InterpretableError(command, \"You can't votekick yourself :(\");\n      }\n\n      await this.votekickPlayer(target);\n      return new InterpretableSilentSuccess(command);\n    })\n  );\n\n  private readonly _openQuickReactHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"open_quickreact\",\n      \"Quick React\",\n      \"Open the quick react menu\",\n      this,\n      () => this.toggleQuickReactMenu(),\n      true,\n      [\"ControlRight\"],\n      undefined,\n      false\n    ),\n  );\n\n  private readonly _instantLikeHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"instant_like\",\n      \"Like Current Drawing\",\n      \"Instantly likes the current drawing, without quick react menu access\",\n      this,\n      () => this.likeCurrentPlayer(),\n      false,\n      [],\n    ),\n  );\n\n  private readonly _instantDislikeHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"instant_dislike\",\n      \"Dislike Current Drawing\",\n      \"Dislikes the current drawing, without quick react menu access\",\n      this,\n      () => this.dislikeCurrentPlayer(),\n      false,\n      [],\n    ),\n  );\n\n  private readonly _instantVotekickHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"instant_votekick\",\n      \"Votekick Current Drawer\",\n      \"Votes to kick the current drawer, without quick react menu access\",\n      this,\n      () => this.votekickPlayer(undefined),\n      false,\n      [],\n    ),\n  );\n\n  private _subscription?: Subscription;\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n  private _rateInteractionsStyle = createElement(\"<style>.typo-hide-rate-interactions { display: none !important }</style>\");\n  private _interactionUpdateSubscription?: Subscription;\n\n  protected override async onActivate() {\n    document.body.appendChild(this._rateInteractionsStyle);\n\n    const elements = await this._elements.complete();\n    this._interactionUpdateSubscription = this._lobbyInteractionsService.availableInteractions$.subscribe(interactions => {\n      elements.gameRate.classList.toggle(\"typo-hide-rate-interactions\", interactions?.rateAvailable !== true);\n    });\n  }\n\n  protected override async onDestroy() {\n    this._subscription?.unsubscribe();\n    this._subscription = undefined;\n\n    this._flyoutSubscription?.unsubscribe();\n    this._flyoutComponent?.$destroy();\n    this._flyoutComponent = undefined;\n    this._flyoutSubscription = undefined;\n\n    this._interactionUpdateSubscription?.unsubscribe();\n    this._interactionUpdateSubscription = undefined;\n    this._rateInteractionsStyle.remove();\n  }\n\n  private async hideGameRate(){\n    const elements = await this._elements.complete();\n    elements.gameRate.style.display = \"none\";\n  }\n\n  async toggleQuickReactMenu() {\n    if (this._flyoutComponent) {\n      this._flyoutComponent.close();\n    } else {\n      const elements = await this._elements.complete();\n\n      const flyoutContent: componentData<QuickReact> = {\n        componentType: QuickReact,\n        props: {\n          feature: this,\n        },\n      };\n\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          marginY: \"2.5rem\",\n          title: \"Quick React\",\n          closeStrategy: \"implicit\",\n        },\n      });\n\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(async () => {\n        this._logger.debug(\"Destroyed menu\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutComponent = undefined;\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutSubscription = undefined;\n\n        const elements = await this._elements.complete();\n        elements.chatInput.focus();\n      });\n    }\n  }\n\n  public get availableInteractionsStore() {\n    return fromObservable(this._lobbyInteractionsService.availableInteractions$, undefined);\n  }\n\n  public async getCurrentInteractionPlayer(matchesAvailable?: (available: lobbyAvailableInteractions) => boolean): Promise<skribblPlayer | undefined> {\n    return firstValueFrom(this._lobbyInteractionsService.availableInteractions$.pipe(map((interactions) => {\n      if(interactions === undefined || matchesAvailable && !matchesAvailable(interactions)) {\n        throw new Error(\"Interaction is not available\");\n      }\n      return interactions.interactionTarget;\n    })));\n  }\n\n  public async likeCurrentPlayer() {\n    const toast = await this._toastService.showLoadingToast(\"Liking current player\");\n    let player: skribblPlayer;\n\n    try {\n      const availablePlayer = await this.getCurrentInteractionPlayer(interactions => interactions.rateAvailable);\n      if(availablePlayer === undefined) throw new Error(\"No player available to rate\");\n      player = availablePlayer;\n    }\n    catch(e) {\n      toast.reject((e as Error).message);\n      return;\n    }\n\n    await this._lobbyInteractionsService.likePlayer();\n    await this.hideGameRate();\n    toast.resolve(`Liked the drawing of ${player.name}`);\n  }\n\n  public async dislikeCurrentPlayer() {\n    const toast = await this._toastService.showLoadingToast(\"Disliking current player\");\n    let player: skribblPlayer;\n\n    try {\n      const availablePlayer = await this.getCurrentInteractionPlayer(interactions => interactions.rateAvailable);\n      if(availablePlayer === undefined) throw new Error(\"No player available to rate\");\n      player = availablePlayer;\n    }\n    catch(e) {\n      toast.reject((e as Error).message);\n      return;\n    }\n\n    await this._lobbyInteractionsService.dislikePlayer();\n    await this.hideGameRate();\n    toast.resolve(`Disliked the drawing of ${player.name}`);\n  }\n\n  public async votekickPlayer(player: skribblPlayer | undefined) {\n\n    const toast = await this._toastService.showLoadingToast(`Voting to kick ${player === undefined ? \"current player\" : player.name}`);\n\n    try {\n      const targetPlayer = await this.getCurrentInteractionPlayer(interactions => interactions.votekickAvailable);\n      if(player === undefined) {\n        if(targetPlayer === undefined) throw new Error(\"No default player available to votekick\");\n        player = targetPlayer;\n      }\n    }\n    catch(e) {\n      toast.reject((e as Error).message);\n      return;\n    }\n\n    await this._lobbyInteractionsService.votekickPlayer(player.id);\n    toast.resolve(`Voted to kick ${player.name}`);\n  }\n}","import { MessageSentEventListener } from \"@/content/events/message-sent.event\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\nexport class ChatRecallFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(MessageSentEventListener) private readonly _messageSent!: MessageSentEventListener;\n\n  public readonly name = \"Chat Recall\";\n  public readonly description = \"Remembers your last messages so you can quickly recall them with arrow up/down in the chat box\";\n  public readonly featureId = 15;\n\n  private _history: string[] = [];\n  private _historyIndex?:number = undefined;\n\n  async handleInputEvent(event: KeyboardEvent) {\n    if (event.key === \"ArrowUp\" || event.key === \"ArrowDown\") {\n      event.preventDefault();\n      const element = (event.target as HTMLInputElement);\n\n      /* if not in browse mode, start at last element if arrow down, else ignore*/\n      if(this._historyIndex === undefined) {\n        if(event.key === \"ArrowUp\"){\n          this._historyIndex = this._history.length - 1;\n          element.value = this._history[this._historyIndex] ?? \"\";\n        }\n      }\n\n      /* browse earlier */\n      else if(event.key === \"ArrowDown\"){\n        if(this._historyIndex < this._history.length - 1){\n          this._historyIndex++;\n          element.value = this._history[this._historyIndex];\n        }\n\n        /* reset if after earliest */\n        else {\n          this._historyIndex = undefined;\n          element.value = \"\";\n        }\n      }\n\n      /* browse later */\n      else if(event.key === \"ArrowUp\"){\n        if(this._historyIndex > 0){\n          this._historyIndex--;\n          element.value = this._history[this._historyIndex];\n        }\n      }\n    }\n  }\n\n  listener = this.handleInputEvent.bind(this);\n\n  protected override async onActivate() {\n\n    /* add handler for arrow up/down */\n    const elements = await this._elements.complete();\n    elements.chatInput.addEventListener(\"keydown\", this.listener);\n\n    /* push messages to history */\n    this._messageSent.events$.subscribe((event) => {\n      this._history.push(event.data);\n      this._historyIndex = undefined;\n    });\n  }\n\n  protected override async onDestroy() {\n    const elements = await this._elements.complete();\n    elements.chatInput.removeEventListener(\"keydown\", this.listener);\n    this._history = [];\n    this._historyIndex = 0;\n  }\n}","export class ImageData {\n\n  public static async fromImageUrl(url: string): Promise<ImageData> {\n    const blob = await (await fetch(url)).blob();\n    return ImageData.fromBlob(blob);\n  }\n\n  public static async fromBlob(blob: Blob): Promise<ImageData> {\n    const reader = new FileReader();\n    reader.readAsDataURL(blob);\n\n    return new Promise((resolve, reject) => {\n      reader.onloadend = () => {\n        const base64 = reader.result as string;\n        resolve(new ImageData(base64, blob));\n      };\n      reader.onerror = () => reject();\n    });\n  }\n\n  public static async fromBase64(base64: string): Promise<ImageData> {\n    const blob = await (await fetch(base64)).blob();\n    return new ImageData(base64, blob);\n  }\n\n  private constructor(private _base64Full: string, private _blob: Blob) { }\n\n  public get base64Full(): string {\n    return this._base64Full;\n  }\n\n  public get blob(): Blob {\n    return this._blob;\n  }\n\n  public get base64ApiTruncated(): string {\n    return this._base64Full.split(\",\")[1].replace(\"==\", \"\");\n  }\n\n  public getBase64(){\n    return this._base64Full;\n  }\n}","import { DrawEvent, DrawEventListener } from \"@/content/events/draw.event\";\nimport { HintsAddedEvent, HintsAddedEventListener } from \"@/content/events/hints-added.event\";\nimport { ImageResetEvent, ImageResetEventListener } from \"@/content/events/image-reset.event\";\nimport { LobbyStateChangedEvent, LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport { WordGuessedEvent, WordGuessedEventListener } from \"@/content/events/word-guessed.event\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { SkribblMessageRelaySetup } from \"@/content/setups/skribbl-message-relay/skribbl-message-relay.setup\";\nimport { arrayChunk } from \"@/util/arrayChunk\";\nimport { ImageData } from \"@/util/imageData\";\nimport { inject, injectable } from \"inversify\";\nimport {\n  BehaviorSubject,\n  concatMap, debounceTime,\n  delay, distinctUntilChanged,\n  filter,\n  map,\n  merge, mergeWith, of, scan, Subject, tap,\n  withLatestFrom,\n} from \"rxjs\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\nimport { LobbyLeftEvent, LobbyLeftEventListener } from \"../../events/lobby-left.event\";\n\nexport interface imageStateUpdate {\n  drawerId?: number,\n  word: {\n    length: number[],\n    hints: string,\n    solution?: string\n  }\n}\n\nexport interface savedDrawCommands {\n  name: string;\n  commands: number[][]\n}\n\n@injectable()\nexport class DrawingService {\n\n  private readonly _logger;\n\n  private _currentImageState$ = new BehaviorSubject<imageStateUpdate | null>(null);\n  private _currentCommands$ = new BehaviorSubject<number[][]>([]);\n  private _drawingState$ = new BehaviorSubject<\"drawing\" | \"idle\">(\"idle\");\n\n  private _pasteInProgress$ = new BehaviorSubject<boolean>(false);\n  private _abortCommands$ = new BehaviorSubject<number>(Number.MAX_VALUE);\n  private _incomingDrawCommands$ = new Subject<[number[], boolean]>(); /* [commands, scheduled] -> scheduled false when cancel/schedule skipped */\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(LobbyLeftEventListener) private readonly lobbyLeft: LobbyLeftEventListener,\n    @inject(LobbyStateChangedEventListener) private readonly lobbyChanged: LobbyStateChangedEventListener,\n    @inject(HintsAddedEventListener) private readonly hintsAdded: HintsAddedEventListener,\n    @inject(DrawEventListener) private readonly draw: DrawEventListener,\n    @inject(WordGuessedEventListener) private readonly wordGuessed: WordGuessedEventListener,\n    @inject(ImageResetEventListener) private readonly imageReset: ImageResetEventListener,\n    @inject(ElementsSetup) private readonly elementsSetup: ElementsSetup,\n    @inject(SkribblMessageRelaySetup) private readonly skribblMessages: SkribblMessageRelaySetup\n  ) {\n    this._logger = loggerFactory(this);\n\n    this.listenDrawCommands();\n    this.listenCurrentImageState();\n\n    this.imageState$.subscribe(data => {\n      this._logger.debug(\"Image state updated\", data);\n    });\n\n    this.commands$.pipe(debounceTime(1000)).subscribe(data => {\n      this._logger.debug(\"Commands updated\", data);\n    });\n\n    /* cancel always when lobby left */\n    lobbyLeft.events$.subscribe(() => this.cancelPendingDrawCommands());\n\n    this._incomingDrawCommands$.pipe(\n\n      /* not very satisfied with the access of the .value .. but it works */\n      concatMap(([value, scheduled]) => {\n\n        if(!scheduled) return of(value);\n\n        const scheduledTime = Date.now();\n        const abort = this._abortCommands$.value;\n\n        /* if command is aborted, return as cancelled. else return as scheduled */\n        if(scheduledTime < abort) return of(value).pipe(\n          delay(2)\n        );\n        else return of(null);\n      }),\n\n      /* filter out cancelled commands */\n      filter(value => value !== null),\n\n      /* perform commands */\n      tap((command) => this.onDrawCommand(command)),\n\n      /* count amount of pasted commands, reset when not drawing*/\n      mergeWith(this._pasteInProgress$.pipe(\n        distinctUntilChanged()\n      )),\n      scan((acc, pastingOrCommands) => pastingOrCommands === false ? 0 : pastingOrCommands === true ? acc : acc + 1, 0),\n      /*filter(count => count > 0),*/\n\n      /* inset when aborted to \"finish\" state even when no commands were pending */\n      mergeWith(this._abortCommands$.pipe(\n        distinctUntilChanged(),\n        map(() => 0)\n      )),\n\n      /* after 50ms of no commands, treat as action */\n      debounceTime(50),\n    ).subscribe((count) => {\n      this._logger.debug(\"finished pasting\", count);\n      if(count > 0) document.dispatchEvent(new CustomEvent(\"collapseUndoActions\", { detail: count }));\n      this._pasteInProgress$.next(false);\n      this._abortCommands$.next(Number.MAX_VALUE);\n    });\n  }\n\n  private onDrawCommand(command: number[]) {\n    this._logger.debug(\"Incoming draw command\", command);\n    document.dispatchEvent(new CustomEvent(\"performDrawCommand\", {detail: command}));\n  }\n\n  /**\n   * create observable for all draw command updates\n   * @private\n   */\n  private listenDrawCommands() {\n    merge(\n      this.lobbyLeft.events$,\n      this.lobbyChanged.events$,\n      this.draw.events$,\n      this.imageReset.events$\n    ).pipe(\n      withLatestFrom(this._currentCommands$),\n      map(data => ({update: data[0], currentCommands: data[1]})),\n    ).subscribe(({update, currentCommands}) => {\n      currentCommands = structuredClone(currentCommands);\n\n      if(update instanceof LobbyLeftEvent) {\n        currentCommands = [];\n      }\n      else if(update instanceof LobbyStateChangedEvent) {\n        if(update.data.drawingStarted !== undefined) {\n          currentCommands = [];\n        }\n      }\n      else if(update instanceof LobbyLeftEvent) {\n        currentCommands = [];\n      }\n      else if(update instanceof DrawEvent) {\n        const commands = update.data.map(command => command.length > 7 ? arrayChunk(command, 7) : [command]).flat(1);\n        currentCommands.push(...commands);\n      }\n      else if(update instanceof ImageResetEvent) {\n        currentCommands = update.data === 0 ? [] : currentCommands.slice(0, update.data);\n      }\n\n      this._currentCommands$.next(currentCommands);\n    });\n  }\n\n  /**\n   * emit to observable for all drawing updates\n   * @private\n   */\n  private listenCurrentImageState() {\n    merge(\n      this.lobbyLeft.events$,\n      this.lobbyChanged.events$,\n      this.hintsAdded.events$,\n      this.wordGuessed.events$\n    ).pipe(\n      withLatestFrom(this._currentImageState$),\n      map(data => ({update: data[0], currentImageState: data[1]})),\n    ).subscribe(({update, currentImageState}) => {\n\n      /* prevent issues with references */\n      currentImageState = currentImageState === null ? null : structuredClone(currentImageState);\n\n      if(update instanceof LobbyLeftEvent) {\n        currentImageState = null;\n        this._drawingState$.next(\"idle\");\n      }\n      else if(update instanceof LobbyStateChangedEvent) {\n\n        /* if current image state empty, prefill with defaults */\n        currentImageState = currentImageState ?? {\n          drawerId: undefined,\n          word: {\n            length: [0],\n            hints: \"\",\n            solution: undefined\n          }\n        };\n\n        /*if(update.data.initialDrawerId !== undefined) {\n          currentImageState.drawerId = update.data.initialDrawerId;\n        }*/\n        if(update.data.drawingStarted !== undefined) {\n          this._drawingState$.next(\"drawing\");\n\n          currentImageState.drawerId = update.data.drawingStarted.drawerId;\n          currentImageState.word.length = update.data.drawingStarted.characters;\n          currentImageState.word.solution = update.data.drawingStarted.word;\n          currentImageState.word.hints =\n            update.data.drawingStarted.word ??\n            update.data.drawingStarted.characters.map(len => \"_\".repeat(len)).join(\" \");\n        }\n        if (update.data.drawingRevealed !== undefined) {\n          this._drawingState$.next(\"idle\");\n\n          currentImageState.word.solution = update.data.drawingRevealed.word;\n          currentImageState.word.hints = update.data.drawingRevealed.word;\n        }\n      }\n      else if(currentImageState !== null && update instanceof HintsAddedEvent) {\n        const hints = [...currentImageState.word.hints];\n        update.data.forEach(hint => {\n          hints[hint[0]] = hint[1];\n        });\n        currentImageState.word.hints = hints.join(\"\");\n      }\n      else if(currentImageState !== null && update instanceof WordGuessedEvent) {\n        if(update.data.word !== undefined) {\n          currentImageState.word.solution = update.data.word;\n          currentImageState.word.hints = update.data.word;\n        }\n      }\n      else if(currentImageState !== null && update instanceof LobbyLeftEvent) {\n        this._drawingState$.next(\"idle\");\n        currentImageState = null;\n      }\n\n      this._currentImageState$.next(currentImageState);\n    });\n  }\n\n  /**\n   * Observable which emits every change image state, including draw commands\n   */\n  public get imageState$() {\n    return this._currentImageState$.asObservable();\n  }\n\n  /**\n   * Observable which emits every change to captured current draw commands\n   */\n  public get commands$() {\n    return this._currentCommands$.asObservable();\n  }\n\n  /**\n   * Observable which emits when the drawer changes\n   */\n  public get drawingState$() {\n    return this._drawingState$.asObservable();\n  }\n\n  /**\n   * Get the current canvas image as a base64 string\n   */\n  private async getCurrentImageBase64() {\n    return (await this.elementsSetup.complete()).canvas.toDataURL();\n  }\n\n  /**\n   * Get the current canvas image as a blob\n   */\n  public async getCurrentImageData() {\n    const base64 = await this.getCurrentImageBase64();\n    return await ImageData.fromBase64(base64);\n  }\n\n  /**\n   * Paste draw commands on the canvas\n   * @param commands\n   * @param scheduled set to false to skip 2ms-delay-scheduling (scheduled react to cancel signal)\n   */\n  public async pasteDrawCommands(commands: number[][], scheduled = true) {\n    this._logger.debug(\"Pasting draw commands\", commands);\n    if(commands.length === 0) return;\n    this._pasteInProgress$.next(true);\n    commands.forEach(command => this._incomingDrawCommands$.next([command, scheduled]));\n  }\n\n  public cancelPendingDrawCommands(){\n    this._abortCommands$.next(Date.now());\n  }\n\n  public get pasteInProgress$(){\n    return this._pasteInProgress$.pipe(\n      distinctUntilChanged()\n    );\n  }\n\n  /**\n   *\n   * @param color the skribbl color code\n   */\n  public setColor(color: number) {\n    this._logger.debug(\"Setting color\", color);\n    document.dispatchEvent(new CustomEvent(\"setColor\", {detail: {code: color}}));\n  }\n\n  /**\n   * Disable or enable cursor updates\n   * Prevents performance bottlenecks when mods change cursor properties frequently\n   * When set to false, cursor will be updated once\n   * @param state\n   */\n  public disableCursorUpdates(state: boolean){\n    document.dispatchEvent(new CustomEvent(\"disableCursorUpdates\", {detail: state}));\n  }\n\n  /**\n   * Set the brush size, from 4 to 40\n   * @param size\n   */\n  public setSize(size: number) {\n    this._logger.debug(\"Setting size\", size);\n    document.dispatchEvent(new CustomEvent(\"selectSkribblSize\", {detail: size}));\n  }\n\n  public clearImage() {\n    this._logger.debug(\"Clearing image\");\n    document.dispatchEvent(new CustomEvent(\"clearDrawing\"));\n  }\n\n  public async drawImage(imageBase64: string, x?: number, y?: number, dx?: number, dy?: number) {\n    this._logger.debug(\"Drawing image\", imageBase64, x, y, dx, dy);\n\n    const img = new Image();\n    img.src = imageBase64;\n    await new Promise(resolve => img.onload = resolve);\n\n    const canvas = (await this.elementsSetup.complete()).canvas;\n    const ctx = canvas.getContext(\"2d\");\n    ctx?.drawImage(img, x ?? 0, y ?? 0, dx ?? img.width, dy ?? img.height);\n  }\n\n  public createLineCommand(coordinates: [number, number, number, number], colorCode: number | undefined = undefined, size: number | undefined = undefined, clip = true){\n    const clipped = clip ?\n      this.clipLine([coordinates[0], coordinates[1]], [coordinates[2], coordinates[3]])?.flat() :\n      [Math.floor(coordinates[0]), Math.floor(coordinates[1]), Math.floor(coordinates[2]), Math.floor(coordinates[3])];\n    if(clipped === undefined) return;\n\n    return [0, colorCode ?? 1, size ?? 4, ...clipped];\n  }\n\n  public async drawLine(coordinates: [number, number, number, number], colorCode: number | undefined = undefined, size: number | undefined = undefined){\n    this._logger.debug(\"Drawing line\", coordinates, colorCode, size);\n\n    const clipped = this.clipLine([coordinates[0], coordinates[1]], [coordinates[2], coordinates[3]])?.flat();\n    if(clipped === undefined) return;\n    await this.pasteDrawCommands([[0, colorCode ?? 1, size ?? 4, ...clipped]]);\n  }\n\n  private clipLine(origin: [number, number], target: [number, number]){\n    const canvasWidth = 800;\n    const canvasHeight = 600;\n\n    /* if target and origin out of bounds, return dummy coords */\n    if((origin[0] < 0 && target[0] < 0) || (origin[0] >= canvasWidth && target[0] >= canvasWidth) ||\n       (origin[1] < 0 && target[1] < 0) || (origin[1] >= canvasHeight && target[1] >= canvasHeight)){\n      return undefined;\n    }\n\n    /* if target x is outside of canvas, calculate new target by intersection of canvas bounds */\n    if (target[0] < 0 || target[0] >= canvasWidth) {\n      const slope = (target[1] - origin[1]) / (target[0] - origin[0]);\n      const y = slope * ((target[0] < 0 ? 0 : canvasWidth - 1) - origin[0]) + origin[1];\n      target = [target[0] < 0 ? 0 : canvasWidth - 1, y];\n    }\n\n    /* if target y is outside of canvas, calculate new target by intersection of canvas bounds */\n    if (target[1] < 0 || target[1] >= canvasHeight) {\n      const slope = (target[0] - origin[0]) / (target[1] - origin[1]);\n      const x = slope * ((target[1] < 0 ? 0 : canvasHeight - 1) - origin[1]) + origin[0];\n      target = [x, target[1] < 0 ? 0 : canvasHeight - 1];\n    }\n\n    /* if origin y is outside of canvas, calculate new origin by intersection of canvas bounds */\n    if (origin[1] < 0 || origin[1] >= canvasHeight) {\n      const slope = (target[0] - origin[0]) / (target[1] - origin[1]);\n      const x = slope * ((origin[1] < 0 ? 0 : canvasHeight - 1) - origin[1]) + origin[0];\n      origin = [x, origin[1] < 0 ? 0 : canvasHeight - 1];\n    }\n\n    /* if origin x is outside of canvas, calculate new origin by intersection of canvas bounds */\n    if (origin[0] < 0 || origin[0] >= canvasWidth) {\n      const slope = (target[1] - origin[1]) / (target[0] - origin[0]);\n      const y = slope * ((origin[0] < 0 ? 0 : canvasWidth - 1) - origin[0]) + origin[1];\n      origin = [origin[0] < 0 ? 0 : canvasWidth - 1, y];\n    }\n\n    origin = [Math.floor(origin[0]), Math.floor(origin[1])];\n    target = [Math.floor(target[0]), Math.floor(target[1])];\n\n    return [origin, target];\n  }\n}","import { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { ImageData } from \"@/util/imageData\";\nimport { inject, injectable } from \"inversify\";\nimport {\n  delay, distinctUntilChanged,\n  filter,\n  map,\n  type Observable, of, scan,\n  switchMap, tap,\n  withLatestFrom,\n} from \"rxjs\";\nimport { fromPromise } from \"rxjs/internal/observable/innerFrom\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\n\nexport interface skribblImage {\n  name: string;\n  artist: string;\n  date: Date;\n  player: string;\n  commands: number[][];\n  private: boolean;\n  isOwn: boolean;\n  language: string;\n  image: ImageData;\n}\n\n@injectable()\nexport class ImageFinishedService {\n\n  private readonly _logger;\n\n  private _imageFinished$: Observable<skribblImage>;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(DrawingService) private readonly _drawingService: DrawingService,\n    @inject(LobbyService) private readonly _lobbyService: LobbyService,\n  ) {\n    this._logger = loggerFactory(this);\n    this._imageFinished$ = this.listenImageFinished();\n  }\n\n  private listenImageFinished(){\n    return this.mapToImageState(\n      this._drawingService.drawingState$.pipe(\n        delay(100) /* avoid race conditions of state change and data observables */,\n        filter(\n          (state) => state === \"idle\",\n        ) /* update only when state entered idle (drawing finished) */,\n      ),\n    ).pipe(\n      filter((image) => image !== null), /* only if image mapping successfully */\n      tap(() => this._logger.debug(\"Image finished\")),\n    );\n  }\n\n  /**\n   * A new observable is returned, that whenever the input observable emits, gets the current image state\n   * @param input\n   * @private\n   */\n  public mapToImageState(input?: Observable<unknown>) {\n    if(input === undefined) input = of(1); /* default to trigger immediately */\n    return input.pipe(\n      withLatestFrom(this._drawingService.imageState$, this._lobbyService.lobby$, this._drawingService.commands$),  /* on every input, fetch latest lobby and drawing state */\n      switchMap((data) =>\n        fromPromise(this._drawingService.getCurrentImageData()).pipe(\n          map((imageData) => ({ image: structuredClone(data[1]), lobby: structuredClone(data[2]), commands: structuredClone(data[3]), imageData })), /* fetch additionally current drawing blob and add to data */\n        ),\n      ),\n      map((state) => {\n        if (state.image === null || state.lobby === null) return null; /* something unexpected */\n        const { lobby, image, imageData, commands } = state;\n        return {\n          name: image.word.solution ?? `${image.word.hints} (${image.word.length.join(\", \")})`,\n          image: imageData,\n          commands: commands,\n          private: lobby.private,\n          artist: lobby.players.find((p) => p.id === image.drawerId)?.name ?? \"Unknown Artist\",\n          date: new Date(),\n          player: lobby.players.find(p => p.id === lobby.meId)?.name ?? \"Unknown Poster\",\n          isOwn: lobby.meId === image.drawerId,\n          language: lobby.settings.language,\n        } as skribblImage; /* return mapped data as image history object */\n      }),\n    );\n  }\n\n  public get imageFinished$() {\n    return this._imageFinished$;\n  }\n\n  public get imageHistory$() {\n    return this._imageFinished$.pipe(\n      scan((acc, image) => {\n        if (image === null) return acc;\n        else return [...acc, image];\n      }, [] as skribblImage[]),\n      distinctUntilChanged(\n        (a, b) => a.length === b.length,\n      ) /* only emit when new image is added */\n    );\n  }\n}","import { CloudApi, type MemberDto } from \"@/api\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { type skribblImage } from \"@/content/services/image-finished/image-finished.service\";\nimport { inject, injectable } from \"inversify\";\n\n@injectable()\nexport class CloudService{\n  @inject(ApiService) private readonly _apiService!: ApiService;\n\n  private readonly _logger;\n  private _pendingAwardInventoryIds = new Set<number>();\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  public async uploadToCloud(image: skribblImage, member: MemberDto, linkWithPendingAwards = false) {\n\n    /* upload new image to cloud */\n    const api =this._apiService.getApi(CloudApi);\n    const uploaded = await api.uploadToUserCloud({\n      login: Number(member.userLogin),\n      cloudUploadDto: {\n        name: image.name,\n        author: image.artist,\n        inPrivate: image.private,\n        isOwn: image.isOwn,\n        language: image.language,\n        commands: image.commands,\n        imageBase64: image.image.base64ApiTruncated,\n      }\n    });\n    this._logger.debug(\"Image saved to cloud\");\n\n    if(linkWithPendingAwards && this._pendingAwardInventoryIds.size > 0){\n      const ids = Array.from(this._pendingAwardInventoryIds);\n      this._pendingAwardInventoryIds.clear();\n      const linked = await Promise.all(\n        ids.map(id =>\n          api.linkImageToAward({login: Number(member.userLogin), token: id, id: uploaded.id}))\n      );\n\n      this._logger.info(\"Linked image to pending awards\", linked.length);\n    }\n  }\n\n  public addPendingAwardInventoryId(inventoryId: number){\n    this._logger.debug(\"Adding pending award inventory id\", inventoryId);\n\n    this._pendingAwardInventoryIds.add(inventoryId);\n  }\n\n  public clearPendingAwardInventoryIds(){\n    this._logger.debug(\"Clearing pending award inventory ids\");\n\n    this._pendingAwardInventoryIds.clear();\n  }\n}","export const convertOldSkd = (oldSkd: number[][][]): number[][] => {\n  const commands = oldSkd.flat();\n  //return commands;\n  commands.forEach(command => {\n    switch (command[0]) {\n      case 2:\n        command[0] = 1;\n      case 0:\n        if (command[1] > 11) command[1] += 2; // if index > 11, skip new cyan color column\n        if (command[1] > 21) command[1] += 2; // if index > 11, skip new skin tone color column\n        /* command[1] = command[1] % 2 == 0 ? // if command is fill or brush\n            command[1] + (command[1] / 2) : // if color is even, add half of index\n            command[1] + ((command[1] + 1) / 2); // if odd, add half of index+1 */\n        break;\n      case 1:\n        command = [command[0], 0, command[1], command[2], command[3], command[4], command[5]];\n        break;\n    }\n  });\n  return commands;\n};","import type { featureBinding } from \"@/content/core/feature/featureBinding\";\nimport { convertOldSkd } from \"@/util/skribbl/skd\";\nimport { inject, injectable } from \"inversify\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\nexport interface savedDrawCommands {\n  name: string;\n  commands: number[][]\n}\n\n@injectable()\nexport class ImagelabService implements featureBinding {\n\n  private readonly _logger;\n  private _savedDrawCommands$?: BehaviorSubject<savedDrawCommands[]>;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  async onFeatureDestroy() {\n    this._savedDrawCommands$ = undefined;\n  }\n\n  async onFeatureActivate() {\n    this._savedDrawCommands$ = new BehaviorSubject<savedDrawCommands[]>([]);\n  }\n\n  public get savedDrawCommands$() {\n    if (!this._savedDrawCommands$) {\n      this._logger.error(\"Tried to access saved draw commands without initializing the service first. Imagelab feature enabled?\");\n      throw new Error(\"illegal state\");\n    }\n    return this._savedDrawCommands$;\n  }\n\n  public saveDrawCommands(name: string, commands: number[][] | number[][][]) {\n    if (!this._savedDrawCommands$) {\n      this._logger.warn(\"Tried to save draw commands without initializing the service first. Imagelab feature enabled?\");\n      throw new Error(\"illegal state\");\n    }\n\n    if(commands[0] && Array.isArray(commands[0]) && Array.isArray(commands[0][0])) {\n      commands = convertOldSkd(commands as number[][][]);\n    }\n    else commands = commands as number[][];\n\n    this._savedDrawCommands$.next([...this.savedDrawCommands$.value, { name, commands }]);\n  }\n\n  /**\n   * Remove draw commands from saved commands\n   * @param index\n   */\n  public removeSavedDrawCommands(index: number) {\n    if (!this._savedDrawCommands$) {\n      this._logger.warn(\"Tried to save draw commands without initializing the service first. Imagelab feature enabled?\");\n      throw new Error(\"illegal state\");\n    }\n    this._savedDrawCommands$.next(this._savedDrawCommands$.value.filter((item, i) => i !== index));\n  }\n}","import type { featureBinding } from \"@/content/core/feature/featureBinding\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { ImageFinishedService, type skribblImage } from \"@/content/services/image-finished/image-finished.service\";\nimport { inject, injectable } from \"inversify\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\n\n@injectable()\nexport class ImagePostService implements featureBinding {\n\n  private readonly _logger;\n  private _history$?: BehaviorSubject<skribblImage[]>;\n  private _historySubscription?: Subscription;\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(ImageFinishedService) private readonly _imageFinishedService: ImageFinishedService\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  /**\n   *  listen for finished images and create history\n   *\n   */\n  async onFeatureActivate() {\n    this._history$ = new BehaviorSubject<skribblImage[]>([]);\n    this._historySubscription = this._imageFinishedService.imageHistory$.subscribe(data => this._history$?.next(data));\n  }\n\n  /**\n   * unsubscribe from history subscription\n   * @private\n   */\n  async onFeatureDestroy(){\n    this._history$ = undefined;\n    this._historySubscription?.unsubscribe();\n  }\n\n  public get history$() {\n    if (!this._history$) {\n      this._logger.error(\"Tried to access history without initializing the service first. Imagelab feature enabled?\");\n      throw new Error(\"illegal state\");\n    }\n    return this._history$.asObservable();\n  }\n\n  public addToHistory(image: skribblImage) {\n    if (!this._history$) {\n      this._logger.error(\"Tried to access history without initializing the service first. Imagelab feature enabled?\");\n      throw new Error(\"illegal state\");\n    }\n    this._history$.next([...this._history$.value, image]);\n  }\n\n}","<script lang=\"ts\">\n  import type { componentData } from \"./modal.service\";\n  import { onDestroy, type SvelteComponent } from \"svelte\";\n\n  export let componentData: componentData<SvelteComponent>;\n  export let closeHandler: () => void;\n  export let title: string;\n\n  let closing = false;\n  const close = () => {\n    closing = true;\n    setTimeout(() => closeHandler(), 150);\n  }\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(50vh);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 100;\n    }\n  }\n\n  @keyframes slideOut {\n    from {\n      transform: translateY(0);\n      opacity: 100;\n    }\n    to {\n      transform: translateY(50vh);\n      opacity: 0;\n    }\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 100;\n    }\n  }\n\n  @keyframes fadeOut {\n    from {\n      opacity: 100;\n    }\n    to {\n      opacity: 0;\n    }\n  }\n\n  div.content {\n    position: fixed;\n    inset: 10vh 0 0 0;\n    background: var(--COLOR_PANEL_BG);\n    z-index: 9999;\n    animation: slideIn 0.15s ease-out;\n    backdrop-filter: blur(4px);\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    color: var(--COLOR_PANEL_TEXT);\n    /*padding-bottom: 2rem;*/\n\n    &.closing {\n      animation: slideOut 0.15s ease-out forwards;\n    }\n\n    .content-title {\n      display:flex;\n      justify-content: space-between;\n      width: 100%;\n      align-items: center;\n      padding-left: 2em;\n      padding-right: 2em;\n\n      > div:last-child {\n        user-select: none;\n        position: relative;\n        top: -2vh;\n        cursor: pointer;\n        font-weight: bold;\n        font-size: 2.5rem;\n        opacity: .7;\n\n        &:hover {\n          opacity: 1;\n        }\n      }\n    }\n  }\n\n  div.content-top {\n    position: fixed;\n    top: calc(7vh + 1px);\n    z-index: 9999;\n    background: var(--COLOR_PANEL_BG);\n    clip-path: polygon(100% 0, 0% 100%, 100% 100%);\n    backdrop-filter: blur(4px);\n    border: none;\n    height: 3vh;\n    width: 100vw;\n    animation: slideIn 0.15s ease-out;\n\n    &.closing {\n      animation: slideOut 0.15s ease-out forwards;\n    }\n  }\n\n  div.backdrop {\n    position: fixed;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.5);\n    z-index: 9998;\n    animation: fadeIn 0.15s ease-out;\n\n    &.closing {\n      animation: fadeOut 0.15s ease-out forwards;\n    }\n  }\n\n</style>\n\n<div class=\"backdrop\" role=\"presentation\" class:closing={closing} on:click={() => close()}></div>\n<div class=\"content-top\" role=\"presentation\" class:closing={closing} on:click={() => close()}></div>\n\n<div class=\"content\" class:closing={closing}>\n  \n  <div class=\"content-title\">\n    <div></div>\n    <h1>{title}</h1>\n    <div role=\"button\" tabindex=\"0\" class:closing={closing} on:keypress={(e) => e.key === \"Alt\" && close()} on:click={() => close()}>×</div>\n  </div>\n\n  <svelte:component this={componentData.componentType} {...componentData.props} />\n</div>","<script lang=\"ts\">\n  import type { componentData } from \"./modal.service\";\n  import { onDestroy, type SvelteComponent } from \"svelte\";\n\n  export let componentData: componentData<SvelteComponent>;\n  export let closeHandler: () => void;\n  export let title: string;\n\n  let closing = false;\n  const close = () => {\n    closing = true;\n    setTimeout(() => closeHandler(), 150);\n  }\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(50vh);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 100;\n    }\n  }\n\n  @keyframes slideOut {\n    from {\n      transform: translateY(0);\n      opacity: 100;\n    }\n    to {\n      transform: translateY(50vh);\n      opacity: 0;\n    }\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 100;\n    }\n  }\n\n  @keyframes fadeOut {\n    from {\n      opacity: 100;\n    }\n    to {\n      opacity: 0;\n    }\n  }\n\n  div.content {\n    background: var(--COLOR_PANEL_BG);\n    animation: slideIn 0.15s ease-out;\n    backdrop-filter: blur(4px);\n\n    max-height: calc(100vh - 4rem);\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    color: var(--COLOR_PANEL_TEXT);\n    padding: 2rem;\n    border-radius: 3px;\n\n    &.closing {\n      animation: slideOut 0.15s ease-out forwards;\n    }\n\n    .content-title {\n      display:flex;\n      justify-content: space-between;\n      width: 100%;\n      align-items: center;\n      padding-left: 2em;\n      padding-right: 2em;\n\n      > div:last-child {\n        user-select: none;\n        position: relative;\n        top: -2vh;\n        right: -2rem;\n        cursor: pointer;\n        font-weight: bold;\n        font-size: 2.5rem;\n        opacity: .7;\n\n        &:hover {\n          opacity: 1;\n        }\n      }\n    }\n  }\n\n  div.backdrop {\n    position: fixed;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.5);\n    z-index: 9999;\n    animation: fadeIn 0.15s ease-out;\n    display: grid;\n    place-content: center;\n    padding: 3rem;\n\n    &.closing {\n      animation: fadeOut 0.15s ease-out forwards;\n    }\n  }\n\n</style>\n\n<div class=\"backdrop\" role=\"presentation\" class:closing={closing} on:click={(e) => {\n   if(e.currentTarget === e.target) close();\n}}>\n\n  <div class=\"content\" class:closing={closing}>\n\n    <div class=\"content-title\">\n      <div></div>\n      <h1>{title}</h1>\n      <div role=\"button\" tabindex=\"0\" class:closing={closing} on:keypress={(e) => e.key === \"Alt\" && close()} on:click={() => close()}>×</div>\n    </div>\n\n    <svelte:component this={componentData.componentType} {...componentData.props} />\n  </div>\n</div>\n\n","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { inject, injectable } from \"inversify\";\nimport { firstValueFrom, Subject } from \"rxjs\";\nimport type { ComponentProps, SvelteComponent } from \"svelte\";\nimport type { Type } from \"@/util/types/type\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\nimport ModalDocument from \"./modal-document.svelte\";\nimport ModalCard from \"./modal-card.svelte\";\n\nexport interface componentData<TComponent extends SvelteComponent> {\n  componentType: Type<TComponent>;\n  props: ComponentProps<TComponent>;\n}\n\nexport interface componentDataFactory<TComponent extends SvelteComponent, TResult> {\n  componentType: Type<TComponent>;\n  propsFactory: (submit: (result: TResult) => void) => ComponentProps<TComponent>;\n  validate?: (result: TResult) => Promise<boolean> | boolean;\n}\n\n@injectable()\nexport class ModalService {\n\n  private readonly _logger;\n\n  private _modalClosed$ = new Subject<void>();\n  private readonly _closeHotkey = new HotkeyAction(\n    \"modal_close\",\n    \"Close Modal\",\n    \"Close open modals using a hotkey\",\n    undefined,\n    () => {\n      this._modalClosed$.next();\n    },\n    true,\n    [\"KeyA\"]\n  );\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(GlobalSettingsService) private readonly _globalSettingsService: GlobalSettingsService\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  public showModal<TComponent extends SvelteComponent>(\n    componentType: Type<TComponent>,\n    args: ComponentProps<TComponent>,\n    title: string,\n    style: \"document\" | \"card\" = \"document\"\n  ) {\n\n    const componentData: componentData<TComponent> = {componentType: componentType, props: args};\n    const modal = style === \"document\" ? new ModalDocument({\n      target: document.body,\n      props: {\n        componentData: componentData,\n        closeHandler: () => {\n          modal.$destroy();\n        },\n        title\n      }\n    }) : new ModalCard({\n      target: document.body,\n      props: {\n        componentData: componentData,\n        closeHandler: () => {\n          modal.$destroy();\n        },\n        title\n      }\n    });\n\n    this._globalSettingsService.globalHotkeys.exitModal.once(() => {\n      modal.$destroy();\n    });\n  }\n\n  public async showPrompt<TComponent extends SvelteComponent, TResult>(\n    componentType: Type<TComponent>,\n    argsFactory: ((submit: (result: TResult) => void) => ComponentProps<TComponent>),\n    title: string,\n    style: \"document\" | \"card\" = \"card\",\n    validate?: (result: TResult) => Promise<boolean> | boolean\n  ): Promise<TResult | undefined> {\n\n    const result$ = new Subject<TResult | undefined>();\n    const submit = async (result: TResult) => {\n\n      let validated = validate === undefined ? true : validate(result);\n      if(validated instanceof Promise) validated = await validated;\n\n      if(validated) result$.next(result);\n    };\n    const componentArgs = argsFactory(submit);\n\n    const componentData: componentData<TComponent> = {componentType: componentType, props: componentArgs};\n    const modal = style === \"card\" ? new ModalCard({\n      target: document.body,\n      props: {\n        componentData: componentData,\n        closeHandler: () => {\n          modal.$destroy();\n          result$.next(undefined);\n        },\n        title\n      }\n    }) : new ModalDocument({\n      target: document.body,\n      props: {\n        componentData: componentData,\n        closeHandler: () => {\n          modal.$destroy();\n          result$.next(undefined);\n        },\n        title\n      }\n    });\n\n    this._globalSettingsService.globalHotkeys.exitModal.once(() => {\n      modal.$destroy();\n      result$.next(undefined);\n    });\n\n    const result = await firstValueFrom(result$);\n    modal.$destroy();\n    return result;\n  }\n}","export const downloadBlob = (blob: Blob, filename: string) => {\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\"a\");\n  a.href = url;\n  a.download = filename;\n  a.click();\n};\n\nexport const downloadText = (text: string, filename: string) => {\n  const blob = new Blob([text], {type: \"text/plain\"});\n  downloadBlob(blob, filename);\n};","export const getCloudCommands = async (url: string) => {\n  return await(await fetch(url)).json() as number[][];\n};","export interface cloudMeta {\n  author: string,\n  name: string,\n  private: boolean,\n  own: boolean,\n  language: string,\n  login: number,\n  date: string\n}\n\nexport const getCloudMeta = async (url: string) => {\n  return await(await fetch(url)).json() as cloudMeta;\n};","<script lang=\"ts\">\n  import type { CloudImageDto } from \"@/api\";\n  import { ControlsCloudFeature } from \"@/content/features/controls-cloud/controls-cloud.feature\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\n  export let feature: ControlsCloudFeature;\n\n  const member = feature.memberStore;\n\n  let page = 0;\n  const pageSize = 200;\n\n  let authorQuery = \"\";\n  let titleQuery = \"\";\n  let createdInPrivateLobbyQuery = false;\n  let isOwnQuery = false;\n  let createdBeforeQuery: Date | string = new Date();\n  let createdAfterQuery: Date | string = new Date(new Date().setFullYear(2020, 9, 1));\n\n  let hiddenImages: string[] = [];\n\n  const search = (login: number, resetPage = false) => {\n    if(resetPage) page = 0;\n    return feature.getImages({\n      page,\n      pageSize,\n      authorQuery,\n      titleQuery,\n      isOwnQuery,\n      createdInPrivateLobbyQuery,\n      createdAfterQuery: createdAfterQuery !== \"\" ? new Date(createdAfterQuery).getTime().toString() : undefined,\n      createdBeforeQuery: createdBeforeQuery !== \"\" ? new Date(createdBeforeQuery).getTime().toString() : undefined,\n    }, login);\n  }\n\n  let selectedImage: CloudImageDto | null = null;\n  let images: Promise<CloudImageDto[]> | null = $member ? search(Number($member.userLogin)) : null;\n  $: page, images = $member ? search(Number($member.userLogin)) : null\n\n</script>\n\n\n<style lang=\"scss\">\n\n  .typo-gallery-grid {\n    display: grid;\n    grid-template-columns: 20rem auto;\n    gap: 2rem;\n    width: 100%;\n    padding-left: 2rem;\n    padding-right: 2rem;\n    padding-top: 2rem;\n    height: 100%;\n    overflow: hidden;\n\n    h3 {\n      text-align: center;\n    }\n\n    .gallery-sidebar {\n      display: flex;\n      flex-direction: column;\n      gap: .5rem;\n      border-right: 1px solid var(--COLOR_PANEL_BORDER_FOCUS);\n      padding-right: 2rem;\n      margin-bottom: 2rem;\n      transition: opacity .06s;\n      grid-area: 1/1/1/1;\n\n      > :not(span, .navigate-page){\n        margin-bottom: 1rem;\n      }\n\n      .navigate-page {\n        width: 100%;\n        justify-content: space-between;\n        display: flex;\n        gap: 1rem;\n        align-items: center;\n        margin-top: auto;\n\n\n        span {\n          font-weight: 600;\n          user-select: none;\n        }\n      }\n\n      &.present {\n         opacity: 0;\n         pointer-events: none;\n       }\n    }\n\n    .gallery-results {\n      height: 100%;\n      overflow: auto;\n      display: grid;\n      grid-template-columns: repeat(auto-fill, 20rem);\n      gap: 1rem;\n      justify-content: space-between;\n      margin-bottom: 2rem;\n      grid-area: 1/2/1/2;\n      transition: opacity .06s;\n\n      img {\n        width: 100%;\n        cursor:pointer;\n        border-radius: 3px;\n      }\n\n      .loading {\n        grid-column: 1/-1;\n        display: grid;\n      }\n\n      &.present {\n        opacity: 0;\n        pointer-events: none;\n      }\n    }\n\n    .present-image {\n      grid-area: 1/2/1/2;\n      display: flex;\n      flex-wrap: wrap;\n      justify-content: center;\n      align-items: center;\n      overflow: auto;\n\n      img {\n        border-radius: 3px;\n      }\n    }\n\n    .present-sidebar {\n      display: flex;\n      flex-direction: column;\n      gap: .5rem;\n      border-right: 1px solid var(--COLOR_PANEL_BORDER_FOCUS);\n      padding-right: 2rem;\n      margin-bottom: 2rem;\n      grid-area: 1/1/1/1;\n\n      .exit-present {\n        cursor: pointer;\n        display:flex;\n        gap: 1rem;\n        justify-content: center;\n        align-items: center;\n        font-weight: 600;\n        margin-top: auto;\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-gallery-grid color-scrollbar\">\n\n  <div class=\"gallery-sidebar\" class:present={selectedImage !== null}>\n    <h3>Filter Cloud</h3>\n    <span>Artist Name</span>\n    <input type=\"text\" bind:value={authorQuery} placeholder=\"Filter exact artist name\">\n    <span>Image Name</span>\n    <input type=\"text\" bind:value={titleQuery} placeholder=\"Filter exact image title\">\n    <span>Created Before</span>\n    <input type=\"datetime-local\" bind:value={createdBeforeQuery} >\n    <span>Created After</span>\n    <input type=\"datetime-local\" bind:value={createdAfterQuery} >\n    <Checkbox bind:checked={createdInPrivateLobbyQuery} description=\"Only private lobbies\" />\n    <Checkbox bind:checked={isOwnQuery} description=\"Only own drawings\" />\n\n    <br>\n\n    {#if ($member !== null)}\n      <FlatButton content=\"Search Cloud\" color=\"green\" on:click={() => images = search(Number($member?.userLogin), true)}/>\n    {/if}\n\n    <div class=\"navigate-page\">\n      <IconButton icon=\"file-img-arrow-left-gif\" name=\"Previous\" size=\"2rem\" hoverMove=\"{false}\"\n                  disabled=\"{page <= 0}\"\n                  on:click={() => page--} />\n\n      <span>Page {page + 1}</span>\n\n      <IconButton icon=\"file-img-arrow-right-gif\" name=\"Next\" size=\"2rem\" hoverMove=\"{false}\"\n                  on:click={() => page++} />\n    </div>\n  </div>\n\n\n  <div class=\"gallery-results\" class:present={selectedImage !== null}>\n\n    <!-- check if member logged in -->\n    {#if ($member !== null && images !== null)}\n      {#await images}\n\n        <!--load images-->\n        <div class=\"loading\">\n          <Bounceload content=\"Loading Images...\" />\n        </div>\n\n      {:then images}\n\n        <!-- display grid -->\n        {#each images as image}\n          <img src={image.imageUrl} alt={image.name} style=\"display: {hiddenImages.includes(image.id) ? 'none' : ''}\" on:click={() => selectedImage = image} />\n        {/each}\n\n      {/await}\n    {/if}\n  </div>\n\n  <!-- display only selected image if present -->\n  {#if selectedImage !== null}\n\n    <!-- big image display -->\n    <div class=\"present-image\" on:click={() => selectedImage = null}>\n      <img src={selectedImage.imageUrl} alt={selectedImage.name} on:click={(e) => e.stopImmediatePropagation()} />\n    </div>\n\n\n    <!-- sidebar for image actions -->\n    <div class=\"present-sidebar\"  >\n      <h3>{selectedImage.name}</h3>\n      <span>Drawn by {selectedImage.author} </span>\n      <span>Created on {new Date(Number(selectedImage.createdAt)).toLocaleString()}</span>\n\n      <br>\n      <FlatButton content=\"Download PNG\" color=\"green\" on:click={async () => {\n        if($member === null || $member === undefined || selectedImage === null) throw new Error(\"illegal state\");\n        await feature.saveAsPng(selectedImage);\n      }} />\n      <FlatButton content=\"Download GIF\" color=\"green\" />\n      <FlatButton content=\"Copy Link\" color=\"green\" on:click={async () => {\n        if($member === null || $member === undefined || selectedImage === null) throw new Error(\"illegal state\");\n        await feature.copyToClipboard(selectedImage);\n      }} />\n\n      <br>\n      <FlatButton content=\"Add to Image Post\" color=\"blue\" on:click={async () => {\n        if($member === null || $member === undefined || selectedImage === null) throw new Error(\"illegal state\");\n        await feature.addToImagePost(selectedImage, $member);\n      }} />\n      <FlatButton content=\"Add to Image Lab\" color=\"blue\" on:click={async () => {\n        if($member === null || $member === undefined || selectedImage === null) throw new Error(\"illegal state\");\n        await feature.addToImageLab(selectedImage);\n      }}  />\n\n      <br>\n      <FlatButton content=\"Delete Image\" color=\"orange\" on:click={async () => {\n        if($member === null || $member === undefined || selectedImage === null) throw new Error(\"illegal state\");\n        await feature.deleteImage(selectedImage.id, Number($member.userLogin));\n        hiddenImages = [...hiddenImages, selectedImage.id];\n        selectedImage = null;\n      }} />\n\n      <div class=\"exit-present\" on:click={() => selectedImage = null}>\n        <IconButton icon=\"file-img-arrow-left-gif\" hoverMove=\"{false}\" name=\"Exit\" on:click />\n        Back to Gallery\n      </div>\n    </div>\n\n  {/if}\n</div>\n","import { CloudApi, type CloudImageDto, type CloudSearchDto, type MemberDto } from \"@/api\";\nimport { CloudService } from \"@/content/features/controls-cloud/cloud.service\";\nimport { ImagelabService } from \"@/content/features/toolbar-imagelab/imagelab.service\";\nimport { ImagePostService } from \"@/content/features/toolbar-imagepost/image-post.service\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { ImageFinishedService, type skribblImage } from \"@/content/services/image-finished/image-finished.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { type componentData, ModalService } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { downloadBlob } from \"@/util/download\";\nimport { ImageData } from \"@/util/imageData\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { getCloudCommands } from \"@/util/typo/getCloudCommands\";\nimport { getCloudMeta } from \"@/util/typo/getCloudMeta\";\nimport { inject } from \"inversify\";\nimport { Subscription, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport ControlsSettings from \"./controls-cloud.svelte\";\n\nexport class ControlsCloudFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(CloudService) private readonly _cloudService!: CloudService;\n  @inject(ImagePostService) private readonly _imagePostService!: ImagePostService;\n  @inject(ImagelabService) private readonly _imageLabService!: ImagelabService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(ApiService) private readonly _apiService!: ApiService;\n  @inject(ImageFinishedService) private readonly _imageFinishedService!: ImageFinishedService;\n\n  public readonly name = \"Typo Cloud\";\n  public readonly description =\n    \"Saves all images from your lobbies in a cloud and adds a gallery to browse them\";\n  public readonly featureId = 17;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n  private _cloudSavedSubscription?: Subscription;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach to controls */\n    this._iconComponent = new IconButton({\n      target: elements.controls,\n      props: {\n        hoverMove: false,\n        size: \"48px\",\n        icon: \"file-img-cloud-gif\",\n        name: \"Typo Cloud\",\n        order: 2,\n        tooltipAction: this.createTooltip,\n      },\n    });\n\n    /* listen for new images and combine with current member*/\n    this._cloudSavedSubscription = this._imageFinishedService.imageFinished$\n      .pipe(\n        withLatestFrom(this._memberService.member$),\n      )\n      .subscribe(async ([image, member]) => {\n        if(image === null || member === null || member === undefined) {\n          this._logger.debug(\"Did not save image because either member or image not defined\");\n          return;\n        }\n\n        await this._cloudService.uploadToCloud(image, member, true); /* link pending awards if any */\n      });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n      const settingsComponent: componentData<ControlsSettings> = {\n        componentType: ControlsSettings,\n        props: {\n          feature: this,\n        },\n      };\n      this._modalService.showModal(settingsComponent.componentType, settingsComponent.props, \"Typo Cloud\");\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._cloudSavedSubscription?.unsubscribe();\n  }\n\n  public get memberStore() {\n    return fromObservable(this._memberService.member$, undefined);\n  }\n\n  public async getImages(search: CloudSearchDto, login: number){\n\n    if(search.authorQuery === \"\") search.authorQuery = undefined;\n    if(search.titleQuery === \"\") search.titleQuery = undefined;\n    if(search.createdInPrivateLobbyQuery === false) search.createdInPrivateLobbyQuery = undefined;\n    if(search.isOwnQuery === false) search.isOwnQuery = undefined;\n    return this._apiService.getApi(CloudApi).searchUserCloud({login, cloudSearchDto: search});\n  }\n\n  public async deleteImage(id: string, login: number){\n    const toast = await this._toastService.showLoadingToast(\"Removing image from cloud\");\n    try {\n      const image = await this._apiService.getApi(CloudApi).deleteImageFromUserCloud({login, id});\n      toast.resolve();\n      return image;\n    }\n    catch {\n      toast.reject();\n    }\n  }\n\n  public async addToImagePost(image: CloudImageDto, member: MemberDto){\n    const toast = await this._toastService.showLoadingToast(\"Adding image to history\");\n\n    try {\n      const meta = await getCloudMeta(image.metaUrl);\n      const commands = await getCloudCommands(image.commandsUrl);\n      const imageData = await ImageData.fromImageUrl(image.imageUrl);\n      const skribblImage: skribblImage = {\n        name: image.name,\n        artist: image.author,\n        private: meta.private,\n        isOwn: meta.own,\n        language: meta.language,\n        player: member.userName,\n        date: new Date(meta.date),\n        commands,\n        image: imageData\n      };\n\n      this._imagePostService.addToHistory(skribblImage);\n      toast.resolve();\n    }\n    catch {\n      toast.reject();\n    }\n  }\n\n  public async saveAsPng(image: CloudImageDto){\n    const toast = await this._toastService.showLoadingToast(\"Downloading image\");\n    try {\n      const imageData = await ImageData.fromImageUrl(image.imageUrl);\n      downloadBlob(imageData.blob, `skribbl-${image.name}-by-${image.author}.png`);\n      toast.resolve();\n    }\n    catch(e){\n      this._logger.error(\"Failed to download image\", e);\n      toast.reject();\n      throw e;\n    }\n  }\n\n  public async copyToClipboard(image: CloudImageDto){\n    const toast = await this._toastService.showLoadingToast(\"Copying image link\");\n    try {\n      await navigator.clipboard.writeText(image.imageUrl);\n      toast.resolve();\n    }\n    catch(e){\n      this._logger.error(\"Failed to copy image link to clipboard\", e);\n      toast.reject();\n      throw e;\n    }\n  }\n\n  public async addToImageLab(image: CloudImageDto) {\n    const toast = await this._toastService.showLoadingToast(\"Adding image to image lab\");\n\n    try {\n      const commands = await getCloudCommands(image.commandsUrl);\n      this._imageLabService.saveDrawCommands(`${image.name}-by-${image.author}`, commands);\n      toast.resolve();\n    }\n    catch {\n      toast.reject(\"Is the image lab feature enabled?\");\n    }\n  }\n}","import type { TypoFeature } from \"@/content/core/feature/feature\";\nimport { inject, injectable } from \"inversify\";\nimport { Subject } from \"rxjs\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\n@injectable()\nexport class FeaturesService {\n\n  private readonly _logger;\n  private _features: TypoFeature[] = [];\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  private _featureStates = new Subject<{feature: TypoFeature, running: boolean}>();\n\n  public async registerFeature(feature: TypoFeature) {\n    if(this.features.some(f => f.featureId === feature.featureId)) {\n      this._logger.error(\"Attempted to register a feature with a duplicate ID\", feature.name);\n      throw new Error(\"Duplicate feature ID\");\n    }\n    this._features.push(feature);\n    feature.activated$.subscribe(state => this._featureStates.next({ feature: feature, running: state }));\n  }\n\n  public get features() {\n    return [...this._features];\n  }\n}","<script lang=\"ts\">\n  import type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\n  import type { ControlsSettingsFeature } from \"@/content/features/controls-settings/controls-settings.feature\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let hotkey: HotkeyAction;\n  export let feature: ControlsSettingsFeature;\n\n  const enabledStore = hotkey.enabledSetting.store;\n  const comboStore = hotkey.comboSetting.store;\n\n  let recordingElement: HTMLInputElement;\n  let recordedKeys: string[];\n\n  $: {\n    recordedKeys = [...$comboStore];\n  }\n\n  const getHotkeyComboHumanReadable = async (combo: string[]) => {\n    if((navigator as any)?.keyboard?.getLayoutMap){\n      const layoutMap = await (navigator as any).keyboard.getLayoutMap();\n      return combo.map(key => layoutMap.get(key) || key).join(' + ');\n    }\n    else {\n      return combo.join(' + ');\n    }\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-feature-settings-hotkey {\n    background-color: var(--COLOR_PANEL_HI);\n    display: grid;\n    grid-template-columns: auto auto auto auto;\n    grid-template-rows: 1fr 1fr;\n    flex-direction: column;\n    border-radius: 3px;\n    gap: 1rem;\n    padding: 1rem;\n    align-items: center;\n\n    .inputs-disabled-hint {\n      font-size: .8rem;\n      opacity: .7;\n    }\n\n    .button-container {\n      font-size: 1em;\n    }\n  }\n\n</style>\n\n\n<div class=\"typo-feature-settings-hotkey\">\n\n  <!-- title -->\n  <h3>{hotkey.name}</h3>\n\n  <!-- description -->\n  <div>\n    {hotkey.description}\n    {#if hotkey.disabledOnInputs}\n      <br><span class=\"inputs-disabled-hint\">Disabled in text inputs</span>\n    {/if}\n  </div>\n\n  <!-- reset -->\n  <div class=\"button-container\"> <FlatButton content=\"Reset to default\" color=\"orange\" on:click={async () => {\n    const update = await feature.resetHotkeyCombo(hotkey);\n    if(update){\n      recordedKeys = update;\n      recordingElement.value = await getHotkeyComboHumanReadable(recordedKeys);\n    }\n  }} /> </div>\n\n  <!-- save -->\n  <div class=\"button-container\"> <FlatButton content=\"Save combo\" color=\"green\" on:click={() => {\n    feature.setHotkeyCombo(hotkey, recordedKeys);\n    if(recordedKeys.length > 0){\n      $enabledStore = true;\n    }\n  }} /> </div>\n\n  <!-- enabled toggle -->\n  <div><Checkbox disabled=\"{$comboStore.length === 0}\" bind:checked={$enabledStore} description=\"{$enabledStore ? 'Enabled' : 'Disabled'}\" /></div>\n\n  <!-- recording area -->\n  <div style=\"grid-column: 2 / span 3\">\n    <input\n      value=\"{recordedKeys.join(' + ')}\"\n      bind:this={recordingElement}\n      type=\"text\"\n      placeholder=\"Press Keys\"\n      on:click={() => {\n        recordedKeys = [];\n        recordingElement.value = '';\n      }}\n      on:keydown={async event => {\n        event.preventDefault();\n        if(!recordedKeys.includes(event.code)) {\n          recordedKeys.push(event.code);\n          recordingElement.value = await getHotkeyComboHumanReadable(recordedKeys);\n        }\n        else {\n          recordedKeys = recordedKeys.filter(key => key !== event.code);\n          recordingElement.value = await getHotkeyComboHumanReadable(recordedKeys);\n        }\n      }}\n    />\n  </div>\n</div>","<script lang=\"ts\">\n  import type { ExtensionCommand } from \"@/content/core/commands/command\";\n  import type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\n  import type { ControlsSettingsFeature } from \"@/content/features/controls-settings/controls-settings.feature\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let command: ExtensionCommand;\n  export let feature: ControlsSettingsFeature;\n\n  const enabledStore = command.enabledSetting.store;\n  const idStore = command.idSetting.store;\n\n  let idInput = \"\";\n  $: {\n    idInput = $idStore;\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-feature-settings-command {\n    background-color: var(--COLOR_PANEL_HI);\n    display: grid;\n    grid-template-columns: auto auto auto auto;\n    grid-template-rows: 1fr 1fr;\n    flex-direction: column;\n    border-radius: 3px;\n    gap: 1rem;\n    padding: 1rem;\n    align-items: center;\n\n    .button-container {\n      font-size: 1em;\n    }\n  }\n\n</style>\n\n\n<div class=\"typo-feature-settings-command\">\n\n  <!-- title -->\n  <h3>{command.name}</h3>\n\n  <!-- description -->\n  <div>{command.description}</div>\n\n  <!-- reset -->\n  <div class=\"button-container\"> <FlatButton content=\"Reset name\" color=\"orange\" on:click={() => {\n    $idStore = command.defaultId;\n  }} /> </div>\n\n  <!-- save -->\n  <div class=\"button-container\"> <FlatButton content=\"Save name\" color=\"green\" on:click={() => {\n    $idStore = idInput.length === 0 ? command.defaultId : idInput;\n  }} /> </div>\n\n  <!-- enabled toggle -->\n  <div><Checkbox bind:checked={$enabledStore} description=\"{$enabledStore ? 'Enabled' : 'Disabled'}\" /></div>\n\n  <!-- recording area -->\n  <div style=\"grid-column: 2 / span 3\">\n    <input bind:value={idInput} type=\"text\" placeholder=\"Enter command name\" />\n  </div>\n</div>","<script lang=\"ts\">\n  import type { ExtensionCommand } from \"@/content/core/commands/command\";\n  import type { TypoFeature } from \"@/content/core/feature/feature\";\n  import type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\n  import type { ControlsSettingsFeature } from \"@/content/features/controls-settings/controls-settings.feature\";\n  import type { componentData } from \"@/content/services/modal/modal.service\";\n  import type { SvelteComponent } from \"svelte\";\n  import ControlsSettingsHotkey from \"./controls-settings-hotkey.svelte\";\n  import ControlsSettingsCommand from \"./controls-settings-command.svelte\";\n\n  export let detailsClosed: () => void;\n  export let feature: TypoFeature;\n  export let settingsFeature: ControlsSettingsFeature;\n\n  let settingsComponent: componentData<SvelteComponent> | undefined;\n  let infoComponent: componentData<SvelteComponent> | undefined;\n  let featureHotkeys: HotkeyAction[] = [];\n  let featureCommands: ExtensionCommand[] = [];\n\n  $: {\n    featureHotkeys = [...feature.hotkeys];\n    featureCommands = [...feature.commands];\n    settingsComponent = feature.featureManagementComponent;\n    infoComponent = feature.featureInfoComponent;\n  }\n\n  const supportskeyboardLayout = (navigator as any)?.keyboard?.getLayoutMap !== undefined;\n</script>\n\n<style lang=\"scss\">\n  .typo-feature-settings-title {\n    width: 100%;\n    display: grid;\n    grid-template-columns: 1fr 1fr 1fr;\n    align-items: center;\n\n    .typo-feature-settings-hero {\n      opacity: .7;\n      font-weight: 600;\n      justify-self: start;\n    }\n\n    .typo-feature-settings-back {\n      cursor: pointer;\n      opacity: .7;\n      font-weight: 600;\n      &:hover {\n        opacity: 1;\n      }\n      justify-self: end;\n    }\n\n    > h1 {\n      justify-self: center;\n    }\n  }\n\n  .typo-feature-settings-summary {\n    text-align: center;\n  }\n\n  .typo-feature-settings-info, .typo-feature-settings-management, .typo-feature-settings-hotkeys, .typo-feature-settings-default {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    /*align-items: center;\n    justify-content: center;*/\n\n    h2 {\n      /*opacity: .7;*/\n      margin-bottom: .5em;\n    }\n  }\n\n  .typo-feature-settings-default {\n\n    .typo-feature-settings-default-list {\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      gap: 2rem;\n\n      .typo-feature-settings-default-item {\n        min-width: clamp(20em, 20em, 100%);\n        max-width: clamp(20em, 20em, 100%);\n        background-color: var(--COLOR_PANEL_HI);\n        border-radius: 3px;\n        display: flex;\n        flex-direction: column;\n        gap: 1rem;\n        padding: 1rem;\n        flex: 1 1 0px;\n        position: relative;\n      }\n    }\n\n  }\n\n  .typo-feature-settings-hotkeys-list, .typo-feature-settings-commands-list {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    flex-wrap: wrap;\n  }\n</style>\n\n<!-- header -->\n<div class=\"typo-feature-settings-title\">\n  <div class=\"typo-feature-settings-hero\">Feature Details</div>\n  <h1>{feature.name}</h1>\n  <div class=\"typo-feature-settings-back\" on:click={() => detailsClosed()} >Back to Features ➜</div>\n</div>\n\n<!-- feature summary -->\n<div class=\"typo-feature-settings-summary\">\n  {feature.description}\n</div>\n\n{#if infoComponent}\n  <div class=\"typo-feature-settings-info\">\n    <h2>Feature Information</h2>\n    <div>\n      <svelte:component this={infoComponent.componentType} {...infoComponent.props} />\n    </div>\n  </div>\n{/if}\n\n{#if feature.settings.length > 0}\n  <div class=\"typo-feature-settings-default\">\n    <h2>Feature Settings</h2>\n    <div class=\"typo-feature-settings-default-list\">\n      {#each feature.settings as setting}\n        <div class=\"typo-feature-settings-default-item\">\n          <svelte:component this={setting.componentData.componentType} {...setting.componentData.props} />\n        </div>\n      {/each}\n    </div>\n  </div>\n{/if}\n\n{#if settingsComponent}\n  <div class=\"typo-feature-settings-management\">\n    <h2>Feature Management</h2>\n    <div>\n      <svelte:component this={settingsComponent.componentType} {...settingsComponent.props} />\n    </div>\n  </div>\n{/if}\n\n{#if featureHotkeys.length > 0}\n  <div class=\"typo-feature-settings-hotkeys\">\n    <h2>Feature Hotkeys</h2>\n    <p>\n      Hotkeys are key combinations to quickly access feature functions. You can disable hotkeys that you don't need.<br>\n      Hotkeys with\n      To change a hotkey, click in the input field and press the desired key combination. To remove a key from the combination, press it again.<br>\n      Empty combinations will be disabled automatically.\n    </p>\n      {#if !supportskeyboardLayout}\n        <p>\n        Your browser does not support localized key names. Hotkeys will use US keyboard layout names.<br>\n        Switch to any Chrome-based browser to see the real key names.\n        </p>\n      {/if}\n    <br>\n    <div class=\"typo-feature-settings-hotkeys-list\">\n      {#each featureHotkeys as hotkey}\n        <ControlsSettingsHotkey hotkey=\"{hotkey}\" feature=\"{settingsFeature}\" />\n      {/each}\n    </div>\n  </div>\n{/if}\n\n{#if featureCommands.length > 0}\n  <div class=\"typo-feature-settings-hotkeys\">\n    <h2>Feature Commands</h2>\n    <p>\n      Commands are a quick way to execute actions of a feature from the chat.<br>\n      Here, you can toggle commands on or off and customize the command name.<br>\n      To use a command, type \"/\" and continue with the command name.\n    </p>\n    <br>\n    <div class=\"typo-feature-settings-commands-list\">\n      {#each featureCommands as command}\n        <ControlsSettingsCommand command=\"{command}\" feature=\"{settingsFeature}\" />\n      {/each}\n    </div>\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import type { TypoFeature } from \"@/content/core/feature/feature\";\n  import { fromObservable } from \"@/util/store/fromObservable\";\n  import { firstValueFrom } from \"rxjs\";\n\n  export let devmodeEnabled: boolean;\n  export let feature: TypoFeature;\n  export let featureSettingsClicked: () => void;\n\n  const toggleFeature = async (feature: TypoFeature) => {\n    if(feature.toggleEnabled === false) return feature;\n\n    const state = await firstValueFrom(feature.activated$);\n    if(!state) {\n      await feature.activate();\n    }\n    else {\n      await feature.destroy();\n    }\n\n    return feature;\n  }\n\n  let featureState: ReturnType<typeof fromObservable<boolean>> | undefined;\n\n  $: {\n    featureState = fromObservable(feature.activated$, false);\n  }\n</script>\n\n<style lang=\"scss\">\n  .typo-feature-item {\n    min-width: clamp(20em, 20em, 100%);\n    max-width: clamp(20em, 20em, 100%);\n    background-color: var(--COLOR_PANEL_HI);\n    border-radius: 3px;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    padding: 1rem;\n    flex: 1 1 0px;\n    position: relative;\n\n    &.hidden {\n      display: none;\n    }\n\n    &.devMode .feature-id {\n      display: block;\n      position: absolute;\n      bottom: 0;\n      right: 0;\n      user-select: none;\n      opacity: .5;\n      padding: .2rem;\n    }\n\n    .feature-id {\n      display: none;\n    }\n\n    .description {\n      flex-grow: 1;\n      display: flex;\n      gap: 1rem;\n      align-items: center;\n      user-select: none;\n\n      &[role='button'] {\n        cursor: pointer;\n      }\n\n      img {\n        filter: grayscale(100%);\n        opacity: 0.7;\n        width: 1.5em;\n        height: 1.5em;\n\n        &:hover {\n          filter: grayscale(0%);\n          opacity: 1;\n        }\n      }\n    }\n\n    .name-toggle {\n      display:flex;\n      align-items: center;\n      gap: 1rem;\n      font-weight: bold;\n      font-size: 1.2rem;\n      cursor: pointer;\n      user-select: none;\n\n      &.locked {\n        cursor: not-allowed;\n\n        img {\n          filter: grayscale(100%);\n          opacity: 0.7;\n        }\n      }\n\n      img {\n        width: 1.5em;\n        height: 1.5em;\n        filter: drop-shadow(3px 3px 0px rgba(0, 0, 0, .3));\n      }\n\n      span:last-child {\n        font-size: 1rem;\n        opacity: .5;\n        margin-left: auto;\n        text-transform: uppercase;\n      }\n    }\n  }\n</style>\n\n<!-- container box for a feature, works as toggle-->\n<div class=\"typo-feature-item\"\n     class:devMode={devmodeEnabled}\n     class:hidden={feature.developerFeature && !devmodeEnabled}\n>\n  <!-- icon with name -->\n  <div class=\"name-toggle\" role=\"button\" tabindex=\"0\"\n       class:locked={!feature.toggleEnabled}\n       on:click={async () => feature = await toggleFeature(feature)}\n       on:keypress={async (key) => {\n         if(key.key === 'Enter') feature = await toggleFeature(feature);\n       }}\n  >\n    <img src=\"\" alt=\"{$featureState ? 'enabled' : 'disabled'}\" style=\"content: var(--{$featureState ? 'file-img-enabled-gif' : 'file-img-disabled-gif'})\" />\n    <span>{feature.name}</span>\n    <span>{$featureState ? 'enabled' : 'disabled'}</span>\n  </div>\n\n  <!--description-->\n  {#if feature.hasDetailComponents}\n    <div class=\"description\" role=\"button\" on:click={() => featureSettingsClicked()}>\n      <img src=\"\" alt=\"{$featureState ? 'enabled' : 'disabled'}\" style=\"content: var(--file-img-wrench-gif)\" />\n      <span>{feature.description}</span>\n    </div>\n  {:else}\n    <div class=\"description\">\n      {feature.description}\n    </div>\n  {/if}\n\n  <!-- feature id in dev mode -->\n  <div class=\"feature-id\">#{feature.featureId}</div>\n</div>","<script lang=\"ts\">\n  import type { TypoFeature } from \"@/content/core/feature/feature\";\n  import { ControlsSettingsFeature } from \"@/content/features/controls-settings/controls-settings.feature\";\n  import { firstValueFrom } from \"rxjs\";\n  import ControlsSettingsDetails from \"./controls-settings-details.svelte\";\n  import ControlsSettingsFeatureItem from \"./controls-settings-feature.svelte\";\n\n  export let feature: ControlsSettingsFeature;\n  const devMode = feature.devModeStore;\n  let selectedDetailsFeature: TypoFeature | undefined;\n\n  const toggleFeature = async (feature: TypoFeature) => {\n    if(feature.toggleEnabled === false) return feature;\n\n    const state = await firstValueFrom(feature.activated$);\n    if(!state) {\n      await feature.activate();\n    }\n    else {\n      await feature.destroy();\n    }\n\n    return feature;\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-features-container {\n    position:relative;\n    width: 100%;\n    flex-grow: 1;\n  }\n\n  .typo-features-info {\n    max-width: clamp(40em, 40em, 100%);\n    text-align: left;\n    padding-bottom: 2em;\n  }\n\n  .typo-feature-settings {\n    position: absolute;\n    inset: 0;\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n    margin: 0 2em 2em 2em;\n    padding: 2em;\n    overflow: auto;\n    transform: translateX(-100vw);\n    transition: transform .1s ease-in-out;\n    /*background-color: var(--COLOR_PANEL_HI);*/\n    border-radius: 3px;\n\n    &.settingsVisible {\n      transform: translateX(0);\n    }\n  }\n\n  .typo-features {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    position: absolute;\n    inset: 0;\n    transform: translateX(0);\n    transition: transform .1s ease-in-out;\n\n    &.settingsVisible {\n      transform: translateX(100vw);\n    }\n\n    .typo-features-list {\n      flex-grow: 1;\n      width: 100%;\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      justify-content: center;\n      gap: 2rem;\n      padding: 0 2em 2em 2em;\n      overflow: auto;\n    }\n  }\n</style>\n\n<div class=\"typo-features-container\">\n  <div class=\"typo-features\" class:settingsVisible={selectedDetailsFeature !== undefined}>\n    <div class=\"typo-features-info\">\n      All features of skribbltypo can be managed here.<br>\n      You can click on a feature name to toggle it. To open feature settings, click the settings icon.<br>\n      If you are unsure how a feature works, you can have a look at the typo website or join the typo discord server and get help there!\n    </div>\n\n    <div class=\"typo-features-list color-scrollbar\">\n      {#each feature.features as feat}\n\n        <ControlsSettingsFeatureItem feature=\"{feat}\" devmodeEnabled=\"{$devMode}\" featureSettingsClicked=\"{() => selectedDetailsFeature = feat}\" />\n\n      {/each}\n    </div>\n  </div>\n\n  <div class=\"typo-feature-settings color-scrollbar\" class:settingsVisible={selectedDetailsFeature !== undefined}>\n    {#if selectedDetailsFeature}\n      <ControlsSettingsDetails feature=\"{selectedDetailsFeature}\" detailsClosed=\"{() => selectedDetailsFeature = undefined}\" settingsFeature=\"{feature}\" />\n    {/if}\n  </div>\n</div>\n\n\n","import { FeaturesService } from \"@/content/core/feature/features.service\";\nimport type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { type componentData, ModalService } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { inject } from \"inversify\";\nimport { Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport ControlsSettings from \"./controls-settings.svelte\";\n\nexport class ControlsSettingsFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(FeaturesService) private readonly _featuresService!: FeaturesService;\n  @inject(GlobalSettingsService) private readonly _settingsService!: GlobalSettingsService;\n\n  public readonly name = \"Typo Settings\";\n  public readonly description = \"Manage the features of typo\";\n  public override readonly toggleEnabled = false;\n  public readonly featureId = 1;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach to controls */\n    this._iconComponent = new IconButton({\n      target: elements.controls,\n      props: {\n        hoverMove: false,\n        size: \"48px\",\n        icon: \"file-img-wrench-gif\",\n        name: \"Typo Settings\",\n        order: 1,\n        tooltipAction: this.createTooltip\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n      const settingsComponent: componentData<ControlsSettings> = {\n        componentType: ControlsSettings,\n        props: {\n          feature: this,\n        },\n      };\n      this._modalService.showModal(\n        settingsComponent.componentType,\n        settingsComponent.props,\n        \"Typo Settings\",\n      );\n    });\n  }\n\n  protected override postConstruct() {\n    this._settingsService.globalHotkeysList.forEach(hotkey => this.useHotkey(hotkey));\n\n    this.useSetting(this._settingsService.settings.devMode);\n    this.useSetting(this._settingsService.settings.controlsPosition);\n    this.useSetting(this._settingsService.settings.controlsDirection);\n    this.useSetting(this._settingsService.settings.showLandingOutfit);\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n  }\n\n  public override get hotkeys() {\n    return this._settingsService.globalHotkeysList;\n  }\n\n  public get features() {\n    return this._featuresService.features;\n  }\n\n  public get devModeStore() {\n    return fromObservable(this._settingsService.settings.devMode.changes$, false);\n  }\n\n  /**\n   * Set the hotkey combo for a hotkey action\n   * @param hotkey\n   * @param value\n   */\n  public async setHotkeyCombo(hotkey: HotkeyAction, value: string[]) {\n    const toast = await this._toastService.showLoadingToast(\n      `Updating hotkey ${hotkey.name} to ${value.join(\" + \")}`,\n    );\n\n    try {\n      await this._hotkeysService.setHotkeyCombo(hotkey, value);\n    } catch {\n      toast.reject();\n      return;\n    }\n\n    toast.resolve();\n  }\n\n  /**\n   * Resets the hotkey combo to the default value\n   * @param hotkey\n   */\n  public async resetHotkeyCombo(hotkey: HotkeyAction) {\n    const toast = await this._toastService.showLoadingToast(\n      `Resetting hotkey ${hotkey.name} to default ${hotkey.defaultCombo?.join(\" + \") ?? \"(disabled)\"}`,\n    );\n\n    let newCombo;\n    try {\n      newCombo = await this._hotkeysService.resetHotkeyCombo(hotkey);\n    } catch {\n      toast.reject();\n      return;\n    }\n\n    toast.resolve();\n    return newCombo;\n  }\n}","export const themeColors = Object.freeze({\n  \"--COLOR_PANEL_BG\": [226, 85, 32, 0.75],\n  \"--COLOR_PANEL_LO\": [226, 90, 27, 0.75],\n  \"--COLOR_PANEL_BUTTON\": [226, 67, 49],\n  \"--COLOR_PANEL_BUTTON_HOVER\": [226, 73, 43],\n  \"--COLOR_PANEL_BUTTON_ACTIVE\": [226, 72, 41],\n  \"--COLOR_PANEL_HI\": [226, 80, 44],\n  \"--COLOR_PANEL_FOCUS\": [32, 85, 56],\n  \"--COLOR_PANEL_BORDER\": [232, 85, 11],\n  \"--COLOR_PANEL_BORDER_FOCUS\": [207, 98, 66],\n  \"--COLOR_PANEL_TEXT\": [0, 0, 94],\n  \"--COLOR_PANEL_TEXT_FOCUS\": [0, 0, 100],\n  \"--COLOR_PANEL_TEXT_PLACEHOLDER\": [0, 0, 61],\n  \"--COLOR_TOOL_BASE\": [0, 0, 100],\n  \"--COLOR_TOOL_HOVER\": [0, 0, 77],\n  \"--COLOR_TOOL_TEXT\": [0, 0, 0],\n  \"--COLOR_TOOL_SIZE_BASE\": [0, 0, 100],\n  \"--COLOR_TOOL_SIZE_HOVER\": [0, 0, 77],\n  \"--COLOR_TOOL_ACTIVE\": [271, 77, 66],\n  \"--COLOR_TOOL_SIZE_ACTIVE\": [271, 77, 66],\n  \"--COLOR_INPUT_BG\": [0, 0, 100],\n  \"--COLOR_INPUT_HOVER\": [0, 0, 100],\n  \"--COLOR_INPUT_TEXT\": [0, 0, 17],\n  \"--COLOR_INPUT_BORDER\": [0, 0, 44],\n  \"--COLOR_INPUT_BORDER_FOCUS\": [207, 98, 66],\n  \"--COLOR_PLAYER_TEXT_BASE\": [0, 0, 0],\n  \"--COLOR_PLAYER_ME\": [214, 100, 64],\n  \"--COLOR_PLAYER_ME_GUESSED\": [216, 100, 35],\n  \"--COLOR_PLAYER_BG_BASE\": [0, 0, 100],\n  \"--COLOR_PLAYER_BG_ALT\": [0, 0, 93],\n  \"--COLOR_PLAYER_BG_GUESSED_BASE\": [113, 68, 58],\n  \"--COLOR_PLAYER_BG_GUESSED_ALT\": [113, 57, 50],\n  \"--COLOR_TOOL_TIP_BG\": [226, 100, 64],\n  \"--COLOR_GAMEBAR_TEXT\": [0, 0, 0],\n  \"--COLOR_GAMEBAR_ROUND_TEXT\": [0, 0, 0],\n  \"--COLOR_GAMEBAR_WORD_DESCRIPTION\": [0, 0, 21],\n  \"--COLOR_TEXT_CANVAS_TRANSPARENT\": [0, 0, 25],\n  \"--COLOR_CHAT_TEXT_BASE\": [0, 0, 0],\n  \"--COLOR_CHAT_TEXT_GUESSED\": [103, 68, 48],\n  \"--COLOR_CHAT_TEXT_CLOSE\": [54, 100, 44],\n  \"--COLOR_CHAT_TEXT_DRAWING\": [216, 60, 52],\n  \"--COLOR_CHAT_TEXT_JOIN\": [103, 68, 48],\n  \"--COLOR_CHAT_TEXT_LEAVE\": [21, 91, 42],\n  \"--COLOR_CHAT_TEXT_OWNER\": [32, 100, 63],\n  \"--COLOR_CHAT_TEXT_GUESSCHAT\": [86, 47, 46],\n  \"--COLOR_CHAT_BG_BASE\": [0, 0, 100],\n  \"--COLOR_CHAT_BG_ALT\": [0, 0, 93],\n  \"--COLOR_CHAT_SCROLLBAR\": [0, 0, 49],\n  \"--COLOR_CHAT_SCROLLBAR_THUMB\": [0, 0, 78],\n  \"--COLOR_CHAT_BG_GUESSED_BASE\": [105, 100, 94],\n  \"--COLOR_CHAT_BG_GUESSED_ALT\": [104, 100, 87],\n  \"--COLOR_CHAT_INPUT_COUNT\": [0, 0, 0],\n  \"--COLOR_BUTTON_DANGER_BG\": [44, 81, 51],\n  \"--COLOR_BUTTON_SUBMIT_BG\": [110, 75, 55],\n  \"--COLOR_BUTTON_NORMAL_BG\": [208, 80, 54],\n  \"--COLOR_BUTTON_DANGER_TEXT\": [0, 0, 100],\n  \"--COLOR_BUTTON_SUBMIT_TEXT\": [0, 0, 100],\n  \"--COLOR_BUTTON_NORMAL_TEXT\": [0, 0, 100]\n});","import type { serializable } from \"@/content/core/settings/setting\";\nimport type { Mutable } from \"@/util/types/mutable\";\nimport { themeColors } from \"@/util/typo/themes/colors\";\n\n// eslint-disable-next-line @typescript-eslint/consistent-indexed-object-style\nexport interface serializableTheme extends typoTheme {\n  [key: string]: serializable; /* needed to pass as serializable */\n}\n\nexport interface savedTheme {\n  [key: string]: serializable; /* needed to pass as serializable */\n  theme: serializableTheme;\n  savedAt: number;\n  publicTheme?: {\n    publicId: string;\n    localVersion: number\n  },\n  enableManage?: boolean;\n}\n\nexport interface typoTheme {\n  colors: Mutable<typeof themeColors>;\n  hooks: Record<string, string>;\n  images: {\n    urlLogo?: string;\n    urlBackground?: string;\n    urlBackgroundGame?: string;\n    backgroundRepeat?: boolean;\n    containerImages?: string;\n    backgroundTint?: string;\n  },\n  misc: {\n    fontStyle?: string;\n    hideFooter?: boolean,\n    hideAvatarLogo?: boolean,\n    hideInGameLogo?: boolean,\n    hideSkribblPanels?: boolean,\n    themeCssUrl?: string,\n    cssText?: string,\n    htmlText?: string\n  },\n  meta: {\n    author: string,\n    created: number,\n    id: number,\n    name: string,\n    type: \"theme\"\n  }\n}\n\nexport const createEmptyTheme: (author: string, name?: string, id?: number) => typoTheme = (author, name, id) => {\n  const date = new Date();\n  const theme: typoTheme = {\n    meta: {\n      author,\n      created: date.getTime(),\n      id: id === undefined ? date.getTime() : id,\n      name: name ?? `Untitled Theme ${date.getTime()}`,\n      type: \"theme\"\n    },\n    colors: structuredClone(themeColors),\n    hooks: {} as Record<keyof typeof themeColors, string>,\n    images: {},\n    misc: {}\n  };\n\n  return theme;\n};","import type { oldThemeOptions } from \"@/util/typo/themes/oldTheme\";\nimport { type typoTheme } from \"@/util/typo/themes/theme\";\n\n/**\n * Converta a legacy theme to a new theme format\n * @param options\n * @param author\n * @param name\n */\nexport function convertOldTheme(options: oldThemeOptions, theme: typoTheme) {\n\n  /* apply everything that needed extra elements in old themes */\n  theme.images.urlLogo = options.urlLogo;\n  theme.images.urlBackground = options.urlBackground;\n  theme.images.urlBackgroundGame = options.urlBackgroundGame;\n  theme.misc.fontStyle = options.fontStyle;\n  theme.misc.htmlText = options.injection;\n\n  /* build css for everything else with \"original\" code */\n  let css = \"\";\n  if (options[\"containerBackgroundsCheck\"] == true) {\n\n    const val = options[\"containerBackgrounds\"] ? options[\"containerBackgrounds\"].trim() : \"\";\n    css += \":root {--COLOR_PANEL_BUTTON: \" + (val != \"\" ? val : \"transparent\") + \" !important}\";\n    css += \"#setting-bar .content, #emojiPrev, #imageAgent, #home .news ::-webkit-scrollbar, #home .news ::-webkit-scrollbar-thumb, .modalContainer, .toast, #modal .box, #home .panel, #home .bottom .footer {background-color: \" + (val != \"\" ? val : \"transparent\") + \" !important}\";\n    css += \"#home .bottom svg {fill: \" + (val != \"\" ? val : \"transparent\") + \" !important}\";\n  }\n  if (options[\"containerBackgroundsCheck\"] == true && options[\"ingameContainerBackgroundsCheck\"] !== false) {\n    options[\"ingameContainerBackgrounds\"] = options[\"containerBackgrounds\"];\n    options[\"ingameContainerBackgroundsCheck\"] = true;\n  }\n  if (options[\"ingameContainerBackgroundsCheck\"] == true) {\n    const val = options[\"ingameContainerBackgrounds\"] ? options[\"ingameContainerBackgrounds\"].trim() : \"\";\n    css += \"#game-bar, .clickable,  #game-room .settings, #game-room .players,   .tooltip .tooltip-content, #imageAgent, #gamemodePopup, #optionsPopup, #downloadPopup, #sharePopup, #typoUserInfo, #imageOptions, div#game-toolbar.typomod div.tools-container div.tools div.tool, #game-toolbar divdiv.preview div.graphic-container, #game-room .container-settings, #game-chat .container, #game-players .players-list .player, #game-players .players-list .player.odd {background-color: \" + (val != \"\" ? val : \"transparent\") + \" !important}\";\n    css += \"#game-players .players-list .player.odd{background-image: linear-gradient(0, \" + (val != \"\" ? val : \"transparent\") + \", \" + (val != \"\" ? val : \"transparent\") + \");}\";\n    css += \"#game-chat .chat-content {background:none}\";\n    css += \":root{ --COLOR_TOOL_TIP_BG: \" + val + \" !important; --COLOR_CHAT_BG_BASE: \" + val + \" !important; } \";\n    css += \"#game-players div.list div.player div.bubble div.arrow{border-right-color:\" + val + \"} #game-players div.list div.player div.bubble div.content{background-color:\" + val + \"}\";\n    css += \"#game-chat .chat-content p:nth-child(even), #game-chat .chat-content p.guessed:nth-child(even) {background-color: #ffffff20;} #game-chat .chat-content p.guessed:nth-child(odd){background-color:transparent}\";\n  }\n\n  if (options[\"containerOutlinesCheck\"] == true) {\n    const val = options[\"containerOutlines\"] ? options[\"containerOutlines\"].trim() : \"\";\n    css += \"#game-bar,  #game-room .settings, #game-room .players,   #imageAgent, #modal .box, #home .panel, .modalContainer, #game-chat, #game-players .players-list .player, #imageOptions {border-radius: 4px; border: 2px solid \" + (val != \"\" ? val : \"transparent\") + \" !important}\";\n  }\n\n  if (options[\"containerImages\"] && options[\"containerImages\"].trim() != \"\") {\n    css += \"#game-bar, #game-room .settings, #game-room .players,  #imageAgent, #gamemodePopup, #optionsPopup, #downloadPopup, #sharePopup, #typoUserInfo, #imageOptions, #game-room .container-settings, #game-chat, #game-players .players-list  {background-image: url(\" + options[\"containerImages\"].trim() + \") !important}\";\n    css += \"#game-players .players-list {background:none !important}\";\n  }\n  // font color\n  const color = options[\"fontColor\"] ? options[\"fontColor\"] : \"\";\n  if (color && color != \"\") {\n    css += \"#home .bottom .footer .notice, *:not(.chat-content *), .characters {color:\" + color.trim() + \" !important}\";\n    css += \"input[type=checkbox].flatUI, #game-chat form input, input[type=text].flatUI, #home .bottom .footer .section-container .section{color:unset}\";\n  }\n  // font color of everything in-game\n  if (!options[\"ingameFontColor\"] && options[\"fontColor\"]) {\n    options[\"ingameFontColor\"] = options[\"fontColor\"];\n  }\n  const ingamecolor = options[\"ingameFontColor\"] ? options[\"ingameFontColor\"] : \"\";\n  if (ingamecolor && ingamecolor != \"\") {\n    css += \":root{ --COLOR_CHAT_TEXT_BASE:\" + ingamecolor.trim() + \" !important}\";\n    css += \"#game *:not(.chat-content *) {color:\" + ingamecolor.trim() + \"}\";\n    css += \"div#game-toolbar.typomod div.tools-container div.tools div.tool div.key, #game-word .description, #game-round .round-max, #game-round span, #game-players .player-amount b:nth-child(4), #game-players .player-amount span {color:\" + ingamecolor.trim() + \"; filter: brightness(0.8);}\";\n  }\n\n  // font color of buttons / inputs\n  const colorBtns = options[\"fontColorButtons\"] ? options[\"fontColorButtons\"] : \"\";\n  if (colorBtns && colorBtns != \"\") css += \"select, input, button, textarea {color:\" + colorBtns.trim() + \"}\";\n  if (ingamecolor || color || colorBtns) css += \"#game-clock{color:black !important}\";\n\n  // input backgrounds\n  if (options[\"inputBackgroundsCheck\"] == true) {\n    const val = options[\"inputBackgrounds\"] ? options[\"inputBackgrounds\"].trim() : \"\";\n    css += \"input[type=checkbox], input[type=checkbox].flatUI,#modal .container .box .content .container-rooms .room, button.flatUI.green,button.flatUI.orange, button.flatUI.blue, button.flatUI, input[type=text].flatUI, .link .input-container .link-overlay, input, textarea, button, select, #quickreact > span {background: \" + (val != \"\" ? val : \"transparent\") + \" !important; box-shadow:none !important;} \";\n    css += \"button:is(.flatUI, .flatUI.green, .flatUI.orange, .flatUI.blue):is(:hover, :active, :focus), input:is(:hover, :active, :focus), textarea:is(:hover, :active, :focus), button:is(:hover, :active, :focus), select:is(:hover, :active, :focus) {background: \" + (val != \"\" ? val : \"transparent\") + \" !important; opacity: 0.75}\";\n    css += \":is(#game-room .container-settings .group.customwords .checkbox, .report-menu) input[type=checkbox]:checked:after { content: '🞬'; height:100%; width: 100%; display: grid; place-content: center;}\";\n  }\n\n  // outlines of inputs\n  if (options[\"inputOutlinesCheck\"] == true) {\n    const val = options[\"inputOutlines\"] ? options[\"inputOutlines\"].trim() : \"\";\n    css += \".link .input-container .link-overlay {display:none !important} input[type=checkbox]{border:none !important;} input, textarea, button, select {border: 2px solid \" + (val != \"\" ? val : \"transparent\") + \" !important; }\";\n  }\n  if (options[\"hideFooter\"] == true) {\n    css += \".tos, .notice {display:none}\";\n  }\n  if (options[\"hideTypoInfo\"] == true) {\n    css += \"#typoUserInfo {display:none !important}\";\n  }\n  if (options[\"hideDiscord\"] == true) {\n    css += \"#home .socials {opacity:0}\";\n  }\n  if (options[\"hideInGameLogo\"] == true) {\n    css += \"#game #game-logo{display:none} #game{margin-top:2em}\";\n  }\n  if (options[\"hideAvatarLogo\"] == true) {\n    css += \"#home .logo-big .avatar-container {display:none }\";\n  }\n  if (options[\"hideTypoPanels\"] == true) {\n    css += \"#panelgrid .panel:is(:first-child, :last-child) {display:none } #panelgrid{grid-template-columns: 100% !important}\";\n  }\n  if (options[\"hideAvatarSprites\"] == true) {\n    css += \".avatar-customizer .spriteSlot{display:none }\";\n    css += \".avatar-customizer {background-image: unset !important }\";\n    css += \".avatar-customizer .color, .avatar-customizer .mouth, .avatar-customizer .eyes {opacity: 1 !important}\";\n  }\n\n  theme.misc.cssText = css;\n}","import { ExtensionSetting } from \"@/content/core/settings/setting\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { convertOldTheme } from \"@/util/typo/themes/convertOldTheme\";\nimport type { oldThemeOptions } from \"@/util/typo/themes/oldTheme\";\nimport { createEmptyTheme, type savedTheme, type serializableTheme, type typoTheme } from \"@/util/typo/themes/theme\";\nimport { inject, injectable } from \"inversify\";\nimport { type ThemeListingDto, ThemesApi } from \"@/api\";\nimport { BehaviorSubject, } from \"rxjs\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\n@injectable()\nexport class ThemesService {\n\n  private readonly _logger;\n\n  private readonly _originalTheme: serializableTheme = createEmptyTheme(\"Mel\", \"Original Skribbl\", 0) as serializableTheme;\n  private readonly _activeThemeSetting = new ExtensionSetting<number | undefined>(\"active_theme_local_id\", undefined);\n  private readonly _savedThemesSetting = new ExtensionSetting<savedTheme[]>(\"saved_themes\", [{\n    theme: this._originalTheme,\n    savedAt: Date.now(),\n    enableManage: false\n  }]);\n\n  private _loadedEditorTheme$ = new BehaviorSubject<savedTheme | undefined>(undefined);\n\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(ElementsSetup) private readonly _elementsSetup: ElementsSetup,\n    @inject(ApiService) private readonly _apiService: ApiService\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  public get activeThemeSetting() {\n    return this._activeThemeSetting.asFrozen;\n  }\n\n  public get savedThemesSetting() {\n    return this._savedThemesSetting.asFrozen;\n  }\n\n  public get loadedEditorTheme$() {\n    return this._loadedEditorTheme$.asObservable();\n  }\n\n  public get loadedEditorThemeStore() {\n    return fromObservable(this._loadedEditorTheme$, this._loadedEditorTheme$.value);\n  }\n\n  /**\n   * Load a theme to the editor; might receive changes via updateLoadedEditorTheme without saving later\n   * @param theme\n   */\n  public async loadThemeToEditor(theme: savedTheme){\n    this._logger.info(\"Loading theme to editor\", theme);\n\n    const themes = await this._savedThemesSetting.getValue();\n    const existingTheme = themes.find(t => t.theme.meta.id === theme.theme.meta.id);\n    if(existingTheme === undefined){\n      this._logger.error(\"Theme not found\", theme);\n      throw new Error(\"Theme not found\");\n    }\n\n    this._loadedEditorTheme$.next(structuredClone(theme));\n  }\n\n  /**\n   * Update the loaded theme in the editor\n   * @param theme\n   */\n  public updateLoadedEditorTheme(theme: savedTheme){\n    this._logger.debug(\"Updating loaded theme\", theme);\n\n    if(this._loadedEditorTheme$.value?.theme.meta.id !== theme.theme.meta.id){\n      this._logger.error(\"Theme not loaded or different theme loaded\", theme);\n      throw new Error(\"Theme not loaded or different theme loaded\");\n    }\n    this._loadedEditorTheme$.next(structuredClone(theme));\n  }\n\n  /**\n   * Unload a theme from the editor\n   */\n  public async unloadThemeFromEditor(){\n    this._logger.info(\"Unloading theme from editor\");\n    this._loadedEditorTheme$.next(undefined);\n  }\n\n  /**\n   * Create an empty new local theme and sore it\n   */\n  public async createLocalTheme(): Promise<savedTheme> {\n    this._logger.info(\"Creating new theme\");\n\n    const elements = await this._elementsSetup.complete();\n    const username = elements.inputName.value.length > 0 ? elements.inputName.value : \"User\";\n\n    const theme = createEmptyTheme(username, \"Untitled Theme\");\n    const themes = await this._savedThemesSetting.getValue();\n    const newTheme: savedTheme = {\n      theme: theme as serializableTheme,\n      savedAt: Date.now(),\n      enableManage: true\n    };\n\n    await this._savedThemesSetting.setValue([newTheme, ...themes]);\n    return newTheme;\n  }\n\n  /**\n   * Save the state of the loaded theme in the editor to the original local theme and unload theme from editor\n   */\n  public async saveLoadedEditorTheme(): Promise<savedTheme> {\n    this._logger.info(\"Updating local theme and unloading from editor\");\n\n    const editorTheme = this._loadedEditorTheme$.value;\n    const themes = await this._savedThemesSetting.getValue();\n    const savedTheme = themes.find(t => t.theme.meta.id === editorTheme?.theme.meta.id);\n    if(editorTheme === undefined || savedTheme === undefined){\n      this._logger.error(\"Theme to update not found\", editorTheme);\n      throw new Error(\"Theme to update not found\");\n    }\n\n    savedTheme.theme = editorTheme.theme;\n    savedTheme.savedAt = Date.now();\n\n    await this._savedThemesSetting.setValue([savedTheme, ...themes.filter(t => t.theme.meta.id !== savedTheme.theme.meta.id)]);\n    this._loadedEditorTheme$.next(undefined);\n    await this._activeThemeSetting.setValue(savedTheme.theme.meta.id);\n    return savedTheme;\n  }\n\n  public async importOldTheme(options: oldThemeOptions, name: string){\n    this._logger.info(\"Importing old theme\", options);\n\n    const theme = createEmptyTheme(\"Unknown\", name);\n    convertOldTheme(options, theme);\n    const themes = await this._savedThemesSetting.getValue();\n    const existingTheme = themes.find(t => t.theme.meta.id === theme.meta.id);\n    if(existingTheme !== undefined){\n      this._logger.warn(\"Theme already exists, assigning new ID\", theme);\n      theme.meta.id = Date.now();\n    }\n\n    const savedTheme: savedTheme = {\n      theme: theme as serializableTheme,\n      savedAt: Date.now(),\n      publicTheme: undefined,\n      enableManage: true,\n    };\n\n    await this._savedThemesSetting.setValue([savedTheme, ...themes]);\n    return savedTheme;\n  }\n\n  /**\n   * Download a featured theme and save to local themes\n   * @param theme\n   */\n  public async savePublicTheme(theme: ThemeListingDto): Promise<savedTheme> {\n    this._logger.info(\"Saving public theme\", theme);\n\n    const themeData = await  this._apiService.getApi(ThemesApi).useThemeById({id: theme.id});\n    const saveData: savedTheme = {\n      theme: themeData as serializableTheme,\n      savedAt: Date.now(),\n      publicTheme: {\n        publicId: theme.id,\n        localVersion: theme.version\n      },\n      enableManage: false\n    };\n\n    let currentThemes = await this._savedThemesSetting.getValue();\n\n    const existingTheme = currentThemes.find(t => t.theme.meta.id === themeData.meta.id);\n    if(existingTheme !== undefined){\n      this._logger.warn(\"Theme already saved\", theme);\n      return existingTheme;\n    }\n\n    currentThemes = [saveData, ...currentThemes];\n    await this._savedThemesSetting.setValue(currentThemes);\n    return saveData;\n  }\n\n  /**\n   * Activate a local theme\n   */\n  public async activateLocalTheme(id: number): Promise<savedTheme> {\n    this._logger.info(\"Activating local theme\", id);\n\n    const themes = await this._savedThemesSetting.getValue();\n    const existingTheme = themes.find(t => t.theme.meta.id === id);\n    if(existingTheme === undefined){\n      this._logger.warn(\"Local Theme not found\", id);\n      throw new Error(\"Local Theme not found\");\n    }\n\n    /* remove currently loaded edit theme */\n    this._loadedEditorTheme$.next(undefined);\n\n    await this._activeThemeSetting.setValue(existingTheme.theme.meta.id);\n    return existingTheme;\n  }\n\n  /**\n   * Activate a saved public theme\n   */\n  public async activatePublicTheme(theme: ThemeListingDto): Promise<savedTheme> {\n    this._logger.debug(\"Getting saved theme of public listing\", theme);\n\n    const themes = await this._savedThemesSetting.getValue();\n    const existingTheme = themes.find(t => t.publicTheme?.publicId === theme.id);\n\n    if(existingTheme === undefined){\n      this._logger.error(\"Theme not found\", theme);\n      throw new Error(\"Theme not found\");\n    }\n\n    /* remove currently loaded edit theme */\n    this._loadedEditorTheme$.next(undefined);\n\n    await this._activeThemeSetting.setValue(existingTheme.theme.meta.id);\n    return existingTheme;\n  }\n\n  /**\n   * Removed a saved theme, no matter if local or public\n   * @param localId\n   */\n  public async removeSavedTheme(localId: number): Promise<savedTheme> {\n    this._logger.info(\"Removing saved theme\", localId);\n\n    const themes = await this._savedThemesSetting.getValue();\n    const theme = themes.find(t => t.theme.meta.id === localId);\n\n    if(theme === undefined){\n      this._logger.error(\"Theme not found\", localId);\n      throw new Error(\"Theme not found\");\n    }\n\n    const filtered = themes.filter(t => t.theme.meta.id !== localId);\n    await this._savedThemesSetting.setValue(filtered);\n\n    /* if loaded for edit, unload */\n    if(this._loadedEditorTheme$.value?.theme.meta.id === localId) {\n      this._loadedEditorTheme$.next(undefined);\n    }\n\n    return theme;\n  }\n\n  /**\n   * Share a theme by uploading it, creating a share id and copying it to clipboard\n   * @param theme\n   */\n  public async shareTheme(theme: typoTheme){\n    this._logger.debug(\"Sharing theme\", theme);\n\n    const response = await this._apiService.getApi(ThemesApi).shareTheme({themeDto: theme});\n    const shareId = response.id;\n    this._logger.info(\"created theme share id:\", response.id);\n    return shareId;\n  }\n\n  /**\n   * Import a theme by share id\n   * @param shareId\n   */\n  public async importTheme(shareId: string){\n    this._logger.debug(\"Importing theme\", shareId);\n\n    const theme = await this._apiService.getApi(ThemesApi).getThemeById({id: shareId});\n    this._logger.info(\"Loaded theme\", theme);\n\n    const themes = await this._savedThemesSetting.getValue();\n    const existingTheme = themes.find(t => t.theme.meta.id === theme.meta.id);\n    if(existingTheme !== undefined){\n      this._logger.warn(\"Theme already exists, assigning new ID\", theme);\n      theme.meta.id = Date.now();\n    }\n\n    const savedTheme: savedTheme = {\n      theme: theme as serializableTheme,\n      savedAt: Date.now(),\n      publicTheme: undefined,\n      enableManage: true\n    };\n\n    await this._savedThemesSetting.setValue([savedTheme, ...themes]);\n    return savedTheme;\n  }\n}","/**\n * Extract selectors that use color variables from a CSS stylesheet\n * @param cssText\n * @param colorVariables\n * @returns Record with a color variable as name and selectors that use it as value\n */\nexport const getCssVariableSelectorHooks = (cssText: string, colorVariables: string[]) => {\n\n  // Parse the CSS text using a DOM parser\n  const parser = new DOMParser();\n  const css = parser.parseFromString(`<style>${cssText}</style>`, \"text/html\").querySelector(\"style\");\n\n  // Get all CSS rules from the stylesheet\n  const rules = css?.sheet?.cssRules;\n  if(rules === null || rules === undefined){\n    throw new Error(\"Failed to parse css rules\");\n  }\n\n  // Initialize an empty object to store selectors for each variable\n  const variableSelectors: Record<string, string[]> = {};\n\n  // Iterate through each color variable to initialize empty arrays for each one\n  colorVariables.forEach((colorVariable) => {\n    variableSelectors[colorVariable] = [];\n  });\n\n  // Iterate through each rule to find selectors with variables\n  for (const rule of rules) {\n\n    // Check if the rule is a CSSStyleRule (i.e., a selector with style properties)\n    if (rule instanceof CSSStyleRule) {\n\n      // Iterate through each style property to find variables\n      for (const propertyName in rule.style) {\n        const propertyValue = rule.style.getPropertyValue(propertyName);\n\n        // Check if the property value contains any of the color variables\n        colorVariables.forEach((colorVariable) => {\n          if (propertyValue.includes(`var(${colorVariable}`)) {\n            variableSelectors[colorVariable].push(rule.selectorText);\n          }\n        });\n      }\n    }\n  }\n\n  // Return an object with color variables as keys and an array of selectors where they are used as the value\n  return variableSelectors;\n};","import { earlySetup } from \"@/content/core/setup/earlySetup.decorator\";\nimport { themeColors } from \"@/util/typo/themes/colors\";\nimport { getCssVariableSelectorHooks } from \"@/util/typo/themes/cssVariableSelectorHooks\";\nimport { Setup } from \"../../core/setup/setup\";\n\n/**\n * Setup that waits until the game js has been patched\n */\n@earlySetup()\nexport class CssColorVarSelectorsSetup extends Setup<Record<string, string[]>> {\n\n  protected async runSetup(): Promise<Record<string, string[]>> {\n    const css = await(await fetch(\"/css/style.css\")).text();\n    return getCssVariableSelectorHooks(css, Object.keys(themeColors));\n  }\n}","import type { Color } from \"@/util/color\";\nimport type { Mutable } from \"@/util/types/mutable\";\nimport { themeColors } from \"@/util/typo/themes/colors\";\n\n/**\n * Generate a color scheme based on the main color and text color, in hsla scheme\n * @param mainColor\n * @param textColor\n * @param useIngame\n * @param useInputs\n * @param invertInputText\n */\nexport const generateColorScheme = (mainColor: Color | undefined, textColor: Color | undefined, useIngame: boolean, useInputs: boolean, invertInputText: boolean) => {\n  const theme = structuredClone(themeColors) as Mutable<typeof themeColors>;\n\n  /* modify main elements */\n  const mainHueBase = 226;\n  const mainSatBase = 85;\n  const mainLigBase = 32;\n  const mainOpBase = 0.75;\n\n\n  if (mainColor) {\n    const mainHsl = mainColor.hsl;\n    const mainHue = mainHsl[0];\n    const mainSat = mainHsl[1];\n    const mainLig = mainHsl[2];\n    const mains = [\n      \"--COLOR_PANEL_BG\",\n      \"--COLOR_PANEL_LO\",\n      \"--COLOR_PANEL_BUTTON\",\n      \"--COLOR_PANEL_BUTTON_HOVER\",\n      \"--COLOR_PANEL_BUTTON_ACTIVE\",\n      \"--COLOR_PANEL_HI\",\n      \"--COLOR_PANEL_FOCUS\",\n      \"--COLOR_PANEL_BORDER\",\n      \"--COLOR_TOOL_TIP_BG\"\n    ] as (keyof typeof theme)[];\n    mains.forEach(k => theme[k][0] = (theme[k][0] - mainHueBase + mainHue) % 360);\n    mains.forEach(k => theme[k][1] =  theme[k][1] * (mainSat / 100));\n    mains.forEach(k => theme[k][2] = theme[k][2] * (mainLig / 100));\n    theme[\"--COLOR_CHAT_SCROLLBAR\"] = [...theme[\"--COLOR_PANEL_LO\"]];\n    theme[\"--COLOR_CHAT_SCROLLBAR_THUMB\"] = [...theme[\"--COLOR_PANEL_HI\"]];\n\n    if (useIngame) {\n      const themeSat = mainSatBase * (mainSat / 100);\n      const themeLight = mainLigBase * (mainLig / 100);\n      theme[\"--COLOR_CHAT_BG_BASE\"] = [mainHue, themeSat, themeLight, mainOpBase];\n      theme[\"--COLOR_CHAT_BG_ALT\"] = [mainHue, themeSat, themeLight - 7, mainOpBase];\n      theme[\"--COLOR_PLAYER_BG_BASE\"] = [mainHue, themeSat, themeLight, mainOpBase];\n      theme[\"--COLOR_PLAYER_BG_ALT\"] = [mainHue, themeSat, themeLight - 7, mainOpBase];\n    }\n\n    if (useInputs) {\n      theme[\"--COLOR_INPUT_BORDER\"] = [mainHue, mainSatBase, 75 * (mainLigBase / 100), 0.4];\n      theme[\"--COLOR_INPUT_BORDER_FOCUS\"] = [mainHue, mainSatBase, 85 * (mainLigBase / 100), 0.4];\n      theme[\"--COLOR_INPUT_BG\"] = [mainHue, mainSatBase, 80 * (mainLigBase / 100), 0.3];\n      theme[\"--COLOR_INPUT_HOVER\"] = [mainHue, mainSatBase, 90 * (mainLigBase / 100), 0.3];\n    }\n  }\n\n  /* modify text */\n  if (textColor) {\n    const textHsl = textColor.hsl;\n    const texts = [\n\n        /* if ingame generation enabled */\n        ...(useIngame ? [\n          \"--COLOR_GAMEBAR_TEXT\",\n          \"--COLOR_GAMEBAR_ROUND_TEXT\",\n          \"--COLOR_PLAYER_TEXT_BASE\",\n          \"--COLOR_CHAT_TEXT_BASE\",\n        ] : []),\n\n      /* if input generation enabled */\n      ...(useInputs ? [\n        \"--COLOR_INPUT_TEXT\",\n      ] : []),\n\n      \"--COLOR_PANEL_TEXT\"\n    ] as (keyof typeof theme)[];\n    texts.forEach(k => theme[k] = [textHsl[0], textHsl[1], textHsl[2], ...(textHsl[3] ? [textHsl[3]] : [])]);\n\n    if(useInputs) theme[\"--COLOR_PANEL_TEXT_PLACEHOLDER\"] = [textHsl[0], textHsl[1], textHsl[2] - 50];\n    if(useIngame) theme[\"--COLOR_GAMEBAR_WORD_DESCRIPTION\"] = [textHsl[0], textHsl[1], textHsl[2], 0.7];\n    if (invertInputText) theme[\"--COLOR_INPUT_TEXT\"][2] = 100 - theme[\"--COLOR_INPUT_TEXT\"][2];\n  }\n\n  return theme;\n};","import { createElement } from \"@/util/document/appendElement\";\nimport type { typoTheme } from \"@/util/typo/themes/theme\";\n\nexport const generateThemeBackgroundElement = (theme: typoTheme) => {\n  return createElement(`<div id='typo-theme-background-${theme.meta.id}' class=\"typo-theme-background\"></div>`);\n};","export const stringHasContent = (str: string | undefined): str is string => {\n  return str !== undefined && str.trim().length > 0;\n};","import { stringHasContent } from \"@/util/stringHasContent\";\nimport type { typoTheme } from \"@/util/typo/themes/theme\";\n\nexport const generateStyleElementForTheme = (theme: typoTheme, selectorHooks: Record<string, string[]>) => {\n\n  /* generate colors css */\n  const colorsCss = Object.entries(theme.colors).map(entry => {\n    const value = entry[1];\n    const colorString = value.length == 3\n      ? `hsl(${value[0]}, ${value[1]}%, ${value[2]}%)`\n      : `hsla(${value[0]}, ${value[1]}%, ${value[2]}%, ${value[3]})`;\n    return `${entry[0]}: ${colorString};`;\n  }).join(\"\\n\");\n\n  /* create style element and generate css styles */\n  const style = document.createElement(\"STYLE\");\n  style.id = `typo-theme-style-${theme.meta.id}`;\n\n  // TODO background style adjustment for ingame detection\n\n  style.innerHTML = `\n        :root {${colorsCss}}\n        body {\n            background: none;\n        }\n        .typo-theme-background {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: ${ theme.images.backgroundTint ?? \"\" };\n            z-index: -10;\n            pointer-events: none;\n            filter: brightness(${ !stringHasContent(theme.images.urlBackground) && (theme.images.backgroundTint ?? \"transparent\") !== \"transparent\" ? 4 : 1 });\n        }\n        .typo-theme-background::after {\n            image-rendering: unset;\n            content: \"\";\n            position: absolute;\n            inset: 0;\n            background-position: center;\n            background-image: url(${ stringHasContent(theme.images.urlBackground) ? theme.images.urlBackground : \"/img/background.png\" });\n            background-repeat: ${!stringHasContent(theme.images.urlBackground) || theme.images.backgroundRepeat ? \"repeat\" : \"no-repeat\"};\n            background-size: ${!stringHasContent(theme.images.urlBackground) ? \"350px\" : theme.images.backgroundRepeat ? \"auto\" : \"cover\"};\n            mix-blend-mode: ${theme.images.backgroundTint == \"transparent\" || !stringHasContent(theme.images.backgroundTint) ? \"none\" : \"multiply\"};\n            filter: ${theme.images.backgroundTint == \"transparent\" || !stringHasContent(theme.images.backgroundTint) ? \"none\" : \"saturate(0%)\"};\n        }\n        body:has(#game[style*=\"display: flex\"]) .typo-theme-background${ stringHasContent(theme.images.urlBackgroundGame) ? \"\" : \".disabled\" }::after {\n            background-image: url(${ theme.images.urlBackgroundGame });\n        }\n\n        ${theme.misc.hideFooter ? \".tos, .notice {display:none}\" : \"\"}\n        \n        ${theme.misc.hideInGameLogo ? \"#game #game-logo{display:none} #game{margin-top:2em}\" : \"\"}\n\n        ${theme.misc.hideAvatarLogo ? \"#home .logo-big .avatar-container {display:none }\" : \"\"}\n\n        ${theme.misc.hideSkribblPanels ? \".bottom .footer .section-container { display: none !important }\" : \"\"}\n\n        ${stringHasContent(theme.images.containerImages) ? `\n        #game-bar, #game-room .settings, #game-room .players,  #imageAgent, #gamemodePopup, #optionsPopup, #downloadPopup, \n        #sharePopup, #typoUserInfo, #imageOptions, #game-room .container-settings, #game-chat \n        .chat-content, #game-players .players-list  {background-image: url(${theme.images.containerImages}) !important}\n        #game-players .players-list .player {background:none !important}\n        ` : \"\"}\n\n        .flatUi.orange, .button-orange {\n            background-color: var(--COLOR_BUTTON_DANGER_BG) !important;\n            color: var(--COLOR_BUTTON_DANGER_TEXT) !important;\n        }\n        .flatUI.green, .button-play, #start-game {\n            color: var(--COLOR_BUTTON_SUBMIT_TEXT) !important;\n            background-color: var(--COLOR_BUTTON_SUBMIT_BG) !important;\n        }\n        .flatUI.blue, .button-create, .button-blue, #copy-invite {\n            background-color: var(--COLOR_BUTTON_NORMAL_BG) !important;\n            color: var(--COLOR_BUTTON_NORMAL_TEXT) !important;\n        }\n\n        :is(.flatUi.orange, .button-orange):is(:hover, :active, :focus) {\n            background-color: var(--COLOR_BUTTON_DANGER_BG) !important;\n            color: var(--COLOR_BUTTON_DANGER_TEXT) !important;\n            opacity: 0.8;\n        }\n        :is(.flatUI.green, .button-play, #start-game):is(:hover, :active, :focus) {\n            color: var(--COLOR_BUTTON_SUBMIT_TEXT) !important;\n            background-color: var(--COLOR_BUTTON_SUBMIT_BG) !important;\n            opacity: 0.8;\n        }\n        :is(.flatUI.blue, .button-create, .button-blue, #copy-invite):is(:hover, :active, :focus) {\n            background-color: var(--COLOR_BUTTON_NORMAL_BG) !important;\n            color: var(--COLOR_BUTTON_NORMAL_TEXT) !important;\n            opacity: 0.8;\n        }\n\n        ${stringHasContent(theme.misc.fontStyle) ? `*{font-family:'${theme.misc.fontStyle.trim().split(\":\")[0].replaceAll(\"+\", \" \")}', sans-serif !important}` : \"\"}\n\n        ${stringHasContent(theme.images.urlLogo) ? `\n          div.logo-big a {display: flex; justify-content: center }\n          div.logo-big img, div#game-logo img {max-height:20vh; content: url(${theme.images.urlLogo}) }\n        ` : \"\"}\n\n        ${\n          Object.entries(theme.hooks ? theme.hooks : {})\n            .filter(entry => entry[1] !== \"\")\n            .map(entry => `${selectorHooks[entry[0]].join(\",\")}{${entry[1]}}`)\n            .join(\"\\n\")\n        }\n\n        ::-webkit-scrollbar {\n            width: 14px;\n            border-radius: 7px;\n            background-color: var(--COLOR_PANEL_LO); \n        }\n        \n        ::-webkit-scrollbar-thumb {\n            border-radius: 7px;\n            background-color: var(--COLOR_PANEL_HI)\n        }\n\n        #game-chat ::-webkit-scrollbar {\n            width: 14px;\n            border-radius: 7px;\n            background-color: var(--COLOR_CHAT_SCROLLBAR); \n        }\n        \n        #game-chat ::-webkit-scrollbar-thumb {\n            border-radius: 7px;\n            background-color: var(--COLOR_CHAT_SCROLLBAR_THUMB); \n        }\n\n        ${theme.misc.cssText ?? \"\"}\n    \n        `;\n\n  return style;\n};","import { createElement } from \"@/util/document/appendElement\";\nimport type { typoTheme } from \"@/util/typo/themes/theme\";\n\nexport const generateThemeExternalCssElement = (theme: typoTheme) => {\n  return theme.misc.themeCssUrl && theme.misc.themeCssUrl.length > 0 ? [\n    createElement(`<link id='typo-theme-external-css-${theme.meta.id}' rel=\"stylesheet\" href=\"${theme.misc.themeCssUrl}\">`)\n  ] : [];\n};","import { createElement } from \"@/util/document/appendElement\";\nimport type { typoTheme } from \"@/util/typo/themes/theme\";\n\nexport const generateThemeFontElements = (theme: typoTheme) => {\n  return theme.misc.fontStyle && theme.misc.fontStyle.length > 0 ? [\n    createElement(`<link id='typo-theme-font-preconnect-${theme.meta.id}' rel=\"preconnect\" href=\"https://fonts.gstatic.com\">`),\n    createElement(`<link id='typo-theme-font-style-${theme.meta.id}' href=\"https://fonts.googleapis.com/css2?family=${theme.misc.fontStyle?.trim()}&display=swap\" rel=\"stylesheet\">`)\n  ] : [];\n};","import { createElement } from \"@/util/document/appendElement\";\nimport type { typoTheme } from \"@/util/typo/themes/theme\";\n\nexport const generateThemeCustomHtmlElement = (theme: typoTheme) => {\n  return theme.misc.htmlText && theme.misc.htmlText.length > 0 ? [\n    createElement(`<div id='typo-theme-html-${theme.meta.id}'>${theme.misc.htmlText}</div>`)\n  ] : [];\n};","<script lang=\"ts\">\n\n  import type { ThemeListingDto } from \"@/api\";\n  import type { ControlsThemesFeature, savedTheme } from \"@/content/features/controls-themes/controls-themes.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let feature: ControlsThemesFeature;\n  const devmode = feature.devmodeStore;\n  const savedThemes = feature.savedThemesStore;\n  const currentThemeId = feature.activeThemeStore;\n  const loadedEditorTheme = feature.loadedEditorThemeStore;\n\n  let currentTheme: savedTheme | undefined;\n\n  $: {\n    currentTheme = $loadedEditorTheme === undefined ? $savedThemes.find(t => t.theme.meta.id === $currentThemeId) : undefined;\n  }\n\n</script>\n\n<style lang=\"scss\">\n  .typo-themes-browser-header {\n    padding-bottom: 1rem;\n    text-align: center;\n  }\n\n  .typo-themes-browser-list {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    flex-wrap: wrap;\n    justify-content: center;\n  }\n\n  .typo-themes-browser-item {\n    background-color: var(--COLOR_PANEL_HI);\n    border-radius: 3px;\n    padding: 1rem;\n    gap: 1rem;\n    justify-content: start;\n    align-items: center;\n    min-width: clamp(30em, 30em, 100%);\n    max-width: clamp(30em, 30em, 100%);\n\n    display: grid;\n    grid-template-columns: auto 1fr;\n\n    span {\n      opacity: .5;\n    }\n\n    div {\n      justify-self: end;\n    }\n  }\n\n</style>\n\n<div class=\"typo-themes-browser-header\">\n  Here you can discover themes made by other typo users. When you download a theme, it will be activated and saved to your local themes.<br>\n  When a theme receives an update, it will be automatically downloaded.\n</div>\n\n{#await feature.getOnlineThemes() then themes}\n  <div class=\"typo-themes-browser-list\">\n    {#each themes as theme}\n      <div class=\"typo-themes-browser-item\">\n        <b>{theme.name}</b>\n        <div>by {theme.author}</div>\n\n        {#if $devmode}\n          <div></div>\n          <div>\n            <span>v{theme.version}</span>\n            <span>#{theme.id}</span>\n          </div>\n        {/if}\n\n        {#if $savedThemes.some(t => t.publicTheme?.publicId === theme.id)}\n          <FlatButton\n            content=\"{currentTheme?.publicTheme?.publicId === theme.id ? 'Active' : 'Activate'}\"\n            disabled=\"{currentTheme?.publicTheme?.publicId === theme.id}\"\n            color=\"green\"\n            on:click={() => feature.activatePublicTheme(theme)}\n          />\n        {:else}\n          <FlatButton\n            content=\"Download\"\n            color=\"blue\"\n            on:click={async () => {\n              await feature.savePublicTheme(theme);\n              await feature.activatePublicTheme(theme);\n            }}\n          />\n        {/if}\n\n        <div>{theme.downloads} downloads</div>\n      </div>\n    {/each}\n  </div>\n{/await}","<script lang=\"ts\">\n  import { Color } from \"@/util/color\";\n  export let color = Color.fromHex(\"#45588d\");\n  export let allowAlpha = false;\n  export let description = \"\";\n\n  let inputHex = color.hex;\n\n  let hue: number;\n  let saturation: number;\n  let value: number;\n  let alpha: number | undefined;\n\n  let listenSV = false;\n  const handleSV = (event: MouseEvent) => {\n    if(!listenSV) return;\n    listenSV = false;\n    const rect = (event.target as HTMLElement).getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    saturation = (x / rect.width) * 100;\n    value = 100 - (y / rect.height) * 100;\n    color = Color.fromHsv(hue, saturation, value, alpha);\n    inputHex = color.hex;\n  }\n\n  let listenHue = false;\n  const handleHue = (event: MouseEvent) => {\n    if(!listenHue) return;\n    listenHue = false;\n    const rect = (event.target as HTMLElement).getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    hue = (x / rect.width) * 360;\n    color = Color.fromHsv(hue, saturation, value, alpha);\n    inputHex = color.hex;\n  }\n\n  let listenAlpha = false;\n  const handleAlpha = (event: MouseEvent) => {\n    if(!listenAlpha || !allowAlpha) return;\n    listenAlpha = false;\n    const rect = (event.target as HTMLElement).getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    alpha = (x / rect.width);\n    color = Color.fromHsv(hue, saturation, value, alpha);\n    inputHex = color.hex;\n  }\n\n\n  $: {\n    const hsv = color.hsv;\n    hue = hsv[0] ?? 0;\n    saturation = hsv[1] ?? 100;\n    value = hsv[2] ?? 50;\n    alpha = allowAlpha ? hsv[3] : undefined;\n  }\n  \n</script>\n\n<style lang=\"scss\">\n    .color-picker {\n      color: var(--COLOR_PANEL_TEXT);\n      user-select: none;\n      display: flex;\n      flex-direction: column;\n      gap: .5rem;\n      width: 100%;\n\n      .picker-header {\n        display: flex;\n        width: 100%;\n        flex-direction: row;\n        gap: 1rem;\n        align-items: center;\n        justify-content: center;\n\n        > img {\n          user-select: none;\n          height: 1.2rem;\n          width: 1.2rem;\n          filter: drop-shadow(3px 3px 0px rgba(0, 0, 0, .3));\n        }\n\n        h3 {\n          margin-bottom: 0;\n        }\n      }\n\n      .color-rect {\n        width: 100%;\n        aspect-ratio: 1;\n        position: relative;\n        cursor: crosshair;\n        border-radius: 3px;\n\n        .color-thumb {\n          position: absolute;\n          width: 1rem;\n          height: 1rem;\n          border-radius: 50%;\n          background-color: white;\n\n          &.listen {\n            display:none;\n          }\n        }\n      }\n\n      .hue-rect {\n        width: 100%;\n        height: 1rem;\n        position: relative;\n        cursor: pointer;\n        border-radius: 3px;\n        /* hue gradient */\n        background: linear-gradient(to right in hsl increasing hue, hsl(1deg 100% 50%), hsl(360deg 100% 50%));\n\n        .hue-thumb {\n          position: absolute;\n          width: 1rem;\n          height: 1rem;\n          border-radius: 50%;\n          background-color: white;\n        }\n      }\n\n      .alpha-rect {\n        width: 100%;\n        height: 1rem;\n        position: relative;\n        cursor: pointer;\n        border-radius: 3px;\n\n        .alpha-thumb {\n          position: absolute;\n          width: 1rem;\n          height: 1rem;\n          border-radius: 50%;\n          background-color: white;\n        }\n      }\n\n      .slider {\n        width: 100%;\n        height: 1rem;\n      }\n\n      .preview {\n        width: 100%;\n        height: 40px;\n      }\n    }\n</style>\n\n<div class=\"color-picker\">\n\n  <div class=\"picker-header\">\n    <img src=\"\" alt=\"picker icon\" style=\"content: var(--file-img-crosshair-gif)\">\n    <h3>Color Picker</h3>\n  </div>\n\n  {#if description.length > 0}\n    <p>{description}</p>\n  {/if}\n\n  <!-- show saturation/value picker -->\n  <div\n    class=\"color-rect\"\n    on:mousedown={() => listenSV = true}\n    on:mouseup={handleSV}\n    on:mouseleave={handleSV}\n    style=\"\n      background:\n        linear-gradient(to top, rgba(0, 0, 0, 1), rgba(0, 0, 0, 0)),\n        linear-gradient(to right, hsl(0, 0%, 100%), hsl({hue}, 100%, 50%));\n    \"\n  >\n    <div class=\"color-thumb\" style=\"top: calc(100% - {value}% - .5rem); left: calc({saturation}% - .5rem)\" class:listen={listenSV}></div>\n  </div>\n\n   <!-- show hue picker -->\n  <div\n    class=\"hue-rect\"\n    on:mousedown={() => listenHue = true}\n    on:mouseup={handleHue}\n    on:mouseleave={handleHue}\n  >\n    <div class=\"hue-thumb\" style=\"top: calc(50% - .5rem); left: calc({hue / 3.6}% - .5rem)\" class:listen={listenHue}></div>\n  </div>\n\n  <!-- if alpha allowed, show alpha picker -->\n  {#if allowAlpha}\n    <div\n      class=\"alpha-rect\"\n      on:mousedown={() => listenAlpha = true}\n      on:mouseup={handleAlpha}\n      on:mouseleave={handleAlpha}\n      style=\"background: linear-gradient(to right, {color.copy().withAlpha(0).rgbString}, {color.copy().withAlpha(1).rgbString});\"\n    >\n      <div class=\"alpha-thumb\" style=\"top: calc(50% - .5rem); left: calc({(alpha ?? 1) * 100}% - .5rem)\" class:listen={listenAlpha}></div>\n    </div>\n  {/if}\n\n  <!-- show manual hex input -->\n  <input type=\"text\" placeholder=\"#aabbcc\" bind:value={inputHex} on:change={event => {\n    color = Color.fromHex(inputHex);\n  }}>\n</div>\n","<script lang=\"ts\">\n  import { Color } from \"@/util/color\";\n  import ColorPicker from \"./color-picker.svelte\";\n\n  export let color = Color.fromHex(\"#45588d\");\n  export let allowAlpha = false;\n  export let useBackground = true;\n  export let height = '2rem';\n  export let borderRadius = '3px';\n  export let colorChanged: undefined | ((color: Color) => void) = undefined;\n  export let description = \"\";\n\n  let popupPosition: {top: string | undefined, left: string | undefined, right: string | undefined, bottom: string | undefined, transformOrigin: string} | undefined = undefined;\n  let closing = false;\n\n  const openPopup = (event: MouseEvent) => {\n    /*event.stopImmediatePropagation();*/\n    closing = false;\n    const anchor = event.target as HTMLElement;\n    const rect = anchor.getBoundingClientRect();\n\n    const handler = (e: MouseEvent) => {\n\n      if(e.target === anchor) return;\n      document.removeEventListener(\"click\", handler);\n\n      /* dispatch changed event */\n      colorChanged?.(color);\n\n      /* close popup */\n      closing = true;\n      setTimeout(() => {\n        popupPosition = undefined;\n      }, 150);\n    };\n\n    document.addEventListener(\"click\", handler);\n    \n    let left, right, bottom, top: string | undefined;\n    let transformOrigin: string;\n    if(rect.x > window.innerWidth / 2) {\n      right = `0`;\n    }\n    else {\n      left = `0`;\n    }\n\n    if(rect.y > window.innerHeight / 2) {\n      bottom = `0`;\n      transformOrigin = 'bottom';\n    }\n    else {\n      top = `0`;\n      transformOrigin = 'top';\n    }\n    \n    popupPosition = {\n      top, left, right, bottom, transformOrigin\n    };\n  };\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes slideIn {\n    from {\n      transform: scaleY(0);\n      opacity: 0;\n    }\n    to {\n      transform: scaleY(100%);\n      opacity: 100;\n    }\n  }\n\n  @keyframes slideOut {\n    from {\n      transform: scaleY(100%);\n      opacity: 100;\n    }\n    to {\n      transform: scaleY(0);\n      opacity: 0;\n    }\n  }\n\n  .typo-color-picker-button {\n    aspect-ratio: 1;\n    position: relative;\n\n    .color-picker-button-content {\n      position: absolute;\n      inset: 0;\n      cursor: pointer;\n      /*background-image: var(--file-img-crosshair-gif);\n      background-size: contain;*/\n    }\n\n    .color-picker-popout {\n      position: absolute;\n      z-index: 10;\n      width: 20em;\n      border-radius: 10px;\n      padding: 1rem;\n      background-color: var(--COLOR_PANEL_HI);\n      /*backdrop-filter: blur(2px);*/\n      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, .3));\n      animation: slideIn .08s ease-out;\n\n      &.closing {\n        animation: slideOut .08s ease-out forwards;\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-color-picker-button\" style=\"height: {height}\" on:click={openPopup} data-rgb=\"{color.rgbString}\">\n\n  <!-- actual visible part of the button-->\n  <div class=\"color-picker-button-content\" style=\"background-color: {useBackground ? color.hex : undefined}; border-radius: {borderRadius}; \"></div>\n\n  <!-- popout -->\n  {#if popupPosition}\n    <div class=\"color-picker-popout\" class:closing={closing}\n         style=\"top: {popupPosition.top}; left: {popupPosition.left}; right: {popupPosition.right}; bottom: {popupPosition.bottom}; transform-origin: {popupPosition.transformOrigin};\"\n         on:click={e => e.stopImmediatePropagation()}\n    >\n      <ColorPicker bind:color={color} allowAlpha=\"{allowAlpha}\" description=\"{description}\" />\n    </div>\n  {/if}\n</div>","<script lang=\"ts\">\n\n  import type { ControlsThemesFeature } from \"@/content/features/controls-themes/controls-themes.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import ColorPickerButton from \"@/lib/color-picker/color-picker-button.svelte\";\n  import { Color } from \"@/util/color\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import { themeColors as baseColors } from \"@/util/typo/themes/colors\";\n\n  let schemePrimaryColor = Color.fromHex(\"#4197c5\");\n  let schemeTextColor = Color.fromHex(\"#FFFFFF\");\n  let schemeBackgroundTint = Color.fromHex(\"#2f61eb\");\n  let schemeOnInputs = true;\n  let schemeInvertInputBrightness = false;\n  let schemeEnableBackgroundTint = true;\n  let schemeIngame = false;\n  let shareId = \"\";\n  let importJson = \"\";\n\n  export let feature: ControlsThemesFeature;\n  export let variableHooks: Record<string, string[]>;\n  const loadedTheme = feature.loadedEditorThemeStore;\n  const activeThemeTab = feature.activeThemeTabStore;\n  let themeColors: [keyof typeof baseColors, Color][] = [];\n\n  $: {\n    themeColors = $loadedTheme ? Object\n        .entries($loadedTheme.theme.colors)\n        .map(entry => {\n          const color = Color.fromHsl(entry[1][0], entry[1][1], entry[1][2], entry[1][3]);\n          return ([entry[0] as keyof typeof baseColors, color] as const);\n        }) :\n      [];\n\n    if($loadedTheme?.theme.images.backgroundTint && $loadedTheme?.theme.images.backgroundTint !== \"transparent\") {\n      schemeBackgroundTint = Color.fromHex($loadedTheme.theme.images.backgroundTint);\n      schemeEnableBackgroundTint = true;\n    }\n    else {\n      schemeEnableBackgroundTint = false;\n    }\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-themes-editor {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n  }\n\n  .typo-themes-editor-header {\n    padding-bottom: 1rem;\n    text-align: center;\n  }\n\n  .typo-themes-editor-content {\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n    align-items: start;\n    padding: 0 2rem;\n    overflow: auto;\n  }\n\n  details{\n    border-radius: 3px;\n    padding: .5rem 1rem;\n  }\n\n  details[open]{\n    background-color: var(--COLOR_PANEL_HI);\n\n    summary {\n      margin-bottom: .5rem;\n    }\n  }\n\n  summary {\n    font-weight: bold;\n    cursor: pointer;\n    user-select: none;\n    font-size: 1.2rem;\n  }\n\n  .typo-themes-editor-content-section {\n    display: flex;\n    flex-direction: row;\n    gap: 3rem;\n    flex-wrap: wrap;\n    align-items: center;\n    width: 100%;\n    padding-bottom: .5rem;\n\n    .group {\n      display: flex;\n      flex-direction: row;\n      gap: 1rem;\n      align-items: center;\n\n      &:vertical {\n        flex-direction: column;\n      }\n\n      input {\n        width: auto;\n        box-sizing: border-box;\n      }\n    }\n  }\n\n  .color-pickers {\n    display: grid;\n    grid-template-columns: auto auto;\n    grid-gap: .5rem 2rem;\n  }\n\n  .style-hooks {\n    display: grid;\n    grid-template-columns: auto auto;\n    grid-gap: .5rem 2rem;\n  }\n\n</style>\n\n<div class=\"typo-themes-editor\">\n\n  {#if $loadedTheme === undefined}\n    <div class=\"typo-themes-editor-header\">\n      No theme loaded for editing. Select one of your themes in the \"Saved Themes\" tab or create a new one!<br>\n      <br>\n\n      <FlatButton content=\"Create new Theme\" color=\"green\" on:click={async () => {\n        const theme = await feature.createLocalTheme();\n        await feature.loadThemeToEditor(theme);\n      }} />\n    </div>\n    <br>\n    <br>\n\n    <div class=\"typo-themes-editor-header\">\n      <div>If you have received a theme share ID, you can import it here:</div>\n      <br>\n      <input type=\"text\" style=\"width: auto; margin-right: 1rem\" placeholder=\"Share ID\" bind:value={shareId} />\n      <FlatButton content=\"Import Theme\" color=\"blue\" on:click={async () => {\n            const theme = await feature.importTheme(shareId);\n            await feature.activateLocalTheme(theme.theme.meta.id);\n            $activeThemeTab = \"list\";\n          }} />\n    </div>\n\n  {:else}\n\n    <div class=\"typo-themes-editor-header\">\n      <h3 style=\"flex-grow: 1\">Editing Theme: {$loadedTheme.theme.meta.name}</h3>\n      <br>\n\n      <FlatButton content=\"Discard & Delete\" color=\"orange\" on:click={async () => {\n        const id = $loadedTheme.theme.meta.id;\n        await feature.unloadThemeFromEditor();\n        await feature.removeSavedTheme(id);\n      }} />\n      <FlatButton content=\"Discard Changes\" color=\"blue\" on:click={() => feature.unloadThemeFromEditor()} />\n      <FlatButton content=\"Save Theme\" color=\"green\" on:click={() =>{\n        feature.saveLoadedEditorTheme();\n        feature.activeThemeTabStore.set(\"list\");\n      }} />\n    </div>\n\n    <div class=\"typo-themes-editor-content\">\n\n      <div class=\"typo-themes-editor-content-section\">\n        <div class=\"group\">\n          <div>Theme Name:</div>\n          <input type=\"text\" bind:value={$loadedTheme.theme.meta.name} />\n        </div>\n\n        <div class=\"group\">\n          <div>Creator Name:</div>\n          <input type=\"text\" bind:value={$loadedTheme.theme.meta.author} />\n        </div>\n      </div>\n\n      <details open>\n        <summary>Color Scheme</summary>\n\n        Using the color scheme generator, you can easily create a unique color theme for skribbl.<br>\n        This overwrites all existing color customizations in \"Advanced Color Settings\".<br>\n        <br>\n\n        <!-- scheme color pickers-->\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <div>Primary Color:</div>\n            <ColorPickerButton bind:color={schemePrimaryColor} />\n          </div>\n\n          <div class=\"group\">\n            <div>Text Color:</div>\n            <ColorPickerButton bind:color={schemeTextColor}  />\n          </div>\n        </div>\n\n        <br>\n\n        <!-- scheme color settings -->\n        <div class=\"typo-themes-editor-content-section\">\n          <Checkbox bind:checked={schemeOnInputs} description=\"Generate colors for input fields\" />\n          <Checkbox bind:checked={schemeInvertInputBrightness} description=\"Invert text brightness on input fields\" />\n          <Checkbox bind:checked={schemeIngame} description=\"Use theme colors in-game\" />\n        </div>\n\n        <br>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <FlatButton content=\"Generate Color Scheme\" color=\"green\" on:click={async () => {\n            await feature.setColorScheme(\n              $loadedTheme.theme,\n              schemePrimaryColor,\n              schemeTextColor,\n              schemeOnInputs,\n              schemeInvertInputBrightness,\n              schemeIngame\n            );\n            feature.updateLoadedEditorTheme($loadedTheme);\n          }}/>\n        </div>\n      </details>\n\n      <details open>\n        <summary>Image Settings</summary>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <div>Replace Skribbl Logo:</div>\n            <input type=\"text\" placeholder=\"https://link.here/image.gif\" bind:value={$loadedTheme.theme.images.urlLogo}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n\n          <div class=\"group\">\n            <div>Replace Background:</div>\n            <input type=\"text\" placeholder=\"https://link.here/image.gif\" bind:value={$loadedTheme.theme.images.urlBackground}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n\n          <div class=\"group\">\n            <div>In-Game Background:</div>\n            <input type=\"text\" placeholder=\"https://link.here/image.gif\" bind:value={$loadedTheme.theme.images.urlBackgroundGame}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n\n          <div class=\"group\">\n            <div>Container Background:</div>\n            <input type=\"text\" placeholder=\"https://link.here/image.gif\" bind:value={$loadedTheme.theme.images.containerImages}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n        </div>\n        <br>\n\n        <!-- background color settings -->\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <Checkbox bind:checked={schemeEnableBackgroundTint} description=\"Tint the skribbl background with a color\"  on:change={() => {\n              if(schemeEnableBackgroundTint) {\n                $loadedTheme.theme.images.backgroundTint = schemeBackgroundTint.hex;\n              }\n              else {\n                $loadedTheme.theme.images.backgroundTint = undefined;\n              }\n              feature.updateLoadedEditorTheme($loadedTheme);\n            }}/>\n            <ColorPickerButton allowAlpha=\"{true}\" colorChanged={(color) => {\n              schemeBackgroundTint = color;\n              schemeEnableBackgroundTint = true;\n              $loadedTheme.theme.images.backgroundTint = color.hex;\n              feature.updateLoadedEditorTheme($loadedTheme);\n            }} />\n          </div>\n        </div>\n        <br>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <Checkbox bind:checked={$loadedTheme.theme.images.backgroundRepeat} description=\"Repeat custom background image\"\n                    on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n        </div>\n      </details>\n\n      <details>\n        <summary>Advanced Color Settings</summary>\n        <p>Advanced color settings allow you to customize the appearance of skribbl in more detail.</p>\n        <p>These settings are overwritten when the color scheme generator is used.</p>\n        <p>The color names are taken from the skribbl code.</p>\n        <br>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <div class=\"color-pickers\">\n              {#each themeColors as color}\n                <div>{color[0].replace(\"--\", \"\")}:</div>\n                <ColorPickerButton color={color[1]} allowAlpha=\"{true}\" colorChanged={(update) => {\n                  $loadedTheme.theme.colors[color[0]] = update.hsl;\n                  feature.updateLoadedEditorTheme($loadedTheme);\n                }} />\n              {/each}\n            </div>\n          </div>\n        </div>\n      </details>\n\n      <details>\n        <summary>Miscellaneous</summary>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <div>Use Google Font:</div>\n            <input type=\"text\" placeholder=\"Google Fonts import URL\" bind:value={$loadedTheme.theme.misc.fontStyle}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n\n          <div class=\"group\">\n            <div>External CSS URL:</div>\n            <input type=\"text\" placeholder=\"https://some.website/link-to-style.css\" bind:value={$loadedTheme.theme.misc.themeCssUrl}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n        </div>\n        <br>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <div>Custom CSS:</div>\n            <input type=\"text\" placeholder=\".logo-big &lbrace; display: none !important; }\" bind:value={$loadedTheme.theme.misc.cssText}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n\n          <div class=\"group\">\n            <div>HTML Element Injection:</div>\n            <input type=\"text\" placeholder=\"<div>hello there</div>\" bind:value={$loadedTheme.theme.misc.htmlText}\n                   on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          </div>\n        </div>\n        <br>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <Checkbox bind:checked={$loadedTheme.theme.misc.hideFooter} description=\"Hide skribbl footer\"\n                    on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          <Checkbox bind:checked={$loadedTheme.theme.misc.hideSkribblPanels} description=\"Hide About, News & How-To Panels\"\n                    on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          <Checkbox bind:checked={$loadedTheme.theme.misc.hideAvatarLogo} description=\"Hide avatars below skribbl logo\"\n                    on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n          <Checkbox bind:checked={$loadedTheme.theme.misc.hideInGameLogo} description=\"Hide in-game skribbl logo\"\n                    on:change={() => feature.updateLoadedEditorTheme($loadedTheme)} />\n        </div>\n      </details>\n\n      <details>\n        <summary>Skribbl Style Hooks</summary>\n        <p>Skribbl style hooks allow more advanced CSS styling without having to dig through the skribbl css classes.</p>\n        <p>The CSS you write will be applied wherever the skribbl color variable is used.</p>\n        <p>Hover over the ℹ️ icon to display the linked CSS classes.</p>\n        <br>\n\n        <div class=\"typo-themes-editor-content-section\">\n          <div class=\"group\">\n            <div class=\"style-hooks\">\n              {#each Object.entries(variableHooks) as color}\n                <div><abbr title=\"{color[1].join(', ')}\">ℹ️</abbr> {color[0].replace(\"--\", \"\")}:</div>\n                <input type=\"text\" placeholder=\"color: red; border: 1px solid green;\" bind:value={$loadedTheme.theme.hooks[color[0]]} on:change={() => {\n                  feature.updateLoadedEditorTheme($loadedTheme);\n                }} />\n              {/each}\n            </div>\n          </div>\n        </div>\n      </details>\n\n    </div>\n\n  {/if}\n</div>\n","<script lang=\"ts\">\n\n  import type { ControlsThemesFeature } from \"@/content/features/controls-themes/controls-themes.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let feature: ControlsThemesFeature;\n  const devmode = feature.devmodeStore;\n  const savedThemes = feature.savedThemesStore;\n  const currentThemeId = feature.activeThemeStore;\n  const loadedEditorTheme = feature.loadedEditorThemeStore;\n  const selectedTab = feature.activeThemeTabStore;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-themes-list-header {\n    padding-bottom: 1rem;\n    text-align: center;\n  }\n\n  .typo-themes-list-list {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    flex-wrap: wrap;\n    justify-content: center;\n  }\n\n  .typo-themes-list-item {\n    background-color: var(--COLOR_PANEL_HI);\n    border-radius: 3px;\n    padding: 1rem;\n    gap: 1rem;\n    justify-content: center;\n    align-items: start;\n    display: flex;\n    flex-direction: column;\n    min-width: clamp(20em, 20em, 100%);\n\n    .active-marker {\n      display: flex;\n      gap: .5rem;\n      align-items: center;\n\n      img {\n        height: 1.5rem;\n        aspect-ratio: 1;\n      }\n    }\n\n    > div {\n      display: flex;\n      flex-direction: row;\n      gap: 1rem;\n      width: 100%;\n\n      span {\n        opacity: .5;\n      }\n\n      > :last-child:not(:first-child) {\n        flex-grow: 1;\n        text-align: end;\n      }\n    }\n  }\n</style>\n\n<div class=\"typo-themes-list-header\">\n  Downloaded and created themes will appear here. Select a theme to change the appearance of skribbl!\n</div>\n\n<div class=\"typo-themes-list-list\">\n  {#each $savedThemes as theme}\n    <div class=\"typo-themes-list-item\">\n      <div>\n        <b>{theme.theme.meta.name}</b>\n        <span>{theme.publicTheme ? 'Featured Theme' : 'Local Theme'}</span>\n      </div>\n\n      <div>\n        {#if $currentThemeId === theme.theme.meta.id && $loadedEditorTheme === undefined}\n          <div class=\"active-marker\">\n            <img src=\"\" alt=\"enabled\" style=\"content: var(--file-img-enabled-gif)\" />\n            <div>Selected</div>\n          </div>\n        {:else if $loadedEditorTheme?.theme.meta.id === theme.theme.meta.id}\n          <div class=\"active-marker\">\n            <img src=\"\" alt=\"enabled\" style=\"content: var(--file-img-enabled-gif)\" />\n            <div>Editing</div>\n          </div>\n        {:else}\n          <div class=\"active-marker\">\n            <img src=\"\" alt=\"disabled\" style=\"content: var(--file-img-disabled-gif)\" />\n            <div>Inactive</div>\n          </div>\n        {/if}\n        <div>by {theme.theme.meta.author}</div>\n        {#if $devmode && theme.publicTheme}\n          <span>v{theme.publicTheme.localVersion}</span>\n          <span>#{theme.publicTheme.publicId}</span>\n        {/if}\n      </div>\n\n      <div>\n\n        <FlatButton\n          content=\"{$currentThemeId === theme.theme.meta.id && $loadedEditorTheme === undefined ? 'Active' : 'Activate'}\"\n          disabled=\"{$currentThemeId === theme.theme.meta.id && $loadedEditorTheme === undefined}\"\n          color=\"green\"\n          on:click={() => feature.activateLocalTheme(theme.theme.meta.id)}\n        />\n\n        {#if theme.publicTheme || theme.enableManage === true}\n          <FlatButton\n            content=\"Remove\"\n            color=\"orange\"\n            on:click={() => feature.removeSavedTheme(theme.theme.meta.id)}\n          />\n        {/if}\n\n        {#if theme.enableManage === true}\n          <FlatButton\n            content=\"{$loadedEditorTheme?.theme.meta.id === theme.theme.meta.id ? 'Editing' : 'Edit'}\"\n            color=\"blue\"\n            disabled=\"{$loadedEditorTheme?.theme.meta.id === theme.theme.meta.id}\"\n            on:click={() => {\n              feature.loadThemeToEditor(theme);\n              $selectedTab = \"editor\";\n            }}\n          />\n        {/if}\n\n        {#if theme.enableManage === true}\n          <FlatButton\n            content=\"Share\"\n            color=\"blue\"\n            disabled=\"{$loadedEditorTheme?.theme.meta.id === theme.theme.meta.id}\"\n            on:click={() => {\n              feature.shareTheme(theme.theme);\n            }}\n          />\n        {/if}\n      </div>\n    </div>\n  {/each}\n</div>","<script lang=\"ts\">\n  import type { ControlsThemesFeature } from \"@/content/features/controls-themes/controls-themes.feature\";\n  import ThemesBrowser from \"./themes-browser.svelte\";\n  import ThemesEditor from \"./themes-editor.svelte\";\n  import ThemesList from \"./themes-list.svelte\";\n\n  export let feature: ControlsThemesFeature;\n  export let variableHooks: Record<string, string[]>;\n  const selectedTab = feature.activeThemeTabStore;\n</script>\n\n\n<style lang=\"scss\">\n\n  .typo-themes-content {\n    padding: 1rem;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    overflow: auto;\n  }\n\n  .typo-themes-navigation {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 2rem;\n    margin-top: 1rem;\n    margin-bottom: 2rem;\n\n    h3 {\n      opacity: .5;\n      cursor: pointer;\n\n      &.selected {\n        opacity: 1;\n      }\n    }\n  }\n\n  .typo-themes-tab {\n    overflow:auto;\n  }\n\n</style>\n\n<div class=\"typo-themes-content\">\n  <div class=\"typo-themes-navigation\">\n    <h3 class:selected={$selectedTab === \"list\"} on:click={() => $selectedTab = \"list\"}>Saved Themes</h3>\n    <h3 class:selected={$selectedTab === \"editor\"} on:click={() => $selectedTab = \"editor\"}>Theme Editor</h3>\n    <h3 class:selected={$selectedTab === \"browser\"} on:click={() => $selectedTab = \"browser\"}>Discover Themes</h3>\n  </div>\n\n  <div class=\"typo-themes-tab color-scrollbar\">\n    {#if $selectedTab === \"list\"}\n      <ThemesList {feature} />\n    {:else if $selectedTab === \"editor\"}\n      <ThemesEditor {feature} {variableHooks} />\n    {:else if $selectedTab === \"browser\"}\n      <ThemesBrowser {feature} />\n    {/if}\n  </div>\n</div>","import {type ThemeListingDto } from \"@/api\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { type componentData, ModalService } from \"@/content/services/modal/modal.service\";\nimport { ThemesService } from \"@/content/services/themes/themes.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { CssColorVarSelectorsSetup } from \"@/content/setups/css-color-var-selectors/cssColorVarSelectors.setup\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport type { Color } from \"@/util/color\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { generateColorScheme } from \"@/util/typo/themes/colorScheme\";\nimport { generateThemeBackgroundElement } from \"@/util/typo/themes/generateThemeBackgroundElement\";\nimport { generateStyleElementForTheme } from \"@/util/typo/themes/generateThemeCssElement\";\nimport { generateThemeExternalCssElement } from \"@/util/typo/themes/generateThemeExternalCssElement\";\nimport { generateThemeFontElements } from \"@/util/typo/themes/generateThemeFontElement\";\nimport { generateThemeCustomHtmlElement } from \"@/util/typo/themes/generateThemeHtmlElement\";\nimport { type savedTheme, type typoTheme } from \"@/util/typo/themes/theme\";\nimport { inject } from \"inversify\";\nimport { BehaviorSubject, combineLatestWith, map, Subscription, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport ControlsThemes from \"./controls-themes.svelte\";\n\nexport class ControlsThemesFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(CssColorVarSelectorsSetup) private readonly _cssColorVarSelectorsSetup!: CssColorVarSelectorsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(ThemesService) private readonly _themesService!: ThemesService;\n  @inject(GlobalSettingsService) private readonly _globalSettingsService!: GlobalSettingsService;\n\n  public readonly name = \"Themes\";\n  public readonly description =\n    \"Customize the skribbl.io appearance with pre-made themes or your own style\";\n  public readonly featureId = 34;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n  private _themeResetSubscription?: Subscription;\n  private _currentThemeSubscription?: Subscription;\n  private _activeThemeTab$ = new BehaviorSubject<\"editor\" | \"list\" | \"browser\">(\"list\");\n  private _themeElements: HTMLElement[] = [];\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n    const variableHooks = await this._cssColorVarSelectorsSetup.complete();\n\n    /* create icon and attach to controls */\n    this._iconComponent = new IconButton({\n      target: elements.controls,\n      props: {\n        hoverMove: false,\n        size: \"48px\",\n        icon: \"file-img-themes-gif\",\n        name: \"Themes\",\n        order: 3,\n        tooltipAction: this.createTooltip\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n      const themesComponent: componentData<ControlsThemes> = {\n        componentType: ControlsThemes,\n        props: {\n          feature: this,\n          variableHooks\n        },\n      };\n      this._modalService.showModal(themesComponent.componentType, themesComponent.props, \"Typo Themes\");\n    });\n\n    /* Switch to original/no theme when invalid theme detected */\n    this._themeResetSubscription = this._themesService.savedThemesSetting.changes$.pipe(\n      combineLatestWith(this._themesService.activeThemeSetting.changes$)\n    ).subscribe(([themes, activeId]) => {\n      if(!themes.some(t => t.theme.meta.id === activeId)) this._themesService.activeThemeSetting.setValue(0);\n    });\n\n    /* change theme elements when active theme changed */\n    this._currentThemeSubscription = this._themesService.activeThemeSetting.changes$.pipe(\n      withLatestFrom(this._themesService.savedThemesSetting.changes$),\n      map(([activeId, themes]) => activeId === 0 ? undefined : themes.find(t => t.theme.meta.id === activeId)?.theme),\n      combineLatestWith(this._themesService.loadedEditorTheme$),\n      map(([activeTheme, loadedTheme]) => (loadedTheme?.theme ?? activeTheme))\n    ).subscribe(theme => {\n      this._logger.debug(\"Active theme changed\", theme);\n      this.setThemeElements(theme);\n    });\n  }\n\n  protected override async onDestroy(): Promise<void> {\n    this._iconComponent?.$destroy();\n    this._iconClickSubscription?.unsubscribe();\n    this._iconClickSubscription = undefined;\n    this._themeResetSubscription?.unsubscribe();\n    this._themeResetSubscription = undefined;\n    this._currentThemeSubscription?.unsubscribe();\n    this._currentThemeSubscription = undefined;\n    await this.setThemeElements(undefined);\n  }\n\n  public get savedThemesStore() {\n    return this._themesService.savedThemesSetting.store;\n  }\n\n  public get activeThemeStore() {\n    return this._themesService.activeThemeSetting.store;\n  }\n\n  public get loadedEditorThemeStore(){\n    return this._themesService.loadedEditorThemeStore;\n  }\n\n  public get activeThemeTabStore() {\n    return fromObservable(this._activeThemeTab$, this._activeThemeTab$.value, value => this._activeThemeTab$.next(value));\n  }\n\n  public get devmodeStore() {\n    return this._globalSettingsService.settings.devMode.store;\n  }\n\n  public async getOnlineThemes() {\n    return (await this._apiDataSetup.complete()).themes;\n  }\n\n  public async loadThemeToEditor(theme: savedTheme){\n    const toast = await this._toastService.showLoadingToast(\"Loading theme to editor\");\n    try {\n      await this._themesService.loadThemeToEditor(theme);\n      toast.resolve(`Theme ${theme.theme.meta.name} loaded`);\n    }\n    catch {\n      toast.reject(\"Failed to load theme\");\n    }\n  }\n\n  public updateLoadedEditorTheme(theme: savedTheme){\n    this._themesService.updateLoadedEditorTheme(theme);\n  }\n\n  public async unloadThemeFromEditor(){\n    await this._themesService.unloadThemeFromEditor();\n    await this._toastService.showToast(\"Theme unloaded from editor\");\n  }\n\n  public async createLocalTheme(){\n    const toast = await this._toastService.showLoadingToast(\"Creating new theme\");\n    try {\n      const theme = await this._themesService.createLocalTheme();\n      toast.resolve(\"New theme created\");\n      return theme;\n    }\n    catch(e) {\n      toast.reject(\"Failed to create theme\");\n      throw e;\n    }\n  }\n\n  public async importOldTheme(theme: string){\n    const toast = await this._toastService.showLoadingToast(\"Converting old theme..\");\n    try {\n\n      const oldTheme = JSON.parse(theme);\n      const newTheme = await this._themesService.importOldTheme(oldTheme.options, oldTheme.name);\n      toast.resolve(\"Old theme convert\");\n      return newTheme;\n    }\n    catch(e) {\n      toast.reject(\"Failed to convert theme\");\n      throw e;\n    }\n  }\n\n  public async saveLoadedEditorTheme(){\n    const toast = await this._toastService.showLoadingToast(\"Saving theme changes\");\n    try {\n      const theme = await this._themesService.saveLoadedEditorTheme();\n      toast.resolve(`Theme ${theme.theme.meta.name} updated`);\n      return theme;\n    }\n    catch(e) {\n      toast.reject(\"Failed to create theme\");\n      throw e;\n    }\n  }\n\n  public async savePublicTheme(theme: ThemeListingDto){\n    const toast = await this._toastService.showLoadingToast(\"Saving theme\");\n    try {\n      const localTheme = await this._themesService.savePublicTheme(theme);\n      toast.resolve(`Theme ${localTheme.theme.meta.name} saved`);\n    }\n    catch {\n      toast.reject(\"Failed to save theme\");\n    }\n  }\n\n  public async activateLocalTheme(id: number){\n    const toast = await this._toastService.showLoadingToast(\"Activating theme\");\n    try {\n      const theme = await this._themesService.activateLocalTheme(id);\n      toast.resolve(`Theme ${theme.theme.meta.name} activated`);\n    }\n    catch {\n      toast.reject(\"Failed to activate theme\");\n    }\n  }\n\n  public async activatePublicTheme(theme: ThemeListingDto){\n    const toast = await this._toastService.showLoadingToast(\"Activating theme\");\n    try {\n      const localTheme = await this._themesService.activatePublicTheme(theme);\n      toast.resolve(`Theme ${localTheme.theme.meta.name} activated`);\n    }\n    catch {\n      toast.reject(\"Failed to activate theme\");\n    }\n  }\n\n  public async removeSavedTheme(localId: number){\n\n    if(! await(await this._toastService.showConfirmToast(\"Do you want to delete the theme?\")).result){\n      this._logger.info(\"User canceled theme removal\");\n      return;\n    }\n\n    const toast = await this._toastService.showLoadingToast(\"Removing theme\");\n    try {\n      const theme = await this._themesService.removeSavedTheme(localId);\n      toast.resolve(`Theme ${theme.theme.meta.name} removed`);\n    }\n    catch {\n      toast.reject(\"Failed to remove theme\");\n    }\n  }\n\n  public async shareTheme(theme: typoTheme){\n    const toast = await this._toastService.showLoadingToast(\"Sharing theme\");\n    try {\n     const id = await this._themesService.shareTheme(theme);\n     await navigator.clipboard.writeText(id);\n     toast.resolve(`Share id (${id}) for theme ${theme.meta.name} copied`);\n    }\n    catch {\n      toast.reject(\"Failed to share theme\");\n    }\n  }\n\n  public async importTheme(shareId: string){\n    const toast = await this._toastService.showLoadingToast(\"Importing theme\");\n    try {\n      const theme = await this._themesService.importTheme(shareId);\n      toast.resolve(`Theme ${theme.theme.meta.name} imported`);\n      return theme;\n    }\n    catch(e) {\n      toast.reject(\"Failed to import theme\");\n      throw e;\n    }\n  }\n\n  /**\n   * Update the html elements that represent the selelcted theme\n   * @param theme\n   * @private\n   */\n  private async setThemeElements(theme: typoTheme | undefined){\n    this._logger.info(\"Setting theme elements\", theme);\n\n    this._themeElements.forEach(e => e.remove());\n    this._themeElements = theme ? await this.createThemeElements(theme) : [];\n    this._themeElements.forEach(e => document.body.appendChild(e));\n  }\n\n  /**\n   * Create html elements to display a theme\n   * @param theme\n   * @private\n   */\n  private async createThemeElements(theme: typoTheme){\n    const selectorHooks = await this._cssColorVarSelectorsSetup.complete();\n    const themeStyle = generateStyleElementForTheme(theme, selectorHooks);\n    const themeFont = generateThemeFontElements(theme);\n    const themeHtml = generateThemeCustomHtmlElement(theme);\n    const themeExternalCss = generateThemeExternalCssElement(theme);\n    const themeBackground = generateThemeBackgroundElement(theme);\n    return [themeStyle, ...themeFont, ...themeHtml, ...themeExternalCss, themeBackground];\n  }\n\n  /**\n   * Generate a color scheme based on parameters and fill the color variables accordingly\n   * @param theme\n   * @param primary\n   * @param text\n   * @param useOnInputs\n   * @param invertInputText\n   * @param useIngame\n   */\n  public async setColorScheme(theme: typoTheme, primary: Color, text: Color, useOnInputs: boolean, invertInputText: boolean, useIngame: boolean){\n    this._logger.debug(\"Setting color scheme\", theme, primary, text, useOnInputs, invertInputText, useIngame);\n    const colors = generateColorScheme(primary, text, useIngame, useOnInputs, invertInputText);\n    theme.colors = colors;\n\n    await this._toastService.showToast(\"Color scheme updated\");\n  }\n}","import { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport type { Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\nexport class CustomizerOutfitToggleFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(GlobalSettingsService) private readonly _globalSettingsService!: GlobalSettingsService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n\n  public readonly name = \"Outfit Toggle\";\n  public readonly description = \"Add a toggle to the customizer to show or hide your typo outfit\";\n  public readonly featureId = 45;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n  private _memberSubscription?: Subscription;\n\n  protected override async onActivate() {\n    this._memberSubscription = this._memberService.member$.subscribe(async (member) => {\n      await this.setIconEnabled(member !== undefined && member !== null);\n    });\n  }\n\n  protected override async onDestroy() {\n    await this.setIconEnabled(false);\n    this._memberSubscription?.unsubscribe();\n    this._memberSubscription = undefined;\n  }\n\n  private async setIconEnabled(enabled: boolean) {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._iconComponent = undefined;\n    this._iconClickSubscription = undefined;\n\n    if(enabled) {\n\n      const elements = await this._elementsSetup.complete();\n\n      /* create icon and attach */\n      this._iconComponent = new IconButton({\n        target: elements.customizerActions,\n        props: {\n          hoverMove: false,\n          greyscaleInactive: true,\n          size: \"30px\",\n          icon: \"file-img-mask-gif\",\n          name: \"Toggle Outfit View\",\n          order: 2,\n          tooltipAction: this.createTooltip,\n          lockTooltip: \"Y\"\n        },\n      });\n\n      /* listen for click on icon */\n      this._iconClickSubscription = this._iconComponent.click$.subscribe(async () => {\n        const outfitEnabled = await this._globalSettingsService.settings.showLandingOutfit.getValue();\n        await this._globalSettingsService.settings.showLandingOutfit.setValue(!outfitEnabled);\n      });\n    }\n  }\n}","import { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport type { Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\nexport class CustomizerPracticeJoinFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly name = \"Practice Lobby\";\n  public readonly description = \"Add an option to draw on your own without time limit\";\n  public readonly featureId = 44;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n\n  protected override async onActivate() {\n\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach */\n    this._iconComponent = new IconButton({\n      target: elements.customizerActions,\n      props: {\n        hoverMove: false,\n        greyscaleInactive: true,\n        size: \"30px\",\n        icon: \"file-img-palette-gif\",\n        name: \"Enter\\nPractice Lobby\",\n        order: 1,\n        tooltipAction: this.createTooltip,\n        lockTooltip: \"Y\"\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n      document.dispatchEvent(new CustomEvent(\"joinPractice\"));\n    });\n  }\n\n  protected override async onDestroy() {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._iconComponent = undefined;\n    this._iconClickSubscription = undefined;\n  }\n}","import type { brushStyle } from \"@/content/services/tools/tools.service\";\nimport { injectable } from \"inversify\";\n\nexport interface lineCoordinates {\n  from: [number, number];\n  to: [number, number];\n\n}\n\nexport interface drawModLine extends lineCoordinates {\n  styleOverride?: brushStyle;\n}\n\nexport interface drawModEffect {\n  lines: drawModLine[],\n  style: brushStyle\n}\n\n@injectable()\nexport abstract class TypoDrawMod {\n\n  /**\n   * Indicator if this mod requires the skribbl sampling throttle to be disabled\n   * Needs to be set true if the mod produces many draw commands in a short time\n   */\n  public readonly disableSkribblSamplingRate = false;\n\n  /**\n   * Process a draw input line with style;\n   * output the same, modified or new lines along with processed style\n   * @param line\n   * @param pressure\n   * @param brushStyle\n   * @param eventId id of the event. if a mod previously created multiple lines for a single event, they have the same id\n   * @param strokeId id of the stroke. each event during a pointer-down to pointer-up cycle shares the same stroke id\n   */\n  public abstract applyEffect(\n    line: lineCoordinates,\n    pressure: number | undefined,\n    brushStyle: brushStyle,\n    eventId: number,\n    strokeId: number\n  ): drawModEffect | Promise<drawModEffect>;\n\n  protected noEffect(line: drawModLine, pressure: number | undefined, brushStyle: brushStyle): drawModEffect {\n    return {lines: [line], style: brushStyle};\n  }\n}","import { CommandsService } from \"@/content/core/commands/commands.service\";\nimport { FeaturesService } from \"@/content/core/feature/features.service\";\nimport { HotkeysService } from \"@/content/core/hotkeys/hotkeys.service\";\nimport { Interceptor } from \"@/content/core/interceptor/interceptor\";\nimport { LoggingService } from \"@/content/core/logger/logging.service\";\nimport { TokenService } from \"@/content/core/token/token.service\";\nimport { TooltipsService } from \"@/content/core/tooltips/tooltips.service\";\nimport { Container } from \"inversify\";\nimport { LoggerService } from \"../logger/logger.service\";\nimport { EventsService } from \"../event/events.service\";\nimport { isEarlySetup } from \"../setup/earlySetup.decorator\";\nimport { EventProcessor} from \"../event/eventProcessor\";\nimport { EventListener } from \"../event/eventListener\";\nimport { ApplicationEvent } from \"../event/applicationEvent\";\nimport { loggerFactory } from \"../logger/loggerFactory.interface\";\nimport type { Type } from \"@/util/types/type\";\nimport { TypoFeature } from \"../feature/feature\";\nimport { Setup } from \"../setup/setup\";\n\n/**\n * Data interface for the event registration\n */\nexport interface EventRegistration<TData, TEvent extends ApplicationEvent<TData>> {\n   processorType: Type<EventProcessor<TData, TEvent>>;\n   listenerType: Type<EventListener<TData, TEvent>>;\n}\n\nexport class ExtensionContainer {\n\n   /**\n    * Root dependency injection container.\n    * @private\n    */\n   private readonly _diContainer = new Container();\n\n   private readonly _logging;\n   private readonly _logger;\n   private readonly _events;\n   private readonly _features;\n\n   public constructor(private readonly _interceptor: Interceptor) {\n      this.bindCoreServices();\n\n      this._logging = this._diContainer.get(LoggingService);\n      this._logger = this._diContainer.get<loggerFactory>(loggerFactory)(this);\n      this._events = this._diContainer.get(EventsService);\n      this._features = this._diContainer.get(FeaturesService);\n\n      this._logger.debug(\"Extension container initialized\");\n   }\n\n   /**\n    * Binds core services to the dependency injection container.\n    * @private\n    */\n   private bindCoreServices() {\n      this._diContainer.bind(Interceptor).toConstantValue(this._interceptor);\n      this._diContainer.bind(ExtensionContainer).toConstantValue(this);\n      this._diContainer.bind(LoggingService).toSelf().inSingletonScope();\n      const logging = this._diContainer.get(LoggingService);\n\n      this._diContainer.bind(LoggerService).toSelf();\n      this._diContainer.bind<loggerFactory>(loggerFactory).toFactory<LoggerService, [object]>((context) => {\n          return (loggerContext: object) => {\n             const logger = context.container.get(LoggerService).bindTo(loggerContext);\n             logging.trackLoggerInstance(logger);\n             return logger;\n          };\n      });\n\n      this._diContainer.bind(CommandsService).toSelf().inSingletonScope();\n      this._diContainer.bind(HotkeysService).toSelf().inSingletonScope();\n      this._diContainer.bind(TooltipsService).toSelf().inSingletonScope();\n      this._diContainer.bind(EventsService).toSelf().inSingletonScope();\n      this._diContainer.bind(TokenService).toSelf().inSingletonScope();\n      this._diContainer.bind(FeaturesService).toSelf().inSingletonScope();\n   }\n\n   public registerEventProcessors(...events: EventRegistration<unknown, ApplicationEvent<unknown>>[]) {\n      events.forEach((event) => {\n\n         /* add processor to container as singleton */\n         this._diContainer.bind(event.processorType).toSelf().inSingletonScope();\n\n         /* bind respective event listener */\n         this._diContainer.bind(event.listenerType).toSelf().inRequestScope();\n      });\n      return this;\n   }\n\n   public registerFeatures(...features: Type<TypoFeature>[]){\n      features.forEach((feature) => {\n\n         /* add feature to container */\n         this._diContainer.bind(feature).toSelf().inSingletonScope();\n         const featureInstance = this._diContainer.get(feature);\n         this._features.registerFeature(featureInstance);\n      });\n      return this;\n   }\n\n   public registerSetups(...setups: Type<Setup<unknown>>[]){\n      setups.forEach((setup) => {\n         this._diContainer.bind(setup).toSelf().inSingletonScope();\n\n         /* if setup is marked as early, run immediately */\n         if(isEarlySetup(setup)) {\n            this._diContainer.get(setup).complete();\n         }\n      });\n      return this;\n   }\n\n   public registerServices(...services: { type: Type<unknown>, scope: \"singleton\" | \"scoped\" }[]) {\n      services.forEach((service) => {\n         if(service.scope === \"singleton\") {\n            this._diContainer.bind(service.type).toSelf().inSingletonScope();\n         }\n         else {\n            this._diContainer.bind(service.type).toSelf();\n         }\n      });\n      return this;\n   }\n\n   /**\n    * Resolve a service that has not been registered with the container.\n    * @param service\n    */\n   public resolveService<TService>(service: Type<TService>): TService {\n      return this._diContainer.resolve(service);\n   }\n}","import {\n  type drawModEffect,\n  type lineCoordinates,\n  TypoDrawMod,\n} from \"@/content/services/tools/draw-mod\";\nimport type { brushStyle } from \"@/content/services/tools/tools.service\";\n\nexport interface constantDrawModEffect {\n  line: lineCoordinates,\n  style: brushStyle\n}\n\n/**\n * a mod that does not produce additional lines; only modified style and given line\n */\nexport abstract class ConstantDrawMod extends TypoDrawMod {\n\n  /**\n   * @param line\n   * @param pressure\n   * @param brushStyle\n   * @param eventId\n   * @param strokeId\n   */\n  public async applyEffect(\n    line: lineCoordinates,\n    pressure: number | undefined,\n    brushStyle: brushStyle,\n    eventId: number,\n    strokeId: number\n  ): Promise<drawModEffect>{\n    const effect = this.applyConstantEffect(line, pressure, brushStyle, eventId, strokeId);\n    const awaited = effect instanceof Promise ? await effect : effect;\n    return {\n      lines: [awaited.line],\n      style: awaited.style\n    };\n  }\n\n  /**\n   * Apply an effect to a line, returning the modified line and style\n   * @param line\n   * @param pressure\n   * @param brushStyle\n   * @param eventId\n   * @param strokeId\n   * @protected\n   */\n  protected abstract applyConstantEffect(\n    line: lineCoordinates,\n    pressure: number | undefined,\n    brushStyle: brushStyle,\n    eventId: number,\n    strokeId: number\n  ): constantDrawModEffect | Promise<constantDrawModEffect>;\n\n  protected noConstantEffect(\n    line: lineCoordinates,\n    pressure: number | undefined,\n    brushStyle: brushStyle\n  ): constantDrawModEffect | Promise<constantDrawModEffect> {\n    return {line, style: brushStyle};\n  }\n}","import type { drawCoordinateEvent } from \"@/content/services/tools/tools.service\";\nimport { Subject } from \"rxjs\";\n\ninterface stroke {\n  lastSampleDate: number;\n  pointerDownId: number;\n  canvasRect: DOMRect;\n  lastCoordinates: drawCoordinateEvent;\n}\n\ninterface strokeCoordinates {\n  from: drawCoordinateEvent,\n  to: drawCoordinateEvent,\n  stroke: number;\n}\n\nexport class CoordinateListener {\n  private _enabled = false;\n  private _sampleRate = 1000 / 60;\n  private _currentStroke?: stroke = undefined;\n\n  private _strokes$ = new Subject<strokeCoordinates>();\n  private _pointerDown$ = new Subject<PointerEvent>();\n  private _pointerUp$ = new Subject<PointerEvent>();\n\n  constructor(private readonly _canvas: HTMLCanvasElement) {}\n\n  public set enabled(enabled: boolean) {\n    this._enabled = enabled;\n  }\n\n  public set fps(fps: number) {\n    this._sampleRate = 1000 / fps;\n  }\n\n  public get strokes$() {\n    return this._strokes$.asObservable();\n  }\n\n  public get pointerDown$() {\n    return this._pointerDown$.asObservable();\n  }\n\n  public get pointerUp$() {\n    return this._pointerUp$.asObservable();\n  }\n\n  public onCanvasPointerDown(event: PointerEvent) {\n    if (!this._enabled) return;\n\n    event.stopImmediatePropagation();\n\n    this._canvas.setPointerCapture(event.pointerId);\n    const rect = this._canvas.getBoundingClientRect();\n\n\n    const coords = this.mapPointerEventToDrawCoordinate(\n      event,\n      this._canvas,\n      rect,\n    );\n\n    this._currentStroke = {\n      canvasRect: rect,\n      lastSampleDate: Date.now(),\n      pointerDownId: event.pointerId,\n      lastCoordinates: coords,\n    };\n\n    this._strokes$.next({from: coords, to: coords, stroke: this._currentStroke.pointerDownId});\n    this._pointerDown$.next(event);\n\n    /*document.body.dataset[\"bypassCommandRate\"] = \"true\";*/\n  }\n\n  public onCanvasPointerMove(event: PointerEvent) {\n    const now = Date.now();\n    if (this._currentStroke === undefined || now - this._currentStroke.lastSampleDate < this._sampleRate) {\n      return;\n    }\n\n    event.stopImmediatePropagation();\n\n    this._currentStroke.lastSampleDate = now;\n    const coords = this.mapPointerEventToDrawCoordinate(\n      event,\n      this._canvas,\n      this._currentStroke.canvasRect,\n    );\n\n    this._strokes$.next({from: this._currentStroke.lastCoordinates, to: coords, stroke: this._currentStroke.pointerDownId});\n    this._currentStroke.lastCoordinates = coords;\n  }\n\n  public onDocumentPointerUp(event: PointerEvent) {\n    if (this._currentStroke === undefined) return;\n\n    const coords = this.mapPointerEventToDrawCoordinate(\n      event,\n      this._canvas,\n      this._currentStroke.canvasRect,\n    );\n    this._strokes$.next({from: this._currentStroke.lastCoordinates, to: coords, stroke: this._currentStroke.pointerDownId});\n    this._pointerUp$.next(event);\n    this._currentStroke = undefined;\n\n    /*document.body.dataset[\"bypassCommandRate\"] = \"true\";*/\n  }\n\n  private mapPointerEventToDrawCoordinate(\n    event: PointerEvent,\n    canvas: HTMLCanvasElement,\n    canvasRect: DOMRect,\n  ): drawCoordinateEvent {\n    const canvasX = (event.offsetX * canvas.width) / canvasRect.width;\n    const canvasY = (event.offsetY * canvas.height) / canvasRect.height;\n    return [canvasX, canvasY, event.pointerType === \"pen\" ? event.pressure : undefined];\n  }\n}","import { ConstantDrawMod } from \"@/content/services/tools/constant-draw-mod\";\nimport { type lineCoordinates } from \"@/content/services/tools/draw-mod\";\nimport type { brushStyle } from \"@/content/services/tools/tools.service\";\nimport { Color } from \"@/util/color\";\n\nexport abstract class TypoDrawTool extends ConstantDrawMod {\n\n  private cursorCanvas = document.createElement(\"canvas\");\n\n  public abstract createCursor(brushStyle: brushStyle): { source: string, x: number, y: number };\n\n  /**\n   * Create draw commands from a draw event\n   * IMPORTANT that the line numbers are whole numbers\n   * @param line\n   * @param pressure\n   * @param brushStyle\n   * @param eventId\n   * @param strokeId\n   */\n  public abstract createCommands(line: lineCoordinates, pressure: number | undefined, brushStyle: brushStyle, eventId: number, strokeId: number): number[][] | Promise<number[][]>;\n\n  protected noCommands(): number[][] {\n    return [];\n  }\n\n  /**\n   * Create a cursor based on the current brush style that looks like the skribbl cursor\n   * @param brushStyle\n   * @protected\n   */\n  protected createSkribblLikeCursor(brushStyle: brushStyle){\n    const color = Color.fromSkribblCode(brushStyle.color).rgbArray;\n\n    // Set the alpha component\n    color[3] = 0.8;\n\n    // Set the fill style using the adjusted color\n    const canvasSize = brushStyle.size + 2;\n    const cursorSize = brushStyle.size;\n    const canvas = this.cursorCanvas;\n    canvas.width = canvasSize;\n    canvas.height = canvasSize;\n    const context = canvas.getContext(\"2d\");\n    if(!context) throw new Error(\"Could not get 2d context\");\n\n    context.clearRect(0, 0, canvas.width, canvas.height); // Clear any previous drawing\n    context.fillStyle = `rgba(${color[0]}, ${color[1]}, ${color[2]}, ${color[3]})`;\n\n    // Begin drawing the filled circle (cursor background)\n    context.beginPath();\n    context.arc(canvasSize / 2, canvasSize / 2, cursorSize / 2 - 1, 0, 2 * Math.PI);  // Center at (canvasSize/2, canvasSize/2), radius (cursorSize/2 - 1)\n    context.fill();\n\n    // Draw the outer white stroke (for visibility)\n    context.strokeStyle = \"#FFF\";\n    context.beginPath();\n    context.arc(canvasSize / 2, canvasSize / 2, cursorSize / 2 - 1, 0, 2 * Math.PI);\n    context.stroke();\n\n    // Draw an inner black stroke (for contrast)\n    context.strokeStyle = \"#000\";\n    context.beginPath();\n    context.arc(canvasSize / 2, canvasSize / 2, cursorSize / 2, 0, 2 * Math.PI);\n    context.stroke();\n\n    // Create the cursor style using the canvas data\n    const cursorCenter = canvasSize / 2;\n    return {\n      source: `url(${canvas.toDataURL()})`,\n      x: cursorCenter,\n      y: cursorCenter\n    };\n  }\n}","import { ExtensionContainer } from \"@/content/core/extension-container/extension-container\";\nimport type { LoggerService } from \"@/content/core/logger/logger.service\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { ColorChangedEventListener } from \"@/content/events/color-changed.event\";\nimport { SizeChangedEventListener } from \"@/content/events/size-changed.event\";\nimport { skribblTool, ToolChangedEventListener } from \"@/content/events/tool-changed.event\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { ConstantDrawMod } from \"@/content/services/tools/constant-draw-mod\";\nimport { CoordinateListener } from \"@/content/services/tools/coordinateListener\";\nimport { TypoDrawMod, type drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport {\n  PrioritizedCanvasEventsSetup\n} from \"@/content/setups/prioritized-canvas-events/prioritized-canvas-events.setup\";\nimport { Color } from \"@/util/color\";\nimport type { Type } from \"@/util/types/type\";\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport {\n  BehaviorSubject, combineLatestWith, filter,\n  map, mergeWith, switchMap,\n  withLatestFrom,\n} from \"rxjs\";\n\nexport type drawCoordinateEvent = [number, number, number?];\nexport interface brushStyle {\n\n  /**\n   * the original skribbl color code, or typo encoded hex\n   */\n  color: number;\n  size: number;\n}\n\n@injectable()\nexport class ToolsService {\n\n  @inject(PrioritizedCanvasEventsSetup) private readonly _prioritizedCanvasEventsSetup!: PrioritizedCanvasEventsSetup;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ToolChangedEventListener) private readonly _toolChangedListener!: ToolChangedEventListener;\n  @inject(ExtensionContainer) private readonly _extensionContainer!: ExtensionContainer;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(SizeChangedEventListener) private readonly _sizeChangedListener!: SizeChangedEventListener;\n  @inject(ColorChangedEventListener) private readonly _colorChangedListener!: ColorChangedEventListener;\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  private readonly _logger: LoggerService;\n  private readonly _activeTool$ = new BehaviorSubject<TypoDrawTool | skribblTool>(skribblTool.brush);\n  private readonly _activeMods$ = new BehaviorSubject<TypoDrawMod[]>([]);\n  private readonly _activeBrushStyle$ = new BehaviorSubject<brushStyle>({ color: Color.fromHex(\"#000000\").skribblCode, size: 1 });\n  private readonly _lastPointerDownPosition$ = new BehaviorSubject<PointerEvent | null>(null);\n  private readonly _canvasCursorStyle = document.createElement(\"style\");\n\n  constructor(@inject(loggerFactory) loggerFactory: loggerFactory) {\n    this._logger = loggerFactory(this);\n  }\n\n  @postConstruct()\n  private postConstruct() {\n    this._logger.debug(\"Post construct\");\n    this.initListeners();\n  }\n\n  private async initListeners(){\n    const elements = await this._elementsSetup.complete();\n    const listeners = await this._prioritizedCanvasEventsSetup.complete();\n\n    /* change tool when skribbl tool changed */\n    this._toolChangedListener.events$.subscribe(event => {\n      if(event.data !== skribblTool.deselected && event.data !== this._activeTool$.value){\n        this._logger.debug(\"Tool changed event\", event.data);\n        this._activeTool$.next(event.data);\n      }\n    });\n\n    /* change cursor when skribbltool active */\n    this._activeTool$.pipe(\n      combineLatestWith(this._activeBrushStyle$)\n    ).subscribe(async ([tool, style]) => {\n      if(tool instanceof TypoDrawTool) {\n        if(!this._canvasCursorStyle.parentNode) document.body.appendChild(this._canvasCursorStyle);\n        const cursor = tool.createCursor(style);\n        this._canvasCursorStyle.innerText = `#game-canvas canvas { cursor: ${cursor.source} ${cursor.x} ${cursor.y}, auto !important; }`;\n      }\n      else {\n        this._canvasCursorStyle.remove();\n      }\n    });\n\n    /* set up brush style subscription */\n    this._sizeChangedListener.events$.pipe(\n      combineLatestWith(this._colorChangedListener.events$),\n      map(([size, color]) => ({ size: size.data, color: color.data.skribblCode }))\n    ).subscribe(style => this._activeBrushStyle$.next(style));\n\n    /* set up events for custom stroke listener */\n    const coordinateListener = new CoordinateListener(elements.canvas);\n    listeners.add(\"draw\")(\"pointerdown\", coordinateListener.onCanvasPointerDown.bind(coordinateListener));\n    listeners.add(\"draw\")(\"pointermove\", coordinateListener.onCanvasPointerMove.bind(coordinateListener));\n    document.addEventListener(\"pointerup\", coordinateListener.onDocumentPointerUp.bind(coordinateListener));\n\n    /* current tools and draw style */\n    const drawingMeta$ = this._activeTool$.pipe(\n      combineLatestWith(this._activeMods$, this._activeBrushStyle$),\n      map(([tool, mods, style]) => {\n        const typoMods = tool instanceof TypoDrawTool ? [tool, ...mods] : mods;\n        const typoTool = tool instanceof TypoDrawTool ? tool : undefined;\n        return [style, typoTool, typoMods] as const;\n      })\n    );\n\n    /* disable cursor updates while drawing with mods */\n    this._activeMods$.pipe(\n      combineLatestWith(this._activeTool$),\n      filter(([mods, tool]) => tool instanceof TypoDrawTool || mods.length > 0),\n      switchMap(() => coordinateListener.pointerDown$.pipe(\n        map(() => true),\n        mergeWith(coordinateListener.pointerUp$.pipe(map(() => false)))\n      ))\n    ).subscribe((isDrawing) => {\n      this._drawingService.disableCursorUpdates(isDrawing);\n    });\n\n    /* listen for strokes and create typo tool commands */\n    coordinateListener.strokes$.pipe(\n      withLatestFrom(drawingMeta$)\n    ).subscribe(([stroke, [style, tool, mods]]) => {\n      this.processDrawCoordinates(stroke.from, stroke.to, tool, mods, style, stroke.stroke);\n    });\n\n    /* update last pointer down */\n    coordinateListener.pointerDown$.subscribe((position) => this._lastPointerDownPosition$.next(position));\n\n    /* set listening state of coordinate listener */\n    this._lobbyService.lobby$.pipe(\n      map(lobby => lobby?.meId === lobby?.drawerId),\n      combineLatestWith(this._activeTool$, this._activeMods$),\n      map(([isDrawer, tool, mods]) => isDrawer && (tool instanceof TypoDrawTool || tool === skribblTool.brush && mods.length > 0)),\n    ).subscribe((enabled) => {\n      coordinateListener.enabled = enabled;\n    });\n  }\n\n  private async processDrawCoordinates(start: drawCoordinateEvent, end: drawCoordinateEvent, tool: TypoDrawTool | undefined, mods: TypoDrawMod[], style: brushStyle, strokeId: number) {\n    this._logger.debug(\"Activating tool and applying mods\", start, end);\n\n    /* generate a shared id for every line created from the origin line */\n    const eventId = Date.now();\n    let lines: drawModLine[] = [{from: [start[0], start[1]], to: [end[0], end[1]]}];\n\n    /* copy to avoid reference issues */\n    let modStyle = structuredClone(style);\n    const pressure = end[2];\n\n    /* apply mods and wait for result */\n    for (const mod of mods) {\n\n      /* for each line - mods may append or skip lines */\n      const modLines: drawModLine[] = [];\n      for(const line of lines) {\n        const effect = await mod.applyEffect(line, pressure, line.styleOverride ?? modStyle, eventId, strokeId);\n        modLines.push(...effect.lines);\n        modStyle = effect.style;\n        this._logger.debug(\"Mod applied\", mod);\n      }\n      lines = modLines;\n    }\n\n    /* update brush size in skribbl if changed by mods */\n    /* disabled for now because of efficiency reasons - size only affects current event */\n    /*if(modStyle.size !== style.size) {\n      this._logger.debug(\"Brush size changed by mods\", modStyle.size);\n      this._drawingService.setSize(modStyle.size);\n    }*/\n\n    /* update brush color if changed by mods */\n    if(modStyle.color !== style.color) {\n      this._logger.debug(\"Brush color changed by mods\", modStyle.color);\n      this._drawingService.setColor(modStyle.color);\n    }\n\n    /* create draw commands from tool based on processed lines and style */\n    const commands: number[][] = [];\n    if(tool !== undefined) {\n      for(let line of lines) {\n\n        /* make sure line is safe - decimal places should not be submitted to skribbl */\n        line = {from: [Math.floor(line.from[0]), Math.floor(line.from[1])], to: [Math.floor(line.to[0]), Math.floor(line.to[1])]};\n\n        const lineCommands = await tool.createCommands(line, pressure, line.styleOverride ?? modStyle, eventId, strokeId);\n        if(lineCommands.length > 0) {\n          commands.push(...lineCommands);\n          this._logger.debug(\"Adding commands created by tool\", tool, commands);\n        }\n        else {\n          this._logger.debug(\"No draw commands created from tool\", tool);\n        }\n      }\n    }\n\n    /* create default draw commands as lines */\n    else {\n      for(const line of lines) {\n        const lineCommand = this._drawingService.createLineCommand(\n          [...line.from, ...line.to],\n          line.styleOverride?.color ?? modStyle.color,\n          line.styleOverride?.size ?? modStyle.size,\n          false\n        );\n        if(lineCommand !== undefined) commands.push(lineCommand);\n      }\n    }\n\n    /* paste commands */\n    this._logger.info(\"Pasting draw commands\", commands);\n    await this._drawingService.pasteDrawCommands(commands, false);\n  }\n\n\n  /**\n   * Set the selected skribbl tool id in the game patch\n   * @param tool\n   * @private\n   */\n  private setSkribblTool(tool: skribblTool) {\n    this._logger.debug(\"Setting skribbl tool\", tool);\n    document.dispatchEvent(new CustomEvent(\"selectSkribblTool\", { detail: tool }));\n  }\n\n  public activateTool(tool: TypoDrawTool | skribblTool) {\n    this._logger.debug(\"Activating tool\", tool);\n\n    if(tool === this._activeTool$.value) {\n      this._logger.debug(\"Tool already active\", tool);\n      return;\n    }\n\n    /* if typo tool, disable skribbl tool in game patch */\n    if (tool instanceof TypoDrawTool) {\n      this.setSkribblTool(skribblTool.deselected);\n    }\n\n    /* else select native skribbl tool */\n    else {\n      this.setSkribblTool(tool);\n    }\n\n    /* broadcast active tool */\n    this._activeTool$.next(tool);\n\n    /* dry-run tool to trigger early settings load */\n    if(tool instanceof TypoDrawMod) tool.applyEffect({from: [0,0], to: [0,0]}, undefined, {color: Color.fromHex(\"#000000\").skribblCode, size: 1}, 0, 0);\n    if(tool instanceof TypoDrawTool) tool.createCommands({from: [0,0], to: [0,0]}, undefined, {color: Color.fromHex(\"#000000\").skribblCode, size: 1}, 0, 0);\n  }\n\n  public activateMod(mod: TypoDrawMod) {\n    this._logger.debug(\"Activating mod\", mod);\n\n    /* if mod is not constant, deactivate all other non-constant mods */\n    let mods = this._activeMods$.value;\n    if(!(mod instanceof ConstantDrawMod)) {\n      mods = mods.filter(m => m instanceof ConstantDrawMod);\n    }\n\n    this._activeMods$.next([...mods, mod]);\n  }\n\n  public removeMod(mod: TypoDrawMod) {\n    this._logger.debug(\"Removing mod\", mod);\n    this._activeMods$.next(this._activeMods$.value.filter(m => m !== mod));\n  }\n\n  public get activeTool$() {\n    return this._activeTool$.asObservable();\n  }\n\n  public get activeMods$() {\n    return this._activeMods$.asObservable();\n  }\n\n  public get activeBrushStyle$() {\n    return this._activeBrushStyle$.asObservable();\n  }\n\n  public get lastPointerDownPosition$() {\n    return this._lastPointerDownPosition$.asObservable();\n  }\n\n  public resolveModOrTool<TMod>(tool: Type<TMod>){\n    return this._extensionContainer.resolveService(tool);\n  }\n}\n","import {\n  ChoiceExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { type drawModEffect, type drawModLine, TypoDrawMod } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle, ToolsService } from \"@/content/services/tools/tools.service\";\nimport { inject } from \"inversify\";\nimport { firstValueFrom } from \"rxjs\";\nexport class MandalaMod extends TypoDrawMod implements BrushLabItem {\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n\n  readonly description = \"Draws an additional mirrored line to create a mandala effect.\";\n  readonly icon = \"var(--file-img-line-mandala-gif)\";\n  readonly name = \"Mandala\";\n\n  private _mirrorCenterSetting = new ChoiceExtensionSetting<\"click\" | \"center\">(\"brushlab.mandala.center\", \"center\")\n    .withName(\"Mandala Mirror Center\")\n    .withDescription(\"The center of the mandala mirroring effect\")\n    .withChoices([{choice: \"click\", name: \"At last click\"}, {choice: \"center\", name: \"At canvas center\"}]);\n\n  private _axisSetting = new ChoiceExtensionSetting<\"x\" | \"y\" | \"xy\">(\"brushlab.mandala.axis\", \"xy\")\n    .withName(\"Mandala Mirror Axis\")\n    .withDescription(\"The axis where the mandala line will be mirrored on\")\n    .withChoices([{choice: \"x\", name: \"Horizontal\"}, {choice: \"y\", name: \"Vertical\"}, {choice: \"xy\", name: \"Both\"}]);\n\n  readonly settings = [\n    this._mirrorCenterSetting,\n    this._axisSetting\n  ] as SettingWithInput<serializable>[];\n\n  /**\n   * Set the brush size depending on the pressure\n   * @param line\n   * @param pressure\n   * @param style\n   */\n  public async applyEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle\n  ): Promise<drawModEffect> {\n\n    const axis = await firstValueFrom(this._axisSetting.changes$);\n    const mirrorCenter = await firstValueFrom(this._mirrorCenterSetting.changes$);\n\n    /* create mirrored line */\n    let center: [number, number] = [400,300];\n    if(mirrorCenter === \"click\"){\n      const event = await firstValueFrom(this._toolsService.lastPointerDownPosition$);\n      if(!event) center = line.from;\n      else center = [event.offsetX, event.offsetY];\n    }\n\n    /* mirror line on axis to center */\n    const mirrored = this.calculateMirroredLine(axis, center, line.from, line.to);\n    return {\n      style,\n      lines: [line, mirrored]\n    };\n  }\n\n  calculateMirroredLine(axis: \"x\" | \"y\" | \"xy\", center: [number, number], from: number[], to: number[]): {from: [number, number], to: [number, number]}{\n    if(axis === \"y\"){\n      return {\n        from: [center[0] - (from[0] - center[0]), from[1]],\n        to: [center[0] - (to[0] - center[0]), to[1]]\n      };\n    }\n    else if(axis === \"x\"){\n      return {\n        from: [from[0], center[1] - (from[1] - center[1])],\n        to: [to[0], center[1] - (to[1] - center[1])]\n      };\n    }\n    else {\n      return {\n        from: [center[0] - (from[0] - center[0]), center[1] - (from[1] - center[1])],\n        to: [center[0] - (to[0] - center[0]), center[1] - (to[1] - center[1])]\n      };\n    }\n  }\n}","import {\n  NumericExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { ConstantDrawMod, type constantDrawModEffect } from \"@/content/services/tools/constant-draw-mod\";\nimport { type drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle } from \"@/content/services/tools/tools.service\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class NoiseMod extends ConstantDrawMod implements BrushLabItem {\n\n  readonly description = \"Randomly adds noise to drawn lines.\";\n  readonly icon = \"var(--file-img-line-noise-gif)\";\n  readonly name = \"Noise\";\n\n  private _scaleSetting = new NumericExtensionSetting(\"brushlab.noise.scale\", 5)\n    .withName(\"Noise Scale\")\n    .withDescription(\"Select how much noise is added to the line\")\n    .withSlider(1)\n    .withBounds(1, 100);\n\n  readonly settings = [\n    this._scaleSetting\n  ] as SettingWithInput<serializable>[];\n\n  public async applyConstantEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle\n  ): Promise<constantDrawModEffect> {\n\n    const scale = await firstValueFrom(this._scaleSetting.changes$);\n\n    /* rotate and scale the line randomly around center */\n    const randomRotate = (Math.random() - 0.5) * Math.PI;\n    const randomScale = 1 + (Math.random() - 0.5) * scale * style.size / 40;\n\n    const centerX = (line.from[0] + line.to[0]) / 2;\n    const centerY = (line.from[1] + line.to[1]) / 2;\n\n    const rotatePoint = (x: number, y: number, angle: number): [number, number] => {\n      const cos = Math.cos(angle);\n      const sin = Math.sin(angle);\n      return [\n        cos * (x - centerX) - sin * (y - centerY) + centerX,\n        sin * (x - centerX) + cos * (y - centerY) + centerY,\n      ];\n    };\n\n    const from = rotatePoint(line.from[0], line.from[1], randomRotate);\n    const to = rotatePoint(line.to[0], line.to[1], randomRotate);\n\n    from[0] = centerX + (from[0] - centerX) * randomScale;\n    from[1] = centerY + (from[1] - centerY) * randomScale;\n    to[0] = centerX + (to[0] - centerX) * randomScale;\n    to[1] = centerY + (to[1] - centerY) * randomScale;\n\n    return {\n      style,\n      line: {from, to}\n    };\n  }\n}","import {\n  BooleanExtensionSetting,\n  NumericExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { type drawModEffect, type drawModLine, TypoDrawMod } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle } from \"@/content/services/tools/tools.service\";\nimport { firstValueFrom } from \"rxjs\";\nexport class ParallelLineMod extends TypoDrawMod implements BrushLabItem {\n\n  readonly description = \"Draws additional parallel lines in a angle and distance. In public lobbies, a max of 1 parallel line should be used.\";\n  readonly icon = \"var(--file-img-line-parallel-gif)\";\n  readonly name = \"Parallel\";\n\n  private _distanceSetting = new NumericExtensionSetting(\"brushlab.parallel.distance\", 20)\n    .withName(\"Line Distance\")\n    .withDescription(\"The distance between the lines\")\n    .withSlider(1)\n    .withBounds(1,100);\n\n  private _distanceDependencySetting = new BooleanExtensionSetting(\"brushlab.parallel.dependency\", false)\n    .withName(\"Size Dependency\")\n    .withDescription(\"Make line distance proportionally dependent on brush size\");\n\n  private _angleSetting = new NumericExtensionSetting(\"brushlab.parallel.angle\", 180)\n    .withName(\"Line Angle\")\n    .withDescription(\"The clockwise angle where the parallel lines are drawn with the distance offset\")\n    .withSlider(1)\n    .withBounds(1, 360);\n\n  private _lineCountSetting = new NumericExtensionSetting(\"brushlab.parallel.count\", 1)\n    .withName(\"Line Count\")\n    .withDescription(\"The amount of parallel lines drawn\")\n    .withSlider(1)\n    .withBounds(1,4);\n\n  readonly settings = [\n    this._distanceSetting,\n    this._distanceDependencySetting,\n    this._angleSetting,\n    this._lineCountSetting\n  ] as SettingWithInput<serializable>[];\n\n  /**\n   * Set the brush size depending on the pressure\n   * @param line\n   * @param pressure\n   * @param style\n   */\n  public async applyEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle\n  ): Promise<drawModEffect> {\n\n    const distance = await firstValueFrom(this._distanceSetting.changes$);\n    const angle = await firstValueFrom(this._angleSetting.changes$);\n    const count = await firstValueFrom(this._lineCountSetting.changes$);\n    const dependency = await firstValueFrom(this._distanceDependencySetting.changes$);\n\n    /* create n parallel lines with offset and angle to original line*/\n    const lines = [];\n    const offset = this.getOffset(distance, angle);\n    if(dependency) {\n      offset[0] *= style.size / 40;\n      offset[1] *= style.size / 40;\n    }\n\n    for (let i = 0; i < count; i++) {\n      const offsetLine = {\n        from: [line.from[0] + (offset[0] * (i+1)), line.from[1] + (offset[1] *( i+1))] as [number, number],\n        to: [line.to[0] + (offset[0] * (i+1)), line.to[1] + (offset[1] * (i+1))] as [number, number]\n      };\n      lines.push(offsetLine);\n    }\n\n    return  {\n      style,\n      lines: [line, ...lines]\n    };\n  }\n\n  private getOffset(distance: number, angle: number): [number, number] {\n    const angleRad = angle * Math.PI / 180;\n    const x = Math.cos(angleRad) * distance;\n    const y = Math.sin(angleRad) * distance;\n    return [x, y];\n  }\n}","import {\n  ChoiceExtensionSetting, NumericExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { ConstantDrawMod, type constantDrawModEffect } from \"@/content/services/tools/constant-draw-mod\";\nimport { type drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle } from \"@/content/services/tools/tools.service\";\nimport { Color } from \"@/util/color\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class RainbowMod extends ConstantDrawMod implements BrushLabItem {\n\n  readonly description = \"Switches colors while drawing to create a rainbow effect.\";\n  readonly icon = \"var(--file-img-line-rainbow-gif)\";\n  readonly name = \"Rainbow\";\n\n  private _rainbowModeSetting = new ChoiceExtensionSetting<\"dark\" | \"light\">(\"brushlab.rainbow.mode\", \"light\")\n    .withName(\"Rainbow Colors\")\n    .withDescription(\"Choose between the rainbow color shades\")\n    .withChoices([{choice: \"light\", name: \"Light Colors\"}, {choice: \"dark\", name: \"Dark Colors\"}]);\n\n  private _colorSwitchSetting = new NumericExtensionSetting(\"brushlab.rainbow.distance\", 20)\n    .withName(\"Color Switch Distance\")\n    .withDescription(\"The distance between the color switches\")\n    .withSlider(1)\n    .withBounds(1,100);\n\n  private lastSwitch?: { eventId: number, position: [number, number], index: number };\n\n  readonly settings = [\n    this._rainbowModeSetting,\n    this._colorSwitchSetting\n  ] as SettingWithInput<serializable>[];\n\n  public async applyConstantEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle,\n    eventId: number\n  ): Promise<constantDrawModEffect> {\n\n    const mode = await firstValueFrom(this._rainbowModeSetting.changes$);\n    const distance = await firstValueFrom(this._colorSwitchSetting.changes$);\n    const colors = Color.skribblColors.filter((color, index) => index % 2 === 0 ? (mode === \"light\") : (mode === \"dark\"));\n\n    if(this.lastSwitch === undefined || this.lastSwitch.eventId !== eventId && this.getDistance(this.lastSwitch.position, line.from) > (style.size / 10 * distance)){\n\n      /* cycle through */\n      let index = ((this.lastSwitch?.index ?? -1) + 1) % (colors.length - 1);\n\n      /* skip first two indexes (monochromes)*/\n      if(index < 2) index = 2;\n\n      /* map index back to original palette index */\n      style.color = index * 2 + (mode === \"light\" ? 0 : 1);\n\n      this.lastSwitch = {\n        eventId: eventId,\n        position: line.from,\n        index: index\n      };\n    }\n\n    return {\n      style,\n      line: line\n    };\n  }\n\n  private getDistance(from: [number, number], to: [number, number]): number {\n    return Math.sqrt(Math.pow(to[0] - from[0], 2) + Math.pow(to[1] - from[1], 2));\n  }\n}","export const defaultPalettes = {\n  skribblPalette: {\n    name: \"Skribbl.io Original\",\n    columns: 13,\n    colorHexCodes: [\n      \"#ffffff\",\n      \"#c1c1c1\",\n      \"#ef130b\",\n      \"#ff7100\",\n      \"#ffe400\",\n      \"#00cc00\",\n      \"#00ff91\",\n      \"#00b2ff\",\n      \"#231fd3\",\n      \"#a300ba\",\n      \"#df69a7\",\n      \"#ffac8e\",\n      \"#a0522d\",\n      \"#000000\",\n      \"#505050\",\n      \"#740b07\",\n      \"#c23800\",\n      \"#e8a200\",\n      \"#004619\",\n      \"#00785d\",\n      \"#00569e\",\n      \"#0e0865\",\n      \"#550069\",\n      \"#873554\",\n      \"#cc774d\",\n      \"#63300d\"\n    ]\n  }\n};","import { ExtensionSetting, type serializable } from \"@/content/core/settings/setting\";\nimport { defaultPalettes } from \"@/content/features/drawing-color-palettes/default-palettes\";\nimport { inject, injectable } from \"inversify\";\nimport { BehaviorSubject, combineLatestWith, distinctUntilChanged, map, tap } from \"rxjs\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\nexport interface palette extends pickerColors {\n  name: string;\n  [key: string]: serializable;  /* needed to pass as serializable */\n}\n\nexport interface pickerColors {\n  columns: number,\n  colorHexCodes: string[]\n}\n\n@injectable()\nexport class ColorsService {\n\n  private readonly _logger;\n\n  private _savedPalettesSetting = new ExtensionSetting<palette[]>(\"colors_saved_palettes\", []);\n  private _activePaletteSetting = new ExtensionSetting<string | undefined>(\"colors_active_palette\", undefined);\n\n  private _selectedPalette$ = new BehaviorSubject<palette | undefined>(undefined);\n  private _pickerColors$ = new BehaviorSubject<pickerColors | undefined>(undefined);\n  private _colorSelector$ = new BehaviorSubject<((palette: palette | undefined) => (pickerColors | undefined)) | undefined>(undefined);\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n  ) {\n    this._logger = loggerFactory(this);\n\n    this._activePaletteSetting.changes$.pipe(\n      combineLatestWith(this._savedPalettesSetting.changes$),\n\n      /* if changed and active does not exist, update current to undefined */\n      tap(([activePalette, savedPalettes]) => {\n        if(activePalette !== undefined && ![...savedPalettes, ...Object.values(defaultPalettes)]\n          .some(p => p.name === activePalette)) {\n          this._activePaletteSetting.setValue(undefined);\n        }\n      }),\n      map(([activePalette, savedPalettes]) => activePalette !== undefined ?\n        [...savedPalettes, ...Object.values(defaultPalettes)].find(p => p.name === activePalette) :\n        undefined\n      ),\n      distinctUntilChanged()\n    ).subscribe(palette => this._selectedPalette$.next(palette));\n\n    this._selectedPalette$.pipe(\n      combineLatestWith(this._colorSelector$),\n      map(([palette, selector]) => selector ? selector(palette) : palette),\n    ).subscribe(colors => this._pickerColors$.next(colors));\n  }\n\n  /**\n   * Selected palette or undefined if default skribbl palette\n   */\n  public get selectedPalette$() {\n    return this._selectedPalette$.asObservable();\n  }\n\n  /**\n   * Colors to show in the picker or undefined to show default skribbl colors\n   */\n  public get pickerColors$() {\n    return this._pickerColors$.asObservable();\n  }\n\n  public get activePaletteSetting() {\n    return this._activePaletteSetting.asFrozen;\n  }\n\n  public get savedPalettesSetting() {\n    return this._savedPalettesSetting.asFrozen;\n  }\n\n  public async removePalette(name: string){\n    this._logger.debug(`Removing palette ${name}`);\n\n    const palettes = await this._savedPalettesSetting.getValue();\n    const index = palettes.findIndex(p => p.name === name);\n    if(index === -1) {\n      this._logger.error(`Palette with name ${name} does not exist`);\n      throw new Error(`Palette with name ${name} does not exist`);\n    }\n\n    palettes.splice(index, 1);\n    await this._savedPalettesSetting.setValue(palettes);\n  }\n\n  public async savePalette(palette: palette, overwrite: string | undefined = undefined) {\n    this._logger.debug(`Saving palette ${palette.name}`, palette);\n\n    let palettes = await this._savedPalettesSetting.getValue();\n    if(palettes.some(p => p.name === palette.name && p.name !== overwrite)) {\n      this._logger.error(`Palette with name ${palette.name} already exists`);\n      throw new Error(`Palette with name ${palette.name} already exists`);\n    }\n\n    palettes = palettes.filter(p => p.name !== overwrite);\n    palettes.push(palette);\n    await this._savedPalettesSetting.setValue(palettes);\n  }\n\n  public setColorSelector(selector: (palette: palette | undefined) => (pickerColors | undefined)){\n    this._colorSelector$.next(selector);\n  }\n\n  public resetColorSelector(){\n    this._colorSelector$.next(undefined);\n  }\n\n  public get colorSelectorActive(){\n    return this._colorSelector$.value === undefined;\n  }\n\n}","import {\n  NumericExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { defaultPalettes } from \"@/content/features/drawing-color-palettes/default-palettes\";\nimport { ColorsService } from \"@/content/services/colors/colors.service\";\nimport { ConstantDrawMod, type constantDrawModEffect } from \"@/content/services/tools/constant-draw-mod\";\nimport { type drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle } from \"@/content/services/tools/tools.service\";\nimport { Color } from \"@/util/color\";\nimport { inject } from \"inversify\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class RandomColorMod extends ConstantDrawMod implements BrushLabItem {\n  @inject(ColorsService) private readonly _colorsService!: ColorsService;\n\n  readonly description = \"Switches colors of the current palette randomly while drawing.\";\n  readonly icon = \"var(--file-img-line-random-color-gif)\";\n  readonly name = \"Random Colors\";\n\n  private _colorSwitchSetting = new NumericExtensionSetting(\"brushlab.rainbow.distance\", 20)\n    .withName(\"Color Switch Distance\")\n    .withDescription(\"The distance between the color switches\")\n    .withSlider(1)\n    .withBounds(1,100);\n\n  private lastSwitch?: { eventId: number, position: [number, number]};\n\n  readonly settings = [\n    this._colorSwitchSetting\n  ] as SettingWithInput<serializable>[];\n\n  public async applyConstantEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle,\n    eventId: number\n  ): Promise<constantDrawModEffect> {\n\n    const distance = await firstValueFrom(this._colorSwitchSetting.changes$);\n    const colors = await firstValueFrom(this._colorsService.pickerColors$) ?? defaultPalettes.skribblPalette;\n\n    if(this.lastSwitch === undefined || this.lastSwitch.eventId !== eventId && this.getDistance(this.lastSwitch.position, line.from) > (style.size / 10 * distance)){\n\n      /* random index */\n      const index = Math.floor(Math.random() * colors.colorHexCodes.length);\n      const color = Color.fromHex(colors.colorHexCodes[index]);\n      style.color = color.typoCode;\n\n      this.lastSwitch = {\n        eventId: eventId,\n        position: line.from,\n      };\n    }\n\n    return {\n      style,\n      line: line\n    };\n  }\n\n  private getDistance(from: [number, number], to: [number, number]): number {\n    return Math.sqrt(Math.pow(to[0] - from[0], 2) + Math.pow(to[1] - from[1], 2));\n  }\n}","import {\n  ChoiceExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { type drawModEffect, type drawModLine, TypoDrawMod } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle, ToolsService } from \"@/content/services/tools/tools.service\";\nimport { inject } from \"inversify\";\nimport { firstValueFrom } from \"rxjs\";\nexport class SculptMod extends TypoDrawMod implements BrushLabItem {\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n\n  readonly description = \"Creates a figure by mirroring and connecting the line on a axis.\";\n  readonly icon = \"var(--file-img-line-sculpt-gif)\";\n  readonly name = \"Sculpt\";\n\n  private _mirrorCenterSetting = new ChoiceExtensionSetting<\"click\" | \"center\">(\"brushlab.sculpt.center\", \"center\")\n    .withName(\"Sculpt Mirror Center\")\n    .withDescription(\"The center of the sculpt figure mirroring effect\")\n    .withChoices([{choice: \"click\", name: \"At last click\"}, {choice: \"center\", name: \"At canvas center\"}]);\n\n  private _axisSetting = new ChoiceExtensionSetting<\"x\" | \"y\" | \"xy\">(\"brushlab.sculpt.axis\", \"xy\")\n    .withName(\"Sculpt Mirror Axis\")\n    .withDescription(\"The axis where the sculpt figure will be mirrored on\")\n    .withChoices([{choice: \"x\", name: \"Horizontal\"}, {choice: \"y\", name: \"Vertical\"}, {choice: \"xy\", name: \"Both\"}]);\n\n  readonly settings = [\n    this._mirrorCenterSetting,\n    this._axisSetting\n  ] as SettingWithInput<serializable>[];\n\n  public async applyEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle\n  ): Promise<drawModEffect> {\n\n    const axis = await firstValueFrom(this._axisSetting.changes$);\n    const mirrorCenter = await firstValueFrom(this._mirrorCenterSetting.changes$);\n\n    /* calculate center */\n    let center: [number, number] = [400,300];\n    if(mirrorCenter === \"click\"){\n      const event = await firstValueFrom(this._toolsService.lastPointerDownPosition$);\n      if(!event) center = line.from;\n      else center = [event.offsetX, event.offsetY];\n    }\n\n    /* calculate the mirrored point between from and to, and create a line from-mirror and mirror-to */\n    const originalLineCenter = [(line.from[0] + line.to[0]) / 2, (line.from[1] + line.to[1]) / 2] as [number, number];\n    const mirroredLineCenter = this.calculateMirroredPoint(center, originalLineCenter, axis);\n\n    return {\n      style,\n      lines: [\n        {from: line.from, to: mirroredLineCenter},\n        {from: mirroredLineCenter, to: line.to}\n      ]\n    };\n  }\n\n  private calculateMirroredPoint(center: [number, number], point: [number, number], axis: \"x\" | \"y\" | \"xy\"): [number, number] {\n    if(axis === \"x\") {\n      return [point[0], 2 * center[1] - point[1]];\n    } else if(axis === \"y\") {\n      return [2 * center[0] - point[0], point[1]];\n    } else {\n      return [2 * center[0] - point[0], 2 * center[1] - point[1]];\n    }\n  }\n}","import {\n  BooleanExtensionSetting,\n  NumericExtensionSetting,\n  type serializable,\n  SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { ConstantDrawMod, type constantDrawModEffect } from \"@/content/services/tools/constant-draw-mod\";\nimport { type drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { type brushStyle } from \"@/content/services/tools/tools.service\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class TiltMod extends ConstantDrawMod implements BrushLabItem {\n\n  readonly description = \"Tilt the line into a direction.\";\n  readonly icon = \"var(--file-img-line-tilt-gif)\";\n  readonly name = \"Tilt\";\n\n  private _distanceSetting = new NumericExtensionSetting(\"brushlab.tilt.size\", 20)\n    .withName(\"Tilt Size\")\n    .withDescription(\"The size of the tilted line\")\n    .withSlider(1)\n    .withBounds(1,100);\n\n  private _distanceDependencySetting = new BooleanExtensionSetting(\"brushlab.tilt.dependency\", false)\n    .withName(\"Size Dependency\")\n    .withDescription(\"Make tilt size proportionally dependent on brush size\");\n\n  private _angleSetting = new NumericExtensionSetting(\"brushlab.tilt.angle\", 180)\n    .withName(\"Tilt Angle\")\n    .withDescription(\"The clockwise angle where the tilt lines created\")\n    .withSlider(1)\n    .withBounds(1, 360);\n\n  readonly settings = [\n    this._distanceSetting,\n    this._distanceDependencySetting,\n    this._angleSetting\n  ] as SettingWithInput<serializable>[];\n\n  public async applyConstantEffect(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle\n  ): Promise<constantDrawModEffect> {\n\n    const distance = await firstValueFrom(this._distanceSetting.changes$);\n    const angle = await firstValueFrom(this._angleSetting.changes$);\n    const dependency = await firstValueFrom(this._distanceDependencySetting.changes$);\n\n    const offset = this.getOffset(distance, angle - 90);\n    if(dependency) {\n      offset[0] *= style.size / 40;\n      offset[1] *= style.size / 40;\n    }\n\n    const offsetLine = {\n      from: line.from,\n      to: [line.to[0] + offset[0], line.to[1] + offset[1]] as [number, number]\n    };\n\n    return  {\n      style,\n      line: offsetLine\n    };\n  }\n\n  private getOffset(distance: number, angle: number): [number, number] {\n    const angleRad = angle * Math.PI / 180;\n    const x = Math.cos(angleRad) * distance;\n    const y = Math.sin(angleRad) * distance;\n    return [x, y];\n  }\n}","import {\n  NumericExtensionSetting, type serializable, type SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport type { drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport type { brushStyle } from \"@/content/services/tools/tools.service\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class DashTool extends TypoDrawTool implements BrushLabItem {\n\n  readonly name: string = \"Dashed Lines\";\n  readonly description: string = \"Draw dashed lines with a customizable interval and blank size\";\n  readonly icon: string = \"var(--file-img-line-dash-gif)\";\n\n  private _intervalSetting = new NumericExtensionSetting(\"brushlab.dash.interval\", 10)\n    .withName(\"Dash Interval\")\n    .withDescription(\"The time interval between making line blanks in milliseconds\")\n    .withSlider(1)\n    .withBounds(1,300);\n\n  private _blankSizeSetting = new NumericExtensionSetting(\"brushlab.dash.blank\", 20)\n    .withName(\"Blank Size\")\n    .withDescription(\"The size of the blanks between dashes, depending on brush size\")\n    .withSlider(1)\n    .withBounds(1,100);\n\n  readonly settings = [\n    this._intervalSetting,\n    this._blankSizeSetting\n  ] as SettingWithInput<serializable>[];\n\n  public override createCursor(style: brushStyle): { source: string; x: number; y: number } {\n    return this.createSkribblLikeCursor(style);\n  }\n\n  private dashStart?: { eventId: number, position: [number, number] };\n  private lineStart?: {eventId: number, time: number};\n\n  public applyConstantEffect = this.noConstantEffect;\n\n  public override async createCommands(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle,\n    eventId: number\n  ): Promise<number[][]> {\n\n    const interval = await firstValueFrom(this._intervalSetting.changes$);\n    const blankSize = await firstValueFrom(this._blankSizeSetting.changes$);\n    const now = Date.now();\n\n    /* if currently drawing dash */\n    if(this.dashStart !== undefined) {\n\n      /* stop dash if distance big enough */\n      if(this.getDistance(this.dashStart.position as [number, number], line.from) > (style.size / 10 * blankSize)) {\n        this.dashStart = undefined;\n      }\n      return [];\n    }\n\n    /* if currently drawing line, end line after time passed; start dash */\n    if(this.lineStart !== undefined && now - this.lineStart.time > interval) {\n      this.lineStart = undefined;\n      this.dashStart = {eventId, position: line.to};\n      return [];\n    }\n\n    /* init a line */\n    if(this.lineStart === undefined) {\n      this.lineStart = {eventId, time: now};\n    }\n\n    /* line drawing */\n    return [[0, style.color, style.size, ...line.from, ...line.to]];\n  }\n\n  private getDistance(from: [number, number], to: [number, number]): number {\n    return Math.sqrt(Math.pow(to[0] - from[0], 2) + Math.pow(to[1] - from[1], 2));\n  }\n}","import {\n  NumericExtensionSetting, type serializable, type SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport type { drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport type { brushStyle } from \"@/content/services/tools/tools.service\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class DotTool extends TypoDrawTool implements BrushLabItem {\n\n  readonly name: string = \"Dotted Lines\";\n  readonly description: string = \"Draw dotted lines with a customizable interval\";\n  readonly icon: string = \"var(--file-img-line-dot-gif)\";\n\n  private _intervalSetting = new NumericExtensionSetting(\"brushlab.dot.interval\", 10)\n    .withName(\"Dot Interval\")\n    .withDescription(\"The time interval between making dots in milliseconds\")\n    .withSlider(1)\n    .withBounds(1,1000);\n\n  readonly settings = [this._intervalSetting] as SettingWithInput<serializable>[];\n\n  public override createCursor(style: brushStyle): { source: string; x: number; y: number } {\n    return this.createSkribblLikeCursor(style);\n  }\n\n  private lastDown = { eventId: 0, time: Date.now() };\n  public applyConstantEffect = this.noConstantEffect;\n\n  public override async createCommands(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle,\n    eventId: number\n  ): Promise<number[][]> {\n\n    const interval = await firstValueFrom(this._intervalSetting.changes$);\n    const now = Date.now();\n\n    if(this.lastDown.eventId === eventId){\n      return [[0, style.color, style.size, ...line.to, ...line.to]];\n    }\n    else if(now - this.lastDown.time > interval) {\n      this.lastDown.time = now;\n      this.lastDown.eventId = eventId;\n      return [[0, style.color, style.size, ...line.to, ...line.to]];\n    }\n    return [];\n  }\n}","import {\n  NumericExtensionSetting, type serializable, type SettingWithInput,\n} from \"@/content/core/settings/setting\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport type { drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport { type brushStyle, ToolsService } from \"@/content/services/tools/tools.service\";\nimport { inject } from \"inversify\";\nimport { firstValueFrom } from \"rxjs\";\n\nexport class GridTool extends TypoDrawTool implements BrushLabItem {\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n\n  readonly name: string = \"Grid Generator\";\n  readonly description: string = \"Click anywhere on the canvas to create a grid\";\n  readonly icon: string = \"var(--file-img-line-grid-gif)\";\n\n  private _rowsSetting = new NumericExtensionSetting(\"brushlab.grid.rows\", 6)\n    .withName(\"Row Count\")\n    .withDescription(\"The amount of rows in the grid\")\n    .withSlider(1)\n    .withBounds(1,30);\n\n  private _columnsSetting = new NumericExtensionSetting(\"brushlab.grid.columns\", 8)\n    .withName(\"Column Count\")\n    .withDescription(\"The amount of columns in the grid\")\n    .withSlider(1)\n    .withBounds(1,30);\n\n  readonly settings = [\n    this._rowsSetting,\n    this._columnsSetting\n  ] as SettingWithInput<serializable>[];\n\n  public createCursor() {\n    return { source: \"var(--file-img-grid_cur-png)\", x: 7, y: 37 };\n  }\n\n  private _lastDownEvent: PointerEvent | null = null;\n  public applyConstantEffect = this.noConstantEffect;\n\n  public override async createCommands(\n    line: drawModLine,\n    pressure: number | undefined,\n    style: brushStyle\n  ): Promise<number[][]> {\n\n    const lastPointerDown = await firstValueFrom(this._toolsService.lastPointerDownPosition$);\n    if( lastPointerDown === null || this._lastDownEvent === lastPointerDown){\n      return [];\n    }\n\n    this._lastDownEvent = lastPointerDown;\n    const canvasWidth = 800;\n    const canvasHeight = 600;\n    const rows = await firstValueFrom(this._rowsSetting.changes$);\n    const columns = await firstValueFrom(this._columnsSetting.changes$);\n    const rowHeight = Math.ceil(canvasHeight / rows);\n    const columnWidth = Math.ceil(canvasWidth / columns);\n\n    const commands = [];\n    for(let i = 1; i < rows; i++){\n      commands.push([0, style.color, style.size, 0, i * rowHeight, canvasWidth, i * rowHeight]);\n    }\n    for(let i = 1; i < columns; i++){\n      commands.push([0, style.color, style.size, i * columnWidth, 0, i * columnWidth, canvasHeight]);\n    }\n\n    return commands;\n  }\n}","<script lang=\"ts\">\n\n  import type { DrawingBrushLabFeature } from \"@/content/features/drawing-brush-lab/drawing-brush-lab.feature\";\n\n  export let feature: DrawingBrushLabFeature;\n\n\n</script>\n\n<style lang=\"scss\">\n\n</style>\n<div>\n</div>","<script lang=\"ts\">\n  import type { DrawingBrushLabFeature } from \"@/content/features/drawing-brush-lab/drawing-brush-lab.feature\";\n\n  export const toggle = () => {\n    expanded = !expanded;\n  };\n\n  export let feature: DrawingBrushLabFeature;\n  let expanded = false;\n\n</script>\n\n<style lang=\"scss\">\n\n  /* hide colors, skribbl tools */\n  /*:global(#game-toolbar:has(.typo-brush-lab-switch.expanded) > :not(.typo-brush-lab-group, .toolbar-group-actions)){\n    display: none;\n  }*/\n\n  /* change grid area height */\n  :global(#game-toolbar:has(.typo-brush-lab-switch.expanded)){\n    grid-template-rows: max-content;\n  }\n\n  /* hide typo brushlab section */\n  :global(#game-toolbar:not(:has(.typo-brush-lab-switch.expanded)) > .typo-brush-lab-group){\n    display: none;\n  }\n\n</style>\n\n<div class=\"typo-brush-lab-switch tool clickable\"\n     class:expanded on:click={() => expanded = !expanded}\n     use:feature.createTooltip={{title: \"Toggle Brush Lab\", lock: \"Y\"}}\n>\n  <div class=\"icon\" style=\"background-image: var(--file-img-wand-gif)\"></div>\n</div>","<script lang=\"ts\">\n  import { skribblTool } from \"@/content/events/tool-changed.event\";\n  import type { DrawingBrushLabFeature } from \"@/content/features/drawing-brush-lab/drawing-brush-lab.feature\";\n\n  export let feature: DrawingBrushLabFeature;\n  const tools = feature.toolbarItemsStore;\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-brush-lab-group {\n    /*grid-area: preview / preview / preview / tools;*/\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 2rem;\n    grid-row: 2;\n    /*position: absolute;\n    top: calc(var(--UNIT) + var(--BORDER_GAP));*/\n\n    .typo-brush-lab-mods, .typo-brush-lab-tools {\n      display: flex;\n      flex-direction: row;\n      gap: .5rem;\n    }\n  }\n\n</style>\n\n<div class=\"typo-brush-lab-group\">\n\n  <div class=\"typo-brush-lab-settings\">\n\n    <div class=\"tool clickable\"\n         use:feature.createTooltip={{title: \"Brush Lab Settings\", lock: \"Y\"}}\n         on:click={() => feature.openBrushLabSettings()}\n    >\n      <div class=\"icon\" style=\"background-image: var(--file-img-wrench-gif)\"></div>\n    </div>\n\n  </div>\n\n  <div class=\"typo-brush-lab-mods\">\n\n    {#each $tools.mods as mod}\n      <div class=\"tool clickable\" class:selected={mod.active}\n           use:feature.createTooltip={{title: mod.item.name, lock: \"Y\"}}\n           on:click={() => {\n             if(!mod.active){\n               feature.activateMod(mod.item);\n             }\n             else {\n               feature.removeMod(mod.item);\n             }\n           }}\n      >\n        <div class=\"icon\" style=\"background-image: {mod.item.icon}\"></div>\n      </div>\n    {/each}\n\n  </div>\n\n\n  <div class=\"typo-brush-lab-tools\">\n\n    {#each $tools.tools as tool}\n      <div class=\"tool clickable\" class:selected={tool.active}\n           use:feature.createTooltip={{title: tool.item.name, lock: \"Y\"}}\n           on:click={() => {\n             if(!tool.active){\n               feature.activateTool(tool.item);\n             }\n             else {\n               feature.activateTool(skribblTool.brush);\n             }\n           }}\n      >\n        <div class=\"icon\" style=\"background-image: {tool.item.icon}\"></div>\n      </div>\n    {/each}\n\n  </div>\n\n</div>","<script lang=\"ts\">\n\n  import type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\n  import type { DrawingBrushLabFeature } from \"@/content/features/drawing-brush-lab/drawing-brush-lab.feature\";\n  import { ConstantDrawMod } from \"@/content/services/tools/constant-draw-mod\";\n  import type { TypoDrawMod } from \"@/content/services/tools/draw-mod\";\n  import { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\n\n  export let feature: DrawingBrushLabFeature;\n\n  const items = feature.toolbarItemsStore;\n  let selectedItem: (TypoDrawMod & BrushLabItem) | undefined;\n\n  $: {\n    selectedItem = ($items.tools.find(tool => tool.active)\n      ?? $items.mods.find(mod => mod.active)\n      ?? $items.tools[0]\n    )?.item;\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  .item-selection {\n\n    display: grid;\n    grid-template-columns: auto 1fr;\n    height: 100%;\n    width: 100%;\n    padding: 1rem 2rem;\n    gap: 2rem;\n\n    .item-sidebar {\n      display: flex;\n      flex-direction: column;\n      gap: 1rem;\n      padding-right: 2rem;\n      height: 100%;\n      border-right: 1px solid var(--COLOR_PANEL_BORDER_FOCUS);\n      overflow: auto;\n\n      h3 {\n        opacity: .5;\n      }\n\n      .item-sidebar-entry {\n        display: flex;\n        gap: .5rem;\n        align-items: center;\n        cursor: pointer;\n\n        img {\n          height: 2rem;\n        }\n      }\n    }\n\n    .item-details {\n      display: flex;\n      flex-direction: column;\n      gap: 1rem;\n\n      .item-title {\n        display: flex;\n        align-items: center;\n        gap: 2rem;\n\n        b {\n          opacity: .5;\n        }\n      }\n\n      .item-details-settings-list {\n        display: flex;\n        flex-direction: row;\n        flex-wrap: wrap;\n        gap: 2rem;\n\n        .item-details-settings-item {\n          min-width: clamp(20em, 20em, 100%);\n          max-width: clamp(20em, 20em, 100%);\n          background-color: var(--COLOR_PANEL_HI);\n          border-radius: 3px;\n          display: flex;\n          flex-direction: column;\n          gap: 1rem;\n          padding: 1rem;\n          flex: 1 1 0px;\n          position: relative;\n        }\n      }\n    }\n  }\n\n</style>\n\n<p>\n  The Brush Laboratory has many mods and tools to create unique masterpices.<br>\n  Below, you can find all available tools and mods and their settings.<br>\n  Additionally to a tool, you can select one mod and multiple combo mods.\n</p>\n\n\n<div class=\"item-selection\">\n\n  <div class=\"item-sidebar\">\n    <h3>Tools</h3>\n    {#each $items.tools as tool }\n      <div class=\"item-sidebar-entry\" on:click={() => selectedItem = tool.item}>\n        <img src=\"\" style=\"content: {tool.item.icon}\" alt=\"icon\" />\n        <b>{tool.item.name}</b>\n      </div>\n    {/each}\n    <h3>Mods</h3>\n    {#each $items.mods.filter(mod => !(mod.item instanceof ConstantDrawMod)) as mod }\n      <div class=\"item-sidebar-entry\" on:click={() => selectedItem = mod.item}>\n        <img src=\"\" style=\"content: {mod.item.icon}\" alt=\"icon\" />\n        <b>{mod.item.name}</b>\n      </div>\n    {/each}\n    <h3>Combo Mods</h3>\n    {#each $items.mods.filter(mod => mod.item instanceof ConstantDrawMod) as mod }\n      <div class=\"item-sidebar-entry\" on:click={() => selectedItem = mod.item}>\n        <img src=\"\" style=\"content: {mod.item.icon}\" alt=\"icon\" />\n        <b>{mod.item.name}</b>\n      </div>\n    {/each}\n  </div>\n\n  <div class=\"item-details\">\n    <div class=\"item-title\">\n      <img src=\"\" style=\"content: {selectedItem?.icon}\" alt=\"icon\">\n      <h2>{selectedItem?.name}</h2>\n      <b>({selectedItem instanceof ConstantDrawMod ? (selectedItem instanceof TypoDrawTool ? \"TOOL\" : \"COMBO MOD\") : \"MOD\"})</b>\n    </div>\n    <p>{selectedItem?.description}</p>\n\n    {#if selectedItem !== undefined && selectedItem.settings.length > 0}\n        <div class=\"item-details-settings-list\">\n          {#each selectedItem.settings as setting}\n            <div class=\"item-details-settings-item\">\n              <svelte:component this={setting.componentData.componentType} {...setting.componentData.props} />\n            </div>\n          {/each}\n        </div>\n    {/if}\n  </div>\n\n</div>","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { skribblTool } from \"@/content/events/tool-changed.event\";\nimport type { BrushLabItem } from \"@/content/features/drawing-brush-lab/brush-lab-item.interface\";\nimport { MandalaMod } from \"@/content/features/drawing-brush-lab/mods/mandala-mod\";\nimport { NoiseMod } from \"@/content/features/drawing-brush-lab/mods/noise-mod\";\nimport { ParallelLineMod } from \"@/content/features/drawing-brush-lab/mods/parallel-line-mod\";\nimport { RainbowMod } from \"@/content/features/drawing-brush-lab/mods/rainbow-mod\";\nimport { RandomColorMod } from \"@/content/features/drawing-brush-lab/mods/random-color-mod\";\nimport { SculptMod } from \"@/content/features/drawing-brush-lab/mods/sculpt-mod\";\nimport { TiltMod } from \"@/content/features/drawing-brush-lab/mods/tilt-mod\";\nimport { DashTool } from \"@/content/features/drawing-brush-lab/tools/dash-tool\";\nimport { DotTool } from \"@/content/features/drawing-brush-lab/tools/dot-tool\";\nimport { GridTool } from \"@/content/features/drawing-brush-lab/tools/grid-tool\";\nimport { type componentData, ModalService } from \"@/content/services/modal/modal.service\";\nimport type { TypoDrawMod } from \"@/content/services/tools/draw-mod\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport { ToolsService } from \"@/content/services/tools/tools.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport type { Type } from \"@/util/types/type\";\nimport { inject } from \"inversify\";\nimport { BehaviorSubject, combineLatestWith, firstValueFrom, map } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport DrawingBrushLabInfo from \"./drawing-brush-lab-info.svelte\";\nimport BrushLabSwitch from \"./drawing-brush-lab-switch.svelte\";\nimport BrushLabGroup from \"./drawing-brush-lab-group.svelte\";\nimport BrushLabManage from \"./drawing-brush-lab-manage.svelte\";\n\nexport class DrawingBrushLabFeature extends TypoFeature {\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n\n  public readonly name = \"Brush Laboratory\";\n  public readonly description = \"Add custom drawing tools for special effects to the toolbar\";\n  public readonly featureId = 39;\n\n  private _labSwitchComponent?: BrushLabSwitch;\n  private _labGroupComponent?: BrushLabGroup;\n  private _toolbarItems$ = new BehaviorSubject<{\n    tools: { item: TypoDrawTool & BrushLabItem, active: boolean }[],\n    mods: { item: TypoDrawMod & BrushLabItem, active: boolean }[]\n  }>({ tools: [], mods: [] });\n\n  private _items: Type<TypoDrawMod & BrushLabItem>[] = [\n    ParallelLineMod,\n    MandalaMod,\n    SculptMod,\n    DotTool,\n    DashTool,\n    RainbowMod,\n    RandomColorMod,\n    GridTool,\n    NoiseMod,\n    TiltMod\n  ];\n\n  private readonly _brushLabToggleHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"toggle_lab\",\n      \"Toggle Brush Lab\",\n      \"Toggle the visibility of the brush lab below skribbl tools\",\n      this,\n      () => this._labSwitchComponent?.toggle(),\n      true,\n      [\"ShiftLeft\", \"KeyL\"]\n    )\n  );\n\n  public override get featureInfoComponent(): componentData<DrawingBrushLabInfo> {\n    return { componentType: DrawingBrushLabInfo, props: { feature: this } };\n  }\n\n  /*public override get featureManagementComponent(): componentData<BrushLabManage> {\n    return { componentType: BrushLabManage, props: { feature: this } };\n  }*/\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    this._labGroupComponent = new BrushLabGroup({\n      target: elements.skribblToolbar,\n      props: { feature: this },\n    });\n\n    this._labSwitchComponent = new BrushLabSwitch({\n      target: elements.skribblActions,\n      props: { feature: this },\n    });\n\n    this.createItems();\n  }\n\n  protected override async onDestroy() {\n    if (this._labSwitchComponent) {\n      this._labSwitchComponent.$destroy();\n      this._labSwitchComponent = undefined;\n    }\n\n    if (this._labGroupComponent) {\n      this._labGroupComponent.$destroy();\n      this._labGroupComponent = undefined;\n    }\n\n    const items = await firstValueFrom(this._toolbarItems$);\n    items.mods.forEach(({ item }) => this._toolsService.removeMod(item));\n    this._toolsService.activateTool(skribblTool.brush);\n  }\n\n  public get toolbarItemsStore(){\n    return fromObservable(this._toolbarItems$.pipe(\n      combineLatestWith(this._toolsService.activeTool$, this._toolsService.activeMods$),\n      map(([items, activeTool, activeMods]) => {\n        return {\n          mods: items.mods.map(item => ({item: item.item, active: activeMods.includes(item.item)})),\n          tools: items.tools.map(item => ({item: item.item, active: activeTool === item.item}))\n        };\n      })\n    ), this._toolbarItems$.value);\n  }\n\n  private createItems(){\n    const items = this._items.map(item => this._toolsService.resolveModOrTool(item));\n\n    const tools = items.filter(item => item instanceof TypoDrawTool).map(item => ({ item, active: false }));\n    const mods = items.filter(item => !(item instanceof TypoDrawTool)).map(item => ({ item, active: false }));\n\n    this._toolbarItems$.next({ tools, mods });\n  }\n\n  public activateTool(tool: TypoDrawTool | skribblTool){\n    this._toolsService.activateTool(tool);\n  }\n\n  public activateMod(mod: TypoDrawMod){\n    this._toolsService.activateMod(mod);\n  }\n\n  public removeMod(mod: TypoDrawMod){\n    this._toolsService.removeMod(mod);\n  }\n\n  public openBrushLabSettings(){\n    const componentData: componentData<BrushLabManage> = {\n      componentType: BrushLabManage,\n      props: { feature: this }\n    };\n    this._modalService.showModal(componentData.componentType, componentData.props, \"Brush Laboratory\");\n  }\n}","Using custom palettes, you can customize the colors available in the typo toolbar.<br>\n<br>\n<h3>⚠️ Warning:</h3>\nOnly <b>typo users can see custom colors</b>, other players will not see anything until the next time you clear the canvas.<br>\nUse custom colors and custom palettes only when you're in free draw mode, or when everyone in the lobby has typo installed.","<script lang=\"ts\">\n\n  import type { palette } from \"@/content/features/drawing-color-palettes/drawing-color-palettes.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import ColorPickerButton from \"@/lib/color-picker/color-picker-button.svelte\";\n  import { Color } from \"@/util/color\";\n  import { onMount } from \"svelte\";\n\n  let name = \"new-palette\";\n  let colors: Color[] = [];\n  let columns = 10;\n\n  const loadPalette = (palette: palette) => {\n    name = palette.name;\n    colors = palette.colorHexCodes.map(code => Color.fromHex(code));\n    columns = palette.columns;\n  };\n\n  export let onPaletteSave: undefined | ((palette: palette) => void) = undefined;\n  export let onPaletteExport: undefined | ((palette: palette) => void) = undefined;\n  export let onPaletteDelete: undefined | (() => void) = undefined;\n  export let initialPalette: undefined | palette = undefined;\n\n  onMount(() => {\n    if(initialPalette) {\n      loadPalette(initialPalette);\n    }\n  });\n</script>\n\n<style lang=\"scss\">\n\n  .typo-palette-builder-container {\n    background-color: var(--COLOR_PANEL_HI);\n    border-radius: 3px;\n    gap: 2rem;\n    padding: 1rem;\n    display: grid;\n    grid-template-columns: auto auto;\n    flex-direction: column;\n\n    .typo-palette-builder-inputs {\n      display: flex;\n      flex-direction: column;\n      gap: .5rem;\n\n      b {\n        margin-top: .5rem;\n      }\n    }\n\n    .typo-palette-builder-actions {\n      display: flex;\n      flex-direction: column;\n      gap: .5rem;\n    }\n\n    .typo-palette-builder-colors {\n      display: grid;\n      gap: .2rem;\n    }\n  }\n\n</style>\n\n<div class=\"typo-palette-builder-container\">\n\n  <div class=\"typo-palette-builder-inputs\">\n    <b>Palette Name</b>\n    <input type=\"text\" bind:value={name} disabled=\"{onPaletteSave === undefined}\" />\n\n    <b>Columns per row</b>\n    <input type=\"number\" bind:value={columns} min=\"0\" disabled=\"{onPaletteSave === undefined}\" />\n\n    <b>Palette colors</b>\n    <div class=\"typo-palette-builder-colors\"\n         style=\"pointer-events: {onPaletteSave === undefined ? 'none' : 'all'}; grid-template-columns: repeat({columns}, 2rem); width: calc({columns} * 2rem + {columns - 1} * .2rem)\">\n      {#each colors as color, i}\n        <div class=\"typo-palette-builder-color\" >\n          <ColorPickerButton bind:color=\"{color}\" height=\"auto\" />\n        </div>\n      {/each}\n    </div>\n\n  </div>\n\n  <div class=\"typo-palette-builder-actions\">\n    {#if onPaletteSave}\n      <FlatButton color=\"green\" content=\"Save Palette\" on:click={() => onPaletteSave({name, columns, colorHexCodes: colors.map(c => c.hex)})} />\n    {/if}\n\n    {#if onPaletteDelete}\n      <FlatButton color=\"orange\" content=\"Delete Palette\" on:click={() => onPaletteDelete()} />\n    {/if}\n\n    {#if onPaletteExport}\n      <FlatButton color=\"blue\" content=\"Export to clipboard\" on:click={() => onPaletteExport({name, columns, colorHexCodes: colors.map(c => c.hex)})} />\n    {/if}\n\n    <br>\n\n    {#if onPaletteSave}\n      <FlatButton content=\"Add Color\" color=\"green\" on:click={() => colors = [...colors, Color.fromHex(\"#77c5fa\")]}  />\n    {/if}\n\n    {#if onPaletteSave}\n      <FlatButton content=\"Remove Color\" color=\"orange\" on:click={() => colors = [...colors.slice(0, colors.length - 1)]}  />\n    {/if}\n  </div>\n\n</div>","<script lang=\"ts\">\n\n  import type {\n    DrawingColorPalettesFeature\n  } from \"@/content/features/drawing-color-palettes/drawing-color-palettes.feature\";\n  import ColorPaletteBuilder from \"./color-palette-builder.svelte\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let feature: DrawingColorPalettesFeature;\n\n  let paletteImport = \"\";\n  const palettes = feature.savedPalettesStore;\n  const defaultPalettes = feature.defaultPalettes;\n  const activePalette = feature.activePaletteStore;\n</script>\n\n<style lang=\"scss\">\n  .typo-color-palette-manage-list {\n    display: flex;\n    flex-direction: row-reverse;\n    gap: 1rem;\n    flex-wrap: wrap;\n    justify-content: flex-end;\n  }\n</style>\n\n<h3>Active palette</h3>\nSelect one of the saved palettes to customize the colors available in the skribbl toolbar.<br>\n<select bind:value={$activePalette} style=\"width: auto\">\n  {#each Object.values(defaultPalettes) as palette}\n    <option value={palette === defaultPalettes.skribblPalette ? undefined : palette.name} selected=\"{palette === defaultPalettes.skribblPalette && $activePalette === undefined || $activePalette === palette.name}\">{palette.name}</option>\n  {/each}\n\n  {#each $palettes as palette}\n    <option value={palette.name} selected=\"{$activePalette === palette.name}\">{palette.name}</option>\n  {/each}\n</select><br>\n<br>\n\n<h3>Create a new empty palette</h3>\nCreate a new palette to customize the colors available in the skribbl toolbar.<br>\nYou can enter a name to identify the palette, choose a number of columns for the palette layout and add as many colors as you like.<br>\nClick a color box to change it, remove the last color with \"Remove Color\" or add a new color with \"Add Color\".<br>\nWhen you are done, click \"Save Palette\" to save the changes.<br>\n<br>\n<FlatButton color=\"green\" content=\"Add new palette\" on:click={() => feature.savePalette({name: \"palette-\" + Date.now(), columns: 10, colorHexCodes: [\"#77c5fa\"]})} /><br>\n<br>\n\n<h3>Saved palettes</h3>\n<br>\n<div class=\"typo-color-palette-manage-list\">\n  {#each $palettes as palette}\n    {#key palette}\n      <ColorPaletteBuilder\n        initialPalette=\"{palette}\"\n        onPaletteSave={(newPalette) => feature.savePalette(newPalette, palette.name)}\n        onPaletteExport={(newPalette) => feature.exportPalette(newPalette)}\n        onPaletteDelete=\"{() => feature.removePalette(palette.name)}\"\n      />\n    {/key}\n  {/each}\n\n  {#each Object.values(defaultPalettes) as palette}\n    <ColorPaletteBuilder\n      initialPalette=\"{palette}\"\n      onPaletteExport={() => feature.exportPalette(palette)}\n    />\n  {/each}\n</div>\n<br>\n\n<h3>Import a palette</h3>\nYou can import existing palettes by pasting their data here.<br>\nExisting palettes can be exported by clicking the \"Export to clipboard\" button on the palette.<br>\nThe data is a JSON string that represents the palette; you can also create a new palette without the typo palette builder.<br>\nThe palette has to satisfy following interface: <i>&lbrace; name: string; columns: number; colorHexCodes: string[] }</i><br>\n<br>\n<input bind:value={paletteImport} type=\"text\" placeholder=\"Paste palette data\" style=\"width: auto\"  /><br>\n<br>\n<FlatButton color=\"green\" content=\"Import palette\" on:click={() => feature.savePalette(feature.parsePalette(paletteImport))} /><br>\n<br>\n","<script lang=\"ts\">\n  import {\n    DrawingColorPalettesFeature\n  } from \"@/content/features/drawing-color-palettes/drawing-color-palettes.feature\";\n  import type { pickerColors } from \"@/content/services/colors/colors.service\";\n  export let colors: pickerColors;\n  export let feature: DrawingColorPalettesFeature;\n</script>\n\n<style lang=\"scss\">\n\n  :global(#game-toolbar) .typo-palette.colors {\n    height: fit-content;\n  }\n\n  .typo-palette-picker {\n    display: grid;\n    overflow: hidden;\n    border-radius: var(--BORDER_RADIUS);\n\n    .typo-palette-picker-item {\n      aspect-ratio: 1;\n      height: calc(var(--UNIT) / 2);\n      cursor: pointer;\n      position: relative;\n\n      &:after {\n        content: \"\";\n        position: absolute;\n        left: 2px;\n        top: 2px;\n        right: 2px;\n        bottom: 2px;\n        border-radius: 3px;\n      }\n\n      &:hover:after {\n        border-width: 3px;\n        border-style: solid;\n        border-color: rgba(0, 0, 0, 0.6);\n      }\n    }\n  }\n</style>\n\n<div class=\"colors typo-palette\">\n  <div class=\"typo-palette-picker\" style=\"grid-template-columns: repeat({colors.columns}, auto)\">\n    {#each colors.colorHexCodes as color}\n      <div class=\"typo-palette-picker-item\"\n           on:click={() => feature.setColor(color)}\n           style=\"background-color: {color};\"></div>\n    {/each}\n  </div>\n</div>","import { type serializable } from \"@/content/core/settings/setting\";\nimport { ColorsService, type pickerColors } from \"@/content/services/colors/colors.service\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { Color } from \"@/util/color\";\nimport { createElement } from \"@/util/document/appendElement\";\nimport {type Subscription, } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport ColorPalettesInfo from \"./drawing-color-palettes-info.svelte\";\nimport ColorPalettesManage from \"./drawing-color-palettes-manage.svelte\";\nimport ColorPalettePicker from \"./color-palette-picker.svelte\";\nimport  {defaultPalettes} from \"@/content/features/drawing-color-palettes/default-palettes\";\n\nexport interface palette {\n  name: string;\n  columns: number;\n  colorHexCodes: string[];\n  [key: string]: serializable;  /* needed to pass as serializable */\n}\n\nexport class DrawingColorPalettesFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ColorsService) private readonly _colorsService!: ColorsService;\n\n  public readonly name = \"Color Palettes\";\n  public readonly description = \"Use custom color palettes instead of the default skribbl colors\";\n  public readonly featureId = 32;\n\n  public override get featureInfoComponent(): componentData<ColorPalettesInfo>{\n    return { componentType: ColorPalettesInfo, props: {}};\n  }\n\n  public override get featureManagementComponent(): componentData<ColorPalettesManage>{\n    return {componentType: ColorPalettesManage, props: { feature: this }};\n  }\n\n  private readonly _hideOriginalPaletteStyle = createElement(`<style>\n    #game #game-toolbar .colors:has(.top) {\n      display: none;\n    }\n  </style>`);\n\n  private _activePaletteSubscription?: Subscription;\n  private _colorPalettePicker?: ColorPalettePicker;\n\n  protected override async onActivate() {\n    this._activePaletteSubscription = this._colorsService.pickerColors$.subscribe(palette => this.updatePaletteStyle(palette));\n  }\n\n  protected override async onDestroy() {\n    this._hideOriginalPaletteStyle.remove();\n    this._activePaletteSubscription?.unsubscribe();\n    this._activePaletteSubscription = undefined;\n    this._colorPalettePicker?.$destroy();\n  }\n\n  /**\n   * Change the visibility of the default palette or custom palette\n   * @param palette\n   * @private\n   */\n  private async updatePaletteStyle(colors: pickerColors | undefined){\n    this._logger.info(\"Updating palette style\", colors);\n\n    this._colorPalettePicker?.$destroy();\n    if(colors === undefined){\n      this._hideOriginalPaletteStyle.remove();\n      return;\n    }\n\n    const elements = await this._elementsSetup.complete();\n\n    if(this._hideOriginalPaletteStyle.parentElement === null) document.body.appendChild(this._hideOriginalPaletteStyle);\n    this._colorPalettePicker = new ColorPalettePicker({\n      target: elements.skribblToolbar,\n      anchor: elements.colorContainer,\n      props: {\n        feature: this,\n        colors\n      }\n    });\n  }\n\n  /**\n   * Remove a palette from the settings\n   * @param name\n   */\n  public async removePalette(name: string) {\n    this._logger.info(`Removing palette ${name}`);\n\n    if(! await (await this._toastService.showConfirmToast(`Do you want to remove the palette ${name}?`)).result){\n      this._logger.info(`User canceled removal of palette ${name}`);\n      return;\n    }\n\n    const toast = await this._toastService.showLoadingToast(`Removing palette ${name}`);\n\n    try {\n      await this._colorsService.removePalette(name);\n    }\n    catch (e) {\n      this._logger.error(`Failed to remove palette ${name}`, e);\n      toast.reject(`Failed to remove palette ${name}`);\n      return;\n    }\n\n    toast.resolve();\n  }\n\n  /**\n   * Parse a palette from a json string\n   * @param json\n   */\n  public parsePalette(json: string): palette {\n    this._logger.info(\"Parsing palette from json\", json);\n\n    try {\n      const palette = JSON.parse(json);\n      if(typeof palette.name !== \"string\" || typeof palette.columns !== \"number\" || !Array.isArray(palette.colorHexCodes)\n      || ! palette.colorHexCodes.every((c: unknown) => typeof c === \"string\")) {\n        this._logger.error(\"Invalid palette format\", palette);\n        throw new Error(\"Invalid palette format\");\n      }\n\n      return palette;\n    }\n    catch(e) {\n      this._logger.error(\"Failed to parse palette from json\", e);\n      this._toastService.showToast(\"Failed to read palette\", \"Invalid palette format. Check the JSON data!\");\n      throw e;\n    }\n  }\n\n  /**\n   * Save a palette to the settings, or overwrite with given name\n   * @param palette\n   * @param overwrite\n   */\n  public async savePalette(palette: palette, overwrite: string | undefined = undefined) {\n    this._logger.info(`Saving palette ${palette.name}`, palette);\n\n    const toast = await this._toastService.showLoadingToast(`Saving palette ${palette.name}`);\n\n    if(palette.colorHexCodes.length === 0) {\n      this._logger.error(`Palette ${palette.name} has no colors`);\n      toast.reject(`Palette ${palette.name} has no colors`);\n      return;\n    }\n\n    if(palette.name.trim() === \"\") {\n      this._logger.error(\"Palette has no name set\");\n      toast.reject(\"Palette has no name set\");\n      return;\n    }\n\n    if(palette.columns < 1) {\n      this._logger.error(`Palette ${palette.name} has less than 1 column`);\n      toast.reject(`Palette ${palette.name} cannot have less than 1 column`);\n      return;\n    }\n\n    try {\n      await this._colorsService.savePalette(palette, overwrite);\n    }\n    catch (e) {\n      this._logger.error(`Failed to save palette ${palette.name}`, e);\n      toast.reject(`Failed to save palette ${palette.name}`);\n      return;\n    }\n\n    toast.resolve();\n  }\n\n  /**\n   * Copy the json of a palette to the clipboard\n   * @param palette\n   */\n  public async exportPalette(palette: palette) {\n    this._logger.info(`Exporting palette ${palette.name} to clipboard`, palette);\n\n    const toast = await this._toastService.showLoadingToast(`Exporting palette ${palette.name} to clipboard`);\n\n    try {\n      const json = JSON.stringify(palette);\n      await navigator.clipboard.writeText(json);\n    }\n    catch(e) {\n      this._logger.error(`Failed to export palette ${palette.name} to clipboard`, e);\n      toast.reject(`Failed to export palette ${palette.name} to clipboard`);\n      return;\n    }\n\n    toast.resolve();\n  }\n\n  /**\n   * Set the color of the skribbl tool\n   * @param colorHex\n   */\n  public setColor(colorHex: string){\n    this._logger.info(`Setting color to ${colorHex}`);\n    const color = Color.fromHex(colorHex);\n    this._drawingService.setColor(color.skribblCode);\n  }\n\n  public get savedPalettesStore() {\n    return this._colorsService.savedPalettesSetting.store;\n  }\n\n  public get activePaletteStore() {\n    return this._colorsService.activePaletteSetting.store;\n  }\n\n  public get defaultPalettes() {\n    return defaultPalettes;\n  }\n}","import type { constantDrawModEffect } from \"@/content/services/tools/constant-draw-mod\";\nimport type { drawModLine } from \"@/content/services/tools/draw-mod\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport type { brushStyle } from \"@/content/services/tools/tools.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { Color } from \"@/util/color\";\nimport { inject } from \"inversify\";\n\n/**\n * Tool that allows the user to pick a color from the canvas\n * Produces no draw commands, but sets the current color as mod side effect\n */\nexport class PipetteTool extends TypoDrawTool {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public createCursor() {\n    return { source: \"var(--file-img-pipette_cur-png)\", x: 7, y: 37 };\n  }\n\n  public createCommands = this.noCommands;\n\n  /**\n   * Get the pixel color of the canvas at a certain position\n   * @param line\n   * @param pressure\n   * @param style\n   */\n  public async applyConstantEffect(line: drawModLine, pressure: number | undefined, style: brushStyle): Promise<constantDrawModEffect> {\n    const elements = await this._elementsSetup.complete();\n    const canvas = elements.canvas;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (ctx !== null){\n      const imageData = ctx.getImageData(line.to[0], line.to[1], 1, 1);\n      const rgb = imageData.data.slice(0, 3);\n      style.color = Color.fromRgb(rgb[0], rgb[1], rgb[2]).skribblCode;\n    }\n\n    return this.noConstantEffect(line, pressure, style);\n  }\n}","Add a hotkey to quickly focus the chat input, so you can start guessing right away. <br>\nIf the auto-focus setting is enabled, the chat input will be focused automatically when someone else starts drawing. <br>","<script lang=\"ts\">\n  import type { DrawingColorToolsFeature } from \"@/content/features/drawing-color-tools/drawing-color-tools.feature\";\n  import { PipetteTool } from \"@/content/features/drawing-color-tools/pipette-tool\";\n  import ColorPickerButton from \"@/lib/color-picker/color-picker-button.svelte\";\n\n  export let feature: DrawingColorToolsFeature;\n\n  const selectedTool = feature.selectedToolStore;\n  const color = feature.colorStore;\n</script>\n\n<style lang=\"scss\">\n  .color-tools {\n    height: var(--UNIT);\n    width: calc(var(--UNIT) / 2);\n\n    .pipette, .picker {\n      height: 50%;\n      width: 100%;\n      color: var(--COLOR_TOOL_TEXT);\n      background-color: var(--COLOR_TOOL_BASE);\n      cursor: pointer;\n      background-size: contain;\n      background-position: center;\n      background-repeat: no-repeat;\n\n      &:hover {\n        background-color: var(--COLOR_TOOL_HOVER);\n      }\n\n      &.selected {\n        background-color: var(--COLOR_TOOL_ACTIVE);\n      }\n    }\n\n    .pipette {\n      border-bottom: 1px solid lightgray;\n      background-image: var(--file-img-crosshair-gif);\n      border-radius: var(--BORDER_RADIUS) var(--BORDER_RADIUS) 0 0;\n    }\n\n    .picker {\n      border-top: 1px solid lightgray;\n      background-image: var(--file-img-inspect-gif);\n      border-radius: 0 0 var(--BORDER_RADIUS) var(--BORDER_RADIUS);\n    }\n\n  }\n</style>\n\n<div class=\"color-tools\">\n  <div class=\"pipette\"\n       on:click={() => feature.selectPipetteTool()} class:selected={$selectedTool instanceof PipetteTool}\n       use:feature.createTooltip={{title: \"Pipette\", lock: \"Y\"}}\n  ></div>\n  <div class=\"picker\" use:feature.createTooltip={{title: \"Picker\", lock: \"Y\"}}>\n    <ColorPickerButton\n      color=\"{$color}\"\n      allowAlpha=\"{false}\"\n      useBackground=\"{false}\"\n      height=\"auto\"\n      borderRadius=\"0\"\n      colorChanged={c => feature.updatePickedColor(c)}\n      description=\"Warning: Only typo users can see custom colors.\"\n    />\n  </div>\n</div>","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { ColorChangedEventListener } from \"@/content/events/color-changed.event\";\nimport { skribblTool } from \"@/content/events/tool-changed.event\";\nimport { PipetteTool } from \"@/content/features/drawing-color-tools/pipette-tool\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { TypoDrawTool } from \"@/content/services/tools/draw-tool\";\nimport { ToolsService } from \"@/content/services/tools/tools.service\";\nimport { Color } from \"@/util/color\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { inject } from \"inversify\";\nimport {  filter, map, Subject, type Subscription, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport ColorToolsInfo from \"./drawing-color-tools-info.svelte\";\nimport DrawingColorTools from \"./drawing-color-tools.svelte\";\n\nexport class DrawingColorToolsFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly elementsSetup!: ElementsSetup;\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ColorChangedEventListener) private readonly _colorChangedListener!: ColorChangedEventListener;\n\n  public readonly name = \"Color Tools\";\n  public readonly description = \"Add a pipette and color picker to the toolbar\";\n  public readonly featureId = 31;\n\n  private readonly pipetteHotkey = this.useHotkey(new HotkeyAction(\n    \"activate_pipette\",\n    \"Use Pipette\",\n    \"Activate the pipette tool to select a color from the canvas\",\n    this,\n    () => this.selectPipetteTool(),\n    undefined\n  ));\n\n  private _component?: DrawingColorTools;\n  private _pipetteTool?: TypoDrawTool;\n  private _colorChangeSubscription?: Subscription;\n  private readonly _currentColor$ = new Subject<Color>();\n\n  public override get featureInfoComponent(): componentData<ColorToolsInfo> {\n    return { componentType: ColorToolsInfo, props: {} };\n  }\n\n  protected override async onActivate() {\n    const elements = await this.elementsSetup.complete();\n    this._pipetteTool = this._toolsService.resolveModOrTool(PipetteTool);\n\n    this._colorChangedListener.events$.pipe(\n      withLatestFrom(this._currentColor$),\n      filter(([event, currentColor]) => event.data.hex !== currentColor.hex),\n      map(([event]) => event),\n    ).subscribe((event) => {\n      this._currentColor$.next(event.data);\n    });\n\n    this._component = new DrawingColorTools({\n      target: elements.skribblTools,\n      anchor: elements.skribblBrushTools,\n      props: {\n        feature: this,\n      },\n    });\n  }\n\n  protected override async onDestroy() {\n    this._component?.$destroy();\n    this._component = undefined;\n    this._colorChangeSubscription?.unsubscribe();\n    this._colorChangeSubscription = undefined;\n    this._pipetteTool = undefined;\n  }\n\n  public selectPipetteTool() {\n    if (!this._pipetteTool) {\n      this._logger.error(\"Pipette tool not initialized\");\n      throw new Error(\"Pipette tool not initialized yet\");\n    }\n\n    this._logger.info(\"Pipette tool selected\");\n    this._toolsService.activateTool(this._pipetteTool);\n  }\n\n  public get selectedToolStore() {\n    return fromObservable(this._toolsService.activeTool$, skribblTool.brush);\n  }\n\n  public get colorStore() {\n    return fromObservable(this._currentColor$, new Color(0, 0, 0));\n  }\n\n  public updatePickedColor(color: Color){\n    this._logger.info(\"Color picked\", color);\n    this._drawingService.setColor(color.skribblCode);\n  }\n}","/**\n * Calculate the pressure point\n * The model is a sigmoid function crossing 0,0 and 1,1 with three parameters:\n * @param p pressure from 0-1\n * @param s sensitivity, optimal range 1-20\n * @param b balance, optimal range 0-1\n */\nexport const calculatePressurePoint = (p: number, s: number, b: number) => {\n  const A = 1 / (1 + Math.exp(b * s));\n  const B = 1 / (1 + Math.exp(-s * (p - b)));\n  const C = 1 / (1 + Math.exp(-s * (1 - b)));\n  return (B - A) / (C - A);\n};","import { ConstantDrawMod, type constantDrawModEffect } from \"@/content/services/tools/constant-draw-mod\";\nimport { type drawModLine } from \"@/content/services/tools/draw-mod\";\nimport type { brushStyle } from \"@/content/services/tools/tools.service\";\nimport { calculatePressurePoint } from \"@/util/typo/pressure\";\n\n/**\n * Tool that allows the user to pick a color from the canvas\n * Produces no draw commands, but sets the current color as mod side effect\n */\nexport class PressureMod extends ConstantDrawMod {\n\n  private readonly _maxSize = 40;\n  private readonly _minSize = 4;\n\n  private _sensitivity = 6;\n  private _balance = 0.5;\n\n  /**\n   * Set the brush size depending on the pressure\n   * @param line\n   * @param pressure\n   * @param style\n   * @param eventId\n   * @param strokeId\n   */\n  public async applyConstantEffect(line: drawModLine, pressure: number | undefined, style: brushStyle): Promise<constantDrawModEffect> {\n\n    if(pressure === undefined) {\n      return {\n        style,\n        line,\n      };\n    }\n\n    const point = calculatePressurePoint(pressure, this._sensitivity, this._balance);\n    const size = Math.floor(this._minSize + (this._maxSize - this._minSize) * point);\n    style.size = size;\n\n    return {\n      style,\n      line\n    };\n  }\n\n  /**\n   * Set the sensitivity and balance of the pressure point function\n   * @param sensitivity\n   * @param balance\n   */\n  public setParams(sensitivity: number, balance: number){\n    this._sensitivity = sensitivity;\n    this._balance = balance;\n  }\n}","<script lang=\"ts\">\n\n  import type { DrawingPressureFeature } from \"@/content/features/drawing-pressure/drawing-pressure.feature\";\n  import { calculatePressurePoint } from \"@/util/typo/pressure\";\n\n  export let feature: DrawingPressureFeature;\n\n  const sensitivity = feature.sensitivitySettingStore;\n  const balance = feature.balanceSettingStore;\n  let canvas: HTMLCanvasElement | undefined;\n\n  $: {\n    let s = $sensitivity;\n    let v = $balance;\n\n    const ctx = canvas?.getContext(\"2d\");\n\n    if (ctx) {\n      ctx.imageSmoothingEnabled = false;\n      ctx.clearRect(0, 0, 100, 100);\n      ctx.fillStyle = \"white\";\n      ctx.lineWidth = 2;\n      ctx.fillRect(0, 0, 100, 100);\n\n      ctx.strokeStyle = \"rgb(0, 0, 0)\";\n      ctx.beginPath();\n      for(let x = 0; x < 100; x++) {\n        ctx.lineTo(x, 100 - calculatePressurePoint(x / 100, s, v) * 100);\n      }\n      ctx.stroke();\n    }\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  canvas {\n    border-radius: 3px;\n    width: 10rem;\n  }\n\n</style>\n<div>\n  <p>\n    Typo modifies pressure so that you can use the full brush size range without switching brush sizes in skribbl.<br>\n    Additionally, you can customize the sensitivity of the pen pressure.<br>\n    By default, a performance mode is activated. This mode is recommended for devices with lower performance.<br>\n    To use pressure in combination with the typo brush laboratory, disable performance mode.\n  </p>\n  <br>\n\n  <b>Attention!</b>\n  <p>\n    The performance mode needs \"Pressure Sensitivity\" enabled in the skribbl settings.\n  </p>\n  <br>\n\n  <b>Current sensitivity curve:</b>\n  <p>\n    The sensitivity curve shows how the brush size changes depending on pen pressure.<br>\n    The x-axis represents the pressure (from light to hard), and the y-axis represents the brush size (small to big).\n  </p>\n  <br>\n  <canvas bind:this={canvas} width=\"100\" height=\"100\" />\n</div>","import { BooleanExtensionSetting, NumericExtensionSetting } from \"@/content/core/settings/setting\";\nimport { PressureMod } from \"@/content/features/drawing-pressure/pressure-mod\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToolsService } from \"@/content/services/tools/tools.service\";\nimport { calculatePressurePoint } from \"@/util/typo/pressure\";\nimport { inject } from \"inversify\";\nimport { combineLatestWith, type Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport DrawingPressureInfo from \"./drawing-pressure-info.svelte\";\n\nexport class DrawingPressureFeature extends TypoFeature {\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n\n  public readonly name = \"Modified Pen Pressure\";\n  public readonly description = \"Use the full size range and custom sensitivity for pen pressure\";\n  public readonly featureId = 37;\n\n  private _performanceEnabledSubscription?: Subscription;\n\n  public override get featureInfoComponent(): componentData<DrawingPressureInfo>{\n    return { componentType: DrawingPressureInfo, props: { feature: this }};\n  }\n\n  private readonly _performanceEnabledSetting = this.useSetting(\n    new BooleanExtensionSetting(\"pressure_performance\", true, this)\n      .withName(\"Performance Mode\")\n      .withDescription(\"Better pressure support for less performant devices, but can't be used in combination with the brush laboratory.\")\n  );\n\n  private readonly _pressureParamSensitivitySetting = this.useSetting(\n    new NumericExtensionSetting(\"pressure_sensitivity\", 6, this)\n      .withName(\"Pressure Sensitivity\")\n      .withDescription(\"The sensitivity of pressure change. A higher value means a more dense pressure range.\")\n      .withBounds(1, 20)\n      .withSlider(1)\n  );\n\n  private readonly _pressureParamBalanceSetting = this.useSetting(\n    new NumericExtensionSetting(\"pressure_balance\", 0.5, this)\n      .withName(\"Pressure Balance\")\n      .withDescription(\"The balance of pressure increase. A higher value moves the size range to a higher pressure range.\")\n      .withBounds(0, 1)\n      .withSlider(1/20)\n  );\n\n  private _pressureMod?: PressureMod;\n\n  protected override async onActivate() {\n\n    this._performanceEnabledSubscription = this._performanceEnabledSetting.changes$.pipe(\n      combineLatestWith(this._pressureParamSensitivitySetting.changes$, this._pressureParamBalanceSetting.changes$)\n    ).subscribe(async ([performanceMode, sensitivity, balance]) => {\n      if(performanceMode){\n        if(this._pressureMod) {\n          this._toolsService.removeMod(this._pressureMod);\n          this._pressureMod = undefined;\n        }\n\n        document.documentElement.dataset[\"typo_pressure_performance\"] = this.getPerformanceFunctionEval(sensitivity, balance);\n      }\n      else {\n        if(!this._pressureMod){\n          this._pressureMod = this._toolsService.resolveModOrTool(PressureMod);\n          this._toolsService.activateMod(this._pressureMod);\n        }\n        this._pressureMod.setParams(sensitivity, balance);\n\n        document.documentElement.dataset[\"typo_pressure_performance\"] = \"\";\n      }\n    });\n  }\n\n  /**\n   * An eval function which is used by tha game patch to calculate the typo pressure\n   * Probably not the most performant option (ironic), but good enough & prevents duplicating the function.\n   * @param s\n   * @param b\n   * @private\n   */\n  private getPerformanceFunctionEval(s: number, b: number){\n    return `(pressure) => (${calculatePressurePoint.toString()})(pressure, ${s}, ${b})`;\n  }\n\n  protected override async onDestroy() {\n    if(this._pressureMod){\n      this._toolsService.removeMod(this._pressureMod);\n      this._pressureMod = undefined;\n    }\n\n    document.documentElement.dataset[\"typo_pressure_performance\"] = \"\";\n\n    this._performanceEnabledSubscription?.unsubscribe();\n    this._performanceEnabledSubscription = undefined;\n  }\n\n  public get balanceSettingStore(){\n    return this._pressureParamBalanceSetting.store;\n  }\n\n  public get sensitivitySettingStore(){\n    return this._pressureParamSensitivitySetting.store;\n  }\n}","/* THIS (.ts) FILE IS GENERATED BY TypedSignalR.Client.TypeScript */\n/* eslint-disable */\n/* tslint:disable */\n// @ts-nocheck\nimport type { HubConnection, IStreamResult, Subject } from '@microsoft/signalr';\nimport type { IGuildLobbiesHub, ILobbyHub, IOnlineItemsHub, IGuildLobbiesReceiver, ILobbyReceiver, IOnlineItemsReceiver } from './tobeh.Avallone.Server.Hubs.Interfaces';\nimport type { GuildLobbiesUpdatedDto, LobbyDiscoveredDto, TypoLobbyStateDto, SkribblLobbyStateDto, SkribblLobbyTypoSettingsUpdateDto, DropClaimDto, DropClaimResultDto, AwardGiftDto, TypoLobbySettingsDto, DropAnnouncementDto, AwardGiftedDto, DropClearDto, OnlineItemsUpdatedDto } from '../tobeh.Avallone.Server.Classes.Dto';\n\n\n// components\n\nexport type Disposable = {\n    dispose(): void;\n}\n\nexport type HubProxyFactory<T> = {\n    createHubProxy(connection: HubConnection): T;\n}\n\nexport type ReceiverRegister<T> = {\n    register(connection: HubConnection, receiver: T): Disposable;\n}\n\ntype ReceiverMethod = {\n    methodName: string,\n    method: (...args: any[]) => void\n}\n\nclass ReceiverMethodSubscription implements Disposable {\n\n    public constructor(\n        private connection: HubConnection,\n        private receiverMethod: ReceiverMethod[]) {\n    }\n\n    public readonly dispose = () => {\n        for (const it of this.receiverMethod) {\n            this.connection.off(it.methodName, it.method);\n        }\n    }\n}\n\n// API\n\nexport type HubProxyFactoryProvider = {\n    (hubType: \"IGuildLobbiesHub\"): HubProxyFactory<IGuildLobbiesHub>;\n    (hubType: \"ILobbyHub\"): HubProxyFactory<ILobbyHub>;\n    (hubType: \"IOnlineItemsHub\"): HubProxyFactory<IOnlineItemsHub>;\n}\n\nexport const getHubProxyFactory = ((hubType: string) => {\n    if(hubType === \"IGuildLobbiesHub\") {\n        return IGuildLobbiesHub_HubProxyFactory.Instance;\n    }\n    if(hubType === \"ILobbyHub\") {\n        return ILobbyHub_HubProxyFactory.Instance;\n    }\n    if(hubType === \"IOnlineItemsHub\") {\n        return IOnlineItemsHub_HubProxyFactory.Instance;\n    }\n}) as HubProxyFactoryProvider;\n\nexport type ReceiverRegisterProvider = {\n    (receiverType: \"IGuildLobbiesReceiver\"): ReceiverRegister<IGuildLobbiesReceiver>;\n    (receiverType: \"ILobbyReceiver\"): ReceiverRegister<ILobbyReceiver>;\n    (receiverType: \"IOnlineItemsReceiver\"): ReceiverRegister<IOnlineItemsReceiver>;\n}\n\nexport const getReceiverRegister = ((receiverType: string) => {\n    if(receiverType === \"IGuildLobbiesReceiver\") {\n        return IGuildLobbiesReceiver_Binder.Instance;\n    }\n    if(receiverType === \"ILobbyReceiver\") {\n        return ILobbyReceiver_Binder.Instance;\n    }\n    if(receiverType === \"IOnlineItemsReceiver\") {\n        return IOnlineItemsReceiver_Binder.Instance;\n    }\n}) as ReceiverRegisterProvider;\n\n// HubProxy\n\nclass IGuildLobbiesHub_HubProxyFactory implements HubProxyFactory<IGuildLobbiesHub> {\n    public static Instance = new IGuildLobbiesHub_HubProxyFactory();\n\n    private constructor() {\n    }\n\n    public readonly createHubProxy = (connection: HubConnection): IGuildLobbiesHub => {\n        return new IGuildLobbiesHub_HubProxy(connection);\n    }\n}\n\nclass IGuildLobbiesHub_HubProxy implements IGuildLobbiesHub {\n\n    public constructor(private connection: HubConnection) {\n    }\n\n    public readonly subscribeGuildLobbies = async (guildId: string): Promise<GuildLobbiesUpdatedDto> => {\n        return await this.connection.invoke(\"SubscribeGuildLobbies\", guildId);\n    }\n}\n\nclass ILobbyHub_HubProxyFactory implements HubProxyFactory<ILobbyHub> {\n    public static Instance = new ILobbyHub_HubProxyFactory();\n\n    private constructor() {\n    }\n\n    public readonly createHubProxy = (connection: HubConnection): ILobbyHub => {\n        return new ILobbyHub_HubProxy(connection);\n    }\n}\n\nclass ILobbyHub_HubProxy implements ILobbyHub {\n\n    public constructor(private connection: HubConnection) {\n    }\n\n    public readonly lobbyDiscovered = async (lobbyDiscovery: LobbyDiscoveredDto): Promise<TypoLobbyStateDto> => {\n        return await this.connection.invoke(\"LobbyDiscovered\", lobbyDiscovery);\n    }\n\n    public readonly claimLobbyOwnership = async (): Promise<void> => {\n        return await this.connection.invoke(\"ClaimLobbyOwnership\");\n    }\n\n    public readonly updateSkribblLobbyState = async (state: SkribblLobbyStateDto): Promise<void> => {\n        return await this.connection.invoke(\"UpdateSkribblLobbyState\", state);\n    }\n\n    public readonly updateTypoLobbySettings = async (typoSettings: SkribblLobbyTypoSettingsUpdateDto): Promise<void> => {\n        return await this.connection.invoke(\"UpdateTypoLobbySettings\", typoSettings);\n    }\n\n    public readonly claimDrop = async (dropClaim: DropClaimDto): Promise<DropClaimResultDto> => {\n        return await this.connection.invoke(\"ClaimDrop\", dropClaim);\n    }\n\n    public readonly giftAward = async (awardGift: AwardGiftDto): Promise<void> => {\n        return await this.connection.invoke(\"GiftAward\", awardGift);\n    }\n}\n\nclass IOnlineItemsHub_HubProxyFactory implements HubProxyFactory<IOnlineItemsHub> {\n    public static Instance = new IOnlineItemsHub_HubProxyFactory();\n\n    private constructor() {\n    }\n\n    public readonly createHubProxy = (connection: HubConnection): IOnlineItemsHub => {\n        return new IOnlineItemsHub_HubProxy(connection);\n    }\n}\n\nclass IOnlineItemsHub_HubProxy implements IOnlineItemsHub {\n\n    public constructor(private connection: HubConnection) {\n    }\n}\n\n\n// Receiver\n\nclass IGuildLobbiesReceiver_Binder implements ReceiverRegister<IGuildLobbiesReceiver> {\n\n    public static Instance = new IGuildLobbiesReceiver_Binder();\n\n    private constructor() {\n    }\n\n    public readonly register = (connection: HubConnection, receiver: IGuildLobbiesReceiver): Disposable => {\n\n        const __guildLobbiesUpdated = (...args: [GuildLobbiesUpdatedDto]) => receiver.guildLobbiesUpdated(...args);\n\n        connection.on(\"GuildLobbiesUpdated\", __guildLobbiesUpdated);\n\n        const methodList: ReceiverMethod[] = [\n            { methodName: \"GuildLobbiesUpdated\", method: __guildLobbiesUpdated }\n        ]\n\n        return new ReceiverMethodSubscription(connection, methodList);\n    }\n}\n\nclass ILobbyReceiver_Binder implements ReceiverRegister<ILobbyReceiver> {\n\n    public static Instance = new ILobbyReceiver_Binder();\n\n    private constructor() {\n    }\n\n    public readonly register = (connection: HubConnection, receiver: ILobbyReceiver): Disposable => {\n\n        const __typoLobbySettingsUpdated = (...args: [TypoLobbySettingsDto]) => receiver.typoLobbySettingsUpdated(...args);\n        const __lobbyOwnershipResigned = () => receiver.lobbyOwnershipResigned();\n        const __dropAnnounced = (...args: [DropAnnouncementDto]) => receiver.dropAnnounced(...args);\n        const __awardGifted = (...args: [AwardGiftedDto]) => receiver.awardGifted(...args);\n        const __dropClaimed = (...args: [DropClaimResultDto]) => receiver.dropClaimed(...args);\n        const __dropCleared = (...args: [DropClearDto]) => receiver.dropCleared(...args);\n\n        connection.on(\"TypoLobbySettingsUpdated\", __typoLobbySettingsUpdated);\n        connection.on(\"LobbyOwnershipResigned\", __lobbyOwnershipResigned);\n        connection.on(\"DropAnnounced\", __dropAnnounced);\n        connection.on(\"AwardGifted\", __awardGifted);\n        connection.on(\"DropClaimed\", __dropClaimed);\n        connection.on(\"DropCleared\", __dropCleared);\n\n        const methodList: ReceiverMethod[] = [\n            { methodName: \"TypoLobbySettingsUpdated\", method: __typoLobbySettingsUpdated },\n            { methodName: \"LobbyOwnershipResigned\", method: __lobbyOwnershipResigned },\n            { methodName: \"DropAnnounced\", method: __dropAnnounced },\n            { methodName: \"AwardGifted\", method: __awardGifted },\n            { methodName: \"DropClaimed\", method: __dropClaimed },\n            { methodName: \"DropCleared\", method: __dropCleared }\n        ]\n\n        return new ReceiverMethodSubscription(connection, methodList);\n    }\n}\n\nclass IOnlineItemsReceiver_Binder implements ReceiverRegister<IOnlineItemsReceiver> {\n\n    public static Instance = new IOnlineItemsReceiver_Binder();\n\n    private constructor() {\n    }\n\n    public readonly register = (connection: HubConnection, receiver: IOnlineItemsReceiver): Disposable => {\n\n        const __onlineItemsUpdated = (...args: [OnlineItemsUpdatedDto]) => receiver.onlineItemsUpdated(...args);\n\n        connection.on(\"OnlineItemsUpdated\", __onlineItemsUpdated);\n\n        const methodList: ReceiverMethod[] = [\n            { methodName: \"OnlineItemsUpdated\", method: __onlineItemsUpdated }\n        ]\n\n        return new ReceiverMethodSubscription(connection, methodList);\n    }\n}\n\n","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** Error thrown when an HTTP request fails. */\r\nexport class HttpError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.HttpError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     * @param {number} statusCode The HTTP status code represented by this error.\r\n     */\r\n    constructor(errorMessage, statusCode) {\r\n        const trueProto = new.target.prototype;\r\n        super(`${errorMessage}: Status code '${statusCode}'`);\r\n        this.statusCode = statusCode;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when a timeout elapses. */\r\nexport class TimeoutError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.TimeoutError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     */\r\n    constructor(errorMessage = \"A timeout occurred.\") {\r\n        const trueProto = new.target.prototype;\r\n        super(errorMessage);\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when an action is aborted. */\r\nexport class AbortError extends Error {\r\n    /** Constructs a new instance of {@link AbortError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     */\r\n    constructor(errorMessage = \"An abort occurred.\") {\r\n        const trueProto = new.target.prototype;\r\n        super(errorMessage);\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the selected transport is unsupported by the browser. */\r\n/** @private */\r\nexport class UnsupportedTransportError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.UnsupportedTransportError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n     */\r\n    constructor(message, transport) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.transport = transport;\r\n        this.errorType = 'UnsupportedTransportError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the selected transport is disabled by the browser. */\r\n/** @private */\r\nexport class DisabledTransportError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.DisabledTransportError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n     */\r\n    constructor(message, transport) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.transport = transport;\r\n        this.errorType = 'DisabledTransportError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the selected transport cannot be started. */\r\n/** @private */\r\nexport class FailedToStartTransportError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.FailedToStartTransportError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n     */\r\n    constructor(message, transport) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.transport = transport;\r\n        this.errorType = 'FailedToStartTransportError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the negotiation with the server failed to complete. */\r\n/** @private */\r\nexport class FailedToNegotiateWithServerError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.FailedToNegotiateWithServerError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     */\r\n    constructor(message) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.errorType = 'FailedToNegotiateWithServerError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when multiple errors have occurred. */\r\n/** @private */\r\nexport class AggregateErrors extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.AggregateErrors}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {Error[]} innerErrors The collection of errors this error is aggregating.\r\n     */\r\n    constructor(message, innerErrors) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.innerErrors = innerErrors;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n//# sourceMappingURL=Errors.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** Represents an HTTP response. */\r\nexport class HttpResponse {\r\n    constructor(statusCode, statusText, content) {\r\n        this.statusCode = statusCode;\r\n        this.statusText = statusText;\r\n        this.content = content;\r\n    }\r\n}\r\n/** Abstraction over an HTTP client.\r\n *\r\n * This class provides an abstraction over an HTTP client so that a different implementation can be provided on different platforms.\r\n */\r\nexport class HttpClient {\r\n    get(url, options) {\r\n        return this.send({\r\n            ...options,\r\n            method: \"GET\",\r\n            url,\r\n        });\r\n    }\r\n    post(url, options) {\r\n        return this.send({\r\n            ...options,\r\n            method: \"POST\",\r\n            url,\r\n        });\r\n    }\r\n    delete(url, options) {\r\n        return this.send({\r\n            ...options,\r\n            method: \"DELETE\",\r\n            url,\r\n        });\r\n    }\r\n    /** Gets all cookies that apply to the specified URL.\r\n     *\r\n     * @param url The URL that the cookies are valid for.\r\n     * @returns {string} A string containing all the key-value cookie pairs for the specified URL.\r\n     */\r\n    // @ts-ignore\r\n    getCookieString(url) {\r\n        return \"\";\r\n    }\r\n}\r\n//# sourceMappingURL=HttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// These values are designed to match the ASP.NET Log Levels since that's the pattern we're emulating here.\r\n/** Indicates the severity of a log message.\r\n *\r\n * Log Levels are ordered in increasing severity. So `Debug` is more severe than `Trace`, etc.\r\n */\r\nexport var LogLevel;\r\n(function (LogLevel) {\r\n    /** Log level for very low severity diagnostic messages. */\r\n    LogLevel[LogLevel[\"Trace\"] = 0] = \"Trace\";\r\n    /** Log level for low severity diagnostic messages. */\r\n    LogLevel[LogLevel[\"Debug\"] = 1] = \"Debug\";\r\n    /** Log level for informational diagnostic messages. */\r\n    LogLevel[LogLevel[\"Information\"] = 2] = \"Information\";\r\n    /** Log level for diagnostic messages that indicate a non-fatal problem. */\r\n    LogLevel[LogLevel[\"Warning\"] = 3] = \"Warning\";\r\n    /** Log level for diagnostic messages that indicate a failure in the current operation. */\r\n    LogLevel[LogLevel[\"Error\"] = 4] = \"Error\";\r\n    /** Log level for diagnostic messages that indicate a failure that will terminate the entire application. */\r\n    LogLevel[LogLevel[\"Critical\"] = 5] = \"Critical\";\r\n    /** The highest possible log level. Used when configuring logging to indicate that no log messages should be emitted. */\r\n    LogLevel[LogLevel[\"None\"] = 6] = \"None\";\r\n})(LogLevel || (LogLevel = {}));\r\n//# sourceMappingURL=ILogger.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** A logger that does nothing when log messages are sent to it. */\r\nexport class NullLogger {\r\n    constructor() { }\r\n    /** @inheritDoc */\r\n    // eslint-disable-next-line\r\n    log(_logLevel, _message) {\r\n    }\r\n}\r\n/** The singleton instance of the {@link @microsoft/signalr.NullLogger}. */\r\nNullLogger.instance = new NullLogger();\r\n//# sourceMappingURL=Loggers.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { NullLogger } from \"./Loggers\";\r\n// Version token that will be replaced by the prepack command\r\n/** The version of the SignalR client. */\r\nexport const VERSION = \"8.0.7\";\r\n/** @private */\r\nexport class Arg {\r\n    static isRequired(val, name) {\r\n        if (val === null || val === undefined) {\r\n            throw new Error(`The '${name}' argument is required.`);\r\n        }\r\n    }\r\n    static isNotEmpty(val, name) {\r\n        if (!val || val.match(/^\\s*$/)) {\r\n            throw new Error(`The '${name}' argument should not be empty.`);\r\n        }\r\n    }\r\n    static isIn(val, values, name) {\r\n        // TypeScript enums have keys for **both** the name and the value of each enum member on the type itself.\r\n        if (!(val in values)) {\r\n            throw new Error(`Unknown ${name} value: ${val}.`);\r\n        }\r\n    }\r\n}\r\n/** @private */\r\nexport class Platform {\r\n    // react-native has a window but no document so we should check both\r\n    static get isBrowser() {\r\n        return !Platform.isNode && typeof window === \"object\" && typeof window.document === \"object\";\r\n    }\r\n    // WebWorkers don't have a window object so the isBrowser check would fail\r\n    static get isWebWorker() {\r\n        return !Platform.isNode && typeof self === \"object\" && \"importScripts\" in self;\r\n    }\r\n    // react-native has a window but no document\r\n    static get isReactNative() {\r\n        return !Platform.isNode && typeof window === \"object\" && typeof window.document === \"undefined\";\r\n    }\r\n    // Node apps shouldn't have a window object, but WebWorkers don't either\r\n    // so we need to check for both WebWorker and window\r\n    static get isNode() {\r\n        return typeof process !== \"undefined\" && process.release && process.release.name === \"node\";\r\n    }\r\n}\r\n/** @private */\r\nexport function getDataDetail(data, includeContent) {\r\n    let detail = \"\";\r\n    if (isArrayBuffer(data)) {\r\n        detail = `Binary data of length ${data.byteLength}`;\r\n        if (includeContent) {\r\n            detail += `. Content: '${formatArrayBuffer(data)}'`;\r\n        }\r\n    }\r\n    else if (typeof data === \"string\") {\r\n        detail = `String data of length ${data.length}`;\r\n        if (includeContent) {\r\n            detail += `. Content: '${data}'`;\r\n        }\r\n    }\r\n    return detail;\r\n}\r\n/** @private */\r\nexport function formatArrayBuffer(data) {\r\n    const view = new Uint8Array(data);\r\n    // Uint8Array.map only supports returning another Uint8Array?\r\n    let str = \"\";\r\n    view.forEach((num) => {\r\n        const pad = num < 16 ? \"0\" : \"\";\r\n        str += `0x${pad}${num.toString(16)} `;\r\n    });\r\n    // Trim of trailing space.\r\n    return str.substr(0, str.length - 1);\r\n}\r\n// Also in signalr-protocol-msgpack/Utils.ts\r\n/** @private */\r\nexport function isArrayBuffer(val) {\r\n    return val && typeof ArrayBuffer !== \"undefined\" &&\r\n        (val instanceof ArrayBuffer ||\r\n            // Sometimes we get an ArrayBuffer that doesn't satisfy instanceof\r\n            (val.constructor && val.constructor.name === \"ArrayBuffer\"));\r\n}\r\n/** @private */\r\nexport async function sendMessage(logger, transportName, httpClient, url, content, options) {\r\n    const headers = {};\r\n    const [name, value] = getUserAgentHeader();\r\n    headers[name] = value;\r\n    logger.log(LogLevel.Trace, `(${transportName} transport) sending data. ${getDataDetail(content, options.logMessageContent)}.`);\r\n    const responseType = isArrayBuffer(content) ? \"arraybuffer\" : \"text\";\r\n    const response = await httpClient.post(url, {\r\n        content,\r\n        headers: { ...headers, ...options.headers },\r\n        responseType,\r\n        timeout: options.timeout,\r\n        withCredentials: options.withCredentials,\r\n    });\r\n    logger.log(LogLevel.Trace, `(${transportName} transport) request complete. Response status: ${response.statusCode}.`);\r\n}\r\n/** @private */\r\nexport function createLogger(logger) {\r\n    if (logger === undefined) {\r\n        return new ConsoleLogger(LogLevel.Information);\r\n    }\r\n    if (logger === null) {\r\n        return NullLogger.instance;\r\n    }\r\n    if (logger.log !== undefined) {\r\n        return logger;\r\n    }\r\n    return new ConsoleLogger(logger);\r\n}\r\n/** @private */\r\nexport class SubjectSubscription {\r\n    constructor(subject, observer) {\r\n        this._subject = subject;\r\n        this._observer = observer;\r\n    }\r\n    dispose() {\r\n        const index = this._subject.observers.indexOf(this._observer);\r\n        if (index > -1) {\r\n            this._subject.observers.splice(index, 1);\r\n        }\r\n        if (this._subject.observers.length === 0 && this._subject.cancelCallback) {\r\n            this._subject.cancelCallback().catch((_) => { });\r\n        }\r\n    }\r\n}\r\n/** @private */\r\nexport class ConsoleLogger {\r\n    constructor(minimumLogLevel) {\r\n        this._minLevel = minimumLogLevel;\r\n        this.out = console;\r\n    }\r\n    log(logLevel, message) {\r\n        if (logLevel >= this._minLevel) {\r\n            const msg = `[${new Date().toISOString()}] ${LogLevel[logLevel]}: ${message}`;\r\n            switch (logLevel) {\r\n                case LogLevel.Critical:\r\n                case LogLevel.Error:\r\n                    this.out.error(msg);\r\n                    break;\r\n                case LogLevel.Warning:\r\n                    this.out.warn(msg);\r\n                    break;\r\n                case LogLevel.Information:\r\n                    this.out.info(msg);\r\n                    break;\r\n                default:\r\n                    // console.debug only goes to attached debuggers in Node, so we use console.log for Trace and Debug\r\n                    this.out.log(msg);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\n/** @private */\r\nexport function getUserAgentHeader() {\r\n    let userAgentHeaderName = \"X-SignalR-User-Agent\";\r\n    if (Platform.isNode) {\r\n        userAgentHeaderName = \"User-Agent\";\r\n    }\r\n    return [userAgentHeaderName, constructUserAgent(VERSION, getOsName(), getRuntime(), getRuntimeVersion())];\r\n}\r\n/** @private */\r\nexport function constructUserAgent(version, os, runtime, runtimeVersion) {\r\n    // Microsoft SignalR/[Version] ([Detailed Version]; [Operating System]; [Runtime]; [Runtime Version])\r\n    let userAgent = \"Microsoft SignalR/\";\r\n    const majorAndMinor = version.split(\".\");\r\n    userAgent += `${majorAndMinor[0]}.${majorAndMinor[1]}`;\r\n    userAgent += ` (${version}; `;\r\n    if (os && os !== \"\") {\r\n        userAgent += `${os}; `;\r\n    }\r\n    else {\r\n        userAgent += \"Unknown OS; \";\r\n    }\r\n    userAgent += `${runtime}`;\r\n    if (runtimeVersion) {\r\n        userAgent += `; ${runtimeVersion}`;\r\n    }\r\n    else {\r\n        userAgent += \"; Unknown Runtime Version\";\r\n    }\r\n    userAgent += \")\";\r\n    return userAgent;\r\n}\r\n// eslint-disable-next-line spaced-comment\r\n/*#__PURE__*/ function getOsName() {\r\n    if (Platform.isNode) {\r\n        switch (process.platform) {\r\n            case \"win32\":\r\n                return \"Windows NT\";\r\n            case \"darwin\":\r\n                return \"macOS\";\r\n            case \"linux\":\r\n                return \"Linux\";\r\n            default:\r\n                return process.platform;\r\n        }\r\n    }\r\n    else {\r\n        return \"\";\r\n    }\r\n}\r\n// eslint-disable-next-line spaced-comment\r\n/*#__PURE__*/ function getRuntimeVersion() {\r\n    if (Platform.isNode) {\r\n        return process.versions.node;\r\n    }\r\n    return undefined;\r\n}\r\nfunction getRuntime() {\r\n    if (Platform.isNode) {\r\n        return \"NodeJS\";\r\n    }\r\n    else {\r\n        return \"Browser\";\r\n    }\r\n}\r\n/** @private */\r\nexport function getErrorString(e) {\r\n    if (e.stack) {\r\n        return e.stack;\r\n    }\r\n    else if (e.message) {\r\n        return e.message;\r\n    }\r\n    return `${e}`;\r\n}\r\n/** @private */\r\nexport function getGlobalThis() {\r\n    // globalThis is semi-new and not available in Node until v12\r\n    if (typeof globalThis !== \"undefined\") {\r\n        return globalThis;\r\n    }\r\n    if (typeof self !== \"undefined\") {\r\n        return self;\r\n    }\r\n    if (typeof window !== \"undefined\") {\r\n        return window;\r\n    }\r\n    if (typeof global !== \"undefined\") {\r\n        return global;\r\n    }\r\n    throw new Error(\"could not find global\");\r\n}\r\n//# sourceMappingURL=Utils.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\r\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { Platform, getGlobalThis, isArrayBuffer } from \"./Utils\";\r\nexport class FetchHttpClient extends HttpClient {\r\n    constructor(logger) {\r\n        super();\r\n        this._logger = logger;\r\n        // Node added a fetch implementation to the global scope starting in v18.\r\n        // We need to add a cookie jar in node to be able to share cookies with WebSocket\r\n        if (typeof fetch === \"undefined\" || Platform.isNode) {\r\n            // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n            // @ts-ignore: TS doesn't know about these names\r\n            const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n            // Cookies aren't automatically handled in Node so we need to add a CookieJar to preserve cookies across requests\r\n            this._jar = new (requireFunc(\"tough-cookie\")).CookieJar();\r\n            if (typeof fetch === \"undefined\") {\r\n                this._fetchType = requireFunc(\"node-fetch\");\r\n            }\r\n            else {\r\n                // Use fetch from Node if available\r\n                this._fetchType = fetch;\r\n            }\r\n            // node-fetch doesn't have a nice API for getting and setting cookies\r\n            // fetch-cookie will wrap a fetch implementation with a default CookieJar or a provided one\r\n            this._fetchType = requireFunc(\"fetch-cookie\")(this._fetchType, this._jar);\r\n        }\r\n        else {\r\n            this._fetchType = fetch.bind(getGlobalThis());\r\n        }\r\n        if (typeof AbortController === \"undefined\") {\r\n            // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n            // @ts-ignore: TS doesn't know about these names\r\n            const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n            // Node needs EventListener methods on AbortController which our custom polyfill doesn't provide\r\n            this._abortControllerType = requireFunc(\"abort-controller\");\r\n        }\r\n        else {\r\n            this._abortControllerType = AbortController;\r\n        }\r\n    }\r\n    /** @inheritDoc */\r\n    async send(request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            throw new AbortError();\r\n        }\r\n        if (!request.method) {\r\n            throw new Error(\"No method defined.\");\r\n        }\r\n        if (!request.url) {\r\n            throw new Error(\"No url defined.\");\r\n        }\r\n        const abortController = new this._abortControllerType();\r\n        let error;\r\n        // Hook our abortSignal into the abort controller\r\n        if (request.abortSignal) {\r\n            request.abortSignal.onabort = () => {\r\n                abortController.abort();\r\n                error = new AbortError();\r\n            };\r\n        }\r\n        // If a timeout has been passed in, setup a timeout to call abort\r\n        // Type needs to be any to fit window.setTimeout and NodeJS.setTimeout\r\n        let timeoutId = null;\r\n        if (request.timeout) {\r\n            const msTimeout = request.timeout;\r\n            timeoutId = setTimeout(() => {\r\n                abortController.abort();\r\n                this._logger.log(LogLevel.Warning, `Timeout from HTTP request.`);\r\n                error = new TimeoutError();\r\n            }, msTimeout);\r\n        }\r\n        if (request.content === \"\") {\r\n            request.content = undefined;\r\n        }\r\n        if (request.content) {\r\n            // Explicitly setting the Content-Type header for React Native on Android platform.\r\n            request.headers = request.headers || {};\r\n            if (isArrayBuffer(request.content)) {\r\n                request.headers[\"Content-Type\"] = \"application/octet-stream\";\r\n            }\r\n            else {\r\n                request.headers[\"Content-Type\"] = \"text/plain;charset=UTF-8\";\r\n            }\r\n        }\r\n        let response;\r\n        try {\r\n            response = await this._fetchType(request.url, {\r\n                body: request.content,\r\n                cache: \"no-cache\",\r\n                credentials: request.withCredentials === true ? \"include\" : \"same-origin\",\r\n                headers: {\r\n                    \"X-Requested-With\": \"XMLHttpRequest\",\r\n                    ...request.headers,\r\n                },\r\n                method: request.method,\r\n                mode: \"cors\",\r\n                redirect: \"follow\",\r\n                signal: abortController.signal,\r\n            });\r\n        }\r\n        catch (e) {\r\n            if (error) {\r\n                throw error;\r\n            }\r\n            this._logger.log(LogLevel.Warning, `Error from HTTP request. ${e}.`);\r\n            throw e;\r\n        }\r\n        finally {\r\n            if (timeoutId) {\r\n                clearTimeout(timeoutId);\r\n            }\r\n            if (request.abortSignal) {\r\n                request.abortSignal.onabort = null;\r\n            }\r\n        }\r\n        if (!response.ok) {\r\n            const errorMessage = await deserializeContent(response, \"text\");\r\n            throw new HttpError(errorMessage || response.statusText, response.status);\r\n        }\r\n        const content = deserializeContent(response, request.responseType);\r\n        const payload = await content;\r\n        return new HttpResponse(response.status, response.statusText, payload);\r\n    }\r\n    getCookieString(url) {\r\n        let cookies = \"\";\r\n        if (Platform.isNode && this._jar) {\r\n            // @ts-ignore: unused variable\r\n            this._jar.getCookies(url, (e, c) => cookies = c.join(\"; \"));\r\n        }\r\n        return cookies;\r\n    }\r\n}\r\nfunction deserializeContent(response, responseType) {\r\n    let content;\r\n    switch (responseType) {\r\n        case \"arraybuffer\":\r\n            content = response.arrayBuffer();\r\n            break;\r\n        case \"text\":\r\n            content = response.text();\r\n            break;\r\n        case \"blob\":\r\n        case \"document\":\r\n        case \"json\":\r\n            throw new Error(`${responseType} is not supported.`);\r\n        default:\r\n            content = response.text();\r\n            break;\r\n    }\r\n    return content;\r\n}\r\n//# sourceMappingURL=FetchHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\r\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\nexport class XhrHttpClient extends HttpClient {\r\n    constructor(logger) {\r\n        super();\r\n        this._logger = logger;\r\n    }\r\n    /** @inheritDoc */\r\n    send(request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            return Promise.reject(new AbortError());\r\n        }\r\n        if (!request.method) {\r\n            return Promise.reject(new Error(\"No method defined.\"));\r\n        }\r\n        if (!request.url) {\r\n            return Promise.reject(new Error(\"No url defined.\"));\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.open(request.method, request.url, true);\r\n            xhr.withCredentials = request.withCredentials === undefined ? true : request.withCredentials;\r\n            xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n            if (request.content === \"\") {\r\n                request.content = undefined;\r\n            }\r\n            if (request.content) {\r\n                // Explicitly setting the Content-Type header for React Native on Android platform.\r\n                if (isArrayBuffer(request.content)) {\r\n                    xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\r\n                }\r\n                else {\r\n                    xhr.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\r\n                }\r\n            }\r\n            const headers = request.headers;\r\n            if (headers) {\r\n                Object.keys(headers)\r\n                    .forEach((header) => {\r\n                    xhr.setRequestHeader(header, headers[header]);\r\n                });\r\n            }\r\n            if (request.responseType) {\r\n                xhr.responseType = request.responseType;\r\n            }\r\n            if (request.abortSignal) {\r\n                request.abortSignal.onabort = () => {\r\n                    xhr.abort();\r\n                    reject(new AbortError());\r\n                };\r\n            }\r\n            if (request.timeout) {\r\n                xhr.timeout = request.timeout;\r\n            }\r\n            xhr.onload = () => {\r\n                if (request.abortSignal) {\r\n                    request.abortSignal.onabort = null;\r\n                }\r\n                if (xhr.status >= 200 && xhr.status < 300) {\r\n                    resolve(new HttpResponse(xhr.status, xhr.statusText, xhr.response || xhr.responseText));\r\n                }\r\n                else {\r\n                    reject(new HttpError(xhr.response || xhr.responseText || xhr.statusText, xhr.status));\r\n                }\r\n            };\r\n            xhr.onerror = () => {\r\n                this._logger.log(LogLevel.Warning, `Error from HTTP request. ${xhr.status}: ${xhr.statusText}.`);\r\n                reject(new HttpError(xhr.statusText, xhr.status));\r\n            };\r\n            xhr.ontimeout = () => {\r\n                this._logger.log(LogLevel.Warning, `Timeout from HTTP request.`);\r\n                reject(new TimeoutError());\r\n            };\r\n            xhr.send(request.content);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=XhrHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortError } from \"./Errors\";\r\nimport { FetchHttpClient } from \"./FetchHttpClient\";\r\nimport { HttpClient } from \"./HttpClient\";\r\nimport { Platform } from \"./Utils\";\r\nimport { XhrHttpClient } from \"./XhrHttpClient\";\r\n/** Default implementation of {@link @microsoft/signalr.HttpClient}. */\r\nexport class DefaultHttpClient extends HttpClient {\r\n    /** Creates a new instance of the {@link @microsoft/signalr.DefaultHttpClient}, using the provided {@link @microsoft/signalr.ILogger} to log messages. */\r\n    constructor(logger) {\r\n        super();\r\n        if (typeof fetch !== \"undefined\" || Platform.isNode) {\r\n            this._httpClient = new FetchHttpClient(logger);\r\n        }\r\n        else if (typeof XMLHttpRequest !== \"undefined\") {\r\n            this._httpClient = new XhrHttpClient(logger);\r\n        }\r\n        else {\r\n            throw new Error(\"No usable HttpClient found.\");\r\n        }\r\n    }\r\n    /** @inheritDoc */\r\n    send(request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            return Promise.reject(new AbortError());\r\n        }\r\n        if (!request.method) {\r\n            return Promise.reject(new Error(\"No method defined.\"));\r\n        }\r\n        if (!request.url) {\r\n            return Promise.reject(new Error(\"No url defined.\"));\r\n        }\r\n        return this._httpClient.send(request);\r\n    }\r\n    getCookieString(url) {\r\n        return this._httpClient.getCookieString(url);\r\n    }\r\n}\r\n//# sourceMappingURL=DefaultHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// Not exported from index\r\n/** @private */\r\nexport class TextMessageFormat {\r\n    static write(output) {\r\n        return `${output}${TextMessageFormat.RecordSeparator}`;\r\n    }\r\n    static parse(input) {\r\n        if (input[input.length - 1] !== TextMessageFormat.RecordSeparator) {\r\n            throw new Error(\"Message is incomplete.\");\r\n        }\r\n        const messages = input.split(TextMessageFormat.RecordSeparator);\r\n        messages.pop();\r\n        return messages;\r\n    }\r\n}\r\nTextMessageFormat.RecordSeparatorCode = 0x1e;\r\nTextMessageFormat.RecordSeparator = String.fromCharCode(TextMessageFormat.RecordSeparatorCode);\r\n//# sourceMappingURL=TextMessageFormat.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { TextMessageFormat } from \"./TextMessageFormat\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\n/** @private */\r\nexport class HandshakeProtocol {\r\n    // Handshake request is always JSON\r\n    writeHandshakeRequest(handshakeRequest) {\r\n        return TextMessageFormat.write(JSON.stringify(handshakeRequest));\r\n    }\r\n    parseHandshakeResponse(data) {\r\n        let messageData;\r\n        let remainingData;\r\n        if (isArrayBuffer(data)) {\r\n            // Format is binary but still need to read JSON text from handshake response\r\n            const binaryData = new Uint8Array(data);\r\n            const separatorIndex = binaryData.indexOf(TextMessageFormat.RecordSeparatorCode);\r\n            if (separatorIndex === -1) {\r\n                throw new Error(\"Message is incomplete.\");\r\n            }\r\n            // content before separator is handshake response\r\n            // optional content after is additional messages\r\n            const responseLength = separatorIndex + 1;\r\n            messageData = String.fromCharCode.apply(null, Array.prototype.slice.call(binaryData.slice(0, responseLength)));\r\n            remainingData = (binaryData.byteLength > responseLength) ? binaryData.slice(responseLength).buffer : null;\r\n        }\r\n        else {\r\n            const textData = data;\r\n            const separatorIndex = textData.indexOf(TextMessageFormat.RecordSeparator);\r\n            if (separatorIndex === -1) {\r\n                throw new Error(\"Message is incomplete.\");\r\n            }\r\n            // content before separator is handshake response\r\n            // optional content after is additional messages\r\n            const responseLength = separatorIndex + 1;\r\n            messageData = textData.substring(0, responseLength);\r\n            remainingData = (textData.length > responseLength) ? textData.substring(responseLength) : null;\r\n        }\r\n        // At this point we should have just the single handshake message\r\n        const messages = TextMessageFormat.parse(messageData);\r\n        const response = JSON.parse(messages[0]);\r\n        if (response.type) {\r\n            throw new Error(\"Expected a handshake response from the server.\");\r\n        }\r\n        const responseMessage = response;\r\n        // multiple messages could have arrived with handshake\r\n        // return additional data to be parsed as usual, or null if all parsed\r\n        return [remainingData, responseMessage];\r\n    }\r\n}\r\n//# sourceMappingURL=HandshakeProtocol.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** Defines the type of a Hub Message. */\r\nexport var MessageType;\r\n(function (MessageType) {\r\n    /** Indicates the message is an Invocation message and implements the {@link @microsoft/signalr.InvocationMessage} interface. */\r\n    MessageType[MessageType[\"Invocation\"] = 1] = \"Invocation\";\r\n    /** Indicates the message is a StreamItem message and implements the {@link @microsoft/signalr.StreamItemMessage} interface. */\r\n    MessageType[MessageType[\"StreamItem\"] = 2] = \"StreamItem\";\r\n    /** Indicates the message is a Completion message and implements the {@link @microsoft/signalr.CompletionMessage} interface. */\r\n    MessageType[MessageType[\"Completion\"] = 3] = \"Completion\";\r\n    /** Indicates the message is a Stream Invocation message and implements the {@link @microsoft/signalr.StreamInvocationMessage} interface. */\r\n    MessageType[MessageType[\"StreamInvocation\"] = 4] = \"StreamInvocation\";\r\n    /** Indicates the message is a Cancel Invocation message and implements the {@link @microsoft/signalr.CancelInvocationMessage} interface. */\r\n    MessageType[MessageType[\"CancelInvocation\"] = 5] = \"CancelInvocation\";\r\n    /** Indicates the message is a Ping message and implements the {@link @microsoft/signalr.PingMessage} interface. */\r\n    MessageType[MessageType[\"Ping\"] = 6] = \"Ping\";\r\n    /** Indicates the message is a Close message and implements the {@link @microsoft/signalr.CloseMessage} interface. */\r\n    MessageType[MessageType[\"Close\"] = 7] = \"Close\";\r\n    MessageType[MessageType[\"Ack\"] = 8] = \"Ack\";\r\n    MessageType[MessageType[\"Sequence\"] = 9] = \"Sequence\";\r\n})(MessageType || (MessageType = {}));\r\n//# sourceMappingURL=IHubProtocol.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { SubjectSubscription } from \"./Utils\";\r\n/** Stream implementation to stream items to the server. */\r\nexport class Subject {\r\n    constructor() {\r\n        this.observers = [];\r\n    }\r\n    next(item) {\r\n        for (const observer of this.observers) {\r\n            observer.next(item);\r\n        }\r\n    }\r\n    error(err) {\r\n        for (const observer of this.observers) {\r\n            if (observer.error) {\r\n                observer.error(err);\r\n            }\r\n        }\r\n    }\r\n    complete() {\r\n        for (const observer of this.observers) {\r\n            if (observer.complete) {\r\n                observer.complete();\r\n            }\r\n        }\r\n    }\r\n    subscribe(observer) {\r\n        this.observers.push(observer);\r\n        return new SubjectSubscription(this, observer);\r\n    }\r\n}\r\n//# sourceMappingURL=Subject.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\n/** @private */\r\nexport class MessageBuffer {\r\n    constructor(protocol, connection, bufferSize) {\r\n        this._bufferSize = 100000;\r\n        this._messages = [];\r\n        this._totalMessageCount = 0;\r\n        this._waitForSequenceMessage = false;\r\n        // Message IDs start at 1 and always increment by 1\r\n        this._nextReceivingSequenceId = 1;\r\n        this._latestReceivedSequenceId = 0;\r\n        this._bufferedByteCount = 0;\r\n        this._reconnectInProgress = false;\r\n        this._protocol = protocol;\r\n        this._connection = connection;\r\n        this._bufferSize = bufferSize;\r\n    }\r\n    async _send(message) {\r\n        const serializedMessage = this._protocol.writeMessage(message);\r\n        let backpressurePromise = Promise.resolve();\r\n        // Only count invocation messages. Acks, pings, etc. don't need to be resent on reconnect\r\n        if (this._isInvocationMessage(message)) {\r\n            this._totalMessageCount++;\r\n            let backpressurePromiseResolver = () => { };\r\n            let backpressurePromiseRejector = () => { };\r\n            if (isArrayBuffer(serializedMessage)) {\r\n                this._bufferedByteCount += serializedMessage.byteLength;\r\n            }\r\n            else {\r\n                this._bufferedByteCount += serializedMessage.length;\r\n            }\r\n            if (this._bufferedByteCount >= this._bufferSize) {\r\n                backpressurePromise = new Promise((resolve, reject) => {\r\n                    backpressurePromiseResolver = resolve;\r\n                    backpressurePromiseRejector = reject;\r\n                });\r\n            }\r\n            this._messages.push(new BufferedItem(serializedMessage, this._totalMessageCount, backpressurePromiseResolver, backpressurePromiseRejector));\r\n        }\r\n        try {\r\n            // If this is set it means we are reconnecting or resending\r\n            // We don't want to send on a disconnected connection\r\n            // And we don't want to send if resend is running since that would mean sending\r\n            // this message twice\r\n            if (!this._reconnectInProgress) {\r\n                await this._connection.send(serializedMessage);\r\n            }\r\n        }\r\n        catch {\r\n            this._disconnected();\r\n        }\r\n        await backpressurePromise;\r\n    }\r\n    _ack(ackMessage) {\r\n        let newestAckedMessage = -1;\r\n        // Find index of newest message being acked\r\n        for (let index = 0; index < this._messages.length; index++) {\r\n            const element = this._messages[index];\r\n            if (element._id <= ackMessage.sequenceId) {\r\n                newestAckedMessage = index;\r\n                if (isArrayBuffer(element._message)) {\r\n                    this._bufferedByteCount -= element._message.byteLength;\r\n                }\r\n                else {\r\n                    this._bufferedByteCount -= element._message.length;\r\n                }\r\n                // resolve items that have already been sent and acked\r\n                element._resolver();\r\n            }\r\n            else if (this._bufferedByteCount < this._bufferSize) {\r\n                // resolve items that now fall under the buffer limit but haven't been acked\r\n                element._resolver();\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        if (newestAckedMessage !== -1) {\r\n            // We're removing everything including the message pointed to, so add 1\r\n            this._messages = this._messages.slice(newestAckedMessage + 1);\r\n        }\r\n    }\r\n    _shouldProcessMessage(message) {\r\n        if (this._waitForSequenceMessage) {\r\n            if (message.type !== MessageType.Sequence) {\r\n                return false;\r\n            }\r\n            else {\r\n                this._waitForSequenceMessage = false;\r\n                return true;\r\n            }\r\n        }\r\n        // No special processing for acks, pings, etc.\r\n        if (!this._isInvocationMessage(message)) {\r\n            return true;\r\n        }\r\n        const currentId = this._nextReceivingSequenceId;\r\n        this._nextReceivingSequenceId++;\r\n        if (currentId <= this._latestReceivedSequenceId) {\r\n            if (currentId === this._latestReceivedSequenceId) {\r\n                // Should only hit this if we just reconnected and the server is sending\r\n                // Messages it has buffered, which would mean it hasn't seen an Ack for these messages\r\n                this._ackTimer();\r\n            }\r\n            // Ignore, this is a duplicate message\r\n            return false;\r\n        }\r\n        this._latestReceivedSequenceId = currentId;\r\n        // Only start the timer for sending an Ack message when we have a message to ack. This also conveniently solves\r\n        // timer throttling by not having a recursive timer, and by starting the timer via a network call (recv)\r\n        this._ackTimer();\r\n        return true;\r\n    }\r\n    _resetSequence(message) {\r\n        if (message.sequenceId > this._nextReceivingSequenceId) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this._connection.stop(new Error(\"Sequence ID greater than amount of messages we've received.\"));\r\n            return;\r\n        }\r\n        this._nextReceivingSequenceId = message.sequenceId;\r\n    }\r\n    _disconnected() {\r\n        this._reconnectInProgress = true;\r\n        this._waitForSequenceMessage = true;\r\n    }\r\n    async _resend() {\r\n        const sequenceId = this._messages.length !== 0\r\n            ? this._messages[0]._id\r\n            : this._totalMessageCount + 1;\r\n        await this._connection.send(this._protocol.writeMessage({ type: MessageType.Sequence, sequenceId }));\r\n        // Get a local variable to the _messages, just in case messages are acked while resending\r\n        // Which would slice the _messages array (which creates a new copy)\r\n        const messages = this._messages;\r\n        for (const element of messages) {\r\n            await this._connection.send(element._message);\r\n        }\r\n        this._reconnectInProgress = false;\r\n    }\r\n    _dispose(error) {\r\n        error !== null && error !== void 0 ? error : (error = new Error(\"Unable to reconnect to server.\"));\r\n        // Unblock backpressure if any\r\n        for (const element of this._messages) {\r\n            element._rejector(error);\r\n        }\r\n    }\r\n    _isInvocationMessage(message) {\r\n        // There is no way to check if something implements an interface.\r\n        // So we individually check the messages in a switch statement.\r\n        // To make sure we don't miss any message types we rely on the compiler\r\n        // seeing the function returns a value and it will do the\r\n        // exhaustive check for us on the switch statement, since we don't use 'case default'\r\n        switch (message.type) {\r\n            case MessageType.Invocation:\r\n            case MessageType.StreamItem:\r\n            case MessageType.Completion:\r\n            case MessageType.StreamInvocation:\r\n            case MessageType.CancelInvocation:\r\n                return true;\r\n            case MessageType.Close:\r\n            case MessageType.Sequence:\r\n            case MessageType.Ping:\r\n            case MessageType.Ack:\r\n                return false;\r\n        }\r\n    }\r\n    _ackTimer() {\r\n        if (this._ackTimerHandle === undefined) {\r\n            this._ackTimerHandle = setTimeout(async () => {\r\n                try {\r\n                    if (!this._reconnectInProgress) {\r\n                        await this._connection.send(this._protocol.writeMessage({ type: MessageType.Ack, sequenceId: this._latestReceivedSequenceId }));\r\n                    }\r\n                    // Ignore errors, that means the connection is closed and we don't care about the Ack message anymore.\r\n                }\r\n                catch { }\r\n                clearTimeout(this._ackTimerHandle);\r\n                this._ackTimerHandle = undefined;\r\n                // 1 second delay so we don't spam Ack messages if there are many messages being received at once.\r\n            }, 1000);\r\n        }\r\n    }\r\n}\r\nclass BufferedItem {\r\n    constructor(message, id, resolver, rejector) {\r\n        this._message = message;\r\n        this._id = id;\r\n        this._resolver = resolver;\r\n        this._rejector = rejector;\r\n    }\r\n}\r\n//# sourceMappingURL=MessageBuffer.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { HandshakeProtocol } from \"./HandshakeProtocol\";\r\nimport { AbortError } from \"./Errors\";\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { Subject } from \"./Subject\";\r\nimport { Arg, getErrorString, Platform } from \"./Utils\";\r\nimport { MessageBuffer } from \"./MessageBuffer\";\r\nconst DEFAULT_TIMEOUT_IN_MS = 30 * 1000;\r\nconst DEFAULT_PING_INTERVAL_IN_MS = 15 * 1000;\r\nconst DEFAULT_STATEFUL_RECONNECT_BUFFER_SIZE = 100000;\r\n/** Describes the current state of the {@link HubConnection} to the server. */\r\nexport var HubConnectionState;\r\n(function (HubConnectionState) {\r\n    /** The hub connection is disconnected. */\r\n    HubConnectionState[\"Disconnected\"] = \"Disconnected\";\r\n    /** The hub connection is connecting. */\r\n    HubConnectionState[\"Connecting\"] = \"Connecting\";\r\n    /** The hub connection is connected. */\r\n    HubConnectionState[\"Connected\"] = \"Connected\";\r\n    /** The hub connection is disconnecting. */\r\n    HubConnectionState[\"Disconnecting\"] = \"Disconnecting\";\r\n    /** The hub connection is reconnecting. */\r\n    HubConnectionState[\"Reconnecting\"] = \"Reconnecting\";\r\n})(HubConnectionState || (HubConnectionState = {}));\r\n/** Represents a connection to a SignalR Hub. */\r\nexport class HubConnection {\r\n    /** @internal */\r\n    // Using a public static factory method means we can have a private constructor and an _internal_\r\n    // create method that can be used by HubConnectionBuilder. An \"internal\" constructor would just\r\n    // be stripped away and the '.d.ts' file would have no constructor, which is interpreted as a\r\n    // public parameter-less constructor.\r\n    static create(connection, logger, protocol, reconnectPolicy, serverTimeoutInMilliseconds, keepAliveIntervalInMilliseconds, statefulReconnectBufferSize) {\r\n        return new HubConnection(connection, logger, protocol, reconnectPolicy, serverTimeoutInMilliseconds, keepAliveIntervalInMilliseconds, statefulReconnectBufferSize);\r\n    }\r\n    constructor(connection, logger, protocol, reconnectPolicy, serverTimeoutInMilliseconds, keepAliveIntervalInMilliseconds, statefulReconnectBufferSize) {\r\n        this._nextKeepAlive = 0;\r\n        this._freezeEventListener = () => {\r\n            this._logger.log(LogLevel.Warning, \"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep\");\r\n        };\r\n        Arg.isRequired(connection, \"connection\");\r\n        Arg.isRequired(logger, \"logger\");\r\n        Arg.isRequired(protocol, \"protocol\");\r\n        this.serverTimeoutInMilliseconds = serverTimeoutInMilliseconds !== null && serverTimeoutInMilliseconds !== void 0 ? serverTimeoutInMilliseconds : DEFAULT_TIMEOUT_IN_MS;\r\n        this.keepAliveIntervalInMilliseconds = keepAliveIntervalInMilliseconds !== null && keepAliveIntervalInMilliseconds !== void 0 ? keepAliveIntervalInMilliseconds : DEFAULT_PING_INTERVAL_IN_MS;\r\n        this._statefulReconnectBufferSize = statefulReconnectBufferSize !== null && statefulReconnectBufferSize !== void 0 ? statefulReconnectBufferSize : DEFAULT_STATEFUL_RECONNECT_BUFFER_SIZE;\r\n        this._logger = logger;\r\n        this._protocol = protocol;\r\n        this.connection = connection;\r\n        this._reconnectPolicy = reconnectPolicy;\r\n        this._handshakeProtocol = new HandshakeProtocol();\r\n        this.connection.onreceive = (data) => this._processIncomingData(data);\r\n        this.connection.onclose = (error) => this._connectionClosed(error);\r\n        this._callbacks = {};\r\n        this._methods = {};\r\n        this._closedCallbacks = [];\r\n        this._reconnectingCallbacks = [];\r\n        this._reconnectedCallbacks = [];\r\n        this._invocationId = 0;\r\n        this._receivedHandshakeResponse = false;\r\n        this._connectionState = HubConnectionState.Disconnected;\r\n        this._connectionStarted = false;\r\n        this._cachedPingMessage = this._protocol.writeMessage({ type: MessageType.Ping });\r\n    }\r\n    /** Indicates the state of the {@link HubConnection} to the server. */\r\n    get state() {\r\n        return this._connectionState;\r\n    }\r\n    /** Represents the connection id of the {@link HubConnection} on the server. The connection id will be null when the connection is either\r\n     *  in the disconnected state or if the negotiation step was skipped.\r\n     */\r\n    get connectionId() {\r\n        return this.connection ? (this.connection.connectionId || null) : null;\r\n    }\r\n    /** Indicates the url of the {@link HubConnection} to the server. */\r\n    get baseUrl() {\r\n        return this.connection.baseUrl || \"\";\r\n    }\r\n    /**\r\n     * Sets a new url for the HubConnection. Note that the url can only be changed when the connection is in either the Disconnected or\r\n     * Reconnecting states.\r\n     * @param {string} url The url to connect to.\r\n     */\r\n    set baseUrl(url) {\r\n        if (this._connectionState !== HubConnectionState.Disconnected && this._connectionState !== HubConnectionState.Reconnecting) {\r\n            throw new Error(\"The HubConnection must be in the Disconnected or Reconnecting state to change the url.\");\r\n        }\r\n        if (!url) {\r\n            throw new Error(\"The HubConnection url must be a valid url.\");\r\n        }\r\n        this.connection.baseUrl = url;\r\n    }\r\n    /** Starts the connection.\r\n     *\r\n     * @returns {Promise<void>} A Promise that resolves when the connection has been successfully established, or rejects with an error.\r\n     */\r\n    start() {\r\n        this._startPromise = this._startWithStateTransitions();\r\n        return this._startPromise;\r\n    }\r\n    async _startWithStateTransitions() {\r\n        if (this._connectionState !== HubConnectionState.Disconnected) {\r\n            return Promise.reject(new Error(\"Cannot start a HubConnection that is not in the 'Disconnected' state.\"));\r\n        }\r\n        this._connectionState = HubConnectionState.Connecting;\r\n        this._logger.log(LogLevel.Debug, \"Starting HubConnection.\");\r\n        try {\r\n            await this._startInternal();\r\n            if (Platform.isBrowser) {\r\n                // Log when the browser freezes the tab so users know why their connection unexpectedly stopped working\r\n                window.document.addEventListener(\"freeze\", this._freezeEventListener);\r\n            }\r\n            this._connectionState = HubConnectionState.Connected;\r\n            this._connectionStarted = true;\r\n            this._logger.log(LogLevel.Debug, \"HubConnection connected successfully.\");\r\n        }\r\n        catch (e) {\r\n            this._connectionState = HubConnectionState.Disconnected;\r\n            this._logger.log(LogLevel.Debug, `HubConnection failed to start successfully because of error '${e}'.`);\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n    async _startInternal() {\r\n        this._stopDuringStartError = undefined;\r\n        this._receivedHandshakeResponse = false;\r\n        // Set up the promise before any connection is (re)started otherwise it could race with received messages\r\n        const handshakePromise = new Promise((resolve, reject) => {\r\n            this._handshakeResolver = resolve;\r\n            this._handshakeRejecter = reject;\r\n        });\r\n        await this.connection.start(this._protocol.transferFormat);\r\n        try {\r\n            let version = this._protocol.version;\r\n            if (!this.connection.features.reconnect) {\r\n                // Stateful Reconnect starts with HubProtocol version 2, newer clients connecting to older servers will fail to connect due to\r\n                // the handshake only supporting version 1, so we will try to send version 1 during the handshake to keep old servers working.\r\n                version = 1;\r\n            }\r\n            const handshakeRequest = {\r\n                protocol: this._protocol.name,\r\n                version,\r\n            };\r\n            this._logger.log(LogLevel.Debug, \"Sending handshake request.\");\r\n            await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(handshakeRequest));\r\n            this._logger.log(LogLevel.Information, `Using HubProtocol '${this._protocol.name}'.`);\r\n            // defensively cleanup timeout in case we receive a message from the server before we finish start\r\n            this._cleanupTimeout();\r\n            this._resetTimeoutPeriod();\r\n            this._resetKeepAliveInterval();\r\n            await handshakePromise;\r\n            // It's important to check the stopDuringStartError instead of just relying on the handshakePromise\r\n            // being rejected on close, because this continuation can run after both the handshake completed successfully\r\n            // and the connection was closed.\r\n            if (this._stopDuringStartError) {\r\n                // It's important to throw instead of returning a rejected promise, because we don't want to allow any state\r\n                // transitions to occur between now and the calling code observing the exceptions. Returning a rejected promise\r\n                // will cause the calling continuation to get scheduled to run later.\r\n                // eslint-disable-next-line @typescript-eslint/no-throw-literal\r\n                throw this._stopDuringStartError;\r\n            }\r\n            const useStatefulReconnect = this.connection.features.reconnect || false;\r\n            if (useStatefulReconnect) {\r\n                this._messageBuffer = new MessageBuffer(this._protocol, this.connection, this._statefulReconnectBufferSize);\r\n                this.connection.features.disconnected = this._messageBuffer._disconnected.bind(this._messageBuffer);\r\n                this.connection.features.resend = () => {\r\n                    if (this._messageBuffer) {\r\n                        return this._messageBuffer._resend();\r\n                    }\r\n                };\r\n            }\r\n            if (!this.connection.features.inherentKeepAlive) {\r\n                await this._sendMessage(this._cachedPingMessage);\r\n            }\r\n        }\r\n        catch (e) {\r\n            this._logger.log(LogLevel.Debug, `Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`);\r\n            this._cleanupTimeout();\r\n            this._cleanupPingTimer();\r\n            // HttpConnection.stop() should not complete until after the onclose callback is invoked.\r\n            // This will transition the HubConnection to the disconnected state before HttpConnection.stop() completes.\r\n            await this.connection.stop(e);\r\n            throw e;\r\n        }\r\n    }\r\n    /** Stops the connection.\r\n     *\r\n     * @returns {Promise<void>} A Promise that resolves when the connection has been successfully terminated, or rejects with an error.\r\n     */\r\n    async stop() {\r\n        // Capture the start promise before the connection might be restarted in an onclose callback.\r\n        const startPromise = this._startPromise;\r\n        this.connection.features.reconnect = false;\r\n        this._stopPromise = this._stopInternal();\r\n        await this._stopPromise;\r\n        try {\r\n            // Awaiting undefined continues immediately\r\n            await startPromise;\r\n        }\r\n        catch (e) {\r\n            // This exception is returned to the user as a rejected Promise from the start method.\r\n        }\r\n    }\r\n    _stopInternal(error) {\r\n        if (this._connectionState === HubConnectionState.Disconnected) {\r\n            this._logger.log(LogLevel.Debug, `Call to HubConnection.stop(${error}) ignored because it is already in the disconnected state.`);\r\n            return Promise.resolve();\r\n        }\r\n        if (this._connectionState === HubConnectionState.Disconnecting) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnecting state.`);\r\n            return this._stopPromise;\r\n        }\r\n        const state = this._connectionState;\r\n        this._connectionState = HubConnectionState.Disconnecting;\r\n        this._logger.log(LogLevel.Debug, \"Stopping HubConnection.\");\r\n        if (this._reconnectDelayHandle) {\r\n            // We're in a reconnect delay which means the underlying connection is currently already stopped.\r\n            // Just clear the handle to stop the reconnect loop (which no one is waiting on thankfully) and\r\n            // fire the onclose callbacks.\r\n            this._logger.log(LogLevel.Debug, \"Connection stopped during reconnect delay. Done reconnecting.\");\r\n            clearTimeout(this._reconnectDelayHandle);\r\n            this._reconnectDelayHandle = undefined;\r\n            this._completeClose();\r\n            return Promise.resolve();\r\n        }\r\n        if (state === HubConnectionState.Connected) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this._sendCloseMessage();\r\n        }\r\n        this._cleanupTimeout();\r\n        this._cleanupPingTimer();\r\n        this._stopDuringStartError = error || new AbortError(\"The connection was stopped before the hub handshake could complete.\");\r\n        // HttpConnection.stop() should not complete until after either HttpConnection.start() fails\r\n        // or the onclose callback is invoked. The onclose callback will transition the HubConnection\r\n        // to the disconnected state if need be before HttpConnection.stop() completes.\r\n        return this.connection.stop(error);\r\n    }\r\n    async _sendCloseMessage() {\r\n        try {\r\n            await this._sendWithProtocol(this._createCloseMessage());\r\n        }\r\n        catch {\r\n            // Ignore, this is a best effort attempt to let the server know the client closed gracefully.\r\n        }\r\n    }\r\n    /** Invokes a streaming hub method on the server using the specified name and arguments.\r\n     *\r\n     * @typeparam T The type of the items returned by the server.\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {IStreamResult<T>} An object that yields results from the server as they are received.\r\n     */\r\n    stream(methodName, ...args) {\r\n        const [streams, streamIds] = this._replaceStreamingParams(args);\r\n        const invocationDescriptor = this._createStreamInvocation(methodName, args, streamIds);\r\n        // eslint-disable-next-line prefer-const\r\n        let promiseQueue;\r\n        const subject = new Subject();\r\n        subject.cancelCallback = () => {\r\n            const cancelInvocation = this._createCancelInvocation(invocationDescriptor.invocationId);\r\n            delete this._callbacks[invocationDescriptor.invocationId];\r\n            return promiseQueue.then(() => {\r\n                return this._sendWithProtocol(cancelInvocation);\r\n            });\r\n        };\r\n        this._callbacks[invocationDescriptor.invocationId] = (invocationEvent, error) => {\r\n            if (error) {\r\n                subject.error(error);\r\n                return;\r\n            }\r\n            else if (invocationEvent) {\r\n                // invocationEvent will not be null when an error is not passed to the callback\r\n                if (invocationEvent.type === MessageType.Completion) {\r\n                    if (invocationEvent.error) {\r\n                        subject.error(new Error(invocationEvent.error));\r\n                    }\r\n                    else {\r\n                        subject.complete();\r\n                    }\r\n                }\r\n                else {\r\n                    subject.next((invocationEvent.item));\r\n                }\r\n            }\r\n        };\r\n        promiseQueue = this._sendWithProtocol(invocationDescriptor)\r\n            .catch((e) => {\r\n            subject.error(e);\r\n            delete this._callbacks[invocationDescriptor.invocationId];\r\n        });\r\n        this._launchStreams(streams, promiseQueue);\r\n        return subject;\r\n    }\r\n    _sendMessage(message) {\r\n        this._resetKeepAliveInterval();\r\n        return this.connection.send(message);\r\n    }\r\n    /**\r\n     * Sends a js object to the server.\r\n     * @param message The js object to serialize and send.\r\n     */\r\n    _sendWithProtocol(message) {\r\n        if (this._messageBuffer) {\r\n            return this._messageBuffer._send(message);\r\n        }\r\n        else {\r\n            return this._sendMessage(this._protocol.writeMessage(message));\r\n        }\r\n    }\r\n    /** Invokes a hub method on the server using the specified name and arguments. Does not wait for a response from the receiver.\r\n     *\r\n     * The Promise returned by this method resolves when the client has sent the invocation to the server. The server may still\r\n     * be processing the invocation.\r\n     *\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {Promise<void>} A Promise that resolves when the invocation has been successfully sent, or rejects with an error.\r\n     */\r\n    send(methodName, ...args) {\r\n        const [streams, streamIds] = this._replaceStreamingParams(args);\r\n        const sendPromise = this._sendWithProtocol(this._createInvocation(methodName, args, true, streamIds));\r\n        this._launchStreams(streams, sendPromise);\r\n        return sendPromise;\r\n    }\r\n    /** Invokes a hub method on the server using the specified name and arguments.\r\n     *\r\n     * The Promise returned by this method resolves when the server indicates it has finished invoking the method. When the promise\r\n     * resolves, the server has finished invoking the method. If the server method returns a result, it is produced as the result of\r\n     * resolving the Promise.\r\n     *\r\n     * @typeparam T The expected return type.\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {Promise<T>} A Promise that resolves with the result of the server method (if any), or rejects with an error.\r\n     */\r\n    invoke(methodName, ...args) {\r\n        const [streams, streamIds] = this._replaceStreamingParams(args);\r\n        const invocationDescriptor = this._createInvocation(methodName, args, false, streamIds);\r\n        const p = new Promise((resolve, reject) => {\r\n            // invocationId will always have a value for a non-blocking invocation\r\n            this._callbacks[invocationDescriptor.invocationId] = (invocationEvent, error) => {\r\n                if (error) {\r\n                    reject(error);\r\n                    return;\r\n                }\r\n                else if (invocationEvent) {\r\n                    // invocationEvent will not be null when an error is not passed to the callback\r\n                    if (invocationEvent.type === MessageType.Completion) {\r\n                        if (invocationEvent.error) {\r\n                            reject(new Error(invocationEvent.error));\r\n                        }\r\n                        else {\r\n                            resolve(invocationEvent.result);\r\n                        }\r\n                    }\r\n                    else {\r\n                        reject(new Error(`Unexpected message type: ${invocationEvent.type}`));\r\n                    }\r\n                }\r\n            };\r\n            const promiseQueue = this._sendWithProtocol(invocationDescriptor)\r\n                .catch((e) => {\r\n                reject(e);\r\n                // invocationId will always have a value for a non-blocking invocation\r\n                delete this._callbacks[invocationDescriptor.invocationId];\r\n            });\r\n            this._launchStreams(streams, promiseQueue);\r\n        });\r\n        return p;\r\n    }\r\n    on(methodName, newMethod) {\r\n        if (!methodName || !newMethod) {\r\n            return;\r\n        }\r\n        methodName = methodName.toLowerCase();\r\n        if (!this._methods[methodName]) {\r\n            this._methods[methodName] = [];\r\n        }\r\n        // Preventing adding the same handler multiple times.\r\n        if (this._methods[methodName].indexOf(newMethod) !== -1) {\r\n            return;\r\n        }\r\n        this._methods[methodName].push(newMethod);\r\n    }\r\n    off(methodName, method) {\r\n        if (!methodName) {\r\n            return;\r\n        }\r\n        methodName = methodName.toLowerCase();\r\n        const handlers = this._methods[methodName];\r\n        if (!handlers) {\r\n            return;\r\n        }\r\n        if (method) {\r\n            const removeIdx = handlers.indexOf(method);\r\n            if (removeIdx !== -1) {\r\n                handlers.splice(removeIdx, 1);\r\n                if (handlers.length === 0) {\r\n                    delete this._methods[methodName];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            delete this._methods[methodName];\r\n        }\r\n    }\r\n    /** Registers a handler that will be invoked when the connection is closed.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection is closed. Optionally receives a single argument containing the error that caused the connection to close (if any).\r\n     */\r\n    onclose(callback) {\r\n        if (callback) {\r\n            this._closedCallbacks.push(callback);\r\n        }\r\n    }\r\n    /** Registers a handler that will be invoked when the connection starts reconnecting.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection starts reconnecting. Optionally receives a single argument containing the error that caused the connection to start reconnecting (if any).\r\n     */\r\n    onreconnecting(callback) {\r\n        if (callback) {\r\n            this._reconnectingCallbacks.push(callback);\r\n        }\r\n    }\r\n    /** Registers a handler that will be invoked when the connection successfully reconnects.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection successfully reconnects.\r\n     */\r\n    onreconnected(callback) {\r\n        if (callback) {\r\n            this._reconnectedCallbacks.push(callback);\r\n        }\r\n    }\r\n    _processIncomingData(data) {\r\n        this._cleanupTimeout();\r\n        if (!this._receivedHandshakeResponse) {\r\n            data = this._processHandshakeResponse(data);\r\n            this._receivedHandshakeResponse = true;\r\n        }\r\n        // Data may have all been read when processing handshake response\r\n        if (data) {\r\n            // Parse the messages\r\n            const messages = this._protocol.parseMessages(data, this._logger);\r\n            for (const message of messages) {\r\n                if (this._messageBuffer && !this._messageBuffer._shouldProcessMessage(message)) {\r\n                    // Don't process the message, we are either waiting for a SequenceMessage or received a duplicate message\r\n                    continue;\r\n                }\r\n                switch (message.type) {\r\n                    case MessageType.Invocation:\r\n                        this._invokeClientMethod(message)\r\n                            .catch((e) => {\r\n                            this._logger.log(LogLevel.Error, `Invoke client method threw error: ${getErrorString(e)}`);\r\n                        });\r\n                        break;\r\n                    case MessageType.StreamItem:\r\n                    case MessageType.Completion: {\r\n                        const callback = this._callbacks[message.invocationId];\r\n                        if (callback) {\r\n                            if (message.type === MessageType.Completion) {\r\n                                delete this._callbacks[message.invocationId];\r\n                            }\r\n                            try {\r\n                                callback(message);\r\n                            }\r\n                            catch (e) {\r\n                                this._logger.log(LogLevel.Error, `Stream callback threw error: ${getErrorString(e)}`);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case MessageType.Ping:\r\n                        // Don't care about pings\r\n                        break;\r\n                    case MessageType.Close: {\r\n                        this._logger.log(LogLevel.Information, \"Close message received from server.\");\r\n                        const error = message.error ? new Error(\"Server returned an error on close: \" + message.error) : undefined;\r\n                        if (message.allowReconnect === true) {\r\n                            // It feels wrong not to await connection.stop() here, but processIncomingData is called as part of an onreceive callback which is not async,\r\n                            // this is already the behavior for serverTimeout(), and HttpConnection.Stop() should catch and log all possible exceptions.\r\n                            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n                            this.connection.stop(error);\r\n                        }\r\n                        else {\r\n                            // We cannot await stopInternal() here, but subsequent calls to stop() will await this if stopInternal() is still ongoing.\r\n                            this._stopPromise = this._stopInternal(error);\r\n                        }\r\n                        break;\r\n                    }\r\n                    case MessageType.Ack:\r\n                        if (this._messageBuffer) {\r\n                            this._messageBuffer._ack(message);\r\n                        }\r\n                        break;\r\n                    case MessageType.Sequence:\r\n                        if (this._messageBuffer) {\r\n                            this._messageBuffer._resetSequence(message);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        this._logger.log(LogLevel.Warning, `Invalid message type: ${message.type}.`);\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        this._resetTimeoutPeriod();\r\n    }\r\n    _processHandshakeResponse(data) {\r\n        let responseMessage;\r\n        let remainingData;\r\n        try {\r\n            [remainingData, responseMessage] = this._handshakeProtocol.parseHandshakeResponse(data);\r\n        }\r\n        catch (e) {\r\n            const message = \"Error parsing handshake response: \" + e;\r\n            this._logger.log(LogLevel.Error, message);\r\n            const error = new Error(message);\r\n            this._handshakeRejecter(error);\r\n            throw error;\r\n        }\r\n        if (responseMessage.error) {\r\n            const message = \"Server returned handshake error: \" + responseMessage.error;\r\n            this._logger.log(LogLevel.Error, message);\r\n            const error = new Error(message);\r\n            this._handshakeRejecter(error);\r\n            throw error;\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Debug, \"Server handshake complete.\");\r\n        }\r\n        this._handshakeResolver();\r\n        return remainingData;\r\n    }\r\n    _resetKeepAliveInterval() {\r\n        if (this.connection.features.inherentKeepAlive) {\r\n            return;\r\n        }\r\n        // Set the time we want the next keep alive to be sent\r\n        // Timer will be setup on next message receive\r\n        this._nextKeepAlive = new Date().getTime() + this.keepAliveIntervalInMilliseconds;\r\n        this._cleanupPingTimer();\r\n    }\r\n    _resetTimeoutPeriod() {\r\n        if (!this.connection.features || !this.connection.features.inherentKeepAlive) {\r\n            // Set the timeout timer\r\n            this._timeoutHandle = setTimeout(() => this.serverTimeout(), this.serverTimeoutInMilliseconds);\r\n            // Set keepAlive timer if there isn't one\r\n            if (this._pingServerHandle === undefined) {\r\n                let nextPing = this._nextKeepAlive - new Date().getTime();\r\n                if (nextPing < 0) {\r\n                    nextPing = 0;\r\n                }\r\n                // The timer needs to be set from a networking callback to avoid Chrome timer throttling from causing timers to run once a minute\r\n                this._pingServerHandle = setTimeout(async () => {\r\n                    if (this._connectionState === HubConnectionState.Connected) {\r\n                        try {\r\n                            await this._sendMessage(this._cachedPingMessage);\r\n                        }\r\n                        catch {\r\n                            // We don't care about the error. It should be seen elsewhere in the client.\r\n                            // The connection is probably in a bad or closed state now, cleanup the timer so it stops triggering\r\n                            this._cleanupPingTimer();\r\n                        }\r\n                    }\r\n                }, nextPing);\r\n            }\r\n        }\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    serverTimeout() {\r\n        // The server hasn't talked to us in a while. It doesn't like us anymore ... :(\r\n        // Terminate the connection, but we don't need to wait on the promise. This could trigger reconnecting.\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.connection.stop(new Error(\"Server timeout elapsed without receiving a message from the server.\"));\r\n    }\r\n    async _invokeClientMethod(invocationMessage) {\r\n        const methodName = invocationMessage.target.toLowerCase();\r\n        const methods = this._methods[methodName];\r\n        if (!methods) {\r\n            this._logger.log(LogLevel.Warning, `No client method with the name '${methodName}' found.`);\r\n            // No handlers provided by client but the server is expecting a response still, so we send an error\r\n            if (invocationMessage.invocationId) {\r\n                this._logger.log(LogLevel.Warning, `No result given for '${methodName}' method and invocation ID '${invocationMessage.invocationId}'.`);\r\n                await this._sendWithProtocol(this._createCompletionMessage(invocationMessage.invocationId, \"Client didn't provide a result.\", null));\r\n            }\r\n            return;\r\n        }\r\n        // Avoid issues with handlers removing themselves thus modifying the list while iterating through it\r\n        const methodsCopy = methods.slice();\r\n        // Server expects a response\r\n        const expectsResponse = invocationMessage.invocationId ? true : false;\r\n        // We preserve the last result or exception but still call all handlers\r\n        let res;\r\n        let exception;\r\n        let completionMessage;\r\n        for (const m of methodsCopy) {\r\n            try {\r\n                const prevRes = res;\r\n                res = await m.apply(this, invocationMessage.arguments);\r\n                if (expectsResponse && res && prevRes) {\r\n                    this._logger.log(LogLevel.Error, `Multiple results provided for '${methodName}'. Sending error to server.`);\r\n                    completionMessage = this._createCompletionMessage(invocationMessage.invocationId, `Client provided multiple results.`, null);\r\n                }\r\n                // Ignore exception if we got a result after, the exception will be logged\r\n                exception = undefined;\r\n            }\r\n            catch (e) {\r\n                exception = e;\r\n                this._logger.log(LogLevel.Error, `A callback for the method '${methodName}' threw error '${e}'.`);\r\n            }\r\n        }\r\n        if (completionMessage) {\r\n            await this._sendWithProtocol(completionMessage);\r\n        }\r\n        else if (expectsResponse) {\r\n            // If there is an exception that means either no result was given or a handler after a result threw\r\n            if (exception) {\r\n                completionMessage = this._createCompletionMessage(invocationMessage.invocationId, `${exception}`, null);\r\n            }\r\n            else if (res !== undefined) {\r\n                completionMessage = this._createCompletionMessage(invocationMessage.invocationId, null, res);\r\n            }\r\n            else {\r\n                this._logger.log(LogLevel.Warning, `No result given for '${methodName}' method and invocation ID '${invocationMessage.invocationId}'.`);\r\n                // Client didn't provide a result or throw from a handler, server expects a response so we send an error\r\n                completionMessage = this._createCompletionMessage(invocationMessage.invocationId, \"Client didn't provide a result.\", null);\r\n            }\r\n            await this._sendWithProtocol(completionMessage);\r\n        }\r\n        else {\r\n            if (res) {\r\n                this._logger.log(LogLevel.Error, `Result given for '${methodName}' method but server is not expecting a result.`);\r\n            }\r\n        }\r\n    }\r\n    _connectionClosed(error) {\r\n        this._logger.log(LogLevel.Debug, `HubConnection.connectionClosed(${error}) called while in state ${this._connectionState}.`);\r\n        // Triggering this.handshakeRejecter is insufficient because it could already be resolved without the continuation having run yet.\r\n        this._stopDuringStartError = this._stopDuringStartError || error || new AbortError(\"The underlying connection was closed before the hub handshake could complete.\");\r\n        // If the handshake is in progress, start will be waiting for the handshake promise, so we complete it.\r\n        // If it has already completed, this should just noop.\r\n        if (this._handshakeResolver) {\r\n            this._handshakeResolver();\r\n        }\r\n        this._cancelCallbacksWithError(error || new Error(\"Invocation canceled due to the underlying connection being closed.\"));\r\n        this._cleanupTimeout();\r\n        this._cleanupPingTimer();\r\n        if (this._connectionState === HubConnectionState.Disconnecting) {\r\n            this._completeClose(error);\r\n        }\r\n        else if (this._connectionState === HubConnectionState.Connected && this._reconnectPolicy) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this._reconnect(error);\r\n        }\r\n        else if (this._connectionState === HubConnectionState.Connected) {\r\n            this._completeClose(error);\r\n        }\r\n        // If none of the above if conditions were true were called the HubConnection must be in either:\r\n        // 1. The Connecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail it.\r\n        // 2. The Reconnecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail the current reconnect attempt\r\n        //    and potentially continue the reconnect() loop.\r\n        // 3. The Disconnected state in which case we're already done.\r\n    }\r\n    _completeClose(error) {\r\n        if (this._connectionStarted) {\r\n            this._connectionState = HubConnectionState.Disconnected;\r\n            this._connectionStarted = false;\r\n            if (this._messageBuffer) {\r\n                this._messageBuffer._dispose(error !== null && error !== void 0 ? error : new Error(\"Connection closed.\"));\r\n                this._messageBuffer = undefined;\r\n            }\r\n            if (Platform.isBrowser) {\r\n                window.document.removeEventListener(\"freeze\", this._freezeEventListener);\r\n            }\r\n            try {\r\n                this._closedCallbacks.forEach((c) => c.apply(this, [error]));\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `An onclose callback called with error '${error}' threw error '${e}'.`);\r\n            }\r\n        }\r\n    }\r\n    async _reconnect(error) {\r\n        const reconnectStartTime = Date.now();\r\n        let previousReconnectAttempts = 0;\r\n        let retryError = error !== undefined ? error : new Error(\"Attempting to reconnect due to a unknown error.\");\r\n        let nextRetryDelay = this._getNextRetryDelay(previousReconnectAttempts++, 0, retryError);\r\n        if (nextRetryDelay === null) {\r\n            this._logger.log(LogLevel.Debug, \"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt.\");\r\n            this._completeClose(error);\r\n            return;\r\n        }\r\n        this._connectionState = HubConnectionState.Reconnecting;\r\n        if (error) {\r\n            this._logger.log(LogLevel.Information, `Connection reconnecting because of error '${error}'.`);\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Information, \"Connection reconnecting.\");\r\n        }\r\n        if (this._reconnectingCallbacks.length !== 0) {\r\n            try {\r\n                this._reconnectingCallbacks.forEach((c) => c.apply(this, [error]));\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `An onreconnecting callback called with error '${error}' threw error '${e}'.`);\r\n            }\r\n            // Exit early if an onreconnecting callback called connection.stop().\r\n            if (this._connectionState !== HubConnectionState.Reconnecting) {\r\n                this._logger.log(LogLevel.Debug, \"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.\");\r\n                return;\r\n            }\r\n        }\r\n        while (nextRetryDelay !== null) {\r\n            this._logger.log(LogLevel.Information, `Reconnect attempt number ${previousReconnectAttempts} will start in ${nextRetryDelay} ms.`);\r\n            await new Promise((resolve) => {\r\n                this._reconnectDelayHandle = setTimeout(resolve, nextRetryDelay);\r\n            });\r\n            this._reconnectDelayHandle = undefined;\r\n            if (this._connectionState !== HubConnectionState.Reconnecting) {\r\n                this._logger.log(LogLevel.Debug, \"Connection left the reconnecting state during reconnect delay. Done reconnecting.\");\r\n                return;\r\n            }\r\n            try {\r\n                await this._startInternal();\r\n                this._connectionState = HubConnectionState.Connected;\r\n                this._logger.log(LogLevel.Information, \"HubConnection reconnected successfully.\");\r\n                if (this._reconnectedCallbacks.length !== 0) {\r\n                    try {\r\n                        this._reconnectedCallbacks.forEach((c) => c.apply(this, [this.connection.connectionId]));\r\n                    }\r\n                    catch (e) {\r\n                        this._logger.log(LogLevel.Error, `An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`);\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Information, `Reconnect attempt failed because of error '${e}'.`);\r\n                if (this._connectionState !== HubConnectionState.Reconnecting) {\r\n                    this._logger.log(LogLevel.Debug, `Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`);\r\n                    // The TypeScript compiler thinks that connectionState must be Connected here. The TypeScript compiler is wrong.\r\n                    if (this._connectionState === HubConnectionState.Disconnecting) {\r\n                        this._completeClose();\r\n                    }\r\n                    return;\r\n                }\r\n                retryError = e instanceof Error ? e : new Error(e.toString());\r\n                nextRetryDelay = this._getNextRetryDelay(previousReconnectAttempts++, Date.now() - reconnectStartTime, retryError);\r\n            }\r\n        }\r\n        this._logger.log(LogLevel.Information, `Reconnect retries have been exhausted after ${Date.now() - reconnectStartTime} ms and ${previousReconnectAttempts} failed attempts. Connection disconnecting.`);\r\n        this._completeClose();\r\n    }\r\n    _getNextRetryDelay(previousRetryCount, elapsedMilliseconds, retryReason) {\r\n        try {\r\n            return this._reconnectPolicy.nextRetryDelayInMilliseconds({\r\n                elapsedMilliseconds,\r\n                previousRetryCount,\r\n                retryReason,\r\n            });\r\n        }\r\n        catch (e) {\r\n            this._logger.log(LogLevel.Error, `IRetryPolicy.nextRetryDelayInMilliseconds(${previousRetryCount}, ${elapsedMilliseconds}) threw error '${e}'.`);\r\n            return null;\r\n        }\r\n    }\r\n    _cancelCallbacksWithError(error) {\r\n        const callbacks = this._callbacks;\r\n        this._callbacks = {};\r\n        Object.keys(callbacks)\r\n            .forEach((key) => {\r\n            const callback = callbacks[key];\r\n            try {\r\n                callback(null, error);\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `Stream 'error' callback called with '${error}' threw error: ${getErrorString(e)}`);\r\n            }\r\n        });\r\n    }\r\n    _cleanupPingTimer() {\r\n        if (this._pingServerHandle) {\r\n            clearTimeout(this._pingServerHandle);\r\n            this._pingServerHandle = undefined;\r\n        }\r\n    }\r\n    _cleanupTimeout() {\r\n        if (this._timeoutHandle) {\r\n            clearTimeout(this._timeoutHandle);\r\n        }\r\n    }\r\n    _createInvocation(methodName, args, nonblocking, streamIds) {\r\n        if (nonblocking) {\r\n            if (streamIds.length !== 0) {\r\n                return {\r\n                    arguments: args,\r\n                    streamIds,\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    arguments: args,\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n        }\r\n        else {\r\n            const invocationId = this._invocationId;\r\n            this._invocationId++;\r\n            if (streamIds.length !== 0) {\r\n                return {\r\n                    arguments: args,\r\n                    invocationId: invocationId.toString(),\r\n                    streamIds,\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    arguments: args,\r\n                    invocationId: invocationId.toString(),\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n        }\r\n    }\r\n    _launchStreams(streams, promiseQueue) {\r\n        if (streams.length === 0) {\r\n            return;\r\n        }\r\n        // Synchronize stream data so they arrive in-order on the server\r\n        if (!promiseQueue) {\r\n            promiseQueue = Promise.resolve();\r\n        }\r\n        // We want to iterate over the keys, since the keys are the stream ids\r\n        // eslint-disable-next-line guard-for-in\r\n        for (const streamId in streams) {\r\n            streams[streamId].subscribe({\r\n                complete: () => {\r\n                    promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createCompletionMessage(streamId)));\r\n                },\r\n                error: (err) => {\r\n                    let message;\r\n                    if (err instanceof Error) {\r\n                        message = err.message;\r\n                    }\r\n                    else if (err && err.toString) {\r\n                        message = err.toString();\r\n                    }\r\n                    else {\r\n                        message = \"Unknown error\";\r\n                    }\r\n                    promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createCompletionMessage(streamId, message)));\r\n                },\r\n                next: (item) => {\r\n                    promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createStreamItemMessage(streamId, item)));\r\n                },\r\n            });\r\n        }\r\n    }\r\n    _replaceStreamingParams(args) {\r\n        const streams = [];\r\n        const streamIds = [];\r\n        for (let i = 0; i < args.length; i++) {\r\n            const argument = args[i];\r\n            if (this._isObservable(argument)) {\r\n                const streamId = this._invocationId;\r\n                this._invocationId++;\r\n                // Store the stream for later use\r\n                streams[streamId] = argument;\r\n                streamIds.push(streamId.toString());\r\n                // remove stream from args\r\n                args.splice(i, 1);\r\n            }\r\n        }\r\n        return [streams, streamIds];\r\n    }\r\n    _isObservable(arg) {\r\n        // This allows other stream implementations to just work (like rxjs)\r\n        return arg && arg.subscribe && typeof arg.subscribe === \"function\";\r\n    }\r\n    _createStreamInvocation(methodName, args, streamIds) {\r\n        const invocationId = this._invocationId;\r\n        this._invocationId++;\r\n        if (streamIds.length !== 0) {\r\n            return {\r\n                arguments: args,\r\n                invocationId: invocationId.toString(),\r\n                streamIds,\r\n                target: methodName,\r\n                type: MessageType.StreamInvocation,\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                arguments: args,\r\n                invocationId: invocationId.toString(),\r\n                target: methodName,\r\n                type: MessageType.StreamInvocation,\r\n            };\r\n        }\r\n    }\r\n    _createCancelInvocation(id) {\r\n        return {\r\n            invocationId: id,\r\n            type: MessageType.CancelInvocation,\r\n        };\r\n    }\r\n    _createStreamItemMessage(id, item) {\r\n        return {\r\n            invocationId: id,\r\n            item,\r\n            type: MessageType.StreamItem,\r\n        };\r\n    }\r\n    _createCompletionMessage(id, error, result) {\r\n        if (error) {\r\n            return {\r\n                error,\r\n                invocationId: id,\r\n                type: MessageType.Completion,\r\n            };\r\n        }\r\n        return {\r\n            invocationId: id,\r\n            result,\r\n            type: MessageType.Completion,\r\n        };\r\n    }\r\n    _createCloseMessage() {\r\n        return { type: MessageType.Close };\r\n    }\r\n}\r\n//# sourceMappingURL=HubConnection.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// 0, 2, 10, 30 second delays before reconnect attempts.\r\nconst DEFAULT_RETRY_DELAYS_IN_MILLISECONDS = [0, 2000, 10000, 30000, null];\r\n/** @private */\r\nexport class DefaultReconnectPolicy {\r\n    constructor(retryDelays) {\r\n        this._retryDelays = retryDelays !== undefined ? [...retryDelays, null] : DEFAULT_RETRY_DELAYS_IN_MILLISECONDS;\r\n    }\r\n    nextRetryDelayInMilliseconds(retryContext) {\r\n        return this._retryDelays[retryContext.previousRetryCount];\r\n    }\r\n}\r\n//# sourceMappingURL=DefaultReconnectPolicy.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nexport class HeaderNames {\r\n}\r\nHeaderNames.Authorization = \"Authorization\";\r\nHeaderNames.Cookie = \"Cookie\";\r\n//# sourceMappingURL=HeaderNames.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { HeaderNames } from \"./HeaderNames\";\r\nimport { HttpClient } from \"./HttpClient\";\r\n/** @private */\r\nexport class AccessTokenHttpClient extends HttpClient {\r\n    constructor(innerClient, accessTokenFactory) {\r\n        super();\r\n        this._innerClient = innerClient;\r\n        this._accessTokenFactory = accessTokenFactory;\r\n    }\r\n    async send(request) {\r\n        let allowRetry = true;\r\n        if (this._accessTokenFactory && (!this._accessToken || (request.url && request.url.indexOf(\"/negotiate?\") > 0))) {\r\n            // don't retry if the request is a negotiate or if we just got a potentially new token from the access token factory\r\n            allowRetry = false;\r\n            this._accessToken = await this._accessTokenFactory();\r\n        }\r\n        this._setAuthorizationHeader(request);\r\n        const response = await this._innerClient.send(request);\r\n        if (allowRetry && response.statusCode === 401 && this._accessTokenFactory) {\r\n            this._accessToken = await this._accessTokenFactory();\r\n            this._setAuthorizationHeader(request);\r\n            return await this._innerClient.send(request);\r\n        }\r\n        return response;\r\n    }\r\n    _setAuthorizationHeader(request) {\r\n        if (!request.headers) {\r\n            request.headers = {};\r\n        }\r\n        if (this._accessToken) {\r\n            request.headers[HeaderNames.Authorization] = `Bearer ${this._accessToken}`;\r\n        }\r\n        // don't remove the header if there isn't an access token factory, the user manually added the header in this case\r\n        else if (this._accessTokenFactory) {\r\n            if (request.headers[HeaderNames.Authorization]) {\r\n                delete request.headers[HeaderNames.Authorization];\r\n            }\r\n        }\r\n    }\r\n    getCookieString(url) {\r\n        return this._innerClient.getCookieString(url);\r\n    }\r\n}\r\n//# sourceMappingURL=AccessTokenHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// This will be treated as a bit flag in the future, so we keep it using power-of-two values.\r\n/** Specifies a specific HTTP transport type. */\r\nexport var HttpTransportType;\r\n(function (HttpTransportType) {\r\n    /** Specifies no transport preference. */\r\n    HttpTransportType[HttpTransportType[\"None\"] = 0] = \"None\";\r\n    /** Specifies the WebSockets transport. */\r\n    HttpTransportType[HttpTransportType[\"WebSockets\"] = 1] = \"WebSockets\";\r\n    /** Specifies the Server-Sent Events transport. */\r\n    HttpTransportType[HttpTransportType[\"ServerSentEvents\"] = 2] = \"ServerSentEvents\";\r\n    /** Specifies the Long Polling transport. */\r\n    HttpTransportType[HttpTransportType[\"LongPolling\"] = 4] = \"LongPolling\";\r\n})(HttpTransportType || (HttpTransportType = {}));\r\n/** Specifies the transfer format for a connection. */\r\nexport var TransferFormat;\r\n(function (TransferFormat) {\r\n    /** Specifies that only text data will be transmitted over the connection. */\r\n    TransferFormat[TransferFormat[\"Text\"] = 1] = \"Text\";\r\n    /** Specifies that binary data will be transmitted over the connection. */\r\n    TransferFormat[TransferFormat[\"Binary\"] = 2] = \"Binary\";\r\n})(TransferFormat || (TransferFormat = {}));\r\n//# sourceMappingURL=ITransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// Rough polyfill of https://developer.mozilla.org/en-US/docs/Web/API/AbortController\r\n// We don't actually ever use the API being polyfilled, we always use the polyfill because\r\n// it's a very new API right now.\r\n// Not exported from index.\r\n/** @private */\r\nexport class AbortController {\r\n    constructor() {\r\n        this._isAborted = false;\r\n        this.onabort = null;\r\n    }\r\n    abort() {\r\n        if (!this._isAborted) {\r\n            this._isAborted = true;\r\n            if (this.onabort) {\r\n                this.onabort();\r\n            }\r\n        }\r\n    }\r\n    get signal() {\r\n        return this;\r\n    }\r\n    get aborted() {\r\n        return this._isAborted;\r\n    }\r\n}\r\n//# sourceMappingURL=AbortController.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortController } from \"./AbortController\";\r\nimport { HttpError, TimeoutError } from \"./Errors\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, getUserAgentHeader, sendMessage } from \"./Utils\";\r\n// Not exported from 'index', this type is internal.\r\n/** @private */\r\nexport class LongPollingTransport {\r\n    // This is an internal type, not exported from 'index' so this is really just internal.\r\n    get pollAborted() {\r\n        return this._pollAbort.aborted;\r\n    }\r\n    constructor(httpClient, logger, options) {\r\n        this._httpClient = httpClient;\r\n        this._logger = logger;\r\n        this._pollAbort = new AbortController();\r\n        this._options = options;\r\n        this._running = false;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    async connect(url, transferFormat) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isRequired(transferFormat, \"transferFormat\");\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._url = url;\r\n        this._logger.log(LogLevel.Trace, \"(LongPolling transport) Connecting.\");\r\n        // Allow binary format on Node and Browsers that support binary content (indicated by the presence of responseType property)\r\n        if (transferFormat === TransferFormat.Binary &&\r\n            (typeof XMLHttpRequest !== \"undefined\" && typeof new XMLHttpRequest().responseType !== \"string\")) {\r\n            throw new Error(\"Binary protocols over XmlHttpRequest not implementing advanced features are not supported.\");\r\n        }\r\n        const [name, value] = getUserAgentHeader();\r\n        const headers = { [name]: value, ...this._options.headers };\r\n        const pollOptions = {\r\n            abortSignal: this._pollAbort.signal,\r\n            headers,\r\n            timeout: 100000,\r\n            withCredentials: this._options.withCredentials,\r\n        };\r\n        if (transferFormat === TransferFormat.Binary) {\r\n            pollOptions.responseType = \"arraybuffer\";\r\n        }\r\n        // Make initial long polling request\r\n        // Server uses first long polling request to finish initializing connection and it returns without data\r\n        const pollUrl = `${url}&_=${Date.now()}`;\r\n        this._logger.log(LogLevel.Trace, `(LongPolling transport) polling: ${pollUrl}.`);\r\n        const response = await this._httpClient.get(pollUrl, pollOptions);\r\n        if (response.statusCode !== 200) {\r\n            this._logger.log(LogLevel.Error, `(LongPolling transport) Unexpected response code: ${response.statusCode}.`);\r\n            // Mark running as false so that the poll immediately ends and runs the close logic\r\n            this._closeError = new HttpError(response.statusText || \"\", response.statusCode);\r\n            this._running = false;\r\n        }\r\n        else {\r\n            this._running = true;\r\n        }\r\n        this._receiving = this._poll(this._url, pollOptions);\r\n    }\r\n    async _poll(url, pollOptions) {\r\n        try {\r\n            while (this._running) {\r\n                try {\r\n                    const pollUrl = `${url}&_=${Date.now()}`;\r\n                    this._logger.log(LogLevel.Trace, `(LongPolling transport) polling: ${pollUrl}.`);\r\n                    const response = await this._httpClient.get(pollUrl, pollOptions);\r\n                    if (response.statusCode === 204) {\r\n                        this._logger.log(LogLevel.Information, \"(LongPolling transport) Poll terminated by server.\");\r\n                        this._running = false;\r\n                    }\r\n                    else if (response.statusCode !== 200) {\r\n                        this._logger.log(LogLevel.Error, `(LongPolling transport) Unexpected response code: ${response.statusCode}.`);\r\n                        // Unexpected status code\r\n                        this._closeError = new HttpError(response.statusText || \"\", response.statusCode);\r\n                        this._running = false;\r\n                    }\r\n                    else {\r\n                        // Process the response\r\n                        if (response.content) {\r\n                            this._logger.log(LogLevel.Trace, `(LongPolling transport) data received. ${getDataDetail(response.content, this._options.logMessageContent)}.`);\r\n                            if (this.onreceive) {\r\n                                this.onreceive(response.content);\r\n                            }\r\n                        }\r\n                        else {\r\n                            // This is another way timeout manifest.\r\n                            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\r\n                        }\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    if (!this._running) {\r\n                        // Log but disregard errors that occur after stopping\r\n                        this._logger.log(LogLevel.Trace, `(LongPolling transport) Poll errored after shutdown: ${e.message}`);\r\n                    }\r\n                    else {\r\n                        if (e instanceof TimeoutError) {\r\n                            // Ignore timeouts and reissue the poll.\r\n                            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\r\n                        }\r\n                        else {\r\n                            // Close the connection with the error as the result.\r\n                            this._closeError = e;\r\n                            this._running = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        finally {\r\n            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Polling complete.\");\r\n            // We will reach here with pollAborted==false when the server returned a response causing the transport to stop.\r\n            // If pollAborted==true then client initiated the stop and the stop method will raise the close event after DELETE is sent.\r\n            if (!this.pollAborted) {\r\n                this._raiseOnClose();\r\n            }\r\n        }\r\n    }\r\n    async send(data) {\r\n        if (!this._running) {\r\n            return Promise.reject(new Error(\"Cannot send until the transport is connected\"));\r\n        }\r\n        return sendMessage(this._logger, \"LongPolling\", this._httpClient, this._url, data, this._options);\r\n    }\r\n    async stop() {\r\n        this._logger.log(LogLevel.Trace, \"(LongPolling transport) Stopping polling.\");\r\n        // Tell receiving loop to stop, abort any current request, and then wait for it to finish\r\n        this._running = false;\r\n        this._pollAbort.abort();\r\n        try {\r\n            await this._receiving;\r\n            // Send DELETE to clean up long polling on the server\r\n            this._logger.log(LogLevel.Trace, `(LongPolling transport) sending DELETE request to ${this._url}.`);\r\n            const headers = {};\r\n            const [name, value] = getUserAgentHeader();\r\n            headers[name] = value;\r\n            const deleteOptions = {\r\n                headers: { ...headers, ...this._options.headers },\r\n                timeout: this._options.timeout,\r\n                withCredentials: this._options.withCredentials,\r\n            };\r\n            let error;\r\n            try {\r\n                await this._httpClient.delete(this._url, deleteOptions);\r\n            }\r\n            catch (err) {\r\n                error = err;\r\n            }\r\n            if (error) {\r\n                if (error instanceof HttpError) {\r\n                    if (error.statusCode === 404) {\r\n                        this._logger.log(LogLevel.Trace, \"(LongPolling transport) A 404 response was returned from sending a DELETE request.\");\r\n                    }\r\n                    else {\r\n                        this._logger.log(LogLevel.Trace, `(LongPolling transport) Error sending a DELETE request: ${error}`);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                this._logger.log(LogLevel.Trace, \"(LongPolling transport) DELETE request accepted.\");\r\n            }\r\n        }\r\n        finally {\r\n            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Stop finished.\");\r\n            // Raise close event here instead of in polling\r\n            // It needs to happen after the DELETE request is sent\r\n            this._raiseOnClose();\r\n        }\r\n    }\r\n    _raiseOnClose() {\r\n        if (this.onclose) {\r\n            let logMessage = \"(LongPolling transport) Firing onclose event.\";\r\n            if (this._closeError) {\r\n                logMessage += \" Error: \" + this._closeError;\r\n            }\r\n            this._logger.log(LogLevel.Trace, logMessage);\r\n            this.onclose(this._closeError);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=LongPollingTransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, getUserAgentHeader, Platform, sendMessage } from \"./Utils\";\r\n/** @private */\r\nexport class ServerSentEventsTransport {\r\n    constructor(httpClient, accessToken, logger, options) {\r\n        this._httpClient = httpClient;\r\n        this._accessToken = accessToken;\r\n        this._logger = logger;\r\n        this._options = options;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    async connect(url, transferFormat) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isRequired(transferFormat, \"transferFormat\");\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._logger.log(LogLevel.Trace, \"(SSE transport) Connecting.\");\r\n        // set url before accessTokenFactory because this._url is only for send and we set the auth header instead of the query string for send\r\n        this._url = url;\r\n        if (this._accessToken) {\r\n            url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + `access_token=${encodeURIComponent(this._accessToken)}`;\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            let opened = false;\r\n            if (transferFormat !== TransferFormat.Text) {\r\n                reject(new Error(\"The Server-Sent Events transport only supports the 'Text' transfer format\"));\r\n                return;\r\n            }\r\n            let eventSource;\r\n            if (Platform.isBrowser || Platform.isWebWorker) {\r\n                eventSource = new this._options.EventSource(url, { withCredentials: this._options.withCredentials });\r\n            }\r\n            else {\r\n                // Non-browser passes cookies via the dictionary\r\n                const cookies = this._httpClient.getCookieString(url);\r\n                const headers = {};\r\n                headers.Cookie = cookies;\r\n                const [name, value] = getUserAgentHeader();\r\n                headers[name] = value;\r\n                eventSource = new this._options.EventSource(url, { withCredentials: this._options.withCredentials, headers: { ...headers, ...this._options.headers } });\r\n            }\r\n            try {\r\n                eventSource.onmessage = (e) => {\r\n                    if (this.onreceive) {\r\n                        try {\r\n                            this._logger.log(LogLevel.Trace, `(SSE transport) data received. ${getDataDetail(e.data, this._options.logMessageContent)}.`);\r\n                            this.onreceive(e.data);\r\n                        }\r\n                        catch (error) {\r\n                            this._close(error);\r\n                            return;\r\n                        }\r\n                    }\r\n                };\r\n                // @ts-ignore: not using event on purpose\r\n                eventSource.onerror = (e) => {\r\n                    // EventSource doesn't give any useful information about server side closes.\r\n                    if (opened) {\r\n                        this._close();\r\n                    }\r\n                    else {\r\n                        reject(new Error(\"EventSource failed to connect. The connection could not be found on the server,\"\r\n                            + \" either the connection ID is not present on the server, or a proxy is refusing/buffering the connection.\"\r\n                            + \" If you have multiple servers check that sticky sessions are enabled.\"));\r\n                    }\r\n                };\r\n                eventSource.onopen = () => {\r\n                    this._logger.log(LogLevel.Information, `SSE connected to ${this._url}`);\r\n                    this._eventSource = eventSource;\r\n                    opened = true;\r\n                    resolve();\r\n                };\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n                return;\r\n            }\r\n        });\r\n    }\r\n    async send(data) {\r\n        if (!this._eventSource) {\r\n            return Promise.reject(new Error(\"Cannot send until the transport is connected\"));\r\n        }\r\n        return sendMessage(this._logger, \"SSE\", this._httpClient, this._url, data, this._options);\r\n    }\r\n    stop() {\r\n        this._close();\r\n        return Promise.resolve();\r\n    }\r\n    _close(e) {\r\n        if (this._eventSource) {\r\n            this._eventSource.close();\r\n            this._eventSource = undefined;\r\n            if (this.onclose) {\r\n                this.onclose(e);\r\n            }\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=ServerSentEventsTransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { HeaderNames } from \"./HeaderNames\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, getUserAgentHeader, Platform } from \"./Utils\";\r\n/** @private */\r\nexport class WebSocketTransport {\r\n    constructor(httpClient, accessTokenFactory, logger, logMessageContent, webSocketConstructor, headers) {\r\n        this._logger = logger;\r\n        this._accessTokenFactory = accessTokenFactory;\r\n        this._logMessageContent = logMessageContent;\r\n        this._webSocketConstructor = webSocketConstructor;\r\n        this._httpClient = httpClient;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n        this._headers = headers;\r\n    }\r\n    async connect(url, transferFormat) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isRequired(transferFormat, \"transferFormat\");\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._logger.log(LogLevel.Trace, \"(WebSockets transport) Connecting.\");\r\n        let token;\r\n        if (this._accessTokenFactory) {\r\n            token = await this._accessTokenFactory();\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            url = url.replace(/^http/, \"ws\");\r\n            let webSocket;\r\n            const cookies = this._httpClient.getCookieString(url);\r\n            let opened = false;\r\n            if (Platform.isNode || Platform.isReactNative) {\r\n                const headers = {};\r\n                const [name, value] = getUserAgentHeader();\r\n                headers[name] = value;\r\n                if (token) {\r\n                    headers[HeaderNames.Authorization] = `Bearer ${token}`;\r\n                }\r\n                if (cookies) {\r\n                    headers[HeaderNames.Cookie] = cookies;\r\n                }\r\n                // Only pass headers when in non-browser environments\r\n                webSocket = new this._webSocketConstructor(url, undefined, {\r\n                    headers: { ...headers, ...this._headers },\r\n                });\r\n            }\r\n            else {\r\n                if (token) {\r\n                    url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + `access_token=${encodeURIComponent(token)}`;\r\n                }\r\n            }\r\n            if (!webSocket) {\r\n                // Chrome is not happy with passing 'undefined' as protocol\r\n                webSocket = new this._webSocketConstructor(url);\r\n            }\r\n            if (transferFormat === TransferFormat.Binary) {\r\n                webSocket.binaryType = \"arraybuffer\";\r\n            }\r\n            webSocket.onopen = (_event) => {\r\n                this._logger.log(LogLevel.Information, `WebSocket connected to ${url}.`);\r\n                this._webSocket = webSocket;\r\n                opened = true;\r\n                resolve();\r\n            };\r\n            webSocket.onerror = (event) => {\r\n                let error = null;\r\n                // ErrorEvent is a browser only type we need to check if the type exists before using it\r\n                if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\r\n                    error = event.error;\r\n                }\r\n                else {\r\n                    error = \"There was an error with the transport\";\r\n                }\r\n                this._logger.log(LogLevel.Information, `(WebSockets transport) ${error}.`);\r\n            };\r\n            webSocket.onmessage = (message) => {\r\n                this._logger.log(LogLevel.Trace, `(WebSockets transport) data received. ${getDataDetail(message.data, this._logMessageContent)}.`);\r\n                if (this.onreceive) {\r\n                    try {\r\n                        this.onreceive(message.data);\r\n                    }\r\n                    catch (error) {\r\n                        this._close(error);\r\n                        return;\r\n                    }\r\n                }\r\n            };\r\n            webSocket.onclose = (event) => {\r\n                // Don't call close handler if connection was never established\r\n                // We'll reject the connect call instead\r\n                if (opened) {\r\n                    this._close(event);\r\n                }\r\n                else {\r\n                    let error = null;\r\n                    // ErrorEvent is a browser only type we need to check if the type exists before using it\r\n                    if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\r\n                        error = event.error;\r\n                    }\r\n                    else {\r\n                        error = \"WebSocket failed to connect. The connection could not be found on the server,\"\r\n                            + \" either the endpoint may not be a SignalR endpoint,\"\r\n                            + \" the connection ID is not present on the server, or there is a proxy blocking WebSockets.\"\r\n                            + \" If you have multiple servers check that sticky sessions are enabled.\";\r\n                    }\r\n                    reject(new Error(error));\r\n                }\r\n            };\r\n        });\r\n    }\r\n    send(data) {\r\n        if (this._webSocket && this._webSocket.readyState === this._webSocketConstructor.OPEN) {\r\n            this._logger.log(LogLevel.Trace, `(WebSockets transport) sending data. ${getDataDetail(data, this._logMessageContent)}.`);\r\n            this._webSocket.send(data);\r\n            return Promise.resolve();\r\n        }\r\n        return Promise.reject(\"WebSocket is not in the OPEN state\");\r\n    }\r\n    stop() {\r\n        if (this._webSocket) {\r\n            // Manually invoke onclose callback inline so we know the HttpConnection was closed properly before returning\r\n            // This also solves an issue where websocket.onclose could take 18+ seconds to trigger during network disconnects\r\n            this._close(undefined);\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    _close(event) {\r\n        // webSocket will be null if the transport did not start successfully\r\n        if (this._webSocket) {\r\n            // Clear websocket handlers because we are considering the socket closed now\r\n            this._webSocket.onclose = () => { };\r\n            this._webSocket.onmessage = () => { };\r\n            this._webSocket.onerror = () => { };\r\n            this._webSocket.close();\r\n            this._webSocket = undefined;\r\n        }\r\n        this._logger.log(LogLevel.Trace, \"(WebSockets transport) socket closed.\");\r\n        if (this.onclose) {\r\n            if (this._isCloseEvent(event) && (event.wasClean === false || event.code !== 1000)) {\r\n                this.onclose(new Error(`WebSocket closed with status code: ${event.code} (${event.reason || \"no reason given\"}).`));\r\n            }\r\n            else if (event instanceof Error) {\r\n                this.onclose(event);\r\n            }\r\n            else {\r\n                this.onclose();\r\n            }\r\n        }\r\n    }\r\n    _isCloseEvent(event) {\r\n        return event && typeof event.wasClean === \"boolean\" && typeof event.code === \"number\";\r\n    }\r\n}\r\n//# sourceMappingURL=WebSocketTransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AccessTokenHttpClient } from \"./AccessTokenHttpClient\";\r\nimport { DefaultHttpClient } from \"./DefaultHttpClient\";\r\nimport { AggregateErrors, DisabledTransportError, FailedToNegotiateWithServerError, FailedToStartTransportError, HttpError, UnsupportedTransportError, AbortError } from \"./Errors\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { HttpTransportType, TransferFormat } from \"./ITransport\";\r\nimport { LongPollingTransport } from \"./LongPollingTransport\";\r\nimport { ServerSentEventsTransport } from \"./ServerSentEventsTransport\";\r\nimport { Arg, createLogger, getUserAgentHeader, Platform } from \"./Utils\";\r\nimport { WebSocketTransport } from \"./WebSocketTransport\";\r\nconst MAX_REDIRECTS = 100;\r\n/** @private */\r\nexport class HttpConnection {\r\n    constructor(url, options = {}) {\r\n        this._stopPromiseResolver = () => { };\r\n        this.features = {};\r\n        this._negotiateVersion = 1;\r\n        Arg.isRequired(url, \"url\");\r\n        this._logger = createLogger(options.logger);\r\n        this.baseUrl = this._resolveUrl(url);\r\n        options = options || {};\r\n        options.logMessageContent = options.logMessageContent === undefined ? false : options.logMessageContent;\r\n        if (typeof options.withCredentials === \"boolean\" || options.withCredentials === undefined) {\r\n            options.withCredentials = options.withCredentials === undefined ? true : options.withCredentials;\r\n        }\r\n        else {\r\n            throw new Error(\"withCredentials option was not a 'boolean' or 'undefined' value\");\r\n        }\r\n        options.timeout = options.timeout === undefined ? 100 * 1000 : options.timeout;\r\n        let webSocketModule = null;\r\n        let eventSourceModule = null;\r\n        if (Platform.isNode && typeof require !== \"undefined\") {\r\n            // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n            // @ts-ignore: TS doesn't know about these names\r\n            const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n            webSocketModule = requireFunc(\"ws\");\r\n            eventSourceModule = requireFunc(\"eventsource\");\r\n        }\r\n        if (!Platform.isNode && typeof WebSocket !== \"undefined\" && !options.WebSocket) {\r\n            options.WebSocket = WebSocket;\r\n        }\r\n        else if (Platform.isNode && !options.WebSocket) {\r\n            if (webSocketModule) {\r\n                options.WebSocket = webSocketModule;\r\n            }\r\n        }\r\n        if (!Platform.isNode && typeof EventSource !== \"undefined\" && !options.EventSource) {\r\n            options.EventSource = EventSource;\r\n        }\r\n        else if (Platform.isNode && !options.EventSource) {\r\n            if (typeof eventSourceModule !== \"undefined\") {\r\n                options.EventSource = eventSourceModule;\r\n            }\r\n        }\r\n        this._httpClient = new AccessTokenHttpClient(options.httpClient || new DefaultHttpClient(this._logger), options.accessTokenFactory);\r\n        this._connectionState = \"Disconnected\" /* ConnectionState.Disconnected */;\r\n        this._connectionStarted = false;\r\n        this._options = options;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    async start(transferFormat) {\r\n        transferFormat = transferFormat || TransferFormat.Binary;\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._logger.log(LogLevel.Debug, `Starting connection with transfer format '${TransferFormat[transferFormat]}'.`);\r\n        if (this._connectionState !== \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n            return Promise.reject(new Error(\"Cannot start an HttpConnection that is not in the 'Disconnected' state.\"));\r\n        }\r\n        this._connectionState = \"Connecting\" /* ConnectionState.Connecting */;\r\n        this._startInternalPromise = this._startInternal(transferFormat);\r\n        await this._startInternalPromise;\r\n        // The TypeScript compiler thinks that connectionState must be Connecting here. The TypeScript compiler is wrong.\r\n        if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */) {\r\n            // stop() was called and transitioned the client into the Disconnecting state.\r\n            const message = \"Failed to start the HttpConnection before stop() was called.\";\r\n            this._logger.log(LogLevel.Error, message);\r\n            // We cannot await stopPromise inside startInternal since stopInternal awaits the startInternalPromise.\r\n            await this._stopPromise;\r\n            return Promise.reject(new AbortError(message));\r\n        }\r\n        else if (this._connectionState !== \"Connected\" /* ConnectionState.Connected */) {\r\n            // stop() was called and transitioned the client into the Disconnecting state.\r\n            const message = \"HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!\";\r\n            this._logger.log(LogLevel.Error, message);\r\n            return Promise.reject(new AbortError(message));\r\n        }\r\n        this._connectionStarted = true;\r\n    }\r\n    send(data) {\r\n        if (this._connectionState !== \"Connected\" /* ConnectionState.Connected */) {\r\n            return Promise.reject(new Error(\"Cannot send data if the connection is not in the 'Connected' State.\"));\r\n        }\r\n        if (!this._sendQueue) {\r\n            this._sendQueue = new TransportSendQueue(this.transport);\r\n        }\r\n        // Transport will not be null if state is connected\r\n        return this._sendQueue.send(data);\r\n    }\r\n    async stop(error) {\r\n        if (this._connectionState === \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnected state.`);\r\n            return Promise.resolve();\r\n        }\r\n        if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnecting state.`);\r\n            return this._stopPromise;\r\n        }\r\n        this._connectionState = \"Disconnecting\" /* ConnectionState.Disconnecting */;\r\n        this._stopPromise = new Promise((resolve) => {\r\n            // Don't complete stop() until stopConnection() completes.\r\n            this._stopPromiseResolver = resolve;\r\n        });\r\n        // stopInternal should never throw so just observe it.\r\n        await this._stopInternal(error);\r\n        await this._stopPromise;\r\n    }\r\n    async _stopInternal(error) {\r\n        // Set error as soon as possible otherwise there is a race between\r\n        // the transport closing and providing an error and the error from a close message\r\n        // We would prefer the close message error.\r\n        this._stopError = error;\r\n        try {\r\n            await this._startInternalPromise;\r\n        }\r\n        catch (e) {\r\n            // This exception is returned to the user as a rejected Promise from the start method.\r\n        }\r\n        // The transport's onclose will trigger stopConnection which will run our onclose event.\r\n        // The transport should always be set if currently connected. If it wasn't set, it's likely because\r\n        // stop was called during start() and start() failed.\r\n        if (this.transport) {\r\n            try {\r\n                await this.transport.stop();\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `HttpConnection.transport.stop() threw error '${e}'.`);\r\n                this._stopConnection();\r\n            }\r\n            this.transport = undefined;\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Debug, \"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.\");\r\n        }\r\n    }\r\n    async _startInternal(transferFormat) {\r\n        // Store the original base url and the access token factory since they may change\r\n        // as part of negotiating\r\n        let url = this.baseUrl;\r\n        this._accessTokenFactory = this._options.accessTokenFactory;\r\n        this._httpClient._accessTokenFactory = this._accessTokenFactory;\r\n        try {\r\n            if (this._options.skipNegotiation) {\r\n                if (this._options.transport === HttpTransportType.WebSockets) {\r\n                    // No need to add a connection ID in this case\r\n                    this.transport = this._constructTransport(HttpTransportType.WebSockets);\r\n                    // We should just call connect directly in this case.\r\n                    // No fallback or negotiate in this case.\r\n                    await this._startTransport(url, transferFormat);\r\n                }\r\n                else {\r\n                    throw new Error(\"Negotiation can only be skipped when using the WebSocket transport directly.\");\r\n                }\r\n            }\r\n            else {\r\n                let negotiateResponse = null;\r\n                let redirects = 0;\r\n                do {\r\n                    negotiateResponse = await this._getNegotiationResponse(url);\r\n                    // the user tries to stop the connection when it is being started\r\n                    if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */ || this._connectionState === \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n                        throw new AbortError(\"The connection was stopped during negotiation.\");\r\n                    }\r\n                    if (negotiateResponse.error) {\r\n                        throw new Error(negotiateResponse.error);\r\n                    }\r\n                    if (negotiateResponse.ProtocolVersion) {\r\n                        throw new Error(\"Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.\");\r\n                    }\r\n                    if (negotiateResponse.url) {\r\n                        url = negotiateResponse.url;\r\n                    }\r\n                    if (negotiateResponse.accessToken) {\r\n                        // Replace the current access token factory with one that uses\r\n                        // the returned access token\r\n                        const accessToken = negotiateResponse.accessToken;\r\n                        this._accessTokenFactory = () => accessToken;\r\n                        // set the factory to undefined so the AccessTokenHttpClient won't retry with the same token, since we know it won't change until a connection restart\r\n                        this._httpClient._accessToken = accessToken;\r\n                        this._httpClient._accessTokenFactory = undefined;\r\n                    }\r\n                    redirects++;\r\n                } while (negotiateResponse.url && redirects < MAX_REDIRECTS);\r\n                if (redirects === MAX_REDIRECTS && negotiateResponse.url) {\r\n                    throw new Error(\"Negotiate redirection limit exceeded.\");\r\n                }\r\n                await this._createTransport(url, this._options.transport, negotiateResponse, transferFormat);\r\n            }\r\n            if (this.transport instanceof LongPollingTransport) {\r\n                this.features.inherentKeepAlive = true;\r\n            }\r\n            if (this._connectionState === \"Connecting\" /* ConnectionState.Connecting */) {\r\n                // Ensure the connection transitions to the connected state prior to completing this.startInternalPromise.\r\n                // start() will handle the case when stop was called and startInternal exits still in the disconnecting state.\r\n                this._logger.log(LogLevel.Debug, \"The HttpConnection connected successfully.\");\r\n                this._connectionState = \"Connected\" /* ConnectionState.Connected */;\r\n            }\r\n            // stop() is waiting on us via this.startInternalPromise so keep this.transport around so it can clean up.\r\n            // This is the only case startInternal can exit in neither the connected nor disconnected state because stopConnection()\r\n            // will transition to the disconnected state. start() will wait for the transition using the stopPromise.\r\n        }\r\n        catch (e) {\r\n            this._logger.log(LogLevel.Error, \"Failed to start the connection: \" + e);\r\n            this._connectionState = \"Disconnected\" /* ConnectionState.Disconnected */;\r\n            this.transport = undefined;\r\n            // if start fails, any active calls to stop assume that start will complete the stop promise\r\n            this._stopPromiseResolver();\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n    async _getNegotiationResponse(url) {\r\n        const headers = {};\r\n        const [name, value] = getUserAgentHeader();\r\n        headers[name] = value;\r\n        const negotiateUrl = this._resolveNegotiateUrl(url);\r\n        this._logger.log(LogLevel.Debug, `Sending negotiation request: ${negotiateUrl}.`);\r\n        try {\r\n            const response = await this._httpClient.post(negotiateUrl, {\r\n                content: \"\",\r\n                headers: { ...headers, ...this._options.headers },\r\n                timeout: this._options.timeout,\r\n                withCredentials: this._options.withCredentials,\r\n            });\r\n            if (response.statusCode !== 200) {\r\n                return Promise.reject(new Error(`Unexpected status code returned from negotiate '${response.statusCode}'`));\r\n            }\r\n            const negotiateResponse = JSON.parse(response.content);\r\n            if (!negotiateResponse.negotiateVersion || negotiateResponse.negotiateVersion < 1) {\r\n                // Negotiate version 0 doesn't use connectionToken\r\n                // So we set it equal to connectionId so all our logic can use connectionToken without being aware of the negotiate version\r\n                negotiateResponse.connectionToken = negotiateResponse.connectionId;\r\n            }\r\n            if (negotiateResponse.useStatefulReconnect && this._options._useStatefulReconnect !== true) {\r\n                return Promise.reject(new FailedToNegotiateWithServerError(\"Client didn't negotiate Stateful Reconnect but the server did.\"));\r\n            }\r\n            return negotiateResponse;\r\n        }\r\n        catch (e) {\r\n            let errorMessage = \"Failed to complete negotiation with the server: \" + e;\r\n            if (e instanceof HttpError) {\r\n                if (e.statusCode === 404) {\r\n                    errorMessage = errorMessage + \" Either this is not a SignalR endpoint or there is a proxy blocking the connection.\";\r\n                }\r\n            }\r\n            this._logger.log(LogLevel.Error, errorMessage);\r\n            return Promise.reject(new FailedToNegotiateWithServerError(errorMessage));\r\n        }\r\n    }\r\n    _createConnectUrl(url, connectionToken) {\r\n        if (!connectionToken) {\r\n            return url;\r\n        }\r\n        return url + (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + `id=${connectionToken}`;\r\n    }\r\n    async _createTransport(url, requestedTransport, negotiateResponse, requestedTransferFormat) {\r\n        let connectUrl = this._createConnectUrl(url, negotiateResponse.connectionToken);\r\n        if (this._isITransport(requestedTransport)) {\r\n            this._logger.log(LogLevel.Debug, \"Connection was provided an instance of ITransport, using that directly.\");\r\n            this.transport = requestedTransport;\r\n            await this._startTransport(connectUrl, requestedTransferFormat);\r\n            this.connectionId = negotiateResponse.connectionId;\r\n            return;\r\n        }\r\n        const transportExceptions = [];\r\n        const transports = negotiateResponse.availableTransports || [];\r\n        let negotiate = negotiateResponse;\r\n        for (const endpoint of transports) {\r\n            const transportOrError = this._resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat, (negotiate === null || negotiate === void 0 ? void 0 : negotiate.useStatefulReconnect) === true);\r\n            if (transportOrError instanceof Error) {\r\n                // Store the error and continue, we don't want to cause a re-negotiate in these cases\r\n                transportExceptions.push(`${endpoint.transport} failed:`);\r\n                transportExceptions.push(transportOrError);\r\n            }\r\n            else if (this._isITransport(transportOrError)) {\r\n                this.transport = transportOrError;\r\n                if (!negotiate) {\r\n                    try {\r\n                        negotiate = await this._getNegotiationResponse(url);\r\n                    }\r\n                    catch (ex) {\r\n                        return Promise.reject(ex);\r\n                    }\r\n                    connectUrl = this._createConnectUrl(url, negotiate.connectionToken);\r\n                }\r\n                try {\r\n                    await this._startTransport(connectUrl, requestedTransferFormat);\r\n                    this.connectionId = negotiate.connectionId;\r\n                    return;\r\n                }\r\n                catch (ex) {\r\n                    this._logger.log(LogLevel.Error, `Failed to start the transport '${endpoint.transport}': ${ex}`);\r\n                    negotiate = undefined;\r\n                    transportExceptions.push(new FailedToStartTransportError(`${endpoint.transport} failed: ${ex}`, HttpTransportType[endpoint.transport]));\r\n                    if (this._connectionState !== \"Connecting\" /* ConnectionState.Connecting */) {\r\n                        const message = \"Failed to select transport before stop() was called.\";\r\n                        this._logger.log(LogLevel.Debug, message);\r\n                        return Promise.reject(new AbortError(message));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (transportExceptions.length > 0) {\r\n            return Promise.reject(new AggregateErrors(`Unable to connect to the server with any of the available transports. ${transportExceptions.join(\" \")}`, transportExceptions));\r\n        }\r\n        return Promise.reject(new Error(\"None of the transports supported by the client are supported by the server.\"));\r\n    }\r\n    _constructTransport(transport) {\r\n        switch (transport) {\r\n            case HttpTransportType.WebSockets:\r\n                if (!this._options.WebSocket) {\r\n                    throw new Error(\"'WebSocket' is not supported in your environment.\");\r\n                }\r\n                return new WebSocketTransport(this._httpClient, this._accessTokenFactory, this._logger, this._options.logMessageContent, this._options.WebSocket, this._options.headers || {});\r\n            case HttpTransportType.ServerSentEvents:\r\n                if (!this._options.EventSource) {\r\n                    throw new Error(\"'EventSource' is not supported in your environment.\");\r\n                }\r\n                return new ServerSentEventsTransport(this._httpClient, this._httpClient._accessToken, this._logger, this._options);\r\n            case HttpTransportType.LongPolling:\r\n                return new LongPollingTransport(this._httpClient, this._logger, this._options);\r\n            default:\r\n                throw new Error(`Unknown transport: ${transport}.`);\r\n        }\r\n    }\r\n    _startTransport(url, transferFormat) {\r\n        this.transport.onreceive = this.onreceive;\r\n        if (this.features.reconnect) {\r\n            this.transport.onclose = async (e) => {\r\n                let callStop = false;\r\n                if (this.features.reconnect) {\r\n                    try {\r\n                        this.features.disconnected();\r\n                        await this.transport.connect(url, transferFormat);\r\n                        await this.features.resend();\r\n                    }\r\n                    catch {\r\n                        callStop = true;\r\n                    }\r\n                }\r\n                else {\r\n                    this._stopConnection(e);\r\n                    return;\r\n                }\r\n                if (callStop) {\r\n                    this._stopConnection(e);\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            this.transport.onclose = (e) => this._stopConnection(e);\r\n        }\r\n        return this.transport.connect(url, transferFormat);\r\n    }\r\n    _resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat, useStatefulReconnect) {\r\n        const transport = HttpTransportType[endpoint.transport];\r\n        if (transport === null || transport === undefined) {\r\n            this._logger.log(LogLevel.Debug, `Skipping transport '${endpoint.transport}' because it is not supported by this client.`);\r\n            return new Error(`Skipping transport '${endpoint.transport}' because it is not supported by this client.`);\r\n        }\r\n        else {\r\n            if (transportMatches(requestedTransport, transport)) {\r\n                const transferFormats = endpoint.transferFormats.map((s) => TransferFormat[s]);\r\n                if (transferFormats.indexOf(requestedTransferFormat) >= 0) {\r\n                    if ((transport === HttpTransportType.WebSockets && !this._options.WebSocket) ||\r\n                        (transport === HttpTransportType.ServerSentEvents && !this._options.EventSource)) {\r\n                        this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it is not supported in your environment.'`);\r\n                        return new UnsupportedTransportError(`'${HttpTransportType[transport]}' is not supported in your environment.`, transport);\r\n                    }\r\n                    else {\r\n                        this._logger.log(LogLevel.Debug, `Selecting transport '${HttpTransportType[transport]}'.`);\r\n                        try {\r\n                            this.features.reconnect = transport === HttpTransportType.WebSockets ? useStatefulReconnect : undefined;\r\n                            return this._constructTransport(transport);\r\n                        }\r\n                        catch (ex) {\r\n                            return ex;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it does not support the requested transfer format '${TransferFormat[requestedTransferFormat]}'.`);\r\n                    return new Error(`'${HttpTransportType[transport]}' does not support ${TransferFormat[requestedTransferFormat]}.`);\r\n                }\r\n            }\r\n            else {\r\n                this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it was disabled by the client.`);\r\n                return new DisabledTransportError(`'${HttpTransportType[transport]}' is disabled by the client.`, transport);\r\n            }\r\n        }\r\n    }\r\n    _isITransport(transport) {\r\n        return transport && typeof (transport) === \"object\" && \"connect\" in transport;\r\n    }\r\n    _stopConnection(error) {\r\n        this._logger.log(LogLevel.Debug, `HttpConnection.stopConnection(${error}) called while in state ${this._connectionState}.`);\r\n        this.transport = undefined;\r\n        // If we have a stopError, it takes precedence over the error from the transport\r\n        error = this._stopError || error;\r\n        this._stopError = undefined;\r\n        if (this._connectionState === \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stopConnection(${error}) was ignored because the connection is already in the disconnected state.`);\r\n            return;\r\n        }\r\n        if (this._connectionState === \"Connecting\" /* ConnectionState.Connecting */) {\r\n            this._logger.log(LogLevel.Warning, `Call to HttpConnection.stopConnection(${error}) was ignored because the connection is still in the connecting state.`);\r\n            throw new Error(`HttpConnection.stopConnection(${error}) was called while the connection is still in the connecting state.`);\r\n        }\r\n        if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */) {\r\n            // A call to stop() induced this call to stopConnection and needs to be completed.\r\n            // Any stop() awaiters will be scheduled to continue after the onclose callback fires.\r\n            this._stopPromiseResolver();\r\n        }\r\n        if (error) {\r\n            this._logger.log(LogLevel.Error, `Connection disconnected with error '${error}'.`);\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Information, \"Connection disconnected.\");\r\n        }\r\n        if (this._sendQueue) {\r\n            this._sendQueue.stop().catch((e) => {\r\n                this._logger.log(LogLevel.Error, `TransportSendQueue.stop() threw error '${e}'.`);\r\n            });\r\n            this._sendQueue = undefined;\r\n        }\r\n        this.connectionId = undefined;\r\n        this._connectionState = \"Disconnected\" /* ConnectionState.Disconnected */;\r\n        if (this._connectionStarted) {\r\n            this._connectionStarted = false;\r\n            try {\r\n                if (this.onclose) {\r\n                    this.onclose(error);\r\n                }\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `HttpConnection.onclose(${error}) threw error '${e}'.`);\r\n            }\r\n        }\r\n    }\r\n    _resolveUrl(url) {\r\n        // startsWith is not supported in IE\r\n        if (url.lastIndexOf(\"https://\", 0) === 0 || url.lastIndexOf(\"http://\", 0) === 0) {\r\n            return url;\r\n        }\r\n        if (!Platform.isBrowser) {\r\n            throw new Error(`Cannot resolve '${url}'.`);\r\n        }\r\n        // Setting the url to the href propery of an anchor tag handles normalization\r\n        // for us. There are 3 main cases.\r\n        // 1. Relative path normalization e.g \"b\" -> \"http://localhost:5000/a/b\"\r\n        // 2. Absolute path normalization e.g \"/a/b\" -> \"http://localhost:5000/a/b\"\r\n        // 3. Networkpath reference normalization e.g \"//localhost:5000/a/b\" -> \"http://localhost:5000/a/b\"\r\n        const aTag = window.document.createElement(\"a\");\r\n        aTag.href = url;\r\n        this._logger.log(LogLevel.Information, `Normalizing '${url}' to '${aTag.href}'.`);\r\n        return aTag.href;\r\n    }\r\n    _resolveNegotiateUrl(url) {\r\n        const negotiateUrl = new URL(url);\r\n        if (negotiateUrl.pathname.endsWith('/')) {\r\n            negotiateUrl.pathname += \"negotiate\";\r\n        }\r\n        else {\r\n            negotiateUrl.pathname += \"/negotiate\";\r\n        }\r\n        const searchParams = new URLSearchParams(negotiateUrl.searchParams);\r\n        if (!searchParams.has(\"negotiateVersion\")) {\r\n            searchParams.append(\"negotiateVersion\", this._negotiateVersion.toString());\r\n        }\r\n        if (searchParams.has(\"useStatefulReconnect\")) {\r\n            if (searchParams.get(\"useStatefulReconnect\") === \"true\") {\r\n                this._options._useStatefulReconnect = true;\r\n            }\r\n        }\r\n        else if (this._options._useStatefulReconnect === true) {\r\n            searchParams.append(\"useStatefulReconnect\", \"true\");\r\n        }\r\n        negotiateUrl.search = searchParams.toString();\r\n        return negotiateUrl.toString();\r\n    }\r\n}\r\nfunction transportMatches(requestedTransport, actualTransport) {\r\n    return !requestedTransport || ((actualTransport & requestedTransport) !== 0);\r\n}\r\n/** @private */\r\nexport class TransportSendQueue {\r\n    constructor(_transport) {\r\n        this._transport = _transport;\r\n        this._buffer = [];\r\n        this._executing = true;\r\n        this._sendBufferedData = new PromiseSource();\r\n        this._transportResult = new PromiseSource();\r\n        this._sendLoopPromise = this._sendLoop();\r\n    }\r\n    send(data) {\r\n        this._bufferData(data);\r\n        if (!this._transportResult) {\r\n            this._transportResult = new PromiseSource();\r\n        }\r\n        return this._transportResult.promise;\r\n    }\r\n    stop() {\r\n        this._executing = false;\r\n        this._sendBufferedData.resolve();\r\n        return this._sendLoopPromise;\r\n    }\r\n    _bufferData(data) {\r\n        if (this._buffer.length && typeof (this._buffer[0]) !== typeof (data)) {\r\n            throw new Error(`Expected data to be of type ${typeof (this._buffer)} but was of type ${typeof (data)}`);\r\n        }\r\n        this._buffer.push(data);\r\n        this._sendBufferedData.resolve();\r\n    }\r\n    async _sendLoop() {\r\n        while (true) {\r\n            await this._sendBufferedData.promise;\r\n            if (!this._executing) {\r\n                if (this._transportResult) {\r\n                    this._transportResult.reject(\"Connection stopped.\");\r\n                }\r\n                break;\r\n            }\r\n            this._sendBufferedData = new PromiseSource();\r\n            const transportResult = this._transportResult;\r\n            this._transportResult = undefined;\r\n            const data = typeof (this._buffer[0]) === \"string\" ?\r\n                this._buffer.join(\"\") :\r\n                TransportSendQueue._concatBuffers(this._buffer);\r\n            this._buffer.length = 0;\r\n            try {\r\n                await this._transport.send(data);\r\n                transportResult.resolve();\r\n            }\r\n            catch (error) {\r\n                transportResult.reject(error);\r\n            }\r\n        }\r\n    }\r\n    static _concatBuffers(arrayBuffers) {\r\n        const totalLength = arrayBuffers.map((b) => b.byteLength).reduce((a, b) => a + b);\r\n        const result = new Uint8Array(totalLength);\r\n        let offset = 0;\r\n        for (const item of arrayBuffers) {\r\n            result.set(new Uint8Array(item), offset);\r\n            offset += item.byteLength;\r\n        }\r\n        return result.buffer;\r\n    }\r\n}\r\nclass PromiseSource {\r\n    constructor() {\r\n        this.promise = new Promise((resolve, reject) => [this._resolver, this._rejecter] = [resolve, reject]);\r\n    }\r\n    resolve() {\r\n        this._resolver();\r\n    }\r\n    reject(reason) {\r\n        this._rejecter(reason);\r\n    }\r\n}\r\n//# sourceMappingURL=HttpConnection.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { NullLogger } from \"./Loggers\";\r\nimport { TextMessageFormat } from \"./TextMessageFormat\";\r\nconst JSON_HUB_PROTOCOL_NAME = \"json\";\r\n/** Implements the JSON Hub Protocol. */\r\nexport class JsonHubProtocol {\r\n    constructor() {\r\n        /** @inheritDoc */\r\n        this.name = JSON_HUB_PROTOCOL_NAME;\r\n        /** @inheritDoc */\r\n        this.version = 2;\r\n        /** @inheritDoc */\r\n        this.transferFormat = TransferFormat.Text;\r\n    }\r\n    /** Creates an array of {@link @microsoft/signalr.HubMessage} objects from the specified serialized representation.\r\n     *\r\n     * @param {string} input A string containing the serialized representation.\r\n     * @param {ILogger} logger A logger that will be used to log messages that occur during parsing.\r\n     */\r\n    parseMessages(input, logger) {\r\n        // The interface does allow \"ArrayBuffer\" to be passed in, but this implementation does not. So let's throw a useful error.\r\n        if (typeof input !== \"string\") {\r\n            throw new Error(\"Invalid input for JSON hub protocol. Expected a string.\");\r\n        }\r\n        if (!input) {\r\n            return [];\r\n        }\r\n        if (logger === null) {\r\n            logger = NullLogger.instance;\r\n        }\r\n        // Parse the messages\r\n        const messages = TextMessageFormat.parse(input);\r\n        const hubMessages = [];\r\n        for (const message of messages) {\r\n            const parsedMessage = JSON.parse(message);\r\n            if (typeof parsedMessage.type !== \"number\") {\r\n                throw new Error(\"Invalid payload.\");\r\n            }\r\n            switch (parsedMessage.type) {\r\n                case MessageType.Invocation:\r\n                    this._isInvocationMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.StreamItem:\r\n                    this._isStreamItemMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Completion:\r\n                    this._isCompletionMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Ping:\r\n                    // Single value, no need to validate\r\n                    break;\r\n                case MessageType.Close:\r\n                    // All optional values, no need to validate\r\n                    break;\r\n                case MessageType.Ack:\r\n                    this._isAckMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Sequence:\r\n                    this._isSequenceMessage(parsedMessage);\r\n                    break;\r\n                default:\r\n                    // Future protocol changes can add message types, old clients can ignore them\r\n                    logger.log(LogLevel.Information, \"Unknown message type '\" + parsedMessage.type + \"' ignored.\");\r\n                    continue;\r\n            }\r\n            hubMessages.push(parsedMessage);\r\n        }\r\n        return hubMessages;\r\n    }\r\n    /** Writes the specified {@link @microsoft/signalr.HubMessage} to a string and returns it.\r\n     *\r\n     * @param {HubMessage} message The message to write.\r\n     * @returns {string} A string containing the serialized representation of the message.\r\n     */\r\n    writeMessage(message) {\r\n        return TextMessageFormat.write(JSON.stringify(message));\r\n    }\r\n    _isInvocationMessage(message) {\r\n        this._assertNotEmptyString(message.target, \"Invalid payload for Invocation message.\");\r\n        if (message.invocationId !== undefined) {\r\n            this._assertNotEmptyString(message.invocationId, \"Invalid payload for Invocation message.\");\r\n        }\r\n    }\r\n    _isStreamItemMessage(message) {\r\n        this._assertNotEmptyString(message.invocationId, \"Invalid payload for StreamItem message.\");\r\n        if (message.item === undefined) {\r\n            throw new Error(\"Invalid payload for StreamItem message.\");\r\n        }\r\n    }\r\n    _isCompletionMessage(message) {\r\n        if (message.result && message.error) {\r\n            throw new Error(\"Invalid payload for Completion message.\");\r\n        }\r\n        if (!message.result && message.error) {\r\n            this._assertNotEmptyString(message.error, \"Invalid payload for Completion message.\");\r\n        }\r\n        this._assertNotEmptyString(message.invocationId, \"Invalid payload for Completion message.\");\r\n    }\r\n    _isAckMessage(message) {\r\n        if (typeof message.sequenceId !== 'number') {\r\n            throw new Error(\"Invalid SequenceId for Ack message.\");\r\n        }\r\n    }\r\n    _isSequenceMessage(message) {\r\n        if (typeof message.sequenceId !== 'number') {\r\n            throw new Error(\"Invalid SequenceId for Sequence message.\");\r\n        }\r\n    }\r\n    _assertNotEmptyString(value, errorMessage) {\r\n        if (typeof value !== \"string\" || value === \"\") {\r\n            throw new Error(errorMessage);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=JsonHubProtocol.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { DefaultReconnectPolicy } from \"./DefaultReconnectPolicy\";\r\nimport { HttpConnection } from \"./HttpConnection\";\r\nimport { HubConnection } from \"./HubConnection\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { JsonHubProtocol } from \"./JsonHubProtocol\";\r\nimport { NullLogger } from \"./Loggers\";\r\nimport { Arg, ConsoleLogger } from \"./Utils\";\r\nconst LogLevelNameMapping = {\r\n    trace: LogLevel.Trace,\r\n    debug: LogLevel.Debug,\r\n    info: LogLevel.Information,\r\n    information: LogLevel.Information,\r\n    warn: LogLevel.Warning,\r\n    warning: LogLevel.Warning,\r\n    error: LogLevel.Error,\r\n    critical: LogLevel.Critical,\r\n    none: LogLevel.None,\r\n};\r\nfunction parseLogLevel(name) {\r\n    // Case-insensitive matching via lower-casing\r\n    // Yes, I know case-folding is a complicated problem in Unicode, but we only support\r\n    // the ASCII strings defined in LogLevelNameMapping anyway, so it's fine -anurse.\r\n    const mapping = LogLevelNameMapping[name.toLowerCase()];\r\n    if (typeof mapping !== \"undefined\") {\r\n        return mapping;\r\n    }\r\n    else {\r\n        throw new Error(`Unknown log level: ${name}`);\r\n    }\r\n}\r\n/** A builder for configuring {@link @microsoft/signalr.HubConnection} instances. */\r\nexport class HubConnectionBuilder {\r\n    configureLogging(logging) {\r\n        Arg.isRequired(logging, \"logging\");\r\n        if (isLogger(logging)) {\r\n            this.logger = logging;\r\n        }\r\n        else if (typeof logging === \"string\") {\r\n            const logLevel = parseLogLevel(logging);\r\n            this.logger = new ConsoleLogger(logLevel);\r\n        }\r\n        else {\r\n            this.logger = new ConsoleLogger(logging);\r\n        }\r\n        return this;\r\n    }\r\n    withUrl(url, transportTypeOrOptions) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isNotEmpty(url, \"url\");\r\n        this.url = url;\r\n        // Flow-typing knows where it's at. Since HttpTransportType is a number and IHttpConnectionOptions is guaranteed\r\n        // to be an object, we know (as does TypeScript) this comparison is all we need to figure out which overload was called.\r\n        if (typeof transportTypeOrOptions === \"object\") {\r\n            this.httpConnectionOptions = { ...this.httpConnectionOptions, ...transportTypeOrOptions };\r\n        }\r\n        else {\r\n            this.httpConnectionOptions = {\r\n                ...this.httpConnectionOptions,\r\n                transport: transportTypeOrOptions,\r\n            };\r\n        }\r\n        return this;\r\n    }\r\n    /** Configures the {@link @microsoft/signalr.HubConnection} to use the specified Hub Protocol.\r\n     *\r\n     * @param {IHubProtocol} protocol The {@link @microsoft/signalr.IHubProtocol} implementation to use.\r\n     */\r\n    withHubProtocol(protocol) {\r\n        Arg.isRequired(protocol, \"protocol\");\r\n        this.protocol = protocol;\r\n        return this;\r\n    }\r\n    withAutomaticReconnect(retryDelaysOrReconnectPolicy) {\r\n        if (this.reconnectPolicy) {\r\n            throw new Error(\"A reconnectPolicy has already been set.\");\r\n        }\r\n        if (!retryDelaysOrReconnectPolicy) {\r\n            this.reconnectPolicy = new DefaultReconnectPolicy();\r\n        }\r\n        else if (Array.isArray(retryDelaysOrReconnectPolicy)) {\r\n            this.reconnectPolicy = new DefaultReconnectPolicy(retryDelaysOrReconnectPolicy);\r\n        }\r\n        else {\r\n            this.reconnectPolicy = retryDelaysOrReconnectPolicy;\r\n        }\r\n        return this;\r\n    }\r\n    /** Configures {@link @microsoft/signalr.HubConnection.serverTimeoutInMilliseconds} for the {@link @microsoft/signalr.HubConnection}.\r\n     *\r\n     * @returns The {@link @microsoft/signalr.HubConnectionBuilder} instance, for chaining.\r\n     */\r\n    withServerTimeout(milliseconds) {\r\n        Arg.isRequired(milliseconds, \"milliseconds\");\r\n        this._serverTimeoutInMilliseconds = milliseconds;\r\n        return this;\r\n    }\r\n    /** Configures {@link @microsoft/signalr.HubConnection.keepAliveIntervalInMilliseconds} for the {@link @microsoft/signalr.HubConnection}.\r\n     *\r\n     * @returns The {@link @microsoft/signalr.HubConnectionBuilder} instance, for chaining.\r\n     */\r\n    withKeepAliveInterval(milliseconds) {\r\n        Arg.isRequired(milliseconds, \"milliseconds\");\r\n        this._keepAliveIntervalInMilliseconds = milliseconds;\r\n        return this;\r\n    }\r\n    /** Enables and configures options for the Stateful Reconnect feature.\r\n     *\r\n     * @returns The {@link @microsoft/signalr.HubConnectionBuilder} instance, for chaining.\r\n     */\r\n    withStatefulReconnect(options) {\r\n        if (this.httpConnectionOptions === undefined) {\r\n            this.httpConnectionOptions = {};\r\n        }\r\n        this.httpConnectionOptions._useStatefulReconnect = true;\r\n        this._statefulReconnectBufferSize = options === null || options === void 0 ? void 0 : options.bufferSize;\r\n        return this;\r\n    }\r\n    /** Creates a {@link @microsoft/signalr.HubConnection} from the configuration options specified in this builder.\r\n     *\r\n     * @returns {HubConnection} The configured {@link @microsoft/signalr.HubConnection}.\r\n     */\r\n    build() {\r\n        // If httpConnectionOptions has a logger, use it. Otherwise, override it with the one\r\n        // provided to configureLogger\r\n        const httpConnectionOptions = this.httpConnectionOptions || {};\r\n        // If it's 'null', the user **explicitly** asked for null, don't mess with it.\r\n        if (httpConnectionOptions.logger === undefined) {\r\n            // If our logger is undefined or null, that's OK, the HttpConnection constructor will handle it.\r\n            httpConnectionOptions.logger = this.logger;\r\n        }\r\n        // Now create the connection\r\n        if (!this.url) {\r\n            throw new Error(\"The 'HubConnectionBuilder.withUrl' method must be called before building the connection.\");\r\n        }\r\n        const connection = new HttpConnection(this.url, httpConnectionOptions);\r\n        return HubConnection.create(connection, this.logger || NullLogger.instance, this.protocol || new JsonHubProtocol(), this.reconnectPolicy, this._serverTimeoutInMilliseconds, this._keepAliveIntervalInMilliseconds, this._statefulReconnectBufferSize);\r\n    }\r\n}\r\nfunction isLogger(logger) {\r\n    return logger.log !== undefined;\r\n}\r\n//# sourceMappingURL=HubConnectionBuilder.js.map","import { TokenService } from \"@/content/core/token/token.service\";\nimport { getHubProxyFactory, getReceiverRegister } from \"@/signalr/TypedSignalR.Client\";\nimport { HubConnectionBuilder, type IHttpConnectionOptions, LogLevel } from \"@microsoft/signalr\";\nimport { inject, injectable } from \"inversify\";\nimport { loggerFactory } from \"../../core/logger/loggerFactory.interface\";\n\nconst hubTypeMap = {\n  IGuildLobbiesHub: {\n    url: \"guildLobbies\"\n  },\n  ILobbyHub: {\n    url: \"lobby\"\n  },\n  IOnlineItemsHub: {\n    url: \"onlineItems\"\n  }\n};\n\n@injectable()\nexport class SocketService {\n\n  private readonly _logger;\n\n  private _baseUrl = /*\"http://localhost:5001\";*/ \"https://sockets.typo.rip\";\n  private _token = \"\";\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n    @inject(TokenService) tokenService: TokenService\n  ) {\n    this._logger = loggerFactory(this);\n    tokenService.token.subscribe(token => this._token = token ?? \"\");\n  }\n\n  /**\n   * creates a new signalr config based on set options\n   * @private\n   */\n  private createSignalRConfig(): IHttpConnectionOptions {\n    return {\n      withCredentials: false,\n      accessTokenFactory: () => this._token\n    };\n  }\n\n  /**\n   * create a new signalr client of given type\n   * @returns\n   * @param hubType\n   * @param queryParams\n   */\n  createConnection<THub extends keyof typeof hubTypeMap>(hubType: THub) {\n\n    const connection = new HubConnectionBuilder()\n      .withUrl(`${this._baseUrl}/${hubTypeMap[hubType].url}`, this.createSignalRConfig())\n      .configureLogging({ log: (logLevel: LogLevel, message: string) => {\n          if(logLevel == LogLevel.Trace || logLevel == LogLevel.Debug) this._logger.debug(message);\n          if(logLevel == LogLevel.Information || logLevel == LogLevel.Warning) this._logger.info(message);\n          if(logLevel == LogLevel.Critical) this._logger.warn(message);\n          if(logLevel == LogLevel.Error) this._logger.error(message);\n        }\n      })\n      .build();\n    return connection;\n  }\n\n  createHub = getHubProxyFactory;\n  createReceiver = getReceiverRegister;\n\n  /**\n   * Set the base url which will be used for api calls\n   * @param url\n   */\n  public set baseUrl(url: string) {\n    this._baseUrl = url;\n  }\n}","import type { MemberDto } from \"@/api\";\nimport type { featureBinding } from \"@/content/core/feature/featureBinding\";\nimport { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { SocketService } from \"@/content/services/socket/socket.service\";\nimport type {\n  AwardGiftedDto,\n  DropAnnouncementDto,\n  DropClaimResultDto, DropClearDto, SkribblLobbyStateDto, TypoLobbySettingsDto,\n  TypoLobbyStateDto,\n} from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport type { ILobbyHub } from \"@/signalr/TypedSignalR.Client/tobeh.Avallone.Server.Hubs.Interfaces\";\nimport type { HubConnection } from \"@microsoft/signalr\";\nimport { inject, injectable } from \"inversify\";\nimport { BehaviorSubject, Subject } from \"rxjs\";\n\ninterface lobbyConnectionState {\n  connection: HubConnection,\n  hub: ILobbyHub,\n  typoLobbyState: TypoLobbyStateDto,\n  member: MemberDto\n}\n\n@injectable()\nexport class LobbyConnectionService implements featureBinding {\n  @inject(SocketService) private readonly _socketService!: SocketService;\n\n  private readonly _logger;\n\n  private _connection$ = new BehaviorSubject<undefined | lobbyConnectionState | \"unauthorized\">(undefined);\n  private _existingTypoLobbyStates = new Map<string, TypoLobbyStateDto>();\n  private _abortConnecting?: () => void; /** abort the connection while it is still in setup phase and _connection is still undefined */\n\n  private _dropAnnounced$ = new Subject<DropAnnouncementDto>();\n  private _dropClaimed$ = new Subject<DropClaimResultDto>();\n  private _dropCleared$ = new Subject<DropClearDto>();\n  private _awardGifted$ = new Subject<AwardGiftedDto>();\n\n  constructor(@inject(loggerFactory) loggerFactory: loggerFactory) {\n    this._logger = loggerFactory(this);\n  }\n\n  onFeatureActivate(): Promise<void> {\n    return Promise.resolve(undefined);\n  }\n\n  async onFeatureDestroy(): Promise<void> {\n    await this.destroyConnection();\n    this._existingTypoLobbyStates.clear();\n  }\n\n  public get dropAnnounced$() { return this._dropAnnounced$.asObservable(); }\n  public get dropClaimed$() { return this._dropClaimed$.asObservable(); }\n  public get awardGifted$() { return this._awardGifted$.asObservable(); }\n  public get dropCleared$() { return this._dropCleared$.asObservable(); }\n\n  /**\n   * The current connection state\n   * Throws if not connected\n   * @private\n   */\n  public get connection(): lobbyConnectionState {\n    const connection = this._connection$.value;\n    if(connection === undefined || connection === \"unauthorized\") {\n      this._logger.error(\"connection is not initialized\");\n      throw new Error(\"connection is not initialized\");\n    }\n    return connection;\n  }\n\n  /**\n   * Observable containing the current connection, emits when connection changed or settings updated\n   */\n  public get connection$(){\n    return this._connection$.asObservable();\n  }\n\n  /**\n   * Whether the current connection is established\n   * @private\n   */\n  public get isConnected() {\n    return this._connection$.value !== undefined && this._connection$.value !== \"unauthorized\";\n  }\n\n  /**\n   * Sets up the connection to the lobby hub and initializes the receiver\n   * @private\n   */\n  public async setupConnection(lobbyId: string, lobby: SkribblLobbyStateDto, playerId: number, member: MemberDto){\n    const claim = this._existingTypoLobbyStates.get(lobbyId)?.ownershipClaimToken;\n    const connection = this._socketService.createConnection(\"ILobbyHub\");\n    const hub = this._socketService.createHub(\"ILobbyHub\").createHubProxy(connection);\n    this._socketService.createReceiver(\"ILobbyReceiver\").register(connection, {\n      lobbyOwnershipResigned: this.lobbyOwnershipResigned.bind(this),\n      typoLobbySettingsUpdated: this.typoLobbySettingsUpdated.bind(this),\n      dropAnnounced: async drop => this._dropAnnounced$.next(drop),\n      dropClaimed: async result => this._dropClaimed$.next(result),\n      awardGifted: async award => this._awardGifted$.next(award),\n      dropCleared: async clear => this._dropCleared$.next(clear)\n    });\n\n    connection.onclose(async (error) => {\n      this._logger.debug(\"SignalR Connection closed\", error);\n      this._connection$.next(undefined);\n    });\n\n    this._abortConnecting = async () => {\n      this._logger.info(\"Aborting connection while still in setup phase\");\n      await connection.stop();\n    };\n\n    try {\n      await connection.start();\n    }\n    catch (e) {\n      this._logger.error(\"Failed to setup socket connection\", e);\n      await this.destroyConnection();\n      this._connection$.next(undefined);\n      return \"failed\";\n    }\n\n    const state = await hub.lobbyDiscovered({ownerClaimToken: claim, lobby, playerId});\n    this._logger.info(\"Lobby discovered\", state);\n    this._connection$.next({connection, hub, typoLobbyState: state, member});\n    this._existingTypoLobbyStates.set(state.lobbyId, state);\n    this._abortConnecting = undefined;\n\n    return claim ? \"reconnected\" : \"connected\";\n  }\n\n  /**\n   * Destroys the current connection if it exists, aborts a current connection setup if it is in progress,\n   * and closes the flyout if opened\n   * @private\n   */\n  public async destroyConnection(setUnauthorizedStatus = false) {\n    if(this._connection$.value !== undefined && this._connection$.value !== \"unauthorized\") {\n      await this._connection$.value.connection.stop();\n    }\n    if(this._abortConnecting) {\n      this._abortConnecting();\n    }\n\n    if(setUnauthorizedStatus) this._connection$.next(\"unauthorized\");\n    else this._connection$.next(undefined);\n  }\n\n  /**\n   * Signalr event handler when typo lobby settings have been updated\n   * Saves new properties to current connection info\n   * @param state\n   * @private\n   */\n  private async typoLobbySettingsUpdated(state: TypoLobbySettingsDto) {\n    const savedSettings = this._existingTypoLobbyStates.get(this.connection.typoLobbyState.lobbyId);\n    if(savedSettings) savedSettings.lobbySettings = state;\n\n    this.connection.typoLobbyState.lobbySettings = state;\n    this.connection.typoLobbyState.playerIsOwner = state.lobbyOwnershipClaim === this.connection.typoLobbyState.ownershipClaim;\n    this._connection$.next(this.connection); // notify change\n\n    this._logger.info(\"Lobby state updated\", this.connection.typoLobbyState);\n  }\n\n  /**\n   * Signalr event handler when lobby ownership has been resigned\n   * Attempts to claim the lobby ownership as a reaction\n   * @private\n   */\n  private async lobbyOwnershipResigned() {\n    this._logger.info(\"Lobby ownership resigned, claiming now\");\n    await this.connection.hub.claimLobbyOwnership();\n  }\n\n}","/**\n * Try to parse a SignalR error message from anything, if it fails, throw the error\n * @param error\n */\nexport const parseSignalRError = (error: unknown) => {\n  if(!(error instanceof Error)) throw error;\n\n  const matches = error?.message.match(/.*'(.*)'.*\\. (.*): (.*)/);\n  if(matches) {\n    if(matches.length < 3) throw error;\n    const [, hub, exception, message] = matches;\n\n    return {\n      hub,\n      exception,\n      message\n    };\n  }\n\n  else throw error;\n};","<script lang=\"ts\">\n  import type { EventDropDto } from \"@/api\";\n  import type { DropsFeature } from \"./drops.feature\";\n  export let feature: DropsFeature;\n  export let drops: EventDropDto[];\n  const currentDrop = feature.currentDropStore;\n\n  function getDropUrl(id?: number){\n    const drop = drops.find(drop => drop.id === id);\n    return drop ? `url(${drop.url})` : \"var(--file-img-drop-gif)\";\n  }\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes drop-in {\n    0% {\n      transform: translateY(-50%);\n      opacity: 0;\n    }\n    100% {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n\n  .typo-drop {\n    position: absolute;\n    bottom: 5px;\n    height: 48px;\n    aspect-ratio: 1;\n    background-size: cover;\n    background-position: center;\n    cursor: pointer;\n    user-select: none;\n    animation: drop-in .05s ease-in forwards;\n  }\n</style>\n\n{#if $currentDrop !== undefined && $currentDrop.ownClaimed === false}\n  <div class=\"typo-drop\"\n       on:click={async () => {\n         if($currentDrop) {\n           const claim = await feature.claimDrop($currentDrop.drop, $currentDrop.timestamp);\n           if(claim !== undefined) feature.processClaim(claim, true);\n         }\n       }}\n       style=\"left: calc((100% - 48px) * ({$currentDrop.drop.position} / 100)); background-image: {getDropUrl($currentDrop.drop.eventDropId)}\"\n  ></div>\n{/if}","<script lang=\"ts\">\n  import { DropsFeature } from \"@/content/features/drops/drops.feature\";\n\n  export let feature: DropsFeature;\n  const claims = feature.recordedClaimsStore;\n</script>\n\n\n<style lang=\"scss\">\n\n  .typo-drop-claims {\n    display: flex;\n    flex-direction: column;\n    gap: .5rem;\n\n    .typo-drop-claims-claim {\n      display: flex;\n      gap: .4rem;\n    }\n  }\n\n</style>\n\n<h3>Drop Log</h3>\n<p>\n  In the drop log, you can find all drops claims that happened while you were in lobbies.<br>\n  To report a suspicious drop claim, copy the catch time and drop ID and send it on the typo server.\n</p>\n<br>\n\n<div class=\"typo-drop-claims\">\n  {#each $claims as claim}\n\n    <div class=\"typo-drop-claims-claim\">\n      <b>#{claim.dropId}</b>\n      <span>{claim.username}</span>\n      <span>{claim.catchTime}ms</span>\n      <span>{Math.round(claim.leagueWeight * 100)}%</span>\n    </div>\n\n  {/each}\n\n  {#if $claims.length === 0}\n    <p>No drop claims yet.</p>\n  {/if}\n</div>","import { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyLeftEventListener } from \"@/content/events/lobby-left.event\";\nimport { LobbyConnectionService } from \"@/content/features/lobby-status/lobby-connection.service\";\nimport { ChatService } from \"@/content/services/chat/chat.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport type { DropAnnouncementDto, DropClaimResultDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { parseSignalRError } from \"@/util/signalr/parseErrorOrThrow\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { inject } from \"inversify\";\nimport {\n  BehaviorSubject, delay,\n  distinctUntilChanged,\n  filter,\n  map, mergeMap,\n  mergeWith,\n  of, pairwise, startWith,\n  Subject, type Subscription,\n  switchMap,\n  tap, withLatestFrom,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport DropsComponent from \"./drops.svelte\";\nimport DropsInfoComponent from \"./drops-info.svelte\";\n\nexport class DropsFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(LobbyConnectionService) private readonly _lobbyConnectionService!: LobbyConnectionService;\n  @inject(ChatService) private readonly _chatService!: ChatService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(LobbyLeftEventListener) private readonly _lobbyLeftEventListener!: LobbyLeftEventListener;\n\n  public readonly name = \"Drops\";\n  public readonly description = \"Show drops to collect extra bubbles when you're playing\";\n  public readonly featureId = 40;\n\n  public override get featureManagementComponent() {\n    return { componentType: DropsInfoComponent, props: { feature: this } };\n  }\n\n  private _component?: DropsComponent;\n  private _recordedClaims$ = new BehaviorSubject<(DropClaimResultDto & {own: boolean})[]>([]);\n  private _currentDrop$ = new Subject<{ drop: DropAnnouncementDto, timestamp: number, ownClaimed: boolean } | undefined>();\n  private _dropSummarySubscription?: Subscription;\n  private _dropAnnouncedSubscription?: Subscription;\n\n  private _enableDropSummary = this.useSetting(\n    new BooleanExtensionSetting(\"drop_summary\", true, this)\n      .withName(\"Drop Summary\")\n      .withDescription(\"Show a chat message with all drop catches after a drop\"),\n  );\n\n  private _enableOtherDropNotifications = this.useSetting(\n    new BooleanExtensionSetting(\"drop_notifications\", true, this)\n      .withName(\"Drop Notifications\")\n      .withDescription(\"Show a chat message when someone else catches a drop\"),\n  );\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n    const apiData = await this._apiDataSetup.complete();\n\n    this._component = new DropsComponent({\n      target: elements.canvasWrapper,\n      props: {\n        feature: this,\n        drops: apiData.drops,\n      },\n    });\n\n    /* process claims and announcements to set/clear the current drop */\n    this._dropAnnouncedSubscription = this._lobbyConnectionService.dropAnnounced$\n      .pipe(\n        switchMap((drop) =>\n          of(drop).pipe(\n            mergeWith(\n              /* set to undefined after timeout of 2s */\n              this._lobbyConnectionService.dropCleared$.pipe(\n                filter((clear) => clear.dropId === drop.dropId),\n                tap(() => this._logger.info(\"Drop cleared by server event\", drop)),\n                map(() => undefined),\n                delay(1000) /* delay to make sure all claims have arrived (ping..) */,\n              ),\n\n              /* set to undefined when someone else clears */\n              this._lobbyConnectionService.dropClaimed$.pipe(\n                tap((claim) => this._logger.info(\"Other claim arrived\", claim)),\n                mergeMap(async (claim) => {\n                  await this.processClaim(claim, false);\n                  return claim;\n                }),\n                filter((claim) => claim.clearedDrop),\n                map(() => undefined),\n              ),\n\n              /* clear on lobby leave */\n              this._lobbyLeftEventListener.events$.pipe(\n                map(() => undefined),\n              )\n            ),\n          ),\n        ),\n        tap((drop) => this._logger.info(\"Setting drop\", drop)),\n      )\n      .subscribe((drop) =>\n        this._currentDrop$.next(\n          drop === undefined ? undefined : { drop, timestamp: Date.now(), ownClaimed: false },\n        ),\n      );\n\n    /* subscribe to changes in the current drop and build a summary of claims when it's cleared */\n    this._dropSummarySubscription = this._currentDrop$\n      .pipe(\n        startWith(undefined),\n        distinctUntilChanged(),\n        pairwise(),\n        withLatestFrom(this._recordedClaims$, this._enableDropSummary.changes$),\n      )\n      .subscribe(([[prev, current], claims, summaryEnabled]) => {\n        if (!summaryEnabled) return;\n\n        /* drop has been cleared */\n        if (prev !== undefined && current === undefined) {\n\n          const getEmoji = (claim: DropClaimResultDto) => {\n            if (claim.clearedDrop) return \"🛡️\";\n            if (claim.firstClaim) return \"💎\";\n            if (claim.leagueMode) return \"🧿\";\n            return \"💧\";\n          };\n\n          const currentClaims = claims.filter((c) => c.dropId === prev?.drop.dropId);\n          const title = \"Drop Summary\";\n          const content =\n            \"\\n\" +\n            (currentClaims.length === 0\n              ? \"The drop timed out :(\"\n              : currentClaims\n                  .map(\n                    (c) =>\n                      `${getEmoji(c)} ${c.username}: ${c.catchTime}ms (${Math.round(c.leagueWeight * 100)}%)`,\n                  )\n                  .join(\"\\n\"));\n\n          this._chatService.addChatMessage(content, title, \"info\");\n        }\n      });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._component?.$destroy();\n    this._recordedClaims$.next([]);\n    this._dropSummarySubscription?.unsubscribe();\n    this._dropAnnouncedSubscription?.unsubscribe();\n    this._dropSummarySubscription = undefined;\n    this._dropAnnouncedSubscription = undefined;\n  }\n\n  public get currentDropStore() {\n    return fromObservable(this._currentDrop$, undefined);\n  }\n\n  public get recordedClaimsStore() {\n    return fromObservable(this._recordedClaims$, []);\n  }\n\n  /**\n   * Send a drop claim and show an error if fails - probably timeout or already cleared\n   * @param drop\n   * @param timestamp\n   */\n  public async claimDrop(drop: DropAnnouncementDto, timestamp: number) {\n    this._logger.info(\"Claiming drop after delay\", Date.now() - timestamp);\n\n    this._currentDrop$.next({drop, ownClaimed: true, timestamp}); /* claiming phase not finished, but player cannot claim anymore */\n\n    try {\n      const result = await this._lobbyConnectionService.connection.hub.claimDrop({\n        dropToken: drop.dropToken,\n      });\n      return result;\n    } catch (e) {\n      const error = parseSignalRError(e);\n      this._logger.error(\"Failed to claim drop\", error);\n      await this._toastService.showToast(error.message);\n      return undefined;\n    }\n  }\n\n  /**\n   * Add a claim to the recorded claims and show a chat message\n   * @param claim\n   * @param ownClaim\n   */\n  public async processClaim(claim: DropClaimResultDto, ownClaim: boolean) {\n    this._logger.debug(\"Processing claim\", claim);\n\n    const recordedClaims = [...this._recordedClaims$.value, { ...claim, own: ownClaim }];\n    this._recordedClaims$.next(recordedClaims);\n    const enabledOtherNotifications = await this._enableOtherDropNotifications.getValue();\n\n    if (ownClaim || enabledOtherNotifications) {\n      const previouslyClaimed = recordedClaims.some(c => c.own);\n      const title = ownClaim ? \"Yeee!\" : (claim.clearedDrop && !previouslyClaimed ? \"Oops..\" : \"\");\n      const message = ownClaim\n        ? `You ${claim.clearedDrop ? \"cleared\" : \"caught\"} the drop after ${claim.catchTime}ms (${Math.round(claim.leagueWeight * 100)}%)`\n        : claim.clearedDrop\n          ? `${claim.username} cleared the drop after ${claim.catchTime}ms`\n          : `${claim.username} caught the drop after ${claim.catchTime}ms`;\n      await this._chatService.addChatMessage(message, title, \"info\");\n    }\n\n    if(ownClaim && claim.clearedDrop) this._currentDrop$.next(undefined); /* finish claiming phase - other than own claim automatically in pipeline cleared */\n  }\n}","const BLANK = \"_\";\nconst FILLER = \"‎\";\nconst DIACRITICS:Record<string, string> = {\n  \"ä\": \"a\",\n  \"ö\": \"o\",\n  \"ü\": \"u\",\n  \"à\": \"a\",\n  \"â\": \"a\",\n  \"ç\": \"c\",\n  \"é\": \"e\",\n  \"è\": \"e\",\n  \"ê\": \"e\",\n  \"ë\": \"e\",\n  \"î\": \"i\",\n  \"ï\": \"i\",\n  \"ô\": \"o\",\n  \"û\": \"u\",\n  \"ù\": \"u\",\n  \"ÿ\": \"y\",\n  \"ñ\": \"n\",\n  \"á\": \"a\",\n  \"í\": \"i\",\n  \"ó\": \"o\",\n  \"ú\": \"u\",\n  \"ą\": \"a\",\n  \"ć\": \"c\",\n  \"ę\": \"e\",\n  \"ń\": \"n\",\n  \"ś\": \"s\",\n  \"ż\": \"z\",\n  \"ź\": \"z\",\n};\n\nfunction isTheSameLetter(char: string, otherChar: string): boolean {\n  char = char.toLowerCase();\n  otherChar = otherChar.toLowerCase();\n\n  char = DIACRITICS[char] ?? char;\n  otherChar = DIACRITICS[otherChar] ?? otherChar;\n\n  return char === otherChar;\n}\n\n/**\n * Fills the guess to the same length as the word/hint\n */\nexport function getOverlayContent(guess: string, hints: string): string {\n    guess = guess.replaceAll(\" \", \"\").replaceAll(\"-\", \"\");\n\n    let result = \"\";\n    let guessIndex = 0;\n\n    for (let hintIndex = 0; hintIndex < hints.length; hintIndex++) {\n      const guessChar = guess.charAt(guessIndex);\n      const hintChar = hints.charAt(hintIndex);\n\n      if (hintChar === \" \" || hintChar === \"-\") {\n        result = result.concat(hintChar);\n      } else if (isTheSameLetter(guessChar, hintChar)) {\n        result = result.concat(hintChar);\n        guessIndex++;\n      } else if (guessChar === \"\") {\n        result = result.concat(FILLER);\n      } else {\n        result = result.concat(guessChar);\n        guessIndex++;\n      }\n    }\n\n    return result;\n}\n\n/**\n * Whether the character matches a revealed hint or blank or is a filler character\n */\nexport function guessMatchesHint(character: string, index: number, hints: string): boolean {\n    return hints[index] === character || character === FILLER || hints[index] === BLANK;\n}\n\n/**\n * Whether the character exactly matches a revealed hint\n */\nexport function guessCorrectHint(character: string, index: number, hints: string): boolean {\n    return hints[index] === character && hints[index] !== BLANK;\n}\n","<script lang=\"ts\">\n  import type { GuessCheckFeature } from \"@/content/features/guess-check/guess-check.feature\";\n  import { guessCorrectHint, guessMatchesHint } from \"./guess-overlay\";\n\n  export let feature: GuessCheckFeature;\n  const guess = feature.guessChangedStore;\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes warn-blink {\n    0% {\n      opacity: 1;\n    }\n    25% {\n      opacity: 0;\n    }\n    50% {\n      opacity: 0;\n    }\n    75% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n\n  :global(#game-word .hints) {\n    position: relative;\n  }\n\n  .typo-hints-overlay {\n    position: absolute;\n    display: flex;\n    gap: .08em;\n    z-index: 10;\n\n    /* warning container to sync blinking animation */\n    &.warning {\n      z-index: 11;\n      animation: warn-blink .7s infinite;\n\n      .overlay-character{\n        &.warning {\n          opacity: 1;\n          color:red;\n          background-color: var(--COLOR_CHAT_BG_BASE);\n        }\n\n        /* hide all normal in warning container */\n        &:not(.warning) {\n          opacity: 0;\n        }\n      }\n    }\n\n    /* hide all warnings in correct container */\n    &.correct {\n      .overlay-character.warning {\n        opacity: 0;\n      }\n    }\n\n    /* regular style */\n    .overlay-character {\n      width: 1ch;\n      color: inherit;\n      opacity: .6;\n\n      &.hidden {\n        opacity: 0;\n      }\n    }\n  }\n</style>\n\n<!-- separate container for correct and incorrect, to sync animation -->\n{#each [\"warning\", \"correct\"] as overlayType}\n  <div class=\"typo-hints-overlay {overlayType}\">\n    {#if $guess !== null}\n      {#each $guess.overlayContent as guessCharacter, index}\n        <span class=\"overlay-character\"\n              class:hidden={guessCorrectHint(guessCharacter, index, $guess.hints)}\n              class:warning={!guessMatchesHint(guessCharacter, index, $guess.hints)}\n        >\n          {guessCharacter}\n        </span>\n      {/each}\n    {/if}\n  </div>\n{/each}","import { ChatTypedEventListener } from \"@/content/events/chat-typed.event\";\nimport { LobbyLeftEventListener } from \"@/content/events/lobby-left.event\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { inject } from \"inversify\";\nimport { combineLatestWith, distinctUntilChanged, map, mergeWith, tap } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport GuessCheck from \"./guess-check.svelte\";\nimport { getOverlayContent } from \"./guess-overlay\";\n\nexport class GuessCheckFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ChatTypedEventListener) private readonly _chatTypedEventListener!: ChatTypedEventListener;\n  @inject(LobbyLeftEventListener) private readonly _lobbyLeftEventListener!: LobbyLeftEventListener;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n\n  public readonly name = \"Guess Check\";\n  public readonly description = \"Shows an overlay over the word hints to compare your current guess\";\n  public readonly featureId = 18;\n\n  private _component?: GuessCheck;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    this._component = new GuessCheck({\n      target: elements.hints,\n      props: {\n        feature: this,\n      },\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._component?.$destroy();\n  }\n\n  /**\n   * emits data every time the user types or the hint changes\n   */\n  public get guessChangedStore() {\n    const events = this._chatTypedEventListener.events$.pipe(\n      mergeWith(this._lobbyLeftEventListener.events$.pipe(  /* reset when lobby left */\n        map(() => null)\n      )),\n      map(event => event?.data ?? \"\"),\n      distinctUntilChanged(),\n      combineLatestWith(this._drawingService.imageState$.pipe(\n        map(image => {\n          if(image === null || image.word.solution !== undefined) return null;\n          return image.word.hints;\n        }),\n        distinctUntilChanged()\n      )),\n      map(([guess, hints]) => hints === null ? null : ({\n        guess,\n        hints,\n        overlayContent: getOverlayContent(guess, hints)})),\n      tap(data => this._logger.debug(\"Guess Check data update\", data))\n    );\n    return fromObservable(events, null);\n  }\n\n}","import { TypoFeature } from \"@/content/core/feature/feature\";\nimport type { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { distinctUntilChanged, forkJoin, map, of, Subject, type Subscription, tap } from \"rxjs\";\n\nexport class HotkeysFeature extends TypoFeature {\n\n  public readonly name = \"Hotkeys\";\n  public readonly description = \"Activate actions of features with key combinations\";\n  public readonly featureId = 25;\n\n  private _pressedKeys = new Set<string>();\n  private _releaseCandidates = new Set<HotkeyAction>();\n  private _keysReleased$ = new Subject<string[]>();\n  private _keysPressed$ = new Subject<string[]>();\n  private _pressedSubscription?: Subscription;\n  private _releasedSubscription?: Subscription;\n\n  private readonly keydownListener = this.handleKeydown.bind(this);\n  private readonly keyupListener = this.handleKeyup.bind(this);\n  private readonly visibilityChangeListener = this.handleDocumentVisibilityChange.bind(this);\n  private readonly inactiveListener = this.handleDocumentInactive.bind(this);\n\n  protected override async onActivate() {\n    document.addEventListener(\"keydown\", this.keydownListener);\n    document.addEventListener(\"keyup\", this.keyupListener);\n    document.addEventListener(\"visibilitychange\", this.visibilityChangeListener);\n    window.addEventListener(\"blur\", this.inactiveListener);\n    window.addEventListener(\"focusout\", this.inactiveListener);\n\n    /* when keys pressed, execute hotkeys that are not currently down */\n    this._pressedSubscription = this._keysPressed$.pipe(\n      tap(keys => this._logger.debug(\"Keys pressed\", keys)),\n      distinctUntilChanged((a, b) => a.length === b.length && a.every((v, i) => v === b[i]))\n    ).subscribe(keys => {\n      this._logger.info(\"Keys pressed event\", keys);\n\n      const hotkeys = this._hotkeysService.registeredHotkeys;\n      const inputActive = document.activeElement?.tagName === \"INPUT\";\n\n      forkJoin(hotkeys.map(h => this._releaseCandidates.has(h) ?\n        of({ executed:false, hotkey: h }) :\n        h.executeIfMatches(keys, inputActive).pipe(\n          tap(executed => {\n            if(executed) {\n              this._releaseCandidates.add(h);\n            }\n          }),\n          map(executed => ({ hotkey: h, executed }))\n      ))).subscribe(result => {\n        const executed = result.filter(r => r.executed);\n        if(executed.length > 0) this._logger.info(\"Executed hotkeys\", executed.map(r => r.hotkey.name));\n      });\n    });\n\n    /* when keys released, test release for pressed hotkeys */\n    this._releasedSubscription = this._keysReleased$.subscribe(keys => {\n      this._logger.info(\"Keys released\", keys);\n      this._releaseCandidates.forEach(hotkey => {\n        hotkey.releaseIfNotMatches(keys).subscribe(released => {\n          if(released) {\n            this._releaseCandidates.delete(hotkey);\n            this._logger.info(\"Released hotkey\", hotkey.name);\n          }\n        });\n      });\n    });\n  }\n\n  protected override async onDestroy() {\n    document.removeEventListener(\"keydown\", this.keydownListener);\n    document.removeEventListener(\"keyup\", this.keyupListener);\n    document.removeEventListener(\"visibilitychange\", this.visibilityChangeListener);\n    window.removeEventListener(\"blur\", this.inactiveListener);\n    window.removeEventListener(\"focusout\", this.inactiveListener);\n    this._pressedSubscription?.unsubscribe();\n    this._pressedSubscription = undefined;\n    this._releasedSubscription?.unsubscribe();\n    this._releasedSubscription = undefined;\n  }\n\n  private handleKeydown(event: KeyboardEvent) {\n\n    /* alt key removes focus  by default..? */\n    if(event.altKey){\n      this._logger.debug(\"Alt key pressed; preventing default\");\n      event.preventDefault();\n    }\n\n    this._logger.debug(\"Keydown\", event.code);\n    this._pressedKeys.add(event.code);\n    this._keysPressed$.next([...this._pressedKeys]);\n  }\n\n  private handleKeyup(event: KeyboardEvent) {\n    this._logger.debug(\"Keyup\", event.code);\n    this._pressedKeys.delete(event.code);\n    this._keysReleased$.next([...this._pressedKeys]);\n\n    // because pressed filters out repeated events, needs change to detect same real down event again\n    this._keysPressed$.next([...this._pressedKeys]);\n  }\n\n  private handleDocumentVisibilityChange(){\n    if(!document.hidden) return;\n\n    this._logger.info(\"Document hidden; releasing all keys\");\n    const released = [...this._pressedKeys];\n    this._pressedKeys.clear();\n    this._keysReleased$.next(released);\n    this._keysPressed$.next([]);\n  }\n\n  private handleDocumentInactive(){\n    this._logger.info(\"Document inactive; releasing all keys\");\n    const released = [...this._pressedKeys];\n    this._pressedKeys.clear();\n    this._keysReleased$.next(released);\n    this._keysPressed$.next([]);\n  }\n\n\n}","<script lang=\"ts\">\n  import { ImageAgentFeature } from \"./image-agent.feature\";\n  import Bounceload from \"../../../lib/bounceload/bounceload.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\n  export let feature: ImageAgentFeature;\n  const word = feature.wordStore;\n  const hidden = feature.hiddenSettingStore;\n  let textInput: string | undefined = undefined;\n  let imageIndex: number | undefined = undefined;\n\n  $: textInput = $word ?? undefined; // reset txt input on word change\n  $: imageIndex = $word ? 0 : 0; // init image index with 0 if word is set\n  $: images = (!$hidden && $word) ? feature.getImages($word) : []; // refresh images as soon as word changes\n</script>\n\n<style lang=\"scss\">\n\n  .typo-image-agent {\n    grid-area: chat;\n    align-self: flex-start;\n    width: calc(300px - .4rem);\n    position: relative;\n    justify-self: center;\n    margin-top: .2rem;\n    border-radius: 10px;\n    transform-origin: top;\n    align-items: center;\n    color: var(--COLOR_PANEL_TEXT);\n    z-index: 1;\n    padding: 1rem;\n    transition: transform .08s ease-out, opacity .08s ease-out;\n\n    &.closed {\n      opacity: 0;\n      transform: scaleY(0);\n    }\n\n    .close-agent {\n      position: absolute;\n      top: 0;\n      right: .5rem;\n      font-size: 1.5rem;\n      font-weight: 900;\n      cursor: pointer;\n      z-index: 1;\n    }\n\n    /* background on separate after element because backdrop blur fucks rendering up */\n    &:not(.hidden):after {\n      background: var(--COLOR_PANEL_BG);\n      content: \"\";\n      position: absolute;\n      inset: 0;\n      border-radius: 10px;\n      z-index: 0;\n      transform: none !important; // dont use transform from animation\n      backdrop-filter: blur(2px);\n\n      transition: transform .08s ease-out, opacity .08s ease-out;\n    }\n\n    &.closed:after {\n      opacity: 0;\n      transform: scaleY(0);\n    }\n\n    .agent-content {\n      z-index: 1;\n      width: 100%;\n      display: flex;\n      flex-direction: column;\n      gap: 1rem;\n      position: relative;\n\n      > h3 {\n        width: 100%;\n        display: flex;\n        gap: 1em;\n        align-items: center;\n        justify-content: center;\n        margin-bottom: 0;\n\n        > img {\n          user-select: none;\n          height: 1.8em;\n          width: 1.8em;\n          filter: drop-shadow(3px 3px 0px rgba(0, 0, 0, .3));\n        }\n      }\n\n      > img {\n        width: 100%;\n        border-radius: 3px;\n        cursor: pointer;\n      }\n    }\n\n    .agent-inputs {\n      display: flex;\n      gap: 1rem;\n\n      input {\n        flex-grow: 1;\n      }\n    }\n\n    &.hidden {\n      width: auto;\n      justify-self: end;\n      margin: .5rem;\n      padding: 0;\n    }\n\n  }\n\n</style>\n\n<div class=\"typo-image-agent\" class:closed={$word === null || $hidden === true}>\n  <div class=\"agent-content\">\n    <h3>\n      <img src=\"\" alt=\"agent-icon\" style=\"content: var(--file-img-light-gif)\" />\n      <span>Image Agent</span>\n    </h3>\n\n    <div class=\"agent-inputs\">\n      <!--previous image-->\n\n      <!-- input for custom search -->\n      <input type=\"text\" class=\"typo\" placeholder=\"Custom image name\" bind:value={textInput} on:keydown={event => {\n        if(event.key === 'Enter') word.set(textInput);\n      }}\n      />\n\n      <!--next image-->\n    </div>\n\n    {#await images}\n      <Bounceload />\n    {:then images}\n      {#if imageIndex !== undefined && images.length > 0}\n        <img src=\"{images?.[imageIndex ?? 0] ?? ''}\" alt=\"Image Agent Result\"\n             on:contextmenu={event => event.preventDefault()}\n             on:mousedown={event => {\n          if(imageIndex !== undefined && event.button === 2) imageIndex = imageIndex === 0 ? images.length - 1 : imageIndex - 1;\n          else if(imageIndex !== undefined && event.button === 0) imageIndex = imageIndex === images.length - 1 ? 0 : imageIndex + 1;\n        }}>\n      {/if}\n    {/await}\n  </div>\n\n  <!-- close button -->\n  <span class=\"close-agent\" on:click={() => feature.setHiddenState(true)}>\n        ×\n    <!--<IconButton icon=\"file-img-disabled-gif\" name=\"Close\" size=\"1.5rem\"\n                hoverMove={false} greyscaleInactive=\"{true}\"\n                on:click={() => feature.setHiddenState(true)}\n    />-->\n  </span>\n</div>\n\n","import { ExtensionSetting } from \"@/content/core/settings/setting\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { delay, map, tap, withLatestFrom } from \"rxjs\";\nimport ImageAgent from \"./image-agent.svelte\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\nexport class ImageAgentFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n\n  private _hiddenSetting = new ExtensionSetting<boolean>(\"hidden\", false, this);\n\n  private _element?: ImageAgent;\n  private _iconElement?: IconButton;\n\n  public readonly name = \"Image Agent\";\n  public readonly description = \"Displays a reference image of the word when it's your turn to draw\";\n  public readonly featureId = 14;\n  protected override readonly featureEnabledDefault = false;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    this._element = new ImageAgent({\n      target: elements.gameWrapper,\n      props: {\n        feature: this\n      },\n    });\n\n    this._iconElement = new IconButton({\n      target: elements.chatControls,\n      props: {\n        icon: \"file-img-light-gif\",\n        name: \"Image Agent\",\n        order: 1,\n        size: \"2rem\",\n        hoverMove: false,\n        greyscaleInactive: true,\n        tooltipAction: this.createTooltip\n      }\n    });\n\n    /* show agent when icon clicked */\n    this._iconElement.click$.subscribe(() => {\n      this.setHiddenState(false);\n    });\n  }\n\n  protected override onDestroy() {\n    this._element?.$destroy();\n    this._iconElement?.$destroy();\n  }\n\n  get wordStore() {\n\n    /* create observable that emits the current word if the drawer is self */\n    const ownWordChanges = this._drawingService.drawingState$.pipe(\n      delay(100), /* delay so that no race condition between latest occurs */\n      withLatestFrom(this._lobbyService.lobby$, this._drawingService.imageState$),\n      map(([state, lobby, image]) => {\n\n        /* if drawing ended or any state faulty, hide always */\n        if(state === \"idle\" || lobby === null || image === null) return null;\n        /* else get word if current drawer is player */\n        const drawer = lobby?.players.find(p => p.id === image.drawerId);\n        if(drawer?.id === lobby.meId) return image.word.solution;\n        else return null;\n      }),\n      tap(word => this._logger.debug(\"Word change\", word))\n    );\n\n    return fromObservable(ownWordChanges, null);\n  }\n\n  async getImages(word: string){\n    return await (await fetch(`https://agent.typo.rip/${word}`)).json() as string[];\n  }\n\n  get hiddenSettingStore(){\n    return fromObservable(this._hiddenSetting.changes$, false);\n  }\n\n  setHiddenState(hidden: boolean){\n    this._hiddenSetting.setValue(hidden);\n  }\n}","The Line Tool helps you draw perfectly straight lines on the canvas. <br>\nTo start the tool, press the configured start hotkey and keep it down. <br>\nThe tool can only be used when you are drawing. <br><br>\nNow, you can drag lines onto the canvas by pressing the mouse button and releasing it somewhere else. <br><br>\nYou can also use the Line Tool to connect click positions; to do so, simply click two or more points on the canvas with the mouse to connect them.<br>","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { type stickyToastHandle, ToastService } from \"@/content/services/toast/toast.service\";\nimport { type brushStyle, ToolsService } from \"@/content/services/tools/tools.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport {\n  PrioritizedCanvasEventsSetup\n} from \"@/content/setups/prioritized-canvas-events/prioritized-canvas-events.setup\";\nimport { Color } from \"@/util/color\";\nimport { inject } from \"inversify\";\nimport {\n  BehaviorSubject, catchError,\n  combineLatestWith, debounce, distinctUntilChanged, exhaustMap, filter, map, mergeWith, of,\n  pairwise, skip, startWith, Subject,\n  type Subscription, take, tap, timeout, withLatestFrom,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport LineToolInfo from \"./line-tool-info.svelte\";\n\nexport class LineToolFeature extends TypoFeature {\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(PrioritizedCanvasEventsSetup)\n  private readonly _prioritizedCanvasEventsSetup!: PrioritizedCanvasEventsSetup;\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ToolsService) private readonly _toolsService!: ToolsService;\n\n  public override get featureInfoComponent(): componentData<LineToolInfo> {\n    return { componentType: LineToolInfo, props: {} };\n  }\n\n  public readonly name = \"Line Tool\";\n  public readonly description = \"Draw straight lines between two points\";\n  public readonly featureId = 27;\n\n  private readonly _startLineHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"start_line\",\n      \"Start Line\",\n      \"While pressed, straight lines can be drawn. Press twice to enable horizontal/vertical snap.\",\n      this,\n      () => {\n        this._originCoordinates$.next(undefined);\n        this._targetCoordinates$.next(undefined);\n        this._lineListenToggle$.next(true);\n      },\n      true,\n      [\"ShiftLeft\"],\n      () => {\n        this._lineListenToggle$.next(false);\n      },\n    ),\n  );\n\n  private _lineListenToggle$ = new BehaviorSubject<boolean>(false);\n  private _originCoordinates$ = new BehaviorSubject<[number, number] | undefined>(undefined);\n  private _targetCoordinates$ = new BehaviorSubject<[number, number] | undefined>(undefined);\n  private _lineAccept$ = new Subject<boolean>();\n  private _toastHandle?: stickyToastHandle;\n  private _lineStateSubscription?: Subscription;\n  private _linePreview?: HTMLCanvasElement;\n\n  private readonly _canvasClickListener = this.onCanvasDown.bind(this);\n  private readonly _canvasMoveListener = this.onCanvasMove.bind(this);\n  private readonly _documentUpListener = this.onDocumentUp.bind(this);\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    this._linePreview = document.createElement(\"canvas\");\n    this._linePreview.width = elements.canvas.width;\n    this._linePreview.height = elements.canvas.height;\n    this._linePreview.style.position = \"absolute\";\n    this._linePreview.style.pointerEvents = \"none\";\n    elements.canvasWrapper.appendChild(this._linePreview);\n\n    const { add } = await this._prioritizedCanvasEventsSetup.complete();\n    add(\"preDraw\")(\"pointerdown\", this._canvasClickListener);\n    add(\"preDraw\")(\"pointermove\", this._canvasMoveListener);\n    document.addEventListener(\"pointerup\", this._documentUpListener);\n\n    /* pipe to detect current mode depending on hotkey action */\n    const listenPipe$ = this._lineListenToggle$.pipe(\n      exhaustMap((value) => {\n        if (!value) return of(\"disabled\" as const);\n        else\n          return of(\"free\" as const).pipe(\n            mergeWith(\n              this._lineListenToggle$.pipe(\n                filter((v) => v),\n                skip(1) /* skip current value */,\n                take(1) /* take one value */,\n                map(() => \"snap\" as const) /* identify as snap */,\n                timeout(500) /* snap must have emitted at least 500ms after */,\n                catchError(() =>\n                  this._lineListenToggle$.pipe(\n                    take(1),\n                    map((state) =>\n                      state ? (\"free\" as const) : (\"disabled\" as const),\n                    ) /* if after listen period no snap detected, fallback to free or disabled  */,\n                  ),\n                ),\n              ),\n            ),\n          );\n      }),\n      distinctUntilChanged(),\n      combineLatestWith(this._lobbyService.lobby$.pipe(map(lobby => (lobby?.drawerId ?? undefined) !== undefined && lobby?.drawerId === lobby?.meId))),\n      map(([mode, isDrawer]) => (isDrawer ? mode : \"disabled\" as const)),\n      distinctUntilChanged(),\n      tap((mode) => this._logger.info(\"Mode changed\", mode)),\n    );\n\n    /* pipe for origin coordinates; filter out when not listening */\n    const originPipe$ = this._originCoordinates$.pipe(\n      withLatestFrom(this._lineListenToggle$),\n      map(([origin, listening]) => (listening ? origin : undefined)),\n      distinctUntilChanged(),\n      tap((origin) => this._logger.debug(\"Origin changed\", origin)),\n    );\n\n    /* pipe for target coordinates; filter out when not listening or no origin, and calculate snap if enabled */\n    const targetPipe$ = this._targetCoordinates$.pipe(\n      withLatestFrom(listenPipe$, originPipe$),\n      map(([target, mode, origin]) =>\n        mode == \"disabled\" || origin === undefined || target === undefined\n          ? undefined\n          : mode === \"free\"\n            ? target\n            : this.calculateSnap(origin, target),\n      ),\n      distinctUntilChanged(),\n      tap((target) => this._logger.debug(\"Target changed\", target)),\n    );\n\n    /* combine all updates */\n    this._lineStateSubscription = listenPipe$\n      .pipe(\n        combineLatestWith(originPipe$, targetPipe$),\n        startWith([\"disabled\", undefined, undefined] as [\"disabled\", undefined, undefined]),\n        pairwise(),\n\n        /* update ui */\n        withLatestFrom(this._toolsService.activeBrushStyle$),\n        tap(([[prev, current], style]) => this.processUiStateUpdate(prev, current, style)),\n        map(([[, current]]) => current),\n\n        /* map to current and emit only when line accepted */\n        debounce(() => this._lineAccept$.pipe(take(1), tap(() => this._logger.debug(\"Line accept debounce emitted\")))),\n        startWith([\"disabled\", undefined, undefined] as [\"disabled\", undefined, undefined]),\n      ).pipe(\n        pairwise(),\n        tap(data => this._logger.debug(\"Line accepted\", data)),\n        withLatestFrom(this._toolsService.activeBrushStyle$)\n      )\n      .subscribe(async ([[[, prevOrigin, prevTarget], [listening, origin, target]], style]) => {\n\n        if (!origin || listening === \"disabled\") {\n          return;\n        }\n\n        this._logger.info(\"Line accepted\", origin, target);\n        if (target === undefined || target[0] === origin[0] && target[1] === origin[1]) {\n          this._logger.info(\n            \"Line accepted without or same target - connecting with last origin or target, if existing\",\n            origin,\n            target,\n          );\n          if (prevTarget) { // if last was drag\n            this._logger.info(\"Connecting with last drag end\", prevTarget);\n            await this.drawLine(prevTarget, origin, style);\n          }\n          else if (prevOrigin) { // if last was also one-click\n            this._logger.info(\"Connecting with last click\", prevOrigin);\n            await this.drawLine(prevOrigin, origin, style);\n          }\n          else {\n            this._logger.info(\"No previous line to connect to; waiting for next\");\n          }\n\n          /* reset origin */\n          this._originCoordinates$.next(undefined);\n        } else {\n\n          // regular drag action\n          await this.drawLine(origin, target, style);\n        }\n      });\n  }\n\n  protected override async onDestroy() {\n    const { remove } = await this._prioritizedCanvasEventsSetup.complete();\n    remove(\"pointerdown\", this._canvasClickListener);\n    remove(\"pointermove\", this._canvasMoveListener);\n    document.removeEventListener(\"pointerup\", this._documentUpListener);\n\n    this._linePreview?.remove();\n    this._linePreview = undefined;\n    this._toastHandle?.close();\n    this._lineStateSubscription?.unsubscribe();\n    this._lineStateSubscription = undefined;\n    this._toastHandle = undefined;\n    this._lineListenToggle$.next(false);\n    this._originCoordinates$.next(undefined);\n    this._targetCoordinates$.next(undefined);\n  }\n\n  /**\n   * Transforms a line to snap either on horizontal or vertical axis, depending on the longer distance\n   * @param origin\n   * @param target\n   * @private\n   */\n  private calculateSnap(origin: [number, number], target: [number, number]): [number, number] {\n    const dx = target[0] - origin[0];\n    const dy = target[1] - origin[1];\n\n    /* horizontal */\n    if (Math.abs(dx) > 2 * Math.abs(dy)) {\n      return [target[0], origin[1]];\n    }\n\n    /* vertical */\n    if (Math.abs(dy) > 2 * Math.abs(dx)) {\n      return [origin[0], target[1]];\n    }\n\n    /* diagonal */\n    if (Math.abs(dx) > Math.abs(dy)) {\n      return [origin[0] + Math.sign(dx) * Math.abs(dy), origin[1] + dy];\n    } else {\n      return [origin[0] + dx, origin[1] + Math.sign(dy) * Math.abs(dx)];\n    }\n  }\n\n  /**\n   * Update the line preview canvas with the current line origin and target coordinates\n   * @param coordinates\n   * @param style\n   * @private\n   */\n  private async setPreview(\n    coordinates: [number, number, number | undefined, number | undefined] | undefined, style: brushStyle\n  ) {\n    this._logger.debug(\"Updating preview\", coordinates);\n\n    if (this._linePreview === undefined) {\n      this._logger.error(\"Line preview canvas not initialized\");\n      return;\n    }\n\n    /* update visibility of preview */\n    if (coordinates === undefined || coordinates[2] === undefined || coordinates[3] === undefined) {\n      this._linePreview.style.display = \"none\";\n      return;\n    }\n    this._linePreview.style.display = \"block\";\n\n    const ctx = this._linePreview.getContext(\"2d\");\n    if (ctx === null) {\n      this._logger.error(\"Line preview context not found\");\n      return;\n    }\n\n    ctx.imageSmoothingEnabled = false;\n    ctx.clearRect(0, 0, this._linePreview.width, this._linePreview.height);\n    ctx.lineWidth = style.size;\n    ctx.strokeStyle = Color.fromSkribblCode(style.color).hex;\n    ctx.beginPath();\n    ctx.moveTo(coordinates[0], coordinates[1]);\n    ctx.lineTo(coordinates[2], coordinates[3]);\n    ctx.stroke();\n  }\n\n  /**\n   * Listener when pointer clicked on canvas; sets current line origin\n   * @param event\n   * @private\n   */\n  private onCanvasDown(event: PointerEvent) {\n    this._logger.debug(\"Canvas clicked\", event);\n    if (this._lineListenToggle$.value) {\n      (event.target as HTMLCanvasElement).setPointerCapture(event.pointerId);\n      event.preventDefault();\n      event.stopImmediatePropagation();\n      this._originCoordinates$.next([event.offsetX, event.offsetY]);\n      return false;\n    }\n  }\n\n  /**\n   * Listener when pointer moved on document; updates current line target\n   * @param event\n   * @private\n   */\n  private async onCanvasMove(event: PointerEvent) {\n    /* if listening, cancel event and calculate new endpoint */\n    if (this._lineListenToggle$.value) {\n      this._logger.debug(\"Document pointer moved\", event);\n      const canvas = (await this._elementsSetup.complete()).canvas;\n      const boundingRect = canvas.getBoundingClientRect();\n      const offsetX = event.clientX - boundingRect.left;\n      const offsetY = event.clientY - boundingRect.top;\n      this._targetCoordinates$.next([offsetX, offsetY]);\n    }\n  }\n\n  /**\n   * Listener when pointer released on document; accepts current line preview\n   * @param event\n   * @private\n   */\n  private async onDocumentUp(event: MouseEvent) {\n    this._logger.debug(\"Document pointer up\", event);\n    this._lineAccept$.next(true);\n  }\n\n  /**\n   * Update the toast ui depending on the tool state\n   * @param prevListening\n   * @param prevOrigin\n   * @param prevTarget\n   * @param listening\n   * @param origin\n   * @param target\n   * @param style\n   * @private\n   */\n  private async processUiStateUpdate(\n    [prevListening, prevOrigin, prevTarget]: [\n      \"free\" | \"snap\" | \"disabled\",\n      [number, number] | undefined,\n      [number, number] | undefined,\n    ],\n    [listening, origin, target]: [\n      \"free\" | \"snap\" | \"disabled\",\n      [number, number] | undefined,\n      [number, number] | undefined,\n    ],\n    style: brushStyle\n  ) {\n    this._logger.debug(\n      \"Line state processing\",\n      { prevListening, prevOrigin, prevTarget },\n      { listening, origin, target },\n      this._toastHandle,\n    );\n\n    /* update canvas element */\n    await this.setPreview(\n      listening !== \"disabled\" && origin !== undefined\n        ? [...origin, ...(target ?? [undefined, undefined])]\n        : undefined,\n      style\n    );\n\n    /* if just entered line tool, add toast */\n    if (prevListening === \"disabled\" && listening !== \"disabled\") {\n      if (this._toastHandle) {\n        this._logger.warn(\"Toast handle unexpected existing when entering line tool\");\n        this._toastHandle.close();\n      }\n      this._toastHandle = await this._toastService.showStickyToast(\n        \"Line Tool: \" + (listening === \"snap\" ? \"Snap\" : \"Free\"),\n        \"Click to start line, release to finish\",\n      );\n    }\n\n    /* if mode active but changed */\n    else if (\n      prevListening !== \"disabled\" &&\n      listening !== \"disabled\" &&\n      listening !== prevListening\n    ) {\n      if (!this._toastHandle) {\n        this._logger.error(\"Toast handle unexpected not existing when changing mode\", {\n          prevListening,\n          listening,\n        });\n        return;\n      }\n      this._toastHandle.update(\n        \"Line Tool: \" + (listening === \"snap\" ? \"Snap\" : \"Free\"),\n        \"Click to start line, release to finish\",\n      );\n    }\n\n    /* if line tool exited */\n    else if (prevListening !== \"disabled\" && listening === \"disabled\") {\n      if (!this._toastHandle) {\n        this._logger.warn(\"Toast handle unexpected not existing when exiting line tool\");\n      }\n      this._toastHandle?.close();\n      this._toastHandle = undefined;\n    }\n  }\n\n  /**\n   * Draw a line and reset current selected coordinates\n   * @param origin\n   * @param target\n   * @param style\n   * @private\n   */\n  private async drawLine(\n    origin: [number, number],\n    target: [number, number],\n    style: brushStyle\n  ) {\n    if (!origin || !target) return;\n\n    await this._drawingService.drawLine([...origin, ...target], style.color, style.size);\n\n    this._originCoordinates$.next(undefined);\n    this._targetCoordinates$.next(undefined);\n  }\n}","import { type Observable, repeat, takeUntil, timeout, timer } from \"rxjs\";\n\nexport function repeatAfterDelay<T>(source$: Observable<T>, delayMs: number): Observable<T> {\n  return source$.pipe(\n    // If no new value is emitted within the delay period, restart with the last emitted value\n    timeout({each: delayMs, with: () => source$.pipe(takeUntil(timer(delayMs)))}),\n    // Repeat when a timeout occurs\n    repeat({delay: () => timer(delayMs)})\n  );\n}","<script lang=\"ts\">\n  import type { LobbyStatusFeature } from \"@/content/features/lobby-status/lobby-status.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n\n  export let feature: LobbyStatusFeature;\n\n  let lobbyDescription: string = \"\";\n  let lobbyDisableWhitelistAllowedServers: boolean = false;\n  let lobbyAllowedServers: Record<string, boolean> = {};\n\n  const connection = feature.connectionStore;\n  const devmode = feature.isDevmodeStore;\n  connection.subscribe(conn => {\n    if(conn && conn !== \"unauthorized\"){\n      lobbyDescription = conn.typoLobbyState.lobbySettings.description;\n      lobbyDisableWhitelistAllowedServers = !conn.typoLobbyState.lobbySettings.whitelistAllowedServers;\n      lobbyAllowedServers = Object.fromEntries(\n        conn.typoLobbyState.lobbySettings.allowedServers.map(s => [s, true])\n      );\n    }\n  });\n</script>\n\n<style lang=\"scss\">\n  .typo-lobby-status-settings {\n    display:flex;\n    flex-direction: column;\n    gap: 1rem;\n\n    .status-settings {\n      display: flex;\n      gap: 1rem;\n      flex-direction: column;\n    }\n  }\n</style>\n\n<div class=\"typo-lobby-status-settings\">\n\n  <!-- current status -->\n  <div class=\"status-info\">\n    {#if $connection === undefined}\n      <Bounceload content=\"Connecting lobby...\"></Bounceload>\n    {:else if $connection === \"unauthorized\"}\n      <b>Log-in required:</b> You need to log in with typo to use the lobby status feature.<br>\n    {:else}\n      <b>Lobby Connected:</b> Your lobby is connected to typo and will be visible on Discord.<br>\n    {/if}\n  </div>\n\n  <!-- lobby settings if player is owner -->\n  {#if $connection !== undefined && $connection !== \"unauthorized\"\n    && $connection.typoLobbyState.playerIsOwner}\n\n    <div class=\"status-settings\">\n      <span>You are the typo lobby owner. Only you can change these settings.</span>\n\n      <div>\n        <b>Lobby Description:</b>\n        <input type=\"text\" bind:value={lobbyDescription} placeholder=\"Description in the Palantir Bot\" />\n      </div>\n\n      <div>\n        <b>Lobby Link Privacy:</b>\n        <Checkbox bind:checked={lobbyDisableWhitelistAllowedServers} description=\"Share link on all servers\"/>\n        {#each $connection.member.guilds as guild}\n          <Checkbox disabled=\"{lobbyDisableWhitelistAllowedServers}\" bind:checked={lobbyAllowedServers[guild.guildID]} description=\"{guild.guildName}\"/>\n        {/each}\n      </div>\n\n      <FlatButton content=\"Save Settings\" color=\"green\" on:click={() => {\n        feature.updateLobbySettings(lobbyDescription, !lobbyDisableWhitelistAllowedServers, lobbyAllowedServers);\n      }} />\n    </div>\n\n  {/if}\n\n  <!-- lobby overview if player is not owner -->\n  {#if $connection !== undefined && $connection !== \"unauthorized\"\n  && $connection.typoLobbyState.playerIsOwner === false}\n\n    <div class=\"status-settings\">\n      {#if $connection.typoLobbyState.lobbySettings.description !== \"\"}\n        <b>Lobby Description:</b><br>\n        {$connection.typoLobbyState.lobbySettings.description}\n      {/if}\n\n      <div>\n        <b>Lobby Link Privacy:</b><br>\n        {$connection.typoLobbyState.lobbySettings.whitelistAllowedServers ? \"Only on selected servers by the lobby owner\" : \"On all servers\"}\n      </div>\n    </div>\n\n  {/if}\n\n  <!-- dev settings if devmode enabled -->\n  {#if $devmode === true}\n\n    <div class=\"status-settings\">\n      <div>\n        <b>Lobby ID:</b> {\n        $connection === undefined ? \"/\" :\n          $connection === \"unauthorized\" ? \"not logged in\" :\n            $connection?.typoLobbyState.lobbyId\n        } <br>\n        <b>Ownership Claim:</b> {\n        $connection === undefined ? \"/\" :\n          $connection === \"unauthorized\" ? \"not logged in\" :\n            $connection?.typoLobbyState.ownershipClaim\n      }\n      </div>\n\n      <FlatButton content=\"Reset Connection\" color=\"orange\" on:click={() => {\n        feature.resetConnection();\n      }} />\n\n      <FlatButton content=\"Trigger refresh\" color=\"orange\" on:click={() => {\n        feature.triggerManualRefresh();\n      }} />\n    </div>\n\n  {/if}\n\n</div>\n","import { type MemberDto } from \"@/api\";\nimport type { featureBinding } from \"@/content/core/feature/featureBinding\";\nimport { ExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyConnectionService } from \"@/content/features/lobby-status/lobby-connection.service\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport type {\n  SkribblLobbyStateDto,\n\n} from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { repeatAfterDelay } from \"@/util/rxjs/repeatAfterDelay\";\nimport type { skribblLobby } from \"@/util/skribbl/lobby\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport {\n  BehaviorSubject,\n  combineLatestWith,\n  debounce,\n  distinctUntilChanged, interval,\n  map,\n  of,\n  type Subscription,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\nimport LobbyStatus from \"./lobby-status.svelte\";\n\n\nexport class LobbyStatusFeature extends TypoFeature {\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(GlobalSettingsService) private readonly _settingsService!: GlobalSettingsService;\n  @inject(LobbyConnectionService) private readonly _lobbyConnectionService!: LobbyConnectionService;\n\n  protected override get boundServices(): featureBinding[] {\n    return [this._lobbyConnectionService];\n  }\n\n  private _privateLobbyWhitelistEnabledSetting = new ExtensionSetting<boolean>(\n    \"private_whitelist_enabled\",\n    false,\n    this,\n  );\n  private _publicLobbyWhitelistEnabledSetting = new ExtensionSetting<boolean>(\n    \"public_whitelist_enabled\",\n    false,\n    this,\n  );\n  private _privateLobbyWhitelistedServersSetting = new ExtensionSetting<string[]>(\n    \"private_whitelisted_servers\",\n    [],\n    this,\n  );\n  private _publicLobbyWhitelistedServersSetting = new ExtensionSetting<string[]>(\n    \"public_whitelisted_servers\",\n    [],\n    this,\n  );\n\n  private _lobbySubscription?: Subscription;\n  private _currentBackendProcessing?: Promise<void>; /** a promise that resolves when the current backend lobby update finished */\n  private _triggerManualRefresh$ = new BehaviorSubject(undefined);\n\n  private _controlIcon?: IconButton;\n  private _controlIconSubscription?: Subscription;\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n  private _lobbyTypeSubscription?: Subscription;\n\n  /**\n   * A store containing the current connection state\n   */\n  public get connectionStore() {\n    return fromObservable(this._lobbyConnectionService.connection$, undefined);\n  }\n\n  /**\n   * Store containing devmode state\n   */\n  public get isDevmodeStore() {\n    return this._settingsService.settings.devMode.store;\n  }\n\n  public readonly name = \"Lobby Status\";\n  public readonly description =\n    \"Share your current lobby with typo to use avatar decorations, give awards and catch drops.\";\n  public readonly featureId = 19;\n\n  protected override async onActivate() {\n    this._lobbyTypeSubscription = this._lobbyService.lobby$\n      .pipe(\n        map((lobby) =>\n          lobby === null\n            ? null\n            : lobby.id === null\n              ? \"practice\"\n              : lobby.private\n                ? \"custom\"\n                : \"public\",\n        ),\n        distinctUntilChanged(),\n        combineLatestWith(this._lobbyConnectionService.connection$)\n      )\n      .subscribe(async ([type, connection]) => {\n        if ((type === \"public\" || type === \"custom\") && connection !== \"unauthorized\") {\n          if(!this._controlIcon) await this.setupSettings();\n\n          const open = connection?.typoLobbyState.lobbySettings.whitelistAllowedServers === false;\n          const icon = connection === undefined ? \"file-img-connection-loading-gif\" : open ? \"file-img-connection-open-gif\" : \"file-img-connection-gif\";\n          const greyscale = connection !== undefined;\n          this._controlIcon?.$set({\n            icon,\n            greyscaleInactive: greyscale,\n          });\n\n        } else {\n          this.destroySettings();\n          this._flyoutComponent?.close();\n        }\n      });\n\n    this._lobbySubscription = repeatAfterDelay(\n      this._lobbyService.lobby$.pipe(\n        combineLatestWith(this._triggerManualRefresh$),\n        map(([lobby]) => lobby),\n      ),\n      30 * 1000,\n    )\n      .pipe(\n        debounce(() => this._lobbyConnectionService.isConnected ? of(null) : interval(2000)), // start connection only after player has been in the lobby for 2s to avoid spamming\n        combineLatestWith(this._memberService.member$),\n        debounce(() => this._currentBackendProcessing ?? of(0)), // allow only one backend processing at a time\n      )\n      .subscribe(\n        ([lobby, member]) =>\n          (this._currentBackendProcessing = this.processLobbyUpdate(lobby, member)),\n      );\n  }\n\n  protected override async onDestroy() {\n    this._lobbySubscription?.unsubscribe();\n    this._lobbyTypeSubscription?.unsubscribe();\n    this.destroySettings();\n  }\n\n  /**\n   * Sets up the lobby settings/status UI\n   * @private\n   */\n  private async setupSettings() {\n    const elements = await this._elementsSetup.complete();\n\n    this._controlIcon = new IconButton({\n      target: elements.chatControls,\n      props: {\n        icon: \"file-img-connection-gif\",\n        name: \"Lobby Status\",\n        order: 2,\n        size: \"2rem\",\n        hoverMove: false,\n        greyscaleInactive: true,\n        tooltipAction: this.createTooltip,\n      },\n    });\n\n    /* open settings when icon clicked */\n    this._controlIconSubscription = this._controlIcon.click$.subscribe(() => {\n      /* if already opened, return */\n      if (this._flyoutComponent) {\n        return;\n      }\n\n      /* create fly out content */\n      const flyoutContent: componentData<LobbyStatus> = {\n        componentType: LobbyStatus,\n        props: {\n          feature: this,\n        },\n      };\n\n      /* open flyout and destroy when closed */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          title: \"Lobby Status\",\n          closeStrategy: \"explicit\",\n          iconName: \"file-img-connection-gif\",\n          alignment: \"top\",\n        },\n      });\n\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(() => {\n        this._logger.info(\"Destroyed flyout\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutComponent = undefined;\n      });\n    });\n  }\n\n  /**\n   * Destroys the lobby settings/status UI\n   * @private\n   */\n  private destroySettings() {\n    this._controlIcon?.$destroy();\n    this._controlIconSubscription?.unsubscribe();\n    this._controlIcon = undefined;\n    this._flyoutComponent?.$destroy();\n    this._flyoutSubscription?.unsubscribe();\n    this._flyoutComponent = undefined;\n  }\n\n  /**\n   * Processes a new lobby update\n   * Connects to the server if in lobby and not yet connected, or disconnects if lobby left, or updates state if already connected\n   * @param lobby the current lobby data\n   * @param member the authenticated member data\n   * @private\n   */\n  private async processLobbyUpdate(\n    lobby: skribblLobby | null,\n    member: MemberDto | undefined | null,\n  ): Promise<void> {\n    this._logger.info(\"processing lobby status update\", lobby, member?.userName);\n\n    /* if member is null and connection exists, disconnect */\n    if (member === null || member === undefined) {\n      await this._lobbyConnectionService.destroyConnection(true);\n      return;\n    }\n\n    /* if lobby is null or practice and connection exists, disconnect */\n    if (lobby === null || lobby.id === null) {\n      await this._lobbyConnectionService.destroyConnection();\n      return;\n    }\n\n    /* if lobby exists, but connection null, connect */\n    if (lobby && !this._lobbyConnectionService.isConnected) {\n      const lobbyDto = this.mapLobbyToDto(lobby);\n      const result = await this._lobbyConnectionService.setupConnection(\n        lobby.id,\n        lobbyDto,\n        lobby.meId,\n        member,\n      );\n\n      if(result === \"failed\") {\n        this._logger.error(\"Failed to setup connection, retrying in next update cycle\");\n        return;\n      }\n\n      const { typoLobbyState, hub } = this._lobbyConnectionService.connection;\n\n      // set default settings if owner and not a reconnect (existing claim undefined)\n      if (typoLobbyState.playerIsOwner && result === \"connected\") {\n        const defaults = lobby.private\n          ? {\n              whitelistEnabled: await this._privateLobbyWhitelistEnabledSetting.getValue(),\n              whitelist: await this._privateLobbyWhitelistedServersSetting.getValue(),\n            }\n          : {\n              whitelistEnabled: await this._publicLobbyWhitelistEnabledSetting.getValue(),\n              whitelist: await this._publicLobbyWhitelistedServersSetting.getValue(),\n            };\n        try {\n          await hub.updateTypoLobbySettings({\n            description: \"\",\n            whitelistAllowedServers: defaults.whitelistEnabled,\n            allowedServers: defaults.whitelist,\n          });\n        } catch (e) {\n          this._logger.error(\"Failed to set defaults\", e);\n        }\n      }\n    }\n\n    /* if lobby exists, and connected, send update */\n    if (lobby && this._lobbyConnectionService.isConnected) {\n\n      /* if current lobby is different from current connection, disconnect and reconnect, then run again */\n      if (lobby.id !== this._lobbyConnectionService.connection.typoLobbyState.lobbyId) {\n        this._logger.info(\"Lobby changed, reconnecting\");\n        await this._lobbyConnectionService.destroyConnection();\n        return this.processLobbyUpdate(lobby, member);\n      } else\n        await this._lobbyConnectionService.connection.hub.updateSkribblLobbyState(\n          this.mapLobbyToDto(lobby),\n        );\n    }\n\n    this._logger.info(\"Lobby status processed\");\n  }\n\n  /**\n   * Maps the current lobby state to a DTO\n   * @param lobby\n   * @private\n   */\n  private mapLobbyToDto(lobby: skribblLobby): SkribblLobbyStateDto {\n    if (lobby.id === null) throw new Error(\"cannot map practice lobby to state dto\");\n\n    return {\n      link: lobby.id,\n      ownerId: lobby.ownerId ?? undefined,\n      round: lobby.round,\n      players: lobby.players.map((player) => ({\n        name: player.name,\n        isDrawing: player.id === lobby.drawerId,\n        score: player.score,\n        playerId: player.id,\n        hasGuessed: player.guessed,\n      })),\n      settings: {\n        language: lobby.settings.language,\n        players: lobby.settings.players,\n        rounds: lobby.settings.rounds,\n        drawTime: lobby.settings.drawTime,\n      },\n    };\n  }\n\n  /**\n   * Updates the settings of the current typo lobby\n   * Requires the player to be the typo lobby owner\n   * @param description The new description of the lobby to be shown in the palantir bot\n   * @param whitelistAllowedServers Whether the lobby invite will be shown only in servers in the allowedServers list\n   * @param allowedServers A list of server IDs which are allowed to show the lobby invite\n   */\n  public async updateLobbySettings(\n    description: string,\n    whitelistAllowedServers: boolean,\n    allowedServers: Record<string, boolean>,\n  ) {\n    const toast = await this._toastService.showLoadingToast(\"Updating lobby settings\");\n\n    /* write settings to defaults */\n    this._lobbyService.lobby$.subscribe((lobby) => {\n      if (!lobby) return;\n      if (lobby.private) {\n        this._privateLobbyWhitelistEnabledSetting.setValue(whitelistAllowedServers);\n        this._privateLobbyWhitelistedServersSetting.setValue(\n          Object.keys(allowedServers).filter((key) => allowedServers[key]),\n        );\n      } else {\n        this._publicLobbyWhitelistEnabledSetting.setValue(whitelistAllowedServers);\n        this._publicLobbyWhitelistedServersSetting.setValue(\n          Object.keys(allowedServers).filter((key) => allowedServers[key]),\n        );\n      }\n    });\n\n    try {\n      await this._lobbyConnectionService.connection.hub.updateTypoLobbySettings({\n        description,\n        whitelistAllowedServers,\n        allowedServers: Object.entries(allowedServers)\n          .filter(([, value]) => value)\n          .map(([key]) => key),\n      });\n      toast.resolve();\n    } catch (e) {\n      this._logger.error(\"Failed to update lobby settings\", e);\n      toast.reject();\n    }\n  }\n\n  /**\n   * Disconnect the current lobby connection\n   * The next lobby change event will reconnect as if lobby was first discovered\n   */\n  public async resetConnection() {\n    await this._lobbyConnectionService.destroyConnection();\n    await this._toastService.showToast(\n      undefined,\n      \"Connection reset; reconnecting in next update cycle\",\n    );\n  }\n\n  /**\n   * Triggers a lobby update event with the last seen lobby data\n   */\n  public async triggerManualRefresh() {\n    this._triggerManualRefresh$.next(undefined);\n    await this._toastService.showToast(undefined, \"Manual refresh triggered\");\n  }\n}","Adds a progress bar at the top of the canvas, visualizing the remaining time for selected actions. <br>","import { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyJoinedEventListener } from \"@/content/events/lobby-joined.event\";\nimport { LobbyStateChangedEvent, LobbyStateChangedEventListener } from \"@/content/events/lobby-state-changed.event\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { delay, firstValueFrom, map, of, type Subscription, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport LobbyTimeVisualizerInfo from \"./lobby-time-visualizer-info.svelte\";\n\nexport class LobbyTimeVisualizerFeature extends TypoFeature {\n\n  @inject(LobbyStateChangedEventListener) private readonly _lobbyStateChangedEventListener!: LobbyStateChangedEventListener;\n  @inject(LobbyJoinedEventListener) private readonly _lobbyJoinedEventListener!: LobbyJoinedEventListener;\n\n  public readonly name = \"Time Visualizer\";\n  public readonly description = \"Shows a visual representation of time left to draw/choose\";\n  public readonly featureId = 30;\n\n  public override get featureInfoComponent(): componentData<LobbyTimeVisualizerInfo>{\n    return { componentType: LobbyTimeVisualizerInfo, props: {}};\n  }\n\n  private _enableChooseVisualizer = this.useSetting(new BooleanExtensionSetting(\"choose_visualizer\", true, this)\n    .withName(\"Choose Visualizer\")\n    .withDescription(\"Show a visualizer of the remaining time to choose words\"));\n\n  private _enableDrawVisualizer = this.useSetting(new BooleanExtensionSetting(\"draw_visualizer\", true, this)\n    .withName(\"Draw Visualizer\")\n    .withDescription(\"Show a visualizer of the remaining time to draw a word\"));\n\n  private _enableGuessVisualizer = this.useSetting(new BooleanExtensionSetting(\"guess_visualizer\", true, this)\n    .withName(\"Guess Visualizer\")\n    .withDescription(\"Show a visualizer of the remaining time to guess a word\"));\n\n  private visualizerEventSubscription?: Subscription;\n  private _visualizerStyle?: CSSStyleSheet;\n\n  protected override async onActivate() {\n\n    this._visualizerStyle = new CSSStyleSheet();\n    document.adoptedStyleSheets = [...document.adoptedStyleSheets, this._visualizerStyle];\n\n    this.visualizerEventSubscription = this._lobbyStateChangedEventListener.events$.pipe(\n      withLatestFrom(\n        this._enableDrawVisualizer.changes$,\n        this._enableGuessVisualizer.changes$,\n        this._enableChooseVisualizer.changes$,\n        this._lobbyJoinedEventListener.events$\n      ),\n      map(([event, draw, guess, choose, lobby]) => lobby && (\n        (draw && event.data.drawingStarted?.drawerId === lobby.data.meId ||\n        (guess && event.data.drawingStarted !== undefined && event.data.drawingStarted.drawerId !== lobby.data.meId) ||\n        (choose && event.data.drawerChoosingWord !== undefined) ? event : undefined\n        ))\n      )\n    ).subscribe((event) => {\n      this.visualizeEvent(event);\n    });\n  }\n\n  protected override async onDestroy() {\n    this.visualizerEventSubscription?.unsubscribe();\n    this.visualizerEventSubscription = undefined;\n    document.adoptedStyleSheets = document.adoptedStyleSheets.filter(sheet => sheet !== this._visualizerStyle);\n  }\n\n  private async visualizeEvent(event?: LobbyStateChangedEvent){\n    this._logger.debug(\"Visualize event\", event);\n\n    if(this._visualizerStyle === undefined) {\n      this._logger.error(\"Visualizer style not set\");\n      return;\n    }\n\n    /* reset styles*/\n    await this._visualizerStyle.replace(\"\");\n    if(event === undefined) return;\n\n    const time = event.data.drawingStarted?.maxTime ?? event.data.drawerChoosingWord?.maxTime;\n    if(time === undefined) {\n      this._logger.error(\"No time set for visualizer\", event);\n      return;\n    }\n\n    /* delay to separate animations.. */\n    await firstValueFrom(of(1).pipe(delay(10)));\n\n    /* add current visualizer */\n    await this._visualizerStyle.replace(`  \n      @keyframes countdown {\n        from { width: 100%; }\n        to { width: 0%; }\n      }\n    \n      #game-canvas:after {\n        content: \"\";\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 0;\n        height: .3rem;\n        background-color: LightGreen;\n        animation: countdown ${time * 1000}ms linear;\n      }\n    `);\n  }\n\n  public get enableChooseVisualizerStore() {\n    return this._enableChooseVisualizer.store;\n  }\n\n  public get enableDrawVisualizerStore() {\n    return this._enableDrawVisualizer.store;\n  }\n\n  public get enableGuessVisualizerStore() {\n    return this._enableGuessVisualizer.store;\n  }\n}","<script lang=\"ts\">\n  import type { LoggingFeature } from \"@/content/features/logging/logging.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let feature: LoggingFeature;\n\n  let resetAll: HTMLSelectElement;\n  let loggers = feature.loggers;\n  let loggerFilter: string = \"\";\n</script>\n\n<style lang=\"scss\">\n  .typo-logs-export, .typo-logs-logger-list, .typo-logs-overwrite {\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    gap: 1rem;\n    margin: 1rem;\n    align-items: center;\n  }\n\n  .typo-logs-logger-list {\n\n    .typo-logs-logger {\n      min-width: clamp(10em, auto, 100%);\n      max-width: clamp(10em, auto, 100%);\n      background-color: var(--COLOR_PANEL_HI);\n\n      display: flex;\n      flex-direction: column;\n      border-radius: 3px;\n      gap: 1rem;\n      padding: 1rem;\n\n      &.hidden {\n        display: none;\n      }\n    }\n  }\n</style>\n\n<h3>Export Logs</h3>\n<div class=\"typo-logs-export\">\n  <FlatButton on:click={() => feature.copyLogsToClipboard(false)} content=\"Copy logs text\" color=\"blue\"/>\n  <FlatButton on:click={() => feature.copyLogsToClipboard(true)} content=\"Copy logs JSON\" color=\"blue\"/>\n</div>\n\n<h3>Reset Log Level</h3>\n<div class=\"typo-logs-overwrite\">\n  <select bind:this={resetAll} style=\"width: auto\">\n    <option value=\"debug\">Debug</option>\n    <option value=\"info\">Information</option>\n    <option value=\"warn\">Warn</option>\n    <option value=\"error\">Error</option>\n  </select>\n  <FlatButton on:click={async () => {\n    await feature.resetAllLogLevels(resetAll.value);\n    loggers = feature.loggers;\n  }} content=\"Reset to selection\" color=\"orange\"/>\n</div>\n\n<h3>Customize Log Level</h3>\n<div class=\"typo-logs-logger-list\">\n  <input style=\"max-width: 20rem\" type=\"text\" placeholder=\"Filter loggers\" bind:value={loggerFilter}/>\n</div>\n<div class=\"typo-logs-logger-list\">\n  {#each loggers as logger}\n\n    <div class=\"typo-logs-logger\" class:hidden={!logger.boundTo.toLowerCase().includes(loggerFilter.toLowerCase())}>\n      <b>{logger.boundTo}</b>\n      <select on:change={(e) => feature.setLogLevelOfLogger(logger, e.currentTarget.value)}>\n        <option value=\"debug\" selected=\"{logger.level === 'debug'}\">Debug</option>\n        <option value=\"info\" selected=\"{logger.level === 'info'}\">Information</option>\n        <option value=\"warn\" selected=\"{logger.level === 'warn'}\">Warn</option>\n        <option value=\"error\" selected=\"{logger.level === 'error'}\">Error</option>\n      </select>\n    </div>\n\n  {/each}\n</div>","Logging collects debug data from events of all parts of the typo extension.<br>\nIn case of bugs or unexpected behavior, this data can be used to identify the cause of issues.<br>\n<br>\nTo filter out irrelevant events, the log level of each instance can be adjusted.<br>\nLog level is stored permanently in the extension settings across reloads; existing logs are not affected by log level changes.","import { TypoFeature } from \"@/content/core/feature/feature\";\nimport type { LoggerService } from \"@/content/core/logger/logger.service\";\nimport { LoggingService } from \"@/content/core/logger/logging.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { inject } from \"inversify\";\nimport LoggingManage from \"./logging-manage.svelte\";\nimport LoggingInfo from \"./logging-info.svelte\";\n\nexport class LoggingFeature extends TypoFeature {\n\n  public readonly name = \"Logging\";\n  public readonly description = \"Collect logs of services, features, setups and event processors.\";\n  public readonly featureId = 24;\n  public override readonly toggleEnabled = false;\n  public override readonly developerFeature = true;\n\n  @inject(LoggingService) private readonly _loggingService!: LoggingService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  public override get featureManagementComponent(): componentData<LoggingManage> {\n    return { componentType: LoggingManage, props: { feature: this }};\n  }\n\n  public override get featureInfoComponent(): componentData<LoggingInfo> {\n    return {componentType: LoggingInfo, props: { }};\n  }\n\n  public override postConstruct() {\n    this.useSetting(this._loggingService.printEnabledSetting);\n  }\n\n  public get loggers() {\n    return this._loggingService.loggers;\n  }\n\n  public async copyLogsToClipboard(asJson: boolean) {\n    const logs = this._loggingService.recordedEvents;\n    const logsText = asJson ?\n      JSON.stringify(logs) :\n      logs.map(event => `[${event.date.toISOString()}] [${event.logLevel}] (${event.bindingName}) ${event.message} ${event.data.join(\", \")}`).join(\"\\n\");\n    await navigator.clipboard.writeText(logsText);\n    await this._toastService.showToast(\"Logs copied to clipboard\");\n  }\n\n  public async setLogLevelOfLogger(logger: LoggerService, level: string){\n\n    /* check log level*/\n    if(level !== \"debug\" && level !== \"info\" && level !== \"warn\" && level !== \"error\"){\n      await this._toastService.showToast(\"Invalid log level\");\n      return;\n    }\n\n    /* update log level */\n    try {\n      const setting = this._loggingService.getLogLevelSetting(logger);\n      await setting.setValue(level);\n    }\n    catch (e) {\n      this._logger.error(\"Error updating log level\", e);\n      await this._toastService.showToast(\"Error updating log level\");\n      return;\n    }\n\n    await this._toastService.showToast(\"Updated Logger\", `Log level of ${logger.boundTo} set to ${level}`);\n  }\n\n  public async resetAllLogLevels(level: string) {\n\n    /* check log level*/\n    if(level !== \"debug\" && level !== \"info\" && level !== \"warn\" && level !== \"error\"){\n      await this._toastService.showToast(\"Invalid log level\");\n      return;\n    }\n\n    const toast = await this._toastService.showLoadingToast(\"Resetting log levels to \" + level);\n\n    /* update log level */\n    const promises = this._loggingService.loggers.map(logger => {\n      const setting = this._loggingService.getLogLevelSetting(logger);\n      return setting.setValue(level);\n    });\n\n    try {\n      await Promise.all(promises);\n    }\n    catch (e) {\n      this._logger.error(\"Error resetting log level to \" + level, e);\n      toast.reject(\"Error resetting log levels\");\n      return;\n    }\n\n    toast.resolve();\n  }\n}","<script lang=\"ts\">\n  import { PanelCabinFeature } from \"./panel-cabin.feature\";\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n\n  export let feature: PanelCabinFeature;\n  const memberStore = feature.memberStore;\n  const scenePickerEnabled = feature.scenePickerSettingStore;\n\n  let dndTargetSlot: number | undefined;\n  let dndTrack: number[] | undefined; // [originalSlot] -> newSlot\n  let loading = false;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-cabin {\n    height: 100%;\n    overflow: auto;\n    position: relative;\n\n    .typo-cabin-saving {\n      position: absolute;\n      inset: 0;\n      display: none;\n      place-content: center;\n      z-index: 2;\n    }\n\n    &.loading {\n      .typo-cabin-saving {\n        display: grid;\n      }\n\n      .typo-cabin-picker {\n        opacity: .2;\n      }\n    }\n\n    .typo-cabin-scroll {\n      height: 100%;\n      overflow: auto;\n      padding-right: .5rem;\n    }\n  }\n\n  .typo-cabin-picker {\n    display: grid;\n    grid-template-columns: 1fr 1fr 1fr;\n    grid-gap: .5rem;\n\n    .typo-cabin-scene {\n      order: 0;\n      grid-column: span 3;\n      width: 100%;\n      aspect-ratio: 3;\n      background-color: var(--COLOR_PANEL_BG);\n      border-radius: 5px;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      gap: .5rem;\n      overflow: hidden;\n      transition: transform .1s;\n      cursor: pointer;\n      user-select: none;\n      position: relative;\n\n      .typo-cabin-scene-thumb {\n        position: absolute;\n        inset: 0;\n        background-size: cover;\n        background-position: center;\n        background-repeat: no-repeat;\n        z-index: 0;\n        opacity: 1;\n        transition: opacity .1s;\n      }\n\n      &:hover {\n        transform: scale(0.95);\n\n        .typo-cabin-scene-info {\n          opacity: 1;\n        }\n\n        .typo-cabin-scene-thumb {\n          opacity: .2;\n        }\n      }\n\n      .typo-cabin-scene-info {\n        opacity: 0;\n        text-align: center;\n        font-size: .8rem;\n        transition: opacity .1s;\n        z-index: 1;\n\n        &.visible {\n          opacity: 1;\n        }\n      }\n    }\n\n    .typo-cabin-slot {\n      background-color: var(--COLOR_PANEL_BG);\n      border-radius: 5px;\n      width: 100%;\n      aspect-ratio: 1;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      gap: .5rem;\n      overflow: hidden;\n      transition: transform .1s;\n      cursor: pointer;\n      user-select: none;\n      position: relative;\n\n      .typo-cabin-slot-thumb {\n        position: absolute;\n        inset: 0;\n        background-size: cover;\n        background-position: center;\n        background-repeat: no-repeat;\n        z-index: 0;\n        opacity: 1;\n        transition: opacity .1s;\n      }\n\n      &:hover:not(.dragging) {\n        transform: scale(0.9);\n\n        .typo-cabin-slot-info {\n          opacity: 1;\n        }\n\n        .typo-cabin-slot-thumb {\n          opacity: .2;\n        }\n      }\n\n      .typo-cabin-slot-info {\n        opacity: 0;\n        text-align: center;\n        font-size: .8rem;\n        transition: opacity .1s;\n        z-index: 1;\n\n        &.visible {\n          opacity: 1;\n        }\n      }\n\n      &.locked {\n        cursor: not-allowed;\n\n        .typo-cabin-slot-info {\n          opacity: .9;\n        }\n      }\n\n      &.dnd-placeholder {\n        opacity: 0;\n      }\n    }\n  }\n</style>\n\n<div class=\"typo-cabin\" class:loading={loading}>\n\n  <div class=\"typo-cabin-saving\">\n    <Bounceload content=\"Saving..\" />\n  </div>\n\n{#if $memberStore === undefined}\n\n  <Bounceload content=\"Loading inventory..\" />\n\n{:else if ($memberStore === null)}\n\n  <div>You need to log in to use sprites.</div>\n\n{:else}\n\n  <div class=\"typo-cabin-scroll\">\n    <div class=\"typo-cabin-picker\">\n\n      {#if $scenePickerEnabled}\n        <div class=\"typo-cabin-scene\"\n             on:click={async ()=>{\n               const scene = await feature.promptSceneSelection($memberStore.memberData.sceneInventory);\n               if(scene !== undefined) {\n                  loading = true;\n                  await feature.setScene(scene?.scene ?? null, scene?.shift, $memberStore.memberData.member.userLogin);\n                  loading = false;\n               }\n             }}\n\n             on:contextmenu={async (event) => {\n               event.preventDefault();\n               loading = true;\n               await feature.setScene(null, undefined, $memberStore.memberData.member.userLogin);\n               loading = false;\n             }}\n        >\n          {#if $memberStore.scene && $memberStore.scene.scene}\n            <div class=\"typo-cabin-scene-info\">\n              {$memberStore.scene.scene.name} (#{$memberStore.scene.scene.id})\n            </div>\n            <div class=\"typo-cabin-scene-thumb\"\n                 style=\"background-image: url({feature.getItemThumbnailUrl($memberStore.scene.scene, $memberStore.scene.shift)})\"\n            ></div>\n          {:else }\n            <div class=\"typo-cabin-scene-info visible\">No scene selected</div>\n          {/if}\n        </div>\n      {/if}\n\n      {#each {length: $memberStore.memberData.slots.unlockedSlots} as _, slot}\n        <div class=\"typo-cabin-slot\" role=\"gridcell\" tabindex=\"{slot}\" draggable=\"true\" class:dragging={dndTargetSlot !== undefined}\n             style=\"order: {dndTrack ? dndTrack[slot] : slot}\"\n             on:dragenter={(event) => {\n               if(dndTargetSlot === slot || dndTrack === undefined || dndTargetSlot === undefined) return;\n\n               const newTrack = [...Array($memberStore.memberData.slots.unlockedSlots).keys()];\n               for(let i = 0; i < dndTrack.length; i++) {\n                 if(i >= slot && i < dndTargetSlot){\n                   newTrack[i] = i+1;\n                 }\n                 if(i <= slot && i > dndTargetSlot){\n                   newTrack[i] = i-1;\n                 }\n               }\n               newTrack[dndTargetSlot] = dndTrack[slot];\n               dndTrack = newTrack;\n\n               // TODO: BUG after adjacent (by oder) swapping elements twice, they are stuck??\n             }}\n             on:dragstart={() => {\n                  dndTargetSlot = slot;\n                  dndTrack = [...Array($memberStore.memberData.slots.unlockedSlots).keys()]; // original order\n             }}\n             on:dragend={async () => {\n               loading = true;\n               await feature.reorderSlots(dndTrack, $memberStore.memberData.spriteInventory, Number($memberStore.memberData.member.userLogin));\n               dndTargetSlot = undefined;\n               dndTrack = undefined;\n                loading = false;\n             }}\n             on:click={async ()=>{\n               const sprite = await feature.promptSpriteSelection($memberStore.memberData.spriteInventory);\n               if(sprite !== undefined) {\n                  loading = true;\n                  await feature.setSpriteOnSlot(slot + 1, sprite, $memberStore.memberData.member.userLogin);\n                  loading = false;\n               }\n             }}\n\n             on:contextmenu={async (event) => {\n               event.preventDefault();\n               loading = true;\n               await feature.setSpriteOnSlot(slot + 1, null, $memberStore.memberData.member.userLogin);\n               loading = false;\n             }}\n        >\n\n          {#if $memberStore.slots.has(slot)}\n            <div class=\"typo-cabin-slot-info\">\n              Slot #{slot + 1}\n            </div>\n\n            <div class=\"typo-cabin-slot-info\">\n              {$memberStore.slots.get(slot)?.sprite?.name ?? \"Unknown\"}\n              (#{$memberStore.slots.get(slot)?.spriteId})\n            </div>\n\n            <div class=\"typo-cabin-slot-thumb\"\n                 style=\"background-image: url({feature.getItemThumbnailUrl($memberStore.slots.get(slot)?.sprite, $memberStore.slots.get(slot)?.colorShift)})\"\n            ></div>\n          {:else }\n            <div class=\"typo-cabin-slot-info visible\">\n              Slot #{slot + 1}\n            </div>\n\n            <div class=\"typo-cabin-slot-info visible\">\n              Empty\n            </div>\n          {/if}\n\n        </div>\n      {/each}\n\n      <!-- fill for full row or at least 9 with locked slots -->\n      {#each {length: Math.max(9 - $memberStore.memberData.slots.unlockedSlots, 3 - ($memberStore.memberData.slots.unlockedSlots % 3))} as _, slot}\n        <div class=\"typo-cabin-slot locked\" style=\"order: {slot + $memberStore.memberData.slots.unlockedSlots + 1}\">\n          <div class=\"typo-cabin-slot-info\">\n            Slot #{slot + $memberStore.memberData.slots.unlockedSlots + 1}\n          </div>\n          <div class=\"typo-cabin-slot-info\">\n            Locked\n          </div>\n        </div>\n      {/each}\n\n    </div>\n\n  </div>\n\n{/if}\n</div>","<script lang=\"ts\">\n\n  import type { SpriteDto, SpriteInventoryDto } from \"@/api\";\n  import type { PanelCabinFeature } from \"@/content/features/panel-cabin/panel-cabin.feature\";\n\n  export let feature: PanelCabinFeature;\n  export let onPick: (sprite: SpriteDto | undefined | null) => void;\n  export let sprites: SpriteDto[];\n  export let inventory: SpriteInventoryDto[];\n\n  let spritesMap = new Map<number, SpriteDto>();\n  $: {\n    spritesMap = new Map(sprites.map(sprite => [sprite.id, sprite]));\n  }\n</script>\n\n<style lang=\"scss\">\n\n  .typo-scene-picker {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    overflow: auto;\n\n    .typo-scene-picker-list {\n      flex-grow: 1;\n      width: 100%;\n      overflow: auto;\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(8rem, 1fr));\n      gap: 1rem;\n      padding: 0 2rem;\n\n      .typo-scene-picker-scene {\n        background-color: var(--COLOR_PANEL_BG);\n        border-radius: 5px;\n        display: flex;\n        flex-direction: column;\n        gap: .1rem;\n        padding: .1rem;\n        align-items: center;\n        cursor: pointer;\n        transition: transform .1s;\n\n        &:hover {\n          transform: scale(0.9);\n        }\n\n        .typo-scene-picker-scene-thumb{\n          width: 5rem;\n          aspect-ratio: 1;\n          background-size: cover;\n        }\n\n        span {\n          font-size: .9rem;\n          opacity: .9;\n          text-align: center;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-scene-picker\">\n\n  <span>\n    Choose a sprite from your inventory which will be used on the selected slot.<br>\n    You can only choose sprites that are not already in use.\n  </span>\n\n  <div class=\"typo-scene-picker-list color-scrollbar\">\n\n    <div class=\"typo-scene-picker-scene\" on:click={() => onPick(null)}>\n      <div class=\"typo-scene-picker-scene-thumb\"></div>\n      <span>Empty</span>\n    </div>\n\n    {#each inventory as sprite}\n      {#if sprite.slot === undefined}\n\n        <div class=\"typo-scene-picker-scene\" on:click={() => onPick(spritesMap.get(sprite.spriteId))} style=\"order: {sprite.spriteId}\">\n          <div class=\"typo-scene-picker-scene-thumb\"\n               style=\"background-image: url({spritesMap.get(sprite.spriteId)?.url})\"></div>\n          <span>#{spritesMap.get(sprite.spriteId)?.id}</span>\n          <span>{spritesMap.get(sprite.spriteId)?.name}</span>\n        </div>\n\n      {/if}\n    {/each}\n\n  </div>\n\n</div>","<script lang=\"ts\">\n\n  import type { SceneDto, SceneInventoryDto, SpriteDto, SpriteInventoryDto } from \"@/api\";\n  import type { PanelCabinFeature } from \"@/content/features/panel-cabin/panel-cabin.feature\";\n\n  export let feature: PanelCabinFeature;\n  export let onPick: (sprite: SceneDto | undefined | null, shift: number | undefined) => void;\n  export let scenes: SceneDto[];\n  export let inventory: SceneInventoryDto;\n\n  let scenesMap = new Map<number, SceneDto>();\n  $: {\n    scenesMap = new Map(scenes.map(scene => [scene.id, scene]));\n  }\n</script>\n\n<style lang=\"scss\">\n\n  .typo-scene-picker {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    overflow: auto;\n\n    .typo-scene-picker-list {\n      flex-grow: 1;\n      width: 100%;\n      overflow: auto;\n      display: flex;\n      align-items: center;\n      flex-direction: column;\n      gap: 1rem;\n      padding: 0 2rem;\n\n      .typo-scene-picker-scene {\n        background-color: var(--COLOR_PANEL_BG);\n        border-radius: 5px;\n        display: flex;\n        flex-direction: column;\n        gap: .1rem;\n        padding: .1rem;\n        align-items: center;\n        cursor: pointer;\n        transition: transform .1s;\n\n        &:hover {\n          transform: scale(0.9);\n        }\n\n        .typo-scene-picker-scene-thumb{\n          width: 20rem;\n          max-width: 90%;\n          aspect-ratio: 3;\n          background-size: cover;\n        }\n\n        span {\n          font-size: .9rem;\n          opacity: .9;\n          text-align: center;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-scene-picker\">\n\n  <span>\n    Choose a scene from your inventory which will be used as your avatar background.\n  </span>\n\n  <div class=\"typo-scene-picker-list color-scrollbar\">\n\n    <div class=\"typo-scene-picker-scene\" on:click={() => onPick(null, undefined)}>\n      <div class=\"typo-scene-picker-scene-thumb\"></div>\n      <span>Empty</span>\n    </div>\n\n    {#each inventory.scenes as scene}\n\n      <!-- theme scene -->\n      {#if scene.sceneShift}\n        <div class=\"typo-scene-picker-scene\" on:click={() => onPick(scenesMap.get(scene.sceneId), scene.sceneShift)} style=\"order: {scene.sceneId}\">\n          <div class=\"typo-scene-picker-scene-thumb\"\n               style=\"background-image: url({feature.getItemThumbnailUrl(scenesMap.get(scene.sceneId), scene.sceneShift)})\"></div>\n          <span>#{scenesMap.get(scene.sceneId)?.id} / {scene.sceneShift}</span>\n          <span>{scenesMap.get(scene.sceneId)?.themes.find(t => t.shift === scene.sceneShift)?.name}</span>\n        </div>\n\n      <!-- regular scene -->\n      {:else}\n        <div class=\"typo-scene-picker-scene\" on:click={() => onPick(scenesMap.get(scene.sceneId), undefined)} style=\"order: {scene.sceneId}\">\n          <div class=\"typo-scene-picker-scene-thumb\"\n               style=\"background-image: url({scenesMap.get(scene.sceneId)?.url})\"></div>\n          <span>#{scenesMap.get(scene.sceneId)?.id}</span>\n          <span>{scenesMap.get(scene.sceneId)?.name}</span>\n        </div>\n      {/if}\n    {/each}\n\n  </div>\n\n</div>","import {\n  InventoryApi,\n  type SceneDto,\n  type SceneInventoryDto,\n  type SpriteDto,\n  type SpriteInventoryDto,\n  type SpriteSlotDto,\n} from \"@/api\";\nimport { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport {\n  type componentDataFactory,\n  ModalService,\n} from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { switchMap } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport PanelCabin from \"./panel-cabin.svelte\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport SpritePicker from \"./panel-cabin-sprite-picker.svelte\";\nimport ScenePicker from \"./panel-cabin-scene-picker.svelte\";\n\nexport class PanelCabinFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(ApiService) private readonly _apiService!: ApiService;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  private _component?: PanelCabin;\n\n  public readonly name = \"Outfit Cabin\";\n  public readonly description =\n    \"Displays a drag-n-drop interface on the start page to customize your sprite combo\";\n  public readonly featureId = 3;\n\n  private readonly _enableScenePickerSetting = this.useSetting(\n    new BooleanExtensionSetting(\"enable_scene_picker\", true, this)\n      .withName(\"Enable Scene Picker\")\n      .withDescription(\"Show the scene picker at the top of the sprite cabin\"),\n  );\n\n  protected override async onActivate() {\n    const elements = await this._elements.complete();\n    this._component = new PanelCabin({\n      target: elements.cabinTab,\n      props: {\n        feature: this,\n      },\n    });\n  }\n\n  protected override onDestroy(): void {\n    this._component?.$destroy();\n  }\n\n  public get scenePickerSettingStore() {\n    return this._enableScenePickerSetting.store;\n  }\n\n  public get memberStore() {\n    return fromObservable(\n      this._memberService.memberData$.pipe(\n        /* map data into useful structure */\n        switchMap(async (memberData) => {\n          if (memberData === null || memberData === undefined) {\n            return null;\n          }\n          const apiData = await this._apiDataSetup.complete();\n          const slots = new Map(\n            memberData.spriteInventory\n              .filter((i) => i.slot !== undefined)\n              .map((i) => ({\n                ...i,\n                sprite: apiData.sprites.find((s) => s.id === i.spriteId),\n              }))\n              .map((i) => [(i.slot ?? 0) - 1, i]),\n          );\n\n          const scene = memberData.sceneInventory.activeId\n            ? {\n                id: memberData.sceneInventory.activeId,\n                shift: memberData.sceneInventory.activeShift,\n                scene: apiData.scenes.find((s) => s.id === memberData.sceneInventory.activeId),\n              }\n            : undefined;\n\n          return { memberData, slots, scene };\n        }),\n      ),\n      undefined,\n    );\n  }\n\n  /**\n   * Generates a url of a scene or sprite, optionally shifted if provided\n   * @param item\n   * @param shift\n   */\n  getItemThumbnailUrl(item: SpriteDto | SceneDto | undefined, shift: number | undefined) {\n    return item\n      ? shift\n        ? `https://static.typo.rip/sprites/rainbow/modulate.php?url=${item.url}&hue=${shift}`\n        : item.url\n      : \"\";\n  }\n\n  /**\n   * Reorder the slots of a user\n   * @param slotMap\n   * @param inventory\n   * @param login\n   */\n  async reorderSlots(slotMap: number[], inventory: SpriteInventoryDto[], login: number) {\n    this._logger.debug(\"Reordering slots\", slotMap, inventory);\n\n    if (slotMap.every((v, i) => v === i)) {\n      this._logger.info(\"No change in slot order\");\n      return;\n    }\n\n    const slots: SpriteSlotDto[] = [];\n    inventory.forEach((item) => {\n      if (item.slot !== undefined) {\n        slots.push({ slotId: slotMap[item.slot - 1] + 1, spriteId: item.spriteId });\n      }\n    });\n\n    await this._apiService\n      .getApi(InventoryApi)\n      .setMemberSpriteCombo({ login, spriteComboDto: { slots } });\n    await this._memberService.refreshInventory();\n    this._logger.info(\"Reordered slots\", slots);\n  }\n\n  /**\n   * Prompt the user to select a sprite\n   * @param inventory\n   */\n  async promptSpriteSelection(inventory: SpriteInventoryDto[]): Promise<undefined | null | SpriteDto> {\n    this._logger.debug(\"Opening sprite picker\");\n\n    const sprites = (await this._apiDataSetup.complete()).sprites;\n    const pickerComponent: componentDataFactory<SpritePicker, SpriteDto | null | undefined> = {\n      componentType: SpritePicker,\n      propsFactory: submit => ({\n        feature: this,\n        inventory,\n        sprites,\n        onPick: submit.bind(this),\n      }),\n    };\n\n    const sprite = await this._modalService.showPrompt(\n      pickerComponent.componentType,\n      pickerComponent.propsFactory,\n      \"Sprite Picker\",\n      \"document\"\n    );\n\n    this._logger.debug(\"Sprite picker closed\", sprite);\n    return sprite;\n  }\n\n  /**\n   * Set a sprite on a slot for a user\n   * @param slot\n   * @param sprite\n   * @param login\n   */\n  async setSpriteOnSlot(slot: number, sprite: SpriteDto | null, login: number) {\n    this._logger.debug(\"Setting sprite on slot\", slot, sprite);\n\n    try {\n      await this._apiService\n        .getApi(InventoryApi)\n        .setMemberSpriteSlot({ login, spriteSlotDto: { slotId: slot, spriteId: sprite?.id ?? 0 } });\n      await this._memberService.refreshInventory();\n    } catch (e) {\n      this._logger.error(\"Failed to set sprite on slot\", e);\n      await this._toastService.showToast(\"Failed to set sprite on slot\");\n    }\n  }\n\n  /**\n   * Prompt the user to select a scene\n   * @param inventory\n   */\n  async promptSceneSelection(inventory: SceneInventoryDto): Promise<undefined | null | { scene: SceneDto, shift: number | undefined }> {\n    this._logger.debug(\"Opening scene picker\");\n\n    const scenes = (await this._apiDataSetup.complete()).scenes;\n    const pickerComponent: componentDataFactory<ScenePicker, { scene: SceneDto, shift: number | undefined } | null | undefined> = {\n      componentType: ScenePicker,\n      propsFactory: submit => ({\n        feature: this,\n        inventory,\n        scenes,\n        onPick: (scene: SceneDto | null | undefined, shift: number | undefined) => submit(scene ? {scene, shift} : scene),\n      }),\n    };\n\n    const scene = await this._modalService.showPrompt(\n      pickerComponent.componentType,\n      pickerComponent.propsFactory,\n      \"Scene Picker\",\n      \"document\"\n    );\n\n    this._logger.debug(\"Scene picker closed\", scene);\n    return scene;\n  }\n\n  /**\n   * Set the scene of a user\n   * @param scene\n   * @param shift\n   * @param login\n   */\n  async setScene(scene: SceneDto | null, shift: number | undefined, login: number) {\n    this._logger.debug(\"Setting scene\", scene, shift);\n\n    try {\n      await this._apiService\n        .getApi(InventoryApi)\n        .setMemberScene({ login, setActiveSceneDto: { scene: scene ? {sceneId: scene.id, sceneShift: shift} : undefined } });\n      await this._memberService.refreshInventory();\n    } catch (e) {\n      this._logger.error(\"Failed to set scene\", e);\n      await this._toastService.showToast(\"Failed to set scene\");\n    }\n  }\n}","<script lang=\"ts\">\n  import type { AnnouncementDto } from \"@/api\";\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n  import { Color } from \"@/util/color\";\n  import { PanelChangelogFeature } from \"./panel-changelog.feature\";\n  import ColorPicker from \"@/lib/color-picker/color-picker-button.svelte\";\n  export let feature: PanelChangelogFeature;\n  export let changes: AnnouncementDto[] | undefined = undefined;\n  const devmode = feature.devmodeStore;\n</script>\n\n<style lang=\"scss\">\n  div.panel-changelog {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    padding: 0 .5rem;\n\n    > .changelog {\n      white-space: pre;\n      text-wrap: pretty;\n\n      .change {\n        display: flex;\n        flex-direction: column;\n        gap: .5rem;\n        padding: .5rem 0;\n\n        &:not(:last-child) {\n          border-bottom: 1px solid var(--COLOR_PANEL_BORDER_FOCUS);\n        }\n\n        .title {\n          display: flex;\n          justify-content: space-between;\n          gap: 1rem;\n          align-items: center;\n\n          span {\n            font-size: .8rem;\n            opacity: .7;\n          }\n        }\n      }\n    }\n\n    .typo-version {\n      font-size: .8rem;\n      opacity: .7;\n    }\n  }\n</style>\n\n<div class=\"panel-changelog\">\n  {#if $devmode}\n    <p class=\"typo-version\">\n      Typo version: {feature.getVersion()}\n    </p>\n  {/if}\n  <div class=\"changelog\">\n    {#if changes === undefined}\n      <Bounceload content=\"Loading changelog..\" />\n    {:else}\n      {#each changes as change}\n        <div class=\"change\">\n          <div class=\"title\">\n            <b>{change.title}</b>\n            <span>{change.affectedTypoVersion} ({new Date(Number(change.date)).toLocaleDateString()})</span>\n          </div>\n          <p>{change.content}</p>\n        </div>\n      {/each}\n    {/if}\n  </div>\n</div>","import { AnnouncementDtoTypeEnum } from \"@/api\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport PanelChangelog from \"./panel-changelog.svelte\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\nexport class PanelChangelogFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(GlobalSettingsService) private readonly _globalSettingsService!: GlobalSettingsService;\n\n  private _component?: PanelChangelog;\n\n  public readonly name = \"Changelog\";\n  public readonly description = \"Displays a list of changes since the last updates on the start page\";\n  public readonly featureId = 4;\n\n  protected override async onActivate() {\n    const elements = await this._elements.complete();\n\n    this._component = new PanelChangelog({\n      target: elements.changelogTab,\n      props: {\n        feature: this,\n      }\n    });\n\n    const data = await this._apiDataSetup.complete();\n    const changes = data.announcements\n      .filter(announcement => announcement.type === AnnouncementDtoTypeEnum.Changelog)\n      .sort((a, b) => Number(b.date) - Number(a.date));\n    this._component.$set({ changes });\n  }\n\n  protected override onDestroy(): void {\n    this._component?.$destroy();\n  }\n\n  public get devmodeStore() {\n    return this._globalSettingsService.settings.devMode.store;\n  }\n\n  public getVersion(){\n    return chrome.runtime.getManifest().version_name;\n  }\n\n  public readonly changelog = \"I am the changelog :)\";\n}","import { loggerFactory } from \"@/content/core/logger/loggerFactory.interface\";\nimport { SocketService } from \"@/content/services/socket/socket.service\";\nimport type { OnlineItemDto, OnlineItemsUpdatedDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { inject, injectable, postConstruct } from \"inversify\";\nimport { BehaviorSubject } from \"rxjs\";\n\n@injectable()\nexport class LobbyItemsService {\n\n  @inject(SocketService) private readonly _socketService!: SocketService;\n\n  private readonly _logger;\n  private readonly _onlineItems$ = new BehaviorSubject<OnlineItemDto[]>([]);\n\n  constructor(\n    @inject(loggerFactory) loggerFactory: loggerFactory,\n  ) {\n    this._logger = loggerFactory(this);\n  }\n\n  @postConstruct()\n  private postConstruct() {\n    this.setupConnection();\n  }\n\n  private async setupConnection(){\n    const connection = this._socketService.createConnection(\"IOnlineItemsHub\");\n    this._socketService.createReceiver(\"IOnlineItemsReceiver\").register(connection, {\n      onlineItemsUpdated: this.onOnlineItemsUpdated.bind(this)\n    });\n    await connection.start();\n  }\n\n  async onOnlineItemsUpdated(update: OnlineItemsUpdatedDto) {\n    this._logger.info(\"Online items updated\", update);\n    this._onlineItems$.next(update.items);\n  }\n\n  public get onlineItems$() {\n    return this._onlineItems$.asObservable();\n  }\n}","<script lang=\"ts\">\n  import { type lobbyFilter, PanelFiltersFeature } from \"./panel-filters.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\n  export let feature: PanelFiltersFeature;\n\n  const filters = feature.savedFiltersStore;\n  const selectedFilters = feature.selectedFiltersStore;\n\n  $: filterStates = $filters.map(filter => $selectedFilters.includes(filter.createdAt));\n</script>\n\n<style lang=\"scss\">\n\n  .typo-lobby-filters {\n    display: flex;\n    flex-direction: column;\n    overflow: auto;\n    height: 100%;\n    gap: 1rem;\n\n    .typo-lobby-filters-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .typo-lobby-filters-list{\n      flex-grow: 1;\n      display: flex;\n      flex-wrap: wrap;\n      gap: 1rem;\n      align-content: flex-start;\n      overflow: auto;\n\n      .typo-lobby-filters-item {\n        display: flex;\n        align-items: center;\n        gap: .5rem;\n        padding: .2rem;\n        background-color: var(--COLOR_PANEL_HI);\n        border-radius: 3px;\n\n        .typo-lobby-filters-item-remove {\n          opacity: 0;\n          transition: opacity .1s;\n        }\n\n        &:hover .typo-lobby-filters-item-remove {\n          opacity: 1;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-lobby-filters\">\n\n  <div class=\"typo-lobby-filters-list\" >\n\n    {#if $filters.length === 0}\n      <div>No filters saved.</div>\n    {/if}\n\n    {#each $filters as filter, i}\n      <div class=\"typo-lobby-filters-item\" style=\"order: {filter.createdAt}\" use:feature.createTooltip={{title: `${feature.buildFilterTooltipText(filter)}`}} >\n        <Checkbox description=\"{filter.name}\" checked=\"{filterStates[i]}\" on:change={checked => {\n          const other = $selectedFilters.filter(f => f !== filter.createdAt);\n          selectedFilters.set(checked.detail ? [...other, filter.createdAt] : other);\n        }} />\n        <div class=\"typo-lobby-filters-item-remove\">\n          <IconButton\n            icon=\"file-img-trash-gif\"\n            name=\"Remove Filter\"\n            greyscaleInactive=\"{true}\"\n            hoverMove=\"{false}\"\n            size=\"1.5rem\"\n            on:click={() => feature.removeFilter(filter)}\n          />\n        </div>\n      </div>\n    {/each}\n  </div>\n\n  <div class=\"typo-lobby-filters-header\">\n    <FlatButton content=\"Start Search\" color=\"green\" on:click={async () => {\n      await feature.startSearch();\n    }} />\n\n    <FlatButton content=\"Add Lobby Filter\" color=\"blue\"  on:click={async () => {\n      const filter = await feature.promptFilterCreation();\n      if(filter) {\n        await feature.addFilter(filter);\n      }\n    }} />\n\n    <!--<div use:feature.createTooltip={{title: \"Lobby filters skip lobbies until\\n a matching lobby is found.\"}}>\n\n    </div>-->\n  </div>\n</div>","<script lang=\"ts\">\n  import { type lobbyFilter, PanelFiltersFeature } from \"./panel-filters.feature\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n\n  export let feature: PanelFiltersFeature;\n  export let onCreate: (filter: lobbyFilter) => void;\n\n  const filter: lobbyFilter = {\n    name: \"\",\n    createdAt: new Date().getTime()\n  };\n</script>\n\n<style lang=\"scss\">\n\n  .typo-filter-form {\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n\n    .typo-filter-form-inputs {\n      display: flex;\n      flex-direction: column;\n      gap: 1rem;\n\n      .typo-filter-form-row {\n        display: flex;\n        gap: 1rem;\n        align-items: center;\n\n        input[type=\"text\"] {\n          width: auto;\n          flex-grow: 1;\n        }\n\n        input[type=\"number\"] {\n          width: 5rem;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-filter-form\">\n\n  <div>\n    A lobby filter checks if a lobby matches the filter criteria and skips automatically until a lobby is found.<br>\n    You can add multiple filters; at least one of them has to be matched for a lobby to be accepted.<br>\n    If you leave filter criteria empty, it will be ignored.\n  </div>\n\n  <div class=\"typo-filter-form-inputs\">\n    <div class=\"typo-filter-form-row\">\n      <input type=\"text\" placeholder=\"Filter name\" bind:value={filter.name} />\n      <FlatButton content=\"Add Filter\" color=\"blue\" on:click={async () => {\n        onCreate(filter);\n      }} />\n    </div>\n  </div>\n\n  <div class=\"typo-filter-form-inputs\">\n    <div class=\"typo-filter-form-row\">\n      <b>Names:</b>\n      <span>Match lobbies with names containing one of the comma-separated names</span>\n      <input type=\"text\" placeholder=\"ice king, princess bubblegum, finn\" on:change={(e) => {\n        const names = e.currentTarget.value.split(\",\").map(name => name.trim());\n        filter.containsUsernames = names.length > 0 ? names : undefined;\n      }} />\n    </div>\n\n    <div class=\"typo-filter-form-row\">\n      <b>Players:</b>\n      <span>Match lobbies having at least </span>\n      <input type=\"number\" placeholder=\"1\" bind:value={filter.minAmountPlayers} />\n      <span>and at most</span>\n      <input type=\"number\" placeholder=\"8\" bind:value={filter.maxAmountPlayers} />\n      <span>players.</span>\n    </div>\n\n    <div class=\"typo-filter-form-row\">\n      <b>Round:</b>\n      <span>Match lobbies that are currently at least in round</span>\n      <input type=\"number\" placeholder=\"1\" bind:value={filter.minRound} />\n      <span>and at most in round</span>\n      <input type=\"number\" placeholder=\"3\" bind:value={filter.maxRound} />\n    </div>\n\n    <div class=\"typo-filter-form-row\">\n      <b>Average Score:</b>\n      <span>Match lobbies where the average player score is at least</span>\n      <input type=\"number\" placeholder=\"500\" bind:value={filter.minAverageScore} />\n      <span>points and at most</span>\n      <input type=\"number\" placeholder=\"3000\" bind:value={filter.maxAverageScore} />\n      <span>points.</span>\n    </div>\n\n    <div class=\"typo-filter-form-row\">\n      <Checkbox description=\"Match only lobbies with typo players\" bind:checked={filter.containsTypoPlayers} />\n    </div>\n  </div>\n\n</div>","<script lang=\"ts\">\n  import { type lobbyFilter, PanelFiltersFeature } from \"./panel-filters.feature\";\n\n  export let feature: PanelFiltersFeature;\n  export let filters: lobbyFilter[];\n  export let lobbySelected: (id: string) => void;\n  const visitedLobbies = feature.visitedLobbiesStore;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-filter-search {\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n    max-width: min(50vw, 100%);\n\n    .typo-filter-search-list {\n\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      gap: 1rem;\n      justify-content: center;\n\n      .typo-filter-search-list-item {\n\n        display: flex;\n        flex-direction: column;\n        gap: .5rem;\n        background-color: var(--COLOR_PANEL_HI);\n        border-radius: 3px;\n        padding: .5rem;\n        \n        &.lobby {\n          cursor: pointer;\n        }\n\n        > b {\n          flex-grow: 1;\n          text-align: center;\n        }\n\n        .typo-filter-search-list-item-description {\n          white-space: preserve;\n        }\n      }\n\n    }\n\n  }\n\n</style>\n\n<div class=\"typo-filter-search\">\n\n  <div>\n    Lobby search is currently running and joining through lobbies.<br>\n    The search will stop once a lobby is found that matches one of the filters:\n  </div>\n\n  <div class=\"typo-filter-search-list\">\n    {#each filters as filter}\n\n      <div class=\"typo-filter-search-list-item\">\n        <b>{filter.name}</b>\n\n        <div class=\"typo-filter-search-list-item-description\">\n          {feature.buildFilterTooltipText(filter)}\n        </div>\n\n      </div>\n    {/each}\n  </div>\n\n  <div>\n    Discovered lobbies: {$visitedLobbies.length}<br>\n    If you click on a lobby, the search will stop and join the selected lobby instead.<br>\n    A lobby might have changed since it was discovered.\n  </div>\n\n  <div class=\"typo-filter-search-list\">\n\n    {#each $visitedLobbies.filter(lobby => lobby.players.length > 1) as lobby}\n\n      <div class=\"typo-filter-search-list-item lobby\" on:click={() => lobbySelected(lobby.id ?? \"\")}>\n        <b>{lobby.players.length - 1} players, round {lobby.round}</b>\n\n        <div class=\"typo-filter-search-list-item-description\">\n          {lobby.players.filter(p => p.id !== lobby.meId).map(p => p.name).join(\", \")}\n        </div>\n      </div>\n    {/each}\n  </div>\n</div>","import { ExtensionSetting, type serializableObject } from \"@/content/core/settings/setting\";\nimport { LobbyItemsService } from \"@/content/services/lobby-items/lobby-items.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport {\n  type componentDataFactory,\n  ModalService,\n} from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport type { OnlineItemDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport type { skribblLobby } from \"@/util/skribbl/lobby\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { calculateLobbyKey } from \"@/util/typo/lobbyKey\";\nimport {\n  BehaviorSubject,\n  combineLatestWith, distinctUntilChanged, filter, firstValueFrom, pairwise,\n  startWith,\n  Subject,\n  type Subscription, withLatestFrom,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport PanelFilters from \"./panel-filters.svelte\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport FilterForm from \"./filter-form.svelte\";\nimport FilterSearch from \"./filter-search.svelte\";\n\nexport interface lobbyFilter extends serializableObject {\n  name: string;\n  createdAt: number;\n\n  minAmountPlayers?: number;\n  maxAmountPlayers?: number;\n  minAverageScore?: number;\n  maxAverageScore?: number;\n  minRound?: number;\n  maxRound?: number;\n  containsUsernames?: string[];\n  containsTypoPlayers?: boolean;\n}\n\nexport class PanelFiltersFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(LobbyItemsService) private readonly _lobbyItemsService!: LobbyItemsService;\n\n  public readonly name = \"Lobby Filters\";\n  public readonly description = \"Lets you create custom filters for a quick lobby search\";\n  public readonly featureId = 5;\n\n  private _component?: PanelFilters;\n  private _savedFiltersSetting = new ExtensionSetting<lobbyFilter[]>(\"saved_filters\", [], this);\n  private _selectedFiltersSetting = new ExtensionSetting<number[]>(\"selected_filters\", [], this);\n  private _currentSearch = new Subject<lobbyFilter[] | null>();\n  private _overrideSearch = new Subject<null | string | undefined>();\n  private _visitedLobbies = new BehaviorSubject<skribblLobby[]>([]);\n  private _searchSubscription?: Subscription;\n\n  protected override async onActivate() {\n    const elements = await this._elements.complete();\n    this._component = new PanelFilters({\n      target: elements.filterTab,\n      props: {\n        feature: this\n      }\n    });\n    \n    this._searchSubscription = this._currentSearch.pipe(\n      startWith(null),\n      distinctUntilChanged(),\n      combineLatestWith(this._lobbyService.lobby$),\n      pairwise(),\n      withLatestFrom(this._overrideSearch.pipe(startWith(undefined))),\n    ).subscribe(([[ [previousFilter, previousLobby], [currentFilter, currentLobby] ], override]) =>\n      this.handleSearchChange(previousFilter, previousLobby, currentFilter, currentLobby, override));\n  }\n\n  protected override onDestroy(): void {\n    this._component?.$destroy();\n    this._searchSubscription?.unsubscribe();\n    this._visitedLobbies.next([]);\n  }\n\n  get savedFiltersStore() {\n    return this._savedFiltersSetting.store;\n  }\n\n  get selectedFiltersStore() {\n    return this._selectedFiltersSetting.store;\n  }\n\n  get visitedLobbiesStore() {\n    return fromObservable(this._visitedLobbies, []);\n  }\n\n  /**\n   * Handle update of filters and current lobby,\n   * proceeds with joining/leaving if filters match\n   *\n   * Processes an override signal to abort or join other lobby\n   *\n   * @param previousFilter\n   * @param previousLobby\n   * @param currentFilter\n   * @param currentLobby\n   * @param override\n   * @private\n   */\n  private async handleSearchChange(\n    previousFilter: lobbyFilter[] | null,\n    previousLobby: skribblLobby | null,\n    currentFilter: lobbyFilter[] | null,\n    currentLobby: skribblLobby | null,\n    override: null | string | undefined\n  ) {\n    this._logger.debug(\"Search changed\", previousFilter, previousLobby, currentFilter, currentLobby, override);\n    \n    /* if not joined a lobby */\n    if(!currentLobby) {\n\n      /* if override signal received */\n      if(override !== undefined) {\n\n        /* aborted; stop search */\n        if(override === null){\n          this._overrideSearch.next(undefined);\n          this._currentSearch.next(null);\n          return;\n        }\n\n        /* override has lobby join id */\n        else {\n          this._overrideSearch.next(undefined);\n          this._currentSearch.next(null);\n          await this._lobbyService.joinLobby(override);\n          return;\n        }\n      }\n      \n      /* if filter has just been set (search started) */\n      if(previousFilter === null && currentFilter !== null) {\n        this._logger.info(\"Starting search\");\n        await this._lobbyService.joinLobby();\n        await this.promptFilterSearch(currentFilter);\n      }\n\n      /* if search is running, join next lobby */\n      if(currentFilter !== null) {\n        this._logger.info(\"Joining next lobby\");\n        await this._lobbyService.joinLobby();\n      }\n    }\n    \n    /* if joined a lobby */\n    else {\n\n      /* if search is running regular, check filters */\n      if(currentFilter !== null){\n\n        /* update visited lobbies */\n        this._visitedLobbies.next([currentLobby, ...this._visitedLobbies.value.filter(lobby => lobby.id !== currentLobby.id)]);\n\n        /* if lobby does not match previous filters, leave */\n        const items = await firstValueFrom(this._lobbyItemsService.onlineItems$);\n        if(!currentFilter.some(filter => this.checkLobbyFilterMatch(filter, currentLobby, items))) {\n          this._logger.info(\"Lobby does not match filter, leaving\");\n          this._lobbyService.leaveLobby();\n        }\n\n        /* lobby found*/\n        else {\n          this._logger.info(\"Lobby found\");\n          this._currentSearch.next(null);\n        }\n      }\n    }\n\n    /* reset visited lobbies when no filter set */\n    if(currentFilter === null) {\n      this._visitedLobbies.next([]);\n    }\n  }\n\n  /**\n   * Check if a lobby matches a filter\n   * @param filter\n   * @param lobby\n   * @param items\n   * @private\n   */\n  private checkLobbyFilterMatch(filter: lobbyFilter, lobby: skribblLobby, items: OnlineItemDto[]) {\n    this._logger.info(\"Checking lobby filter match\", filter, lobby);\n\n    if(filter.minAmountPlayers !== undefined && lobby.players.length < filter.minAmountPlayers) return false;\n    if(filter.maxAmountPlayers !== undefined && lobby.players.length > filter.maxAmountPlayers) return false;\n\n    const averageScore = lobby.players.map(p => p.score).reduce((a, b) => a + b, 0) / lobby.players.length;\n    if(filter.minAverageScore !== undefined && averageScore < filter.minAverageScore) return false;\n    if(filter.maxAverageScore !== undefined && averageScore > filter.maxAverageScore) return false;\n\n    if(filter.minRound !== undefined && lobby.round < filter.minRound) return false;\n    if(filter.maxRound !== undefined && lobby.round > filter.maxRound) return false;\n\n    if(filter.containsUsernames && filter.containsUsernames.length) {\n      const usernames = lobby.players.map(p => p.name);\n      if(!filter.containsUsernames.some(name => usernames.includes(name))) return false;\n    }\n\n    if(filter.containsTypoPlayers === true) {\n      const lobbyKey = calculateLobbyKey(lobby.id ?? \"\");\n      return items.some(item => item.lobbyKey === lobbyKey);\n    }\n\n    return true;\n  }\n\n  public async startSearch() {\n\n    let filters = await this._savedFiltersSetting.getValue();\n    const selectedFilters = await this._selectedFiltersSetting.getValue();\n    filters = filters.filter(filter => selectedFilters.includes(filter.createdAt));\n\n    if(filters.length === 0) {\n      await this._toastService.showToast(\"No filters selected\", \"Select search filters from the list above\\n or create a new filter\");\n      return;\n    }\n\n    this._logger.debug(\"Starting search\", filters);\n    this._currentSearch.next(filters);\n  }\n\n  /**\n   * Opens a prompt which indicates that the search is currently in progress.\n   * If the user submits/closes, the search is aborted\n   * If a search filter is removed while the prompt is open, the prompt is closed\n   */\n  private async promptFilterSearch(filters: lobbyFilter[]) {\n    let finishSubscription: Subscription | undefined;\n\n    const formComponent: componentDataFactory<FilterSearch, null | string> = {\n      componentType: FilterSearch,\n      propsFactory: (submit) => {\n\n        /* automatically submit after lobby filter removed */\n        finishSubscription = this._currentSearch.pipe(\n          filter(filters => filters === null),\n        ).subscribe(() => submit(null)); /* submit null as indicator for no user interaction, singnalizes search finished */\n\n        return {\n          feature: this,\n          filters,\n          lobbySelected: (id: string) => submit(id), /* submit lobby id as search override  */\n        };\n      }\n    };\n\n    const result = await this._modalService.showPrompt(\n      formComponent.componentType,\n      formComponent.propsFactory,\n      \"Lobby Search\",\n      \"card\"\n    );\n\n    finishSubscription?.unsubscribe();\n\n    /* prompt has been dismissed, submit as override abort */\n    if(result === undefined){\n      await this._toastService.showToast(\"Search aborted\");\n      this._overrideSearch.next(null);\n    }\n\n    /* user chose lobby in prompt, submit as override id */\n    if(typeof result === \"string\"){\n      await this._toastService.showToast(\"Lobby selected\", `Joining lobby ${result}`);\n      this._overrideSearch.next(result);\n    }\n\n    /* search found lobby */\n    if(result === null){\n      await this._toastService.showToast(\"Search finished\");\n    }\n  }\n\n  /**\n   * Prompt the user to create a new filter\n   */\n  public async promptFilterCreation() {\n    const formComponent: componentDataFactory<FilterForm, lobbyFilter> = {\n      componentType: FilterForm,\n      propsFactory: submit => ({\n        feature: this,\n        onCreate: submit.bind(this)\n      }),\n      validate: filter => this.validateFilter(filter)\n    };\n\n    const result = this._modalService.showPrompt(\n      formComponent.componentType,\n      formComponent.propsFactory,\n      \"Add Lobby Filter\",\n      \"card\",\n      formComponent.validate\n    );\n\n    return await result;\n  }\n\n  /**\n   * Remove a filter from the saved filters\n   * @param filter\n   */\n  public async removeFilter(filter: lobbyFilter) {\n    this._logger.debug(\"Removing filter\", filter);\n\n    const toast = await this._toastService.showLoadingToast(\"Removing filter\");\n    try {\n      let filters = await this._savedFiltersSetting.getValue();\n      filters = filters.filter(f => f.createdAt !== filter.createdAt);\n      await this._savedFiltersSetting.setValue(filters);\n\n      const activeFilters = await this._selectedFiltersSetting.getValue();\n      await this._selectedFiltersSetting.setValue(activeFilters.filter(id => id !== filter.createdAt));\n\n      toast.resolve(`Filter \"${filter.name}\" removed`);\n    }\n    catch(e){\n      this._logger.error(\"Failed to remove filter\", e);\n      toast.reject(\"Failed to remove filter\");\n    }\n  }\n\n  /**\n   * Add a filter to the saved filters\n   * @param filter\n   */\n  public async addFilter(filter: lobbyFilter) {\n    this._logger.debug(\"Adding filter\", filter);\n\n    const toast = await this._toastService.showLoadingToast(\"Adding filter\");\n    try {\n      let filters = await this._savedFiltersSetting.getValue();\n      filters = [filter, ...filters];\n      await this._savedFiltersSetting.setValue(filters);\n\n      const activeFilters = await this._selectedFiltersSetting.getValue();\n      await this._selectedFiltersSetting.setValue([filter.createdAt, ...activeFilters]);\n\n      toast.resolve(`Filter \"${filter.name}\" added`);\n    }\n    catch(e){\n      this._logger.error(\"Failed to add filter\", e);\n      toast.reject(\"Failed to add filter\");\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Validate a filter and show toasts if errors found\n   * @param filter\n   */\n  public async validateFilter(filter: lobbyFilter) {\n    this._logger.debug(\"Validating filter\", filter);\n\n    /*validate name*/\n    filter.name = filter.name.trim();\n    if(filter.name.length === 0){\n      await this._toastService.showToast(\"Invalid Filter\", \"Filter name cannot be empty\");\n      return false;\n    }\n\n    /* sanitize properties */\n    if(filter.containsUsernames?.length === 0) filter.containsUsernames = undefined;\n    if(filter.minRound !== undefined && filter.minRound <= 0) filter.minRound = undefined;\n    if(filter.maxRound !== undefined && filter.maxRound <= 0) filter.maxRound = undefined;\n    if(filter.minAmountPlayers !== undefined && filter.minAmountPlayers <= 0) filter.minAmountPlayers = undefined;\n    if(filter.maxAmountPlayers !== undefined && filter.maxAmountPlayers <= 0) filter.maxAmountPlayers = undefined;\n    if(filter.minAverageScore !== undefined && filter.minAverageScore <= 0) filter.minAverageScore = undefined;\n    if(filter.maxAverageScore !== undefined && filter.maxAverageScore <= 0) filter.maxAverageScore = undefined;\n\n    /* validate score */\n    if(filter.minAverageScore !== undefined && filter.maxAverageScore !== undefined && filter.minAverageScore > filter.maxAverageScore){\n      await this._toastService.showToast(\"Invalid Filter\", \"Minimum average score cannot be higher than maximum average score\");\n      return false;\n    }\n\n    /* validate round */\n    if(filter.minRound !== undefined && filter.maxRound !== undefined && filter.minRound > filter.maxRound){\n      await this._toastService.showToast(\"Invalid Filter\", \"Minimum round cannot be higher than maximum round\");\n      return false;\n    }\n\n    /* validate players */\n    if(filter.minAmountPlayers !== undefined && filter.maxAmountPlayers !== undefined && filter.minAmountPlayers > filter.maxAmountPlayers){\n      await this._toastService.showToast(\"Invalid Filter\", \"Minimum amount of players cannot be higher than maximum amount of players\");\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Build tooltip text for a filter\n   * @param filter\n   */\n  public buildFilterTooltipText(filter: lobbyFilter) {\n    let desc = \"\";\n\n    if(filter.minAmountPlayers != undefined || filter.maxAmountPlayers !== undefined) {\n      desc +=`\\n👤 ${filter.minAmountPlayers ?? \"x\"} - ${filter.maxAmountPlayers ?? \"x\"} players`;\n    }\n\n    if(filter.minAverageScore != undefined || filter.maxAverageScore !== undefined) {\n      desc +=`\\n🏆 ${filter.minAverageScore ?? \"x\"} - ${filter.maxAverageScore ?? \"x\"} average score`;\n    }\n\n    if(filter.minRound != undefined || filter.maxRound !== undefined) {\n      desc +=`\\n🔄 round ${filter.minRound ?? \"x\"} - ${filter.maxRound ?? \"x\"}`;\n    }\n\n    if(filter.containsUsernames?.length) {\n      desc +=`\\n🔎 ${filter.containsUsernames.join(\", \")}`;\n    }\n\n    if(filter.containsTypoPlayers) {\n      desc += \"\\n🤖 Typo players\";\n    }\n\n    return desc.length === 0 ? \"Empty filter :(\" : desc.trim();\n  }\n}","<script lang=\"ts\">\n  import { PanelLobbiesFeature } from \"./panel-lobbies.feature\";\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n  export let feature: PanelLobbiesFeature;\n\n  const lobbies = feature.lobbiesStore;\n  const showDiscovered = feature.showDiscoveredLobbiesStore;\n  const discoveredLobbies = feature.discoveredLobbiesStore;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-lobbies-discord {\n    display: flex;\n    flex-direction: column;\n    gap: .5rem;\n    padding-bottom: 1rem;\n    padding-right: .5rem;\n\n    .typo-lobbies-discord-buttons {\n      display: flex;\n      flex-wrap: wrap;\n      gap: .5rem;\n    }\n  }\n\n  .typo-lobbies-discovered {\n    padding-top: 1rem;\n    display: flex;\n    flex-direction: column;\n    gap: .5rem;\n    padding-right: .5rem;\n    border-top: 1px solid var(--COLOR_PANEL_BORDER_FOCUS);\n\n    .typo-lobbies-discovered-buttons {\n      display: flex;\n      flex-direction: column-reverse;\n      gap: .5rem;\n\n      > div {\n        display: grid;\n        grid-template-columns: auto auto;\n        grid-template-rows: 1fr 1fr;\n        gap: 1rem;\n        row-gap: 0;\n        place-items: center;\n        background-color: var(--COLOR_PANEL_BG);\n        padding: .2rem;\n        border-radius: 3px;\n        font-size: .9rem;\n        cursor: pointer;\n        user-select: none;\n\n        b {\n          opacity: .7;\n          justify-self: baseline;\n        }\n\n        span {\n          grid-column: 2/2;\n          grid-row: 1/3;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div>\n\n  <div class=\"typo-lobbies-discord\">\n    <b>Online Friends</b>\n\n    {#if $lobbies === null}\n      <span>You need to log in to see lobbies of your discord friends.<br></span>\n    {:else if $lobbies === undefined}\n      <Bounceload content=\"Loading connected servers..\"/>\n    {:else}\n      <div class=\"typo-lobbies-discord-buttons\">\n        {#each $lobbies as lobby}\n          <div use:feature.createTooltip={{title: feature.buildButtonTooltip(lobby), lock: \"Y\"}}>\n            <FlatButton content=\"{lobby.userName}\" color=\"{lobby.private ? 'green' : 'blue'}\" on:click={() => feature.joinLobby(lobby.lobbyId, lobby.userName)}  />\n          </div>\n        {/each}\n\n        {#if $lobbies.length === 0}\n          <span>None of your friends are online.</span>\n        {/if}\n      </div>\n    {/if}\n  </div>\n\n  {#if $showDiscovered}\n    <div class=\"typo-lobbies-discovered\">\n      <b>Discovered Lobbies</b>\n\n      {#if $discoveredLobbies.length === 0}\n        <div>Join a lobby to see it here afterwards.</div>\n      {/if}\n\n      <div class=\"typo-lobbies-discovered-buttons\">\n        {#each $discoveredLobbies as lobby}\n          <div style=\"order: {lobby.seenAt % 100000000}\" on:click={() => feature.joinLobby(lobby.id ?? \"\")}>\n            <b>{new Date(Number(lobby.seenAt)).toLocaleTimeString()}</b>\n            <span>{lobby.players.map(p => p.name).join(\", \")}</span>\n          </div>\n        {/each}\n      </div>\n    </div>\n  {/if}\n</div>","import type { MemberDto } from \"@/api\";\nimport { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { SocketService } from \"@/content/services/socket/socket.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport type { GuildLobbiesUpdatedDto, GuildLobbyDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport type { HubConnection } from \"@microsoft/signalr\";\nimport { inject } from \"inversify\";\nimport { BehaviorSubject, map, type Subscription, tap } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport PanelLobbies from \"./panel-lobbies.svelte\";\n\nexport class PanelLobbiesFeature extends TypoFeature {\n  \n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(SocketService) private readonly _socketService!: SocketService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  private _showDiscoveredLobbiesSetting = this.useSetting(\n    new BooleanExtensionSetting(\"show_discovered\", true, this)\n      .withName(\"Show discovered lobbies\")\n      .withDescription(\"Shows a list of lobbies that you were in before\")\n  );\n  \n  private _lobbies$ = new BehaviorSubject<Map<string, GuildLobbyDto[]> | null | undefined>(undefined);\n  private _component?: PanelLobbies;\n  private _connection?: HubConnection;\n  private _memberSubscription?: Subscription;\n\n  public readonly name = \"Lobby List\";\n  public readonly description =\n    \"Displays online players from your connected discord servers on the start page\";\n  public readonly featureId = 6;\n\n  protected override async onActivate() {\n    const elements = await this._elements.complete();\n    this._component = new PanelLobbies({\n      target: elements.lobbiesTab,\n      props: {\n        feature: this,\n      },\n    });\n\n    this._memberSubscription = this._memberService.member$.subscribe(member => this.processMemberChange(member));\n  }\n\n  protected override onDestroy(): void {\n    this._component?.$destroy();\n    this._connection?.stop();\n    this._memberSubscription?.unsubscribe();\n    this._memberSubscription = undefined;\n  }\n\n  public get lobbiesStore(){\n    return fromObservable(this._lobbies$.pipe(\n      map(lobbies => lobbies === null || lobbies === undefined ? lobbies : this.mapLobbiesToPlayerList(lobbies)),\n      tap(lobbies => this._logger.info(\"Lobbies updated\", lobbies))\n    ), []);\n  }\n\n  public get discoveredLobbiesStore(){\n    return fromObservable(this._lobbyService.discoveredLobbies$, []);\n  }\n\n  public get showDiscoveredLobbiesStore(){\n    return this._showDiscoveredLobbiesSetting.store;\n  }\n\n  /**\n   * Subscribe to guild lobbies of a member\n   * @param member\n   * @private\n   */\n  private async processMemberChange(member: MemberDto | null | undefined){\n    this._logger.debug(\"Member changed\", member);\n\n    /*stop existing connection*/\n    this._connection?.stop();\n\n    /* if no member logged in, exit setup */\n    if(member === null || member === undefined){\n      this._lobbies$.next(member);\n      return;\n    }\n\n    /* init with empty map */\n    this._lobbies$.next(new Map());\n\n    /* connect to server */\n    const {connection, hubProxy} = await this.setupConnection();\n    this._connection = connection;\n\n    /* subscribe to all guilds of the member */\n    const promises = member.guilds.map(async guild => {\n      const currentLobbies = await hubProxy.subscribeGuildLobbies(guild.guildID);\n\n      /* set initial guild lobbies */\n      await this.onGuildLobbiesUpdated(currentLobbies);\n    });\n    await Promise.all(promises);\n  }\n\n  /**\n   * Connect to the guild lobby hub to receive updates\n   * @private\n   */\n  private async setupConnection(){\n    const connection = this._socketService.createConnection(\"IGuildLobbiesHub\");\n    const hubProxy = this._socketService.createHub(\"IGuildLobbiesHub\").createHubProxy(connection);\n    this._socketService.createReceiver(\"IGuildLobbiesReceiver\").register(connection, {\n      guildLobbiesUpdated: this.onGuildLobbiesUpdated.bind(this)\n    });\n    await connection.start();\n    return { connection, hubProxy };\n  }\n  \n  private async onGuildLobbiesUpdated(lobbies: GuildLobbiesUpdatedDto){\n    this._logger.info(\"Received guild lobbies for guild\", lobbies.guildId);\n\n    const lastValue = this._lobbies$.value;\n    if(lastValue === null || lastValue === undefined){\n      this._logger.warn(\"Received guild lobbies but lobbies are not initialized yet\", lobbies);\n      return;\n    }\n\n    /* no issue with concurrency because reference and distinct write index */\n    lastValue.set(lobbies.guildId, lobbies.lobbies);\n    this._lobbies$.next(lastValue);\n  }\n\n  private mapLobbiesToPlayerList(lobbies: Map<string, GuildLobbyDto[]>){\n    const distinct: GuildLobbyDto[] = [];\n    const list = Array.from(lobbies.values()).flat();\n\n    list.forEach(lobby => {\n      if(!distinct.some(l => l.lobbyId === lobby.lobbyId && l.userName === lobby.userName)){\n        distinct.push(lobby);\n      }\n    });\n\n    return distinct;\n  }\n\n  public buildButtonTooltip(lobby: GuildLobbyDto){\n    return `🔑  ${lobby.private ? \"Custom\" : \"Public\"}\\n👥 ${lobby.currentPlayers} Players\\n🏳️ ${lobby.language}`;\n  }\n\n  public async joinLobby(id: string, targetName?: string){\n    await this._lobbyService.joinLobby(id);\n    await this._toastService.showToast(targetName ? `Joined the lobby of ${targetName}` : \"Joined discovered lobby\");\n  }\n}","export interface anonymousPlayerIdentification { lobbyKey: string, lobbyPlayerId: number }\nexport interface concretePlayerIdentification { login: number }\nexport type typoPlayerIdentification = anonymousPlayerIdentification | concretePlayerIdentification;\n\nexport const isAnonymousPlayerIdentification = (value: object): value is anonymousPlayerIdentification => {\n  return (value as anonymousPlayerIdentification).lobbyKey !== undefined && (value as anonymousPlayerIdentification).lobbyPlayerId !== undefined;\n};\n\nexport const isConcretePlayerIdentification = (value: object): value is concretePlayerIdentification => {\n  return (value as concretePlayerIdentification).login !== undefined;\n};\n\n/**\n * An interface for player container abstraction\n * Player containers consist of various elements, representing a player and its avatar\n * Implementations provide concrete access to manipulate these elements uniformly\n */\nexport interface SkribblPlayerDisplay {\n\n  /**\n   * Destroy the player display and clean up styles\n   */\n  destroy(): void;\n\n  get typoId(): typoPlayerIdentification;\n\n  /**\n   * Dedicated container for the player's avatar\n   */\n  get avatarContainer(): HTMLElement;\n\n  /**\n   * Dedicated container for the player's background\n   */\n  get backgroundContainer(): HTMLElement;\n\n  /**\n   * The container that holds the player's elements\n   */\n  get container(): HTMLElement;\n\n  /**\n   * Container where icons of the player are displayed\n   */\n  get iconsContainer(): HTMLElement | null;\n\n  /**\n   * Set the background of the player's background container\n   * @param value\n   */\n  set useBackground(value: boolean);\n\n  /**\n   * Enable a background-safe font color for the player's elements (eg on scenes)\n   * @param value\n   */\n  set useSafeColor(value: boolean);\n\n  /**\n   * Modify the container to fit a modified avatar size (eg sprites)\n   * @param value\n   */\n  set adjustToContainSprites(value: boolean);\n\n  /**\n   * Toggle the visibility of the lobby player Id\n   * @param value\n   */\n  set viewPlayerId(value: boolean);\n\n  /**\n   * Hide the skribbl vanilla avatar (skin, mouth, eyes)\n   * @param value\n   */\n  set hideAvatar(value: boolean);\n}","/* THIS (.ts) FILE IS GENERATED BY Tapper */\n/* eslint-disable */\n/* tslint:disable */\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.AwardGiftDto */\nexport type AwardGiftDto = {\n    /** Transpiled from int */\n    awardInventoryId: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.AwardGiftedDto */\nexport type AwardGiftedDto = {\n    /** Transpiled from int */\n    receiverLobbyPlayerId: number;\n    /** Transpiled from int */\n    awarderLobbyPlayerId: number;\n    /** Transpiled from int */\n    awardInventoryId: number;\n    /** Transpiled from int */\n    awardId: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.DropAnnouncementDto */\nexport type DropAnnouncementDto = {\n    /** Transpiled from string */\n    dropToken: string;\n    /** Transpiled from long */\n    dropId: number;\n    /** Transpiled from int */\n    eventDropId?: number;\n    /** Transpiled from int */\n    position: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.DropClaimDto */\nexport type DropClaimDto = {\n    /** Transpiled from string */\n    dropToken: string;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.DropClaimResultDto */\nexport type DropClaimResultDto = {\n    /** Transpiled from string */\n    username: string;\n    /** Transpiled from bool */\n    firstClaim: boolean;\n    /** Transpiled from bool */\n    clearedDrop: boolean;\n    /** Transpiled from int */\n    catchTime: number;\n    /** Transpiled from double */\n    leagueWeight: number;\n    /** Transpiled from long */\n    dropId: number;\n    /** Transpiled from bool */\n    leagueMode: boolean;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.DropClearDto */\nexport type DropClearDto = {\n    /** Transpiled from long */\n    dropId: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.GuildLobbiesUpdatedDto */\nexport type GuildLobbiesUpdatedDto = {\n    /** Transpiled from string */\n    guildId: string;\n    /** Transpiled from System.Collections.Generic.List<tobeh.Avallone.Server.Classes.Dto.GuildLobbyDto> */\n    lobbies: GuildLobbyDto[];\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.GuildLobbyDto */\nexport type GuildLobbyDto = {\n    /** Transpiled from string */\n    userName: string;\n    /** Transpiled from int */\n    currentPlayers: number;\n    /** Transpiled from string */\n    language: string;\n    /** Transpiled from string */\n    lobbyId: string;\n    /** Transpiled from bool */\n    private: boolean;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.LobbyDiscoveredDto */\nexport type LobbyDiscoveredDto = {\n    /** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbyStateDto */\n    lobby: SkribblLobbyStateDto;\n    /** Transpiled from string? */\n    ownerClaimToken?: string;\n    /** Transpiled from int */\n    playerId: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.TypoLobbySettingsDto */\nexport type TypoLobbySettingsDto = {\n    /** Transpiled from string */\n    description: string;\n    /** Transpiled from bool */\n    whitelistAllowedServers: boolean;\n    /** Transpiled from System.Collections.Generic.List<string> */\n    allowedServers: string[];\n    /** Transpiled from long */\n    lobbyOwnershipClaim?: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.TypoLobbyStateDto */\nexport type TypoLobbyStateDto = {\n    /** Transpiled from bool */\n    playerIsOwner: boolean;\n    /** Transpiled from string */\n    ownershipClaimToken: string;\n    /** Transpiled from string */\n    lobbyId: string;\n    /** Transpiled from long */\n    ownershipClaim: number;\n    /** Transpiled from tobeh.Avallone.Server.Classes.Dto.TypoLobbySettingsDto */\n    lobbySettings: TypoLobbySettingsDto;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbyPlayerDto */\nexport type SkribblLobbyPlayerDto = {\n    /** Transpiled from string */\n    name: string;\n    /** Transpiled from int */\n    playerId: number;\n    /** Transpiled from int */\n    score: number;\n    /** Transpiled from bool */\n    isDrawing: boolean;\n    /** Transpiled from bool */\n    hasGuessed: boolean;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbySettingsDto */\nexport type SkribblLobbySettingsDto = {\n    /** Transpiled from string */\n    language: string;\n    /** Transpiled from int */\n    players: number;\n    /** Transpiled from int */\n    drawTime: number;\n    /** Transpiled from int */\n    rounds: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbyStateDto */\nexport type SkribblLobbyStateDto = {\n    /** Transpiled from string */\n    link: string;\n    /** Transpiled from int */\n    ownerId?: number;\n    /** Transpiled from int */\n    round: number;\n    /** Transpiled from System.Collections.Generic.List<tobeh.Avallone.Server.Classes.Dto.SkribblLobbyPlayerDto> */\n    players: SkribblLobbyPlayerDto[];\n    /** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbySettingsDto */\n    settings: SkribblLobbySettingsDto;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.LobbyStateDto */\nexport type LobbyStateDto = {\n    /** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbyStateDto */\n    skribblState: SkribblLobbyStateDto;\n    /** Transpiled from tobeh.Avallone.Server.Classes.Dto.TypoLobbyStateDto */\n    typoState: TypoLobbyStateDto;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.MemberDto */\nexport type MemberDto = {\n    /** Transpiled from string */\n    username: string;\n    /** Transpiled from int */\n    login: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.OnlineItemsUpdatedDto */\nexport type OnlineItemsUpdatedDto = {\n    /** Transpiled from System.Collections.Generic.List<tobeh.Avallone.Server.Classes.Dto.OnlineItemDto> */\n    items: OnlineItemDto[];\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.OnlineItemDto */\nexport type OnlineItemDto = {\n    /** Transpiled from tobeh.Avallone.Server.Classes.Dto.OnlineItemTypeDto */\n    type: OnlineItemTypeDto;\n    /** Transpiled from int */\n    slot: number;\n    /** Transpiled from int */\n    itemId: number;\n    /** Transpiled from string */\n    lobbyKey: string;\n    /** Transpiled from int */\n    lobbyPlayerId: number;\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.OnlineItemTypeDto */\nexport enum OnlineItemTypeDto {\n    Award = 3,\n    Sprite = 0,\n    SpriteShift = 1,\n    Scene = 2,\n    SceneTheme = 6,\n    Rewardee = 5,\n}\n\n/** Transpiled from tobeh.Avallone.Server.Classes.Dto.SkribblLobbyTypoSettingsUpdateDto */\nexport type SkribblLobbyTypoSettingsUpdateDto = {\n    /** Transpiled from bool */\n    whitelistAllowedServers: boolean;\n    /** Transpiled from System.Collections.Generic.List<string> */\n    allowedServers: string[];\n    /** Transpiled from string */\n    description: string;\n}\n\n","<script lang=\"ts\">\n  import type { AwardDto } from \"@/api\";\n  import type { SkribblPlayerDisplay } from \"@/content/services/players/skribblPlayerDisplay.interface\";\n\n  export let playerDisplay: SkribblPlayerDisplay;\n  export let awards: AwardDto[];\n\n  export const getAwards = () => {\n    return awards;\n  }\n</script>\n\n<style>\n  :global(#game-players .player .player-icons) .typo-awards-icon {\n      height: 20px;\n      width: 20px;\n      align-self: flex-end;\n  }\n</style>\n\n{#each awards as award}\n  <div class=\"icon visible typo-awards-icon\" style=\"background-image: url({award.url})\" > </div>\n{/each}","<script lang=\"ts\">\n\n  import type { AwardDto } from \"@/api\";\n  import type { PlayerAwardsFeature } from \"@/content/features/player-awards/player-awards-feature\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\n  export let feature: PlayerAwardsFeature;\n  export let currentAwardPresentation: AwardDto | undefined = undefined;\n\n  const member = feature.memberStore;\n  const awardable = feature.playerAwardableStore;\n\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes award-presentation {\n    0% {\n      opacity: 0;\n      background-size: 100%;\n    }\n\n    25% {\n      opacity: 1;\n      background-size: 30px;\n    }\n\n    50% {\n      opacity: 1;\n      background-size: 48px;\n    }\n\n    100% {\n      opacity: 0;\n      background-size: 48px;\n    }\n  }\n\n  .typo-awards-icon {\n    position: absolute;\n    top: 60px;\n    right: 4px;\n  }\n\n  .typo-awards-presentation {\n    position: absolute;\n    inset: 0;\n    background-position: center;\n    background-repeat: no-repeat;\n    pointer-events: none;\n    animation: award-presentation 3s ease-out forwards;\n  }\n\n</style>\n\n{#if $member !== undefined && $member !== null && $awardable}\n\n  <div class=\"typo-awards-icon\">\n    <IconButton\n      hoverMove=\"{false}\"\n      size=\"48px\"\n      name=\"Award this drawing\"\n      tooltipAction=\"{feature.createTooltip}\"\n      icon=\"file-img-award-gif\"\n      on:click={async () => {\n        const award = await feature.promptAwardSelection($member);\n        if(award !== undefined && award.inventoryIds.length > 0) {\n          await feature.giveAward(award.inventoryIds[0]);\n        }\n      }}\n    />\n  </div>\n\n{/if}\n\n{#if currentAwardPresentation !== undefined}\n  {#key currentAwardPresentation}\n    <div class=\"typo-awards-presentation\" style=\"background-image: url({currentAwardPresentation.url})\"></div>\n  {/key}\n{/if}","<script lang=\"ts\">\n\n  import type { AwardInventoryDto, SpriteDto, SpriteInventoryDto } from \"@/api\";\n  import type { PanelCabinFeature } from \"@/content/features/panel-cabin/panel-cabin.feature\";\n  import type { PlayerAwardsFeature } from \"@/content/features/player-awards/player-awards-feature\";\n\n  export let onPick: (sprite: AwardInventoryDto) => void;\n  export let awards: AwardInventoryDto[];\n\n  const getAwardRarityName = (rarity: number) => {\n    switch (rarity) {\n      case 0:\n        return \"Common\";\n      case 1:\n        return \"Special\";\n      case 2:\n        return \"Epic\";\n      default:\n        return \"Legendary\";\n    }\n  }\n\n</script>\n\n<style lang=\"scss\">\n\n  .typo-award-picker {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n    align-items: center;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    overflow: auto;\n\n    .typo-award-picker-list {\n      flex-grow: 1;\n      width: 100%;\n      overflow: auto;\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(6rem, 1fr));\n      gap: 1rem;\n      padding: 0 2rem;\n\n      .typo-award-picker-award {\n        background-color: var(--COLOR_PANEL_BG);\n        border-radius: 5px;\n        display: flex;\n        flex-direction: column;\n        gap: .1rem;\n        padding: .1rem;\n        align-items: center;\n        cursor: pointer;\n        transition: transform .1s;\n\n        &:hover {\n          transform: scale(0.9);\n        }\n\n        .typo-award-picker-award-thumb{\n          width: 4rem;\n          aspect-ratio: 1;\n          background-size: cover;\n        }\n\n        span {\n          font-size: .9rem;\n          opacity: .9;\n          text-align: center;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-award-picker\">\n\n  <span>\n    Choose an award from your inventory to award the current drawing.\n  </span>\n\n  <div class=\"typo-award-picker-list color-scrollbar\">\n\n    {#each awards as award}\n\n      <div class=\"typo-award-picker-award\" on:click={() => onPick(award)} style=\"order: {award.award.id}\">\n        <div class=\"typo-award-picker-award-thumb\"\n             style=\"background-image: url({award.award.url})\"></div>\n        <span><b>{award.award.name}</b></span>\n        <span>{getAwardRarityName(award.award.rarity)}</span>\n        <span>x{award.inventoryIds.length}</span>\n      </div>\n\n    {/each}\n\n  </div>\n\n</div>","import { type AwardDto, type AwardInventoryDto, InventoryApi, type MemberDto } from \"@/api\";\nimport { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { LobbyLeftEventListener } from \"@/content/events/lobby-left.event\";\nimport { CloudService } from \"@/content/features/controls-cloud/cloud.service\";\nimport { LobbyConnectionService } from \"@/content/features/lobby-status/lobby-connection.service\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { ChatService } from \"@/content/services/chat/chat.service\";\nimport { LobbyItemsService } from \"@/content/services/lobby-items/lobby-items.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { type componentDataFactory, ModalService } from \"@/content/services/modal/modal.service\";\nimport { PlayersService } from \"@/content/services/players/players.service\";\nimport {\n  type anonymousPlayerIdentification,\n  isAnonymousPlayerIdentification,\n  type SkribblPlayerDisplay,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { type OnlineItemDto, OnlineItemTypeDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { calculateLobbyKey } from \"@/util/typo/lobbyKey\";\nimport { inject } from \"inversify\";\nimport { combineLatestWith, map, type Subscription, withLatestFrom } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport AwardsDisplay from \"./awards-display.svelte\";\nimport AwardsComponent from \"./player-awards.svelte\";\nimport AwardPicker from \"./player-awards-award-picker.svelte\";\n\nexport class PlayerAwardsFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(LobbyConnectionService) private readonly _lobbyConnectionService!: LobbyConnectionService;\n  @inject(ChatService) private readonly _chatService!: ChatService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(LobbyItemsService) private readonly _lobbyItemsService!: LobbyItemsService;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(PlayersService) private readonly _lobbyPlayersService!: PlayersService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(ApiService) private readonly _apiService!: ApiService;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(CloudService) private readonly _cloudService!: CloudService;\n  @inject(LobbyLeftEventListener) private readonly _lobbyLeftEventListener!: LobbyLeftEventListener;\n\n  public readonly name = \"Awards\";\n  public readonly description = \"Award drawings of other typo players with special awards\";\n  public readonly featureId = 41;\n\n  public override readonly toggleEnabled = false;\n\n  private _enableAwardAnimationSetting = this.useSetting(\n    new BooleanExtensionSetting(\"animation\", true, this)\n      .withName(\"Award Animation\")\n      .withDescription(\"Show an animation over the canvas when a player is awarded\"),\n  );\n\n  private _awardedSubscription?: Subscription;\n  private _lobbyItemsSubscription?: Subscription;\n  private _lobbyLeftSubscription?: Subscription;\n  private _awardsContainers = new Map<SkribblPlayerDisplay, AwardsDisplay>();\n  private _awardsComponent?: AwardsComponent;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n    const apiData = await this._apiDataSetup.complete();\n\n    /* component for picker and animation */\n    const component = this._awardsComponent = new AwardsComponent({\n      target: elements.canvasWrapper,\n      props: {\n        feature: this,\n        currentAwardPresentation: undefined as (AwardDto | undefined)\n      },\n    });\n\n    /* listen to lobby left and reset current award or pending awards */\n    this._lobbyLeftSubscription = this._lobbyLeftEventListener.events$.subscribe(() => {\n      this._cloudService.clearPendingAwardInventoryIds();\n      component.$set({ currentAwardPresentation: undefined });\n    });\n\n    /* listen to received awards, print message and show animation */\n    this._awardedSubscription = this._lobbyConnectionService.awardGifted$.pipe(\n      withLatestFrom(this._lobbyService.lobby$)\n    ).subscribe(([award, lobby]) => {\n      const awardDto = apiData.awards.find((a) => a.id === award.awardId);\n\n      const awarder = lobby?.players.find(p => p.id === award.awarderLobbyPlayerId)?.name ?? \"Unknown\";\n      const title = `${awarder} awarded this with a ${awardDto?.name ?? \"Award\"}!`;\n      const message = `\\n${awardDto?.description}`;\n      this._chatService.addChatMessage(message, title, \"info\");\n      component.$set({ currentAwardPresentation: structuredClone(awardDto) });\n      this._cloudService.addPendingAwardInventoryId(award.awardInventoryId);\n    });\n\n    /* update award icons */\n    this._lobbyItemsSubscription = this._lobbyItemsService.onlineItems$.pipe(\n      withLatestFrom(this._lobbyPlayersService.players$)\n    ).subscribe(([items, players]) => {\n      this.updatePlayerAwards(players, items, apiData.awards);\n    });\n  }\n\n  protected override async onDestroy(): Promise<void> {\n    this._awardsComponent?.$destroy();\n    this._awardedSubscription?.unsubscribe();\n    this._lobbyItemsSubscription?.unsubscribe();\n    this._lobbyLeftSubscription?.unsubscribe();\n    this._awardedSubscription = undefined;\n    this._lobbyItemsSubscription = undefined;\n    this._awardsComponent = undefined;\n    this._lobbyLeftSubscription = undefined;\n\n    this._cloudService.clearPendingAwardInventoryIds();\n\n    this._awardsContainers.forEach((container) => container.$destroy());\n    this._awardsContainers.clear();\n  }\n\n  public get memberStore() {\n    return fromObservable(this._memberService.member$, undefined);\n  }\n\n  /**\n   * A store that determines whether it is currently allowed to gift an award\n   */\n  public get playerAwardableStore() {\n    return fromObservable(\n      this._lobbyItemsService.onlineItems$.pipe(\n        combineLatestWith(this._lobbyService.lobby$),\n        map(([items, lobby]) => {\n          if (\n            lobby === null || lobby.id === null\n            || lobby.drawerId === undefined\n            || lobby.drawerId === lobby.meId\n          ) return false;\n\n          const lobbyKey = calculateLobbyKey(lobby.id);\n          const isAwardee = items.some(\n            (item) => item.lobbyKey === lobbyKey && item.lobbyPlayerId === lobby.drawerId,\n          );\n          return isAwardee;\n        }),\n      ),\n      false,\n    );\n  }\n\n  get awardsAnimationSettingStore(){\n    return this._enableAwardAnimationSetting.store;\n  }\n\n  /**\n   * Updates the player award icons according to onlineitems and playerdisplays\n   * @param players\n   * @param items\n   * @param awards\n   * @private\n   */\n  private async updatePlayerAwards(\n    players: SkribblPlayerDisplay[],\n    items: OnlineItemDto[],\n    awards: AwardDto[],\n  ) {\n    this._logger.debug(\"Updating player awards\", players);\n\n    /* remove player containers that are not present anymore */\n    for (const [playerDisplay, container] of this._awardsContainers) {\n      if (!players.includes(playerDisplay)) {\n        container.$destroy();\n        this._awardsContainers.delete(playerDisplay);\n      }\n    }\n\n    /* update all current player displays if changed, or add if not existing */\n    for (const player of players) {\n\n      /* update display without icons display */\n      const iconsDisplay = player.iconsContainer;\n      if(iconsDisplay === null) continue;\n\n      const identification = player.typoId;\n      let container = this._awardsContainers.get(player);\n\n      if (!container) {\n        container = new AwardsDisplay({\n          target: iconsDisplay,\n          props: {\n            awards: [],\n            playerDisplay: player,\n          },\n        });\n        this._awardsContainers.set(player, container);\n      }\n\n      let playerAwards: AwardDto[] = [];\n\n      /* get items for player */\n      if (isAnonymousPlayerIdentification(identification)) {\n        playerAwards = this.getAwardsForAnonymousPlayerDisplay(identification, items, awards);\n      } else if (!isAnonymousPlayerIdentification(identification)) {\n        playerAwards = [];\n      } else {\n        this._logger.warn(\"Unknown player identification\", identification);\n      }\n\n      const existingAwards = container.getAwards();\n      const awardsUpdated = playerAwards.length !== existingAwards.length || playerAwards.some((award, index) => existingAwards[index].id !== award.id);\n\n      if(awardsUpdated){\n        container.$set({ awards: playerAwards });\n      }\n    }\n  }\n\n  /**\n   * Get award dtos for player based on current online items\n   * @param identification\n   * @param items\n   * @param awards\n   * @private\n   */\n  private getAwardsForAnonymousPlayerDisplay(\n    identification: anonymousPlayerIdentification,\n    items: OnlineItemDto[],\n    awards: AwardDto[],\n  ) {\n    const playerItems = items.filter(\n      (item) =>\n        item.lobbyPlayerId === identification.lobbyPlayerId &&\n        item.lobbyKey === identification.lobbyKey,\n    );\n    const playerAwards = playerItems.filter((item) => item.type === OnlineItemTypeDto.Award);\n    return playerAwards\n      .map(awardItem => awards.find(award => awardItem.itemId === award.id))\n      .filter(award => award !== undefined\n    );\n  }\n\n  /**\n   * Open the award picker to select an award from  the current inventory\n   * @param member\n   */\n  public async promptAwardSelection(member: MemberDto): Promise<AwardInventoryDto | undefined> {\n    this._logger.debug(\"Opening award picker\");\n\n    const awardInventory = await this._apiService.getApi(InventoryApi).getMemberAvailableAwardInventory({login: Number(member.userLogin)});\n    const pickerComponent: componentDataFactory<AwardPicker, AwardInventoryDto> = {\n      componentType: AwardPicker,\n      propsFactory: submit => ({\n        awards: awardInventory,\n        onPick: submit.bind(this),\n      }),\n    };\n\n    const award = await this._modalService.showPrompt(\n      pickerComponent.componentType,\n      pickerComponent.propsFactory,\n      \"Award Picker\",\n      \"card\"\n    );\n\n    this._logger.debug(\"Award picker closed\", award);\n    return award;\n  }\n\n  /**\n   * Give an award to the current drawer\n   * @param inventoryId\n   */\n  public async giveAward(inventoryId: number){\n    this._logger.debug(\"Giving award to current drawer\", inventoryId);\n\n    try {\n      await this._lobbyConnectionService.connection.hub.giftAward({awardInventoryId: inventoryId});\n    }\n    catch(e){\n      this._logger.error(\"Failed to gift award\", e);\n      await this._toastService.showToast(\"Failed to gift award\");\n    }\n  }\n}","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { PlayersService } from \"@/content/services/players/players.service\";\nimport { take } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\n\nexport class PlayerIdsFeature extends TypoFeature {\n  @inject(PlayersService) private readonly _playersService!: PlayersService;\n\n  public readonly name = \"Player IDs\";\n  public readonly description = \"Show player IDs in the lobby to execute commands like kick\";\n  public readonly featureId = 29;\n\n  private readonly _revealIdsHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"reveal_id\",\n      \"Reveal IDs\",\n      \"Reveal the lobby player ID of all players\",\n      this,\n      () => this.setRevealState(true),\n      true,\n      [\"AltLeft\"],\n      () => this.setRevealState(false),\n      false\n    ),\n  );\n\n  private setRevealState(state: boolean) {\n    this._playersService.players$.pipe(\n      take(1)\n    ).subscribe(players => {\n      for (const player of players) {\n        player.viewPlayerId = state;\n      }\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this.setRevealState(false);\n  }\n}","<script lang=\"ts\">\n  import type { activeScene } from \"@/content/features/player-scenes/player-scenes.feature\";\n  import type { SkribblPlayerDisplay } from \"@/content/services/players/skribblPlayerDisplay.interface\";\n  import { onDestroy } from \"svelte\";\n\n  export let scene: activeScene | undefined = undefined;\n  export let playerDisplay: SkribblPlayerDisplay;\n  export const getScene = () => scene;\n\n  const getUrl = (scene: activeScene) => {\n    return scene.shift === undefined ?\n      scene.scene.url :\n      `https://static.typo.rip/sprites/rainbow/modulate.php?url=${scene.scene.url}&hue=${scene.shift}`;\n  }\n\n  $: {\n    playerDisplay.useSafeColor = scene !== undefined;\n    playerDisplay.useBackground = scene === undefined;\n  }\n\n  onDestroy(() => {\n    playerDisplay.useSafeColor = false;\n    playerDisplay.useBackground = false;\n  });\n</script>\n\n<style lang=\"scss\">\n  .typo-player-scene {\n    position: absolute;\n    inset: 0;\n    background-repeat: no-repeat;\n    background-size: cover;\n    background-position: center;\n    z-index: -1;\n  }\n</style>\n\n{#if scene !== undefined}\n  <div class=\"typo-player-scene\" style=\"background-image: url('{ getUrl(scene) }')\"> </div>\n{/if}","import { type SceneDto } from \"@/api\";\nimport { LobbyItemsService } from \"@/content/services/lobby-items/lobby-items.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { PlayersService } from \"@/content/services/players/players.service\";\nimport {\n  type anonymousPlayerIdentification,\n  type concretePlayerIdentification, isAnonymousPlayerIdentification, type SkribblPlayerDisplay,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { type OnlineItemDto, OnlineItemTypeDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { inject } from \"inversify\";\nimport {\n  combineLatestWith, firstValueFrom,\n  type Subscription,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport SceneContainer from \"./scene-container.svelte\";\n\nexport interface activeScene {\n  scene: SceneDto;\n  shift: number | undefined;\n}\n\nexport class PlayerScenesFeature extends TypoFeature {\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(LobbyItemsService) private readonly _lobbyItemsService!: LobbyItemsService;\n  @inject(PlayersService) private readonly _lobbyPlayersService!: PlayersService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n\n  public readonly name = \"Player Scenes\";\n  public readonly description =\n    \"Display scenes of typo players in lobbies and on the landing page\";\n  public readonly featureId = 21;\n  public override readonly toggleEnabled = false;\n  public override developerFeature = true;\n\n  private _scenesSubscription?: Subscription;\n  private readonly _sceneContainers = new Map<SkribblPlayerDisplay, SceneContainer>();\n\n  protected override async onActivate() {\n    const scenes = (await this._apiDataSetup.complete()).scenes;\n\n    this._scenesSubscription = this._lobbyPlayersService.players$.pipe(\n      combineLatestWith(this._lobbyItemsService.onlineItems$, this._memberService.memberData$) /* add member data to triggers */\n    ).subscribe(([players, items]) => {\n      this.updatePlayerScenes(players, items, scenes);\n    });\n  }\n\n  protected override async onDestroy() {\n    this._scenesSubscription?.unsubscribe();\n\n    this._sceneContainers.forEach((container) => container.$destroy());\n    this._sceneContainers.clear();\n  }\n\n  /**\n   * Updates the scenes of the players in the lobby\n   * @param players\n   * @param lobbyItems\n   * @param scenes\n   * @private\n   */\n  private async updatePlayerScenes(players: SkribblPlayerDisplay[], lobbyItems: OnlineItemDto[], scenes: SceneDto[]) {\n    this._logger.debug(\"Updating player scenes\", players);\n\n    /* remove player containers that are not present anymore */\n    for(const [playerDisplay, container] of this._sceneContainers){\n      if(!players.includes(playerDisplay)){\n        container.$destroy();\n        this._sceneContainers.delete(playerDisplay);\n      }\n    }\n\n    /* update all current player displays if changed, or add if not existing */\n    for(const player of players) {\n      const identification = player.typoId;\n      let container = this._sceneContainers.get(player);\n\n      if (!container) {\n        container = new SceneContainer({\n          target: player.backgroundContainer,\n          props: {\n            scene: undefined,\n            playerDisplay: player\n          }\n        });\n        this._sceneContainers.set(player, container);\n      }\n\n      let playerItems: OnlineItemDto[] = [];\n\n      /* get items for player */\n      if (isAnonymousPlayerIdentification(identification)) {\n        playerItems = this.getItemsForAnonymousPlayerDisplay(identification, lobbyItems);\n      } else if (!isAnonymousPlayerIdentification(identification)) {\n        playerItems = await this.getItemsForConcretePlayerDisplay(identification);\n      } else {\n        this._logger.warn(\"Unknown player identification\", identification);\n      }\n\n      /* create scene from items */\n      const scene = this.createSceneFromItems(playerItems, scenes);\n      const sceneUpdated = container.getScene()?.scene.id !== scene?.scene.id || container.getScene()?.shift !== scene?.shift;\n\n      if(sceneUpdated){\n        this._logger.info(\"Updating scene for player\", player, scene, playerItems);\n        container.$set({ scene: scene });\n      }\n    }\n\n  }\n\n  public getItemsForAnonymousPlayerDisplay(identification: anonymousPlayerIdentification, items: OnlineItemDto[]){\n    return items.filter((item) => item.lobbyPlayerId === identification.lobbyPlayerId && item.lobbyKey === identification.lobbyKey);\n  }\n\n  private async getItemsForConcretePlayerDisplay(identification: concretePlayerIdentification) {\n    return await this.createItemsForMember(identification.login);\n  }\n\n  /**\n   * Creates scene data from the online items of a player\n   * @param playerItems\n   * @param scenes\n   * @private\n   */\n  private createSceneFromItems(playerItems: OnlineItemDto[], scenes: SceneDto[]): activeScene | undefined {\n    const playerScene = playerItems.find((scene) =>\n      scene.type === OnlineItemTypeDto.Scene);\n    const playerShift = playerItems.find((item) =>\n      item.type === OnlineItemTypeDto.SceneTheme && item.slot === playerScene?.itemId);\n\n    if(playerScene === undefined) return undefined;\n\n    const scene = scenes.find((scene) => scene.id === playerScene.itemId);\n    if(scene === undefined) {\n      this._logger.warn(\"Scene not found\", playerScene.itemId);\n      return undefined;\n    }\n\n    return {\n      scene: scene,\n      shift: playerShift?.itemId\n    };\n  }\n\n  /**\n   * Creates dummy scene items for the currently logged in member\n   * @private\n   * @param login\n   */\n  private async createItemsForMember(login: number): Promise<OnlineItemDto[]> {\n    this._logger.debug(\"Creating demo scene items for member\", login);\n\n    const sceneInventory = (await firstValueFrom(this._memberService.memberData$))?.sceneInventory;\n    if(sceneInventory === undefined) return [];\n\n    const items: OnlineItemDto[] = [];\n    if(sceneInventory.activeId !== undefined){\n      items.push({\n        itemId: sceneInventory.activeId,\n        type: OnlineItemTypeDto.Scene,\n        lobbyPlayerId: 0,\n        slot: 0,\n        lobbyKey: \"practice\",\n      });\n\n      if(sceneInventory.activeShift !== undefined){\n        items.push({\n          itemId: sceneInventory.activeShift,\n          type: OnlineItemTypeDto.SceneTheme,\n          lobbyPlayerId: 0,\n          slot: sceneInventory.activeId,\n          lobbyKey: \"practice\",\n        });\n      }\n    }\n\n    return items;\n  }\n}","<script lang=\"ts\">\n  import type { spriteSlot } from \"@/content/features/player-sprites/player-sprites.feature\";\n  import type { SkribblPlayerDisplay } from \"@/content/services/players/skribblPlayerDisplay.interface\";\n  import { onDestroy } from \"svelte\";\n\n  export let sprites: spriteSlot[] = [];\n  export let playerDisplay: SkribblPlayerDisplay;\n  export const getSprites = () => sprites;\n\n  $: {\n    playerDisplay.adjustToContainSprites = sprites.length > 0;\n    playerDisplay.hideAvatar = sprites.some(sprite => sprite.sprite.isSpecial);\n  }\n\n  const getUrl = (slot: spriteSlot) => {\n    return slot.shift === undefined ?\n      slot.sprite.url :\n      `https://static.typo.rip/sprites/rainbow/modulate.php?url=${slot.sprite.url}&hue=${slot.shift}`;\n  }\n\n  onDestroy(() => {\n    playerDisplay.adjustToContainSprites = false;\n  });\n</script>\n\n<style lang=\"scss\">\n  .sprite-slot {\n    position: absolute;\n    left: -33%;\n    top: -33%;\n    width: 166%;\n    height: 166%;\n    background-repeat: no-repeat;\n    background-size: contain;\n  }\n</style>\n\n{#each sprites as slot}\n  <div class=\"sprite-slot\" style=\"background-image: url('{ getUrl(slot) }'); z-index: {slot.slot + 10}\"> </div>\n{/each}\n\n","import { type SpriteDto } from \"@/api\";\nimport { LobbyItemsService } from \"@/content/services/lobby-items/lobby-items.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport { PlayersService } from \"@/content/services/players/players.service\";\nimport {\n  type anonymousPlayerIdentification, type concretePlayerIdentification, isAnonymousPlayerIdentification,\n  type SkribblPlayerDisplay,\n} from \"@/content/services/players/skribblPlayerDisplay.interface\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { type OnlineItemDto, OnlineItemTypeDto } from \"@/signalr/tobeh.Avallone.Server.Classes.Dto\";\nimport { inject } from \"inversify\";\nimport {\n  combineLatestWith, firstValueFrom,\n  type Subscription,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport SpriteContainer from \"./sprite-container.svelte\";\n\nexport interface spriteSlot {\n  sprite: SpriteDto;\n  slot: number;\n  shift: number | undefined;\n}\n\nexport class PlayerSpritesFeature extends TypoFeature {\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n  @inject(LobbyItemsService) private readonly _lobbyItemsService!: LobbyItemsService;\n  @inject(PlayersService) private readonly _lobbyPlayersService!: PlayersService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n\n  public readonly name = \"Player Sprites\";\n  public readonly description =\n    \"Display sprites of typo players in lobbies and on the landing page\";\n  public readonly featureId = 20;\n  public override readonly toggleEnabled = false;\n  public override developerFeature = true;\n\n  private _spritesSubscription?: Subscription;\n  private readonly _spriteContainers = new Map<SkribblPlayerDisplay, SpriteContainer>();\n\n  protected override async onActivate() {\n    const sprites = (await this._apiDataSetup.complete()).sprites;\n\n    this._spritesSubscription = this._lobbyPlayersService.players$.pipe(\n      combineLatestWith(this._lobbyItemsService.onlineItems$, this._memberService.memberData$) /* add member data to triggers */\n    ).subscribe(([players, items]) => {\n      this.updatePlayerSprites(players, items, sprites);\n    });\n  }\n\n  protected override async onDestroy() {\n    this._spritesSubscription?.unsubscribe();\n\n    this._spriteContainers.forEach((container) => container.$destroy());\n    this._spriteContainers.clear();\n  }\n\n  private async updatePlayerSprites(players: SkribblPlayerDisplay[], items: OnlineItemDto[], sprites: SpriteDto[]){\n    this._logger.debug(\"Updating player sprites\", players);\n\n    /* remove player containers that are not present anymore */\n    for(const [playerDisplay, container] of this._spriteContainers){\n      if(!players.includes(playerDisplay)){\n        container.$destroy();\n        this._spriteContainers.delete(playerDisplay);\n      }\n    }\n\n    /* update all current player displays if changed, or add if not existing */\n    for(const player of players) {\n      const identification = player.typoId;\n      let container = this._spriteContainers.get(player);\n\n      if (!container) {\n        container = new SpriteContainer({\n          target: player.avatarContainer,\n          props: {\n            sprites: [],\n            playerDisplay: player\n          }\n        });\n        this._spriteContainers.set(player, container);\n      }\n\n      let playerItems: OnlineItemDto[] = [];\n\n      /* get items for player */\n      if (isAnonymousPlayerIdentification(identification)) {\n        playerItems = this.getItemsForAnonymousPlayerDisplay(identification, items);\n      } else if (!isAnonymousPlayerIdentification(identification)) {\n        playerItems = await this.getItemsForConcretePlayerDisplay(identification);\n      } else {\n        this._logger.warn(\"Unknown player identification\", identification);\n      }\n\n      const slots = this.createSpriteSlotsFromItems(playerItems, sprites);\n      const existingPlayerSlots: spriteSlot[] = container.getSprites();\n      const slotsUpdated = slots.length !== existingPlayerSlots.length || slots.some((slot) => {\n        const existingSlot = existingPlayerSlots.find((s) => s.slot === slot.slot);\n        return !existingSlot || existingSlot.sprite.id !== slot.sprite.id || existingSlot.shift !== slot.shift;\n      });\n\n      if (slotsUpdated) {\n        this._logger.info(\"Updating sprite slots for player\", player, slots, playerItems);\n        container.$set({ sprites: slots });\n      }\n    }\n  }\n\n  private getItemsForAnonymousPlayerDisplay(identification: anonymousPlayerIdentification, items: OnlineItemDto[]){\n    return items.filter((item) => item.lobbyPlayerId === identification.lobbyPlayerId && item.lobbyKey === identification.lobbyKey);\n  }\n\n  private async getItemsForConcretePlayerDisplay(identification: concretePlayerIdentification) {\n    return await this.createItemsForMember(identification.login);\n  }\n\n  /**\n   * Creates sprite slot data from the online items of a player\n   * @param playerItems\n   * @param sprites\n   * @private\n   */\n  private createSpriteSlotsFromItems(playerItems: OnlineItemDto[], sprites: SpriteDto[]){\n    const playerSprites = playerItems.filter((sprite) =>\n      sprite.type === OnlineItemTypeDto.Sprite);\n    const playerShifts = playerItems.filter((sprite) =>\n      sprite.type === OnlineItemTypeDto.SpriteShift);\n\n    const playerSlots: spriteSlot[] = playerSprites.map((sprite) => {\n      const spriteData = sprites.find((s) => s.id === sprite.itemId);\n      if(spriteData === undefined) {\n        this._logger.warn(`Sprite with id ${sprite.itemId} not found`);\n        return undefined;\n      }\n\n      return {\n        sprite: spriteData,\n        slot: sprite.slot,\n        shift: playerShifts.find((shift) => shift.slot === sprite.slot)?.itemId\n      };\n    }).filter((slot) => slot !== undefined);\n\n    return playerSlots;\n  }\n\n  /**\n   * Creates dummy sprite items for the currently logged in member\n   * @private\n   * @param login\n   */\n  private async createItemsForMember(login: number): Promise<OnlineItemDto[]> {\n    this._logger.debug(\"Creating demo items for member\", login);\n\n    const spriteInventory = (await firstValueFrom(this._memberService.memberData$))?.spriteInventory ?? [];\n\n    const items: OnlineItemDto[] = spriteInventory.map((sprite) => {\n      const item = sprite.slot ? {\n        itemId: sprite.spriteId,\n        type: OnlineItemTypeDto.Sprite,\n        lobbyPlayerId: 0,\n        slot: sprite.slot,\n        lobbyKey: \"practice\",\n      } : undefined;\n\n      const shift = sprite.colorShift && sprite.slot ? {\n        itemId: sprite.colorShift,\n        type: OnlineItemTypeDto.SpriteShift,\n        lobbyPlayerId: 0,\n        slot: sprite.slot,\n        lobbyKey: \"practice\",\n      } : undefined;\n\n      return [item, shift];\n    }).flat().filter(item => item !== undefined);\n\n    return items;\n  }\n}","import { injectable } from \"inversify\";\nimport type { Observable } from \"rxjs\";\n\n@injectable()\nexport abstract class TypoChallenge<TTrigger> {\n\n  public abstract get name(): string;\n  public abstract get description(): string;\n\n  /**\n   * Create a new observable that emits when trigger data changed,\n   * indicating an update in the challenge state.\n   */\n  public abstract createTriggerObservable(): Observable<TTrigger>;\n\n  /**\n   * Apply the current game state to the challenge state.\n   * @param trigger\n   */\n  public abstract apply(trigger: TTrigger): void | Promise<void>;\n\n  /**\n   * Destroy the challenge and clean up current state.\n   * No subsequent calls to apply will be made to this instance,\n   * until createTriggerObservable is called again.\n   */\n  public abstract destroy(): void | Promise<void>;\n}","import { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport { combineLatestWith, distinctUntilChanged, map, type Observable } from \"rxjs\";\n\nexport class BlindGuessChallenge extends TypoChallenge<boolean> {\n\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  readonly name = \"Blind Guess\";\n  readonly description = \"You don't see what other people are drawing.\";\n\n\n  createTriggerObservable(): Observable<boolean> {\n    return this._lobbyService.lobby$.pipe(\n      combineLatestWith(this._drawingService.drawingState$),\n      map(([lobby, drawing]) => {\n        return drawing === \"drawing\"\n          && lobby !== null && (lobby.meId !== lobby.drawerId)\n          && !lobby.players.some(player => player.id === lobby.meId && player.guessed);\n      }),\n      distinctUntilChanged(),\n    );\n  }\n\n  async apply(trigger: boolean): Promise<void> {\n    const elements = await this._elementsSetup.complete();\n\n    if(trigger) {\n      elements.canvas.style.opacity = \"0\";\n    }\n    else {\n      elements.canvas.style.opacity = \"\";\n    }\n\n    return;\n  }\n\n  destroy(): Promise<void> {\n    return this.apply(false);\n  }\n}","import { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { ChatService } from \"@/content/services/chat/chat.service\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { inject } from \"inversify\";\nimport { combineLatestWith, distinctUntilChanged, map, type Observable, type Subscription } from \"rxjs\";\n\nexport class DeafGuessChallenge extends TypoChallenge<boolean> {\n\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ChatService) private readonly _chatService!: ChatService;\n\n  private _blurredMessages?: HTMLElement[];\n  private _style?: CSSStyleSheet;\n  private _messagesSubscription?: Subscription;\n\n  readonly name = \"Deaf Guess\";\n  readonly description = \"When guessing, you don't see hints or messages from other people.\";\n\n  createTriggerObservable(): Observable<boolean> {\n    return this._lobbyService.lobby$.pipe(\n      combineLatestWith(this._drawingService.drawingState$),\n      map(([lobby, drawing]) => {\n        return drawing === \"drawing\"\n          && lobby !== null && (lobby.meId !== lobby.drawerId)\n          && !lobby.players.some(player => player.id === lobby.meId && player.guessed);\n      }),\n      distinctUntilChanged(),\n    );\n  }\n\n  async apply(trigger: boolean): Promise<void> {\n\n    if(trigger) {\n\n      /* subscribe to new chat messages and collect content elements */\n      if(!this._messagesSubscription){\n        this._messagesSubscription = this._chatService.playerMessageReceived$.subscribe(message => {\n          if(this._blurredMessages){\n            this._blurredMessages.push(message.contentElement);\n          }\n          else {\n            this._blurredMessages = [message.contentElement];\n          }\n          message.element.classList.add(\"typo-challenge-deaf-guess-hidden\");\n        });\n      }\n\n      /* set the style for the challenge effects */\n      if(!this._style){\n        this._style = new CSSStyleSheet();\n        this._style.insertRule(\".typo-challenge-deaf-guess-hidden span, .player-bubble .content .text { filter: blur(3px); }\");\n        this._style.insertRule(\"#game form.chat-form .characters, #game-word .hints { opacity: 0 }\");\n        document.adoptedStyleSheets = [...document.adoptedStyleSheets, this._style];\n      }\n    }\n\n    else {\n\n      /* stop subscription, remove blurred messages and style */\n      this._messagesSubscription?.unsubscribe();\n      this._messagesSubscription = undefined;\n      this._blurredMessages?.forEach(message => message.classList.remove(\"typo-challenge-deaf-guess-hidden\"));\n      this._blurredMessages = undefined;\n      document.adoptedStyleSheets = document.adoptedStyleSheets.filter(sheet => sheet !== this._style);\n      this._style = undefined;\n    }\n\n    return;\n  }\n\n  destroy(): Promise<void> {\n    return this.apply(false);\n  }\n}","import { CanvasClearedEventListener } from \"@/content/events/canvas-cleared.event\";\nimport { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { inject } from \"inversify\";\nimport {\n  type Observable,\n  of, type Subscription,\n} from \"rxjs\";\n\nexport class DontClearChallenge extends TypoChallenge<boolean> {\n\n  @inject(CanvasClearedEventListener) private readonly _canvasClearedEvent!: CanvasClearedEventListener;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  private _style?: CSSStyleSheet;\n  private _canvasClearedSubscription?: Subscription;\n\n  readonly name = \"Dont Clear\";\n  readonly description = \"The canvas cannot be cleared; you draw over other previous drawings.\";\n\n  createTriggerObservable(): Observable<boolean> {\n    return of(true);\n  }\n\n  async apply(trigger: boolean): Promise<void> {\n\n    if(!trigger) return;\n\n    /* hide undo and clear */\n    this._style = new CSSStyleSheet();\n    this._style.insertRule(\".tool[data-tooltip='Undo'], .tool[data-tooltip='Clear'] { display: none }\");\n    document.adoptedStyleSheets = [...document.adoptedStyleSheets, this._style];\n\n    /* listen for canvas clear and restore image */\n    this._canvasClearedSubscription = this._canvasClearedEvent.events$.subscribe(async (event) => {\n      await this._drawingService.drawImage(event.data);\n    });\n\n    await this._toastService.showToast(\"Don't Clear active\", \"Attention: Your drawings will look different (likely as nonsense) for other people!\");\n  }\n\n  destroy(): void {\n    if(this._style) {\n      document.adoptedStyleSheets = document.adoptedStyleSheets.filter(style => style !== this._style);\n      this._style = undefined;\n    }\n    this._canvasClearedSubscription?.unsubscribe();\n  }\n}","import { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport { combineLatestWith, distinctUntilChanged, map, type Observable } from \"rxjs\";\n\nexport class DrunkVisionChallenge extends TypoChallenge<boolean> {\n\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  readonly name = \"Drunk Vision\";\n  readonly description = \"You can only vaguely see what other people draw.\";\n\n  private _overlay?: HTMLDivElement;\n\n  createTriggerObservable(): Observable<boolean> {\n    return this._lobbyService.lobby$.pipe(\n      combineLatestWith(this._drawingService.drawingState$),\n      map(([lobby, drawing]) => {\n        return drawing === \"drawing\"\n          && lobby !== null && (lobby.meId !== lobby.drawerId)\n          && !lobby.players.some(player => player.id === lobby.meId && player.guessed);\n      }),\n      distinctUntilChanged(),\n    );\n  }\n\n  async apply(trigger: boolean): Promise<void> {\n    const elements = await this._elementsSetup.complete();\n\n    if(trigger) {\n      if(this._overlay === undefined){\n        this._overlay = document.createElement(\"div\");\n        this._overlay.style.position = \"absolute\";\n        this._overlay.style.width = \"100%\";\n        this._overlay.style.height = \"100%\";\n        this._overlay.style.backdropFilter = \"blur(40px)\";\n        this._overlay.style.pointerEvents = \"none\";\n        this._overlay.style.zIndex = \"0\";\n        elements.canvasWrapper.appendChild(this._overlay);\n      }\n    }\n    else {\n      this._overlay?.remove();\n      this._overlay = undefined;\n    }\n\n    return;\n  }\n\n  destroy(): Promise<void> {\n    return this.apply(false);\n  }\n}","import { defaultPalettes } from \"@/content/features/drawing-color-palettes/default-palettes\";\nimport { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { ColorsService } from \"@/content/services/colors/colors.service\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { inject } from \"inversify\";\nimport {\n  combineLatestWith, distinctUntilChanged, map,\n  type Observable\n} from \"rxjs\";\n\nexport class MonochromeChallenge extends TypoChallenge<boolean> {\n\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ColorsService) private readonly _colorsService!: ColorsService;\n\n  readonly name = \"Monochrome\";\n  readonly description = \"You can only use shades of a random color column.\";\n\n  createTriggerObservable(): Observable<boolean> {\n    return this._lobbyService.lobby$.pipe(\n      combineLatestWith(this._drawingService.drawingState$),\n      map(([lobby, drawing]) => drawing === \"drawing\" && lobby !== null && (lobby.meId === lobby.drawerId)),\n      distinctUntilChanged()\n    );\n  }\n\n  apply(trigger: boolean): void {\n\n    if(!trigger) {\n      this._colorsService.resetColorSelector();\n    }\n\n    else {\n      this._colorsService.setColorSelector((palette) => {\n        palette = palette ?? defaultPalettes.skribblPalette;\n        const random = Math.floor(Math.random() * palette.columns);\n        return {\n          columns: 1,\n          colorHexCodes: palette?.colorHexCodes.filter((_, index) => (index % palette.columns) === random) ?? []\n        };\n      });\n    }\n  }\n\n  destroy(): void {\n    this.apply(false);\n  }\n}","import { MessageSentEventListener } from \"@/content/events/message-sent.event\";\nimport { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { inject } from \"inversify\";\nimport {\n  combineLatestWith,\n  distinctUntilChanged,\n  map,\n  type Observable,\n  of,\n  switchMap,\n  take,\n} from \"rxjs\";\n\nexport class OneShotChallenge extends TypoChallenge<boolean> {\n\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(MessageSentEventListener) private readonly _messageSentEventListener!: MessageSentEventListener;\n\n  private _style?: CSSStyleSheet;\n\n  readonly name = \"One Shot\";\n  readonly description = \"You have only one try to guess the word.\";\n\n  createTriggerObservable(): Observable<boolean> {\n    return this._lobbyService.lobby$.pipe(\n      combineLatestWith(this._drawingService.drawingState$),\n      map(([lobby, drawing]) => {\n        return drawing === \"drawing\"\n          && lobby !== null && (lobby.meId !== lobby.drawerId)\n          && !lobby.players.some(player => player.id === lobby.meId && player.guessed);\n      }),\n      distinctUntilChanged(),\n      switchMap(trigger => trigger === false ? of(false) :\n          this._messageSentEventListener.events$.pipe(\n            take(1),\n            map(() => true),\n          )\n      )\n    );\n  }\n\n  async apply(trigger: boolean): Promise<void> {\n\n    if(trigger) {\n      if(!this._style){\n        this._style = new CSSStyleSheet();\n        this._style.insertRule(\"#game form.chat-form { display: none }\");\n        document.adoptedStyleSheets = [...document.adoptedStyleSheets, this._style];\n      }\n    }\n    else {\n      if(this._style) {\n        document.adoptedStyleSheets = document.adoptedStyleSheets.filter(style => style !== this._style);\n        this._style = undefined;\n      }\n    }\n\n    return;\n  }\n\n  destroy(): Promise<void> {\n    return this.apply(false);\n  }\n}","<script lang=\"ts\">\n  import type { ToolbarChallengesFeature } from \"./toolbar-challenges.feature\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  export let feature: ToolbarChallengesFeature;\n\n  const challenges = feature.challenges;\n  const activeIds = feature.activatedChallengesSettingStore;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-toolbar-challenges-list {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    align-items: stretch;\n    gap: 1rem;\n\n    .challenge {\n      display: flex;\n      flex-direction: column;\n\n      span {\n        padding-left: 2rem;\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-toolbar-challenges-list\">\n\n  {#each challenges as challenge}\n    <div class=\"challenge\">\n      <Checkbox\n        checked={$activeIds.includes(challenge.id)}\n        on:change={(event) => {\n          const other = $activeIds.filter(id => id !== challenge.id);\n          $activeIds = event.detail ? [...other, challenge.id] : other;\n        }}\n        description=\"{challenge.challenge.name}\"\n      />\n      <span>{challenge.challenge.description}</span>\n    </div>\n  {/each}\n\n</div>\n","import { ExtensionContainer } from \"@/content/core/extension-container/extension-container\";\nimport { ExtensionSetting } from \"@/content/core/settings/setting\";\nimport type { TypoChallenge } from \"@/content/features/toolbar-challenges/challenge\";\nimport { BlindGuessChallenge } from \"@/content/features/toolbar-challenges/challenges/blind-guess-challenge\";\nimport { DeafGuessChallenge } from \"@/content/features/toolbar-challenges/challenges/deaf-guess-challenge\";\nimport { DontClearChallenge } from \"@/content/features/toolbar-challenges/challenges/dont-clear-challenge\";\nimport { DrunkVisionChallenge } from \"@/content/features/toolbar-challenges/challenges/drunk-vision-challenge\";\nimport { MonochromeChallenge } from \"@/content/features/toolbar-challenges/challenges/monochrome-challenge\";\nimport { OneShotChallenge } from \"@/content/features/toolbar-challenges/challenges/one-shot-challenge\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport type { Type } from \"@/util/types/type\";\nimport { inject } from \"inversify\";\nimport { Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport ToolbarPost from \"./toolbar-challenges.svelte\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\n\nexport class ToolbarChallengesFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ExtensionContainer) private readonly _container!: ExtensionContainer;\n\n  public readonly name = \"Challenges\";\n  public readonly description =\n    \"Adds the option to enable game modifications to make the game more challenging\";\n  public readonly featureId = 8;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n  private _challengeStatesSubscription?: Subscription;\n\n  private readonly _challengeStates = new Map<\n    number,\n    {\n      challenge: TypoChallenge<unknown>;\n      destroy?: VoidFunction;\n    }\n  >();\n\n  private readonly _activatedChallenges = new ExtensionSetting<number[]>(\"activated_challenges\", [], this);\n  private readonly _challenges: { challenge: Type<TypoChallenge<unknown>>; id: number }[] = [\n    { challenge: BlindGuessChallenge, id: 1 },\n    { challenge: DrunkVisionChallenge, id: 2 },\n    { challenge: DeafGuessChallenge, id: 3 },\n    { challenge: OneShotChallenge, id: 4 },\n    { challenge: DontClearChallenge, id: 5 },\n    { challenge: MonochromeChallenge, id: 6 },\n  ];\n\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create challenges */\n    for (const challenge of this._challenges) {\n      const instance = await this.resolveChallenge(challenge.challenge);\n      this._challengeStates.set(challenge.id, { challenge: instance });\n    }\n\n    /* subscribe to states */\n    this._challengeStatesSubscription = this.listenChallengeStates();\n\n    /* create icon and attach to toolbar */\n    this._iconComponent = new IconButton({\n      target: elements.toolbar,\n      props: {\n        icon: \"file-img-challenge-gif\",\n        name: \"Challenges\",\n        order: 4,\n        tooltipAction: this.createTooltip,\n        lockTooltip: \"Y\",\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n      /* if already opened, return */\n      if (this._flyoutComponent) {\n        return;\n      }\n\n      /* create fly out content */\n      const flyoutContent: componentData<ToolbarPost> = {\n        componentType: ToolbarPost,\n        props: {\n          feature: this,\n        },\n      };\n\n      /* open flyout and destroy when clicked out */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          title: \"Challenges\",\n          iconName: \"file-img-nochallenge-gif\",\n        },\n      });\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(() => {\n        this._logger.info(\"Destroyed flyout\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutComponent = undefined;\n      });\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._flyoutComponent?.$destroy();\n    this._flyoutSubscription?.unsubscribe();\n    this._flyoutSubscription = undefined;\n    this._challengeStates.clear();\n    this._challengeStatesSubscription?.unsubscribe();\n    this._challengeStatesSubscription = undefined;\n  }\n\n  public get activatedChallengesSettingStore(){\n    return this._activatedChallenges.store;\n  }\n\n  public get challenges(){\n    const cs = [...this._challengeStates.entries().map(([id, {challenge}]) => ({id, challenge}))];\n    this._logger.debug(cs);\n    return cs;\n  }\n\n  /**\n   * Listen to active challenges and destroy/activate them accordingly\n   * @private\n   */\n  private listenChallengeStates(): Subscription {\n    return this._activatedChallenges.changes$.subscribe(async ids => {\n\n      /* activate challenges that are not yet activated */\n      ids.forEach(id => {\n        const challenge = this._challengeStates.get(id);\n        if(!challenge) {\n          this._logger.warn(`Challenge with id ${id} not resolved`);\n          return;\n        }\n\n        if(!challenge.destroy) {\n          this._logger.debug(`Activating challenge ${challenge.challenge.name}`);\n          challenge.destroy = this.activateChallenge(challenge.challenge);\n        }\n      });\n\n      /* destroy challenges that are not anymore active */\n      this._challengeStates.forEach((state, id) => {\n        if(!ids.includes(id) && state.destroy) {\n          this._logger.debug(`Deactivating challenge ${state.challenge.name}`);\n          state.destroy();\n          state.destroy = undefined;\n        }\n      });\n\n      /* update icon */\n      this._iconComponent?.$set({icon: ids.length > 0 ? \"file-img-challenge-gif\" : \"file-img-nochallenge-gif\"});\n    });\n  }\n\n  /**\n   * Get an instance for a challenge type, resolves DI without being registered\n   * @param challenge\n   * @private\n   */\n  private async resolveChallenge<TTrigger>(challenge: Type<TypoChallenge<TTrigger>>) {\n    const instance = this._container.resolveService(challenge);\n    this._logger.debug(`Resolved challenge: ${instance.name}`);\n\n    return instance;\n  }\n\n  /**\n   * Activate a challenge and return a function to destroy it\n   * @param challenge\n   * @private\n   */\n  private activateChallenge(challenge: TypoChallenge<unknown>): VoidFunction {\n    this._logger.debug(`Activating challenge ${challenge.name}`);\n\n    /* setup challenge */\n    const triggerSubject = challenge.createTriggerObservable();\n    const subscription = triggerSubject.subscribe(async (trigger) => {\n      this._logger.debug(`Challenge trigger: ${trigger}`);\n      try {\n        await challenge.apply(trigger);\n      } catch (error) {\n        this._logger.error(`Error applying challenge: ${error}`);\n      }\n    });\n\n    /* function to destroy challenge */\n    return () => {\n      this._logger.debug(`Destroying challenge ${challenge.name}`);\n      subscription.unsubscribe();\n\n      try {\n        challenge.destroy();\n      } catch (error) {\n        this._logger.error(`Error destroying challenge: ${error}`);\n      }\n    };\n  }\n}","import { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { inject } from \"inversify\";\nimport { Subscription } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\n\nexport class ToolbarFullscreenFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n\n  public readonly name = \"Fullscreen\";\n  public readonly description =\n    \"Adds a toggle in-game to quickly enter/exit the browser fullscreen mode\";\n  public readonly featureId = 9;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n\n  private readonly _toggleHotkey = this.useHotkey(new HotkeyAction(\n    \"toggle_fullscreen\",\n    \"Toggle Fullscreen\",\n    \"Toggle the browser fullscreen mode\",\n    this,\n    async () => await this.toggleFullscreen(),\n    true,\n    [\"ShiftLeft\", \"KeyF\"]\n  ));\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach to toolbar */\n    this._iconComponent = new IconButton({\n      target: elements.toolbar,\n      props: {\n        icon: \"file-img-fullscreen-gif\",\n        name: \"Fullscreen\",\n        order: 1,\n        tooltipAction: this.createTooltip,\n        lockTooltip: \"Y\"\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(async () => {\n      await this.toggleFullscreen();\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n  }\n\n  private async toggleFullscreen() {\n    if(document.fullscreenElement === null) {\n      this._logger.debug(\"Entering fullscreen\");\n      await document.documentElement.requestFullscreen();\n    }\n    else {\n      this._logger.debug(\"Exiting fullscreen\");\n      await document.exitFullscreen();\n    }\n  }\n}","export const chooseFile = async (accept: string, multiple: boolean): Promise<FileList | null> => {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n  input.accept = accept;\n  input.multiple = multiple;\n  input.click();\n  return new Promise<FileList | null>((resolve) => {\n    input.onchange = () => {\n      if(input.files && input.files.length > 0){\n        resolve(input.files);\n      } else {\n        resolve(null);\n      }\n    };\n  });\n};","<script lang=\"ts\">\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import type { ToolbarImageLabFeature } from \"./toolbar-imagelab.feature\";\n  export let feature: ToolbarImageLabFeature;\n  const store = feature.savedDrawCommandsStore;\n  const devmode = feature.devmodeStore;\n  feature.customName = \"\";\n\n  const locked = feature.locked;\n</script>\n\n<style lang=\"scss\">\n  .typo-toolbar-imagelab-actions {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    align-items: stretch;\n    gap: .7rem;\n\n    .lockedHint {\n      display: flex;\n      gap: 1rem;\n      align-items: center;\n      margin-bottom: 1rem;\n      width: 100%;\n\n      span {\n        flex-grow: 1;\n        user-select: none;\n        font-weight: 600;\n        opacity: .8;\n      }\n    }\n\n    .saved-commands {\n      display:flex;\n      gap: 1rem;\n      align-items: center;\n\n      &.locked > :global(:last-child){\n        pointer-events: none;\n        opacity: .5;\n      }\n\n      > :global(:last-child){\n        flex-grow: 1;\n      }\n\n      .remove {\n        filter: grayscale(.7);\n        transition: filter 60ms;\n\n        &:hover {\n          filter: grayscale(0);\n        }\n      }\n    }\n  }\n</style>\n\n<div class=\"typo-toolbar-imagelab-actions\">\n\n\n  {#if $locked}\n    <div class=\"lockedHint\">\n      <IconButton\n        icon=\"file-img-disabled-gif\" name=\"Abort\" size=\"1.5rem\" hoverMove=\"{false}\"\n        on:click={() => feature.abortPaste()}\n      />\n      <span>Drawing in progress...</span>\n    </div>\n  {/if}\n\n  {#each $store as image}\n    <div class=\"saved-commands\" class:locked={$locked}>\n      <div class=\"remove\" >\n        <IconButton\n          icon=\"file-img-trash-gif\" name=\"Remove\" size=\"1.5rem\" hoverMove=\"{false}\"\n          on:click={() => feature.removeDrawCommands($store, image)}\n        />\n      </div>\n      <FlatButton content=\"{image.name}\" color=\"blue\" on:click={() => feature.pasteDrawCommands(image)} />\n    </div>\n  {/each}\n\n  <FlatButton content=\"Paste Image\" color=\"green\" on:click={async () => {\n    const data = await feature.pickImageFromLocal();\n    if(data != null) await feature.pasteImageToLocation(data);\n  }} />\n  <FlatButton content=\"Save Current Image\" color=\"green\" on:click={() => feature.saveCurrentDrawCommands()} />\n  <FlatButton content=\"Load SKD File\" color=\"blue\" on:click={() => feature.addDrawCommandsFromFile()} />\n  <FlatButton content=\"Download Current SKD\" color=\"blue\" on:click={() => feature.downloadCurrentDrawCommands()} />\n  <input type=\"text\" class=\"typo\" placeholder=\"Custom save name\" bind:value={feature.customName} />\n  <Checkbox bind:checked={feature.clearBeforePaste} description=\"Clear before paste\" />\n\n  {#if $devmode}\n    <Checkbox bind:checked={feature.pasteInstant} description=\"Paste instant (practice!)\" />\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n\n  export let onPick: (mode: \"fit\" | \"fill\" | \"position\" | \"range\") => void;\n</script>\n\n<style lang=\"scss\">\n  .typo-imagelab-position-picker {\n    display:flex;\n    flex-direction: column;\n    gap: .5rem;\n  }\n</style>\n\n<div class=\"typo-imagelab-position-picker\">\n  <p>\n    Pick a mode to paste the image on the canvas.<br>\n    \"Fill on canvas\" and \"Paste between click\" might change the source image ratio.<br>\n    <br>\n    <b>Warning: This should be used only in practice mode.</b><br>\n    No one else can see this image, and it will corrupt your drawing for others.\n  </p>\n  <br>\n  <FlatButton content=\"Fit on canvas\" color=\"green\" on:click={() => onPick(\"fit\")} />\n  <FlatButton content=\"Fill canvas\" color=\"green\" on:click={() => onPick(\"fill\")} />\n  <FlatButton content=\"Paste top-right on click position\" color=\"blue\" on:click={() => onPick(\"position\")} />\n  <FlatButton content=\"Paste between two click positions\" color=\"blue\" on:click={() => onPick(\"range\")} />\n</div>\n","import { ImagelabService } from \"@/content/features/toolbar-imagelab/imagelab.service\";\nimport { DrawingService, type savedDrawCommands } from \"@/content/services/drawing/drawing.service\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { type componentData, type componentDataFactory, ModalService } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport {\n  PrioritizedCanvasEventsSetup\n} from \"@/content/setups/prioritized-canvas-events/prioritized-canvas-events.setup\";\nimport { downloadText } from \"@/util/download\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { chooseFile } from \"@/util/upload\";\nimport { inject } from \"inversify\";\nimport {\n  BehaviorSubject,\n  combineLatest,\n  filter,\n  firstValueFrom,\n  Subject,\n  Subscription,\n  take,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport ToolbarImageLab from \"./toolbar-imagelab.svelte\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\nimport ImagelabPositionPicker from \"./imagelab-position-picker.svelte\";\n\nexport class ToolbarImageLabFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(ImagelabService) private readonly _drawCommandsService!: ImagelabService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(ModalService) private readonly _modalService!: ModalService;\n  @inject(PrioritizedCanvasEventsSetup) private readonly _canvasEventsSetup!: PrioritizedCanvasEventsSetup;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(GlobalSettingsService) private readonly _globalSettingsService!: GlobalSettingsService;\n\n  public readonly name = \"Image Laboratory\";\n  public readonly description =\n    \"Adds an icon to the typo toolbar to save or paste skribbl drawings (SKDs) to a lobby\";\n  public readonly featureId = 10;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n\n  protected override get boundServices(){\n    return [this._drawCommandsService];\n  }\n\n  private _customName?: string;\n  public set customName(value: string | undefined){\n    const val = value?.replace(/[^a-z0-9]/gi, \"_\") ?? undefined;\n    this._customName = val && val.length > 0 ? val : undefined;\n  }\n  public get customName(){\n    return this._customName;\n  }\n\n  public clearBeforePaste = false;\n  public pasteInstant = false;\n\n  public get locked(){\n    return fromObservable(this._drawingService.pasteInProgress$, false);\n  }\n\n  public get devmodeStore(){\n    return this._globalSettingsService.settings.devMode.store;\n  }\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach to toolbar */\n    this._iconComponent = new IconButton({\n      target: elements.toolbar,\n      props: {\n        icon: \"file-img-dna-gif\",\n        name: \"Image Laboratory\",\n        order: 3,\n        tooltipAction: this.createTooltip,\n        lockTooltip: \"Y\"\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n\n      /* if already opened, return */\n      if (this._flyoutComponent) {\n        return;\n      }\n\n      /* create fly out content */\n      const flyoutContent: componentData<ToolbarImageLab> = {\n        componentType: ToolbarImageLab,\n        props: {\n          feature: this,\n        },\n      };\n\n      /* open flyout and destroy when clicked out */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          title: \"Image Laboratory\",\n          iconName: \"file-img-dna-gif\",\n        },\n      });\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(() => {\n        this._logger.info(\"Destroyed flyout\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutComponent = undefined;\n      });\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._flyoutComponent?.$destroy();\n    this._flyoutComponent = undefined;\n    this._flyoutSubscription?.unsubscribe();\n  }\n\n  /**\n   * Select files, parse content as draw commands json and save to draw commands store\n   */\n  public async addDrawCommandsFromFile() {\n    const files = await chooseFile(\".skd\", true);\n    if(files === null) return;\n\n    // read files as json draw command array\n    const commands = await Promise.all(\n      [...files].map(async (file) => {\n        let commands;\n        try {\n          const text = await file.text();\n          commands = JSON.parse(text);\n          if(typeof commands !== \"object\" || !Array.isArray(commands)){\n            throw new Error(\"Invalid format\");\n          }\n        }\n        catch(e){\n          this._logger.error(\"Failed to read file\", file, e);\n          throw e;\n        }\n        return {\n          name: file.name,\n          commands\n        };\n      })\n    );\n\n    /* add to store in service */\n    commands.forEach(c => this._drawCommandsService.saveDrawCommands(c.name, c.commands));\n  }\n\n  /**\n   * gets the draww commands of the current image and saves them to the service\n   */\n  public saveCurrentDrawCommands(){\n    combineLatest({\n        commands: this._drawingService.commands$,\n        state: this._drawingService.imageState$\n    }).pipe(\n      take(1)\n    ).subscribe(({commands,  state}) => {\n      if(state === null) {\n        this._logger.warn(\"Attempted to save commands, but state null. In a lobby?\");\n        throw new Error(\"state is null\");\n      }\n\n      this._drawCommandsService.saveDrawCommands(this._customName ?? state.word.hints, commands);\n    });\n  }\n\n  /**\n   * gets the draww commands of the current image and saves them locally as a file\n   */\n  public downloadCurrentDrawCommands(){\n    combineLatest({\n      commands: this._drawingService.commands$,\n      state: this._drawingService.imageState$\n    }).pipe(\n      take(1)\n    ).subscribe(({commands,  state}) => {\n      if(state === null) {\n        this._logger.warn(\"Attempted to save commands, but state null. In a lobby?\");\n        throw new Error(\"state is null\");\n      }\n\n      const name = this._customName ?? state.word.hints;\n      const json = JSON.stringify(commands);\n      downloadText(json, `${name}.skd`);\n    });\n  }\n\n  /**\n   * Get a svelte store based on the saved draw commands from the service\n   */\n  public get savedDrawCommandsStore() {\n    return fromObservable(this._drawCommandsService.savedDrawCommands$, []);\n  }\n\n  /**\n   * Removes saved draw commands from the service\n   * @param all\n   * @param remove\n   */\n  public removeDrawCommands(all: savedDrawCommands[], remove: savedDrawCommands){\n    const index = all.indexOf(remove);\n    if(index === -1) {\n      this._logger.warn(\"Tried to remove commands, but not found\");\n      throw new Error();\n    }\n\n    this._drawCommandsService.removeSavedDrawCommands(index);\n  }\n\n  /**\n   * Start a pasting process using the drawing service\n   * @param commands\n   * @param pasteInstant\n   */\n  public async pasteDrawCommands(commands: savedDrawCommands){\n\n    /* check if currently in a lobby */\n    const lobby = await firstValueFrom(this._lobbyService.lobby$);\n    if(lobby === null){\n      await this._toastService.showToast(\"Can't paste outside of a lobby\");\n      return;\n    }\n\n    /* check if allowed to paste */\n    if(lobby.drawerId !== lobby.meId){\n      await this._toastService.showToast(\"You can only paste while you are drawing\");\n      return;\n    }\n\n    if(this.clearBeforePaste) this._drawingService.clearImage();\n    await this._drawingService.pasteDrawCommands(commands.commands, !this.pasteInstant);\n  }\n\n  /**\n   * Stop a paste in progress\n   */\n  public abortPaste(){\n    this._drawingService.cancelPendingDrawCommands();\n  }\n\n  /**\n   * Pick an image from the local file system and return it as a base64 string\n   */\n  public async pickImageFromLocal(): Promise<string | null> {\n    const files = await chooseFile(\"image/*\", false);\n    if(files === null) return null;\n\n    const file = files[0];\n    const reader = new FileReader();\n    const result = new BehaviorSubject<string | undefined | null>(undefined);\n    reader.onload = async (e) => {\n      const data = e.target?.result;\n      if(typeof data !== \"string\") {\n        this._logger.error(\"Failed to read file\", file);\n        await this._toastService.showToast(\"Failed to read file\");\n        result.next(null);\n        return;\n      }\n\n      result.next(data);\n    };\n    reader.readAsDataURL(file);\n    return await firstValueFrom(result.pipe(filter(v => v !== undefined))) as (string | null);\n  }\n\n  public async pasteImageToLocation(base64: string){\n    this._logger.debug(\"Pasting image to location\");\n\n    const pickerComponent: componentDataFactory<ImagelabPositionPicker, \"fit\" | \"fill\" | \"position\" | \"range\"> = {\n      componentType: ImagelabPositionPicker,\n      propsFactory: submit => ({\n        onPick: submit.bind(this),\n      })\n    };\n    const mode = await this._modalService.showPrompt(\n      pickerComponent.componentType,\n      pickerComponent.propsFactory,\n      \"Paste Image\"\n    );\n\n    this._logger.debug(\"Selected mode\", mode);\n    if(mode === undefined) return;\n\n    let x, y, width, height;\n    const canvas = (await this._elementsSetup.complete()).canvas;\n    const img = new Image();\n    img.src = base64;\n    await new Promise(resolve => img.onload = resolve);\n\n    /* fit centered as big as possible on the canvas */\n    if(mode === \"fit\"){\n      const scale = Math.min(canvas.width / img.width, canvas.height / img.height);\n      width = img.width * scale;\n      height = img.height * scale;\n      x = (canvas.width - width) / 2;\n      y = (canvas.height - height) / 2;\n    }\n\n    /* fill canvas with image, changing image ratio if necessary */\n    else if(mode === \"fill\"){\n      x = 0;\n      y = 0;\n      width = canvas.width;\n      height = canvas.height;\n    }\n\n    /* paste the image in original size with top-left corner at position */\n    else if(mode === \"position\"){\n      const toast = await this._toastService\n        .showStickyToast(\"Paste Image\", \"Click on the canvas to paste the image\", true);\n\n      let position: PointerEvent;\n      try {\n        position = await this.waitForCanvasClick(firstValueFrom(toast.closed$));\n      }\n      catch (e){\n        this._logger.debug(\"Aborted paste image\", e);\n        toast.close();\n        return;\n      }\n\n      x = position.offsetX;\n      y = position.offsetY;\n      width = img.width;\n      height = img.height;\n\n      toast.close();\n    }\n\n    /* paste the image scaled and ratio changed between two clicks */\n    else if(mode === \"range\"){\n      const toast = await this._toastService\n        .showStickyToast(\"Paste Image\", \"Click on the canvas to select the top-left corner\", true);\n\n      let start: PointerEvent;\n      let end: PointerEvent;\n      try {\n        start = await this.waitForCanvasClick(firstValueFrom(toast.closed$));\n        toast.update(\"Paste Image\", \"Click on the canvas to select the bottom-right corner\");\n        end = await this.waitForCanvasClick(firstValueFrom(toast.closed$));\n      }\n      catch (e){\n        this._logger.debug(\"Aborted paste image\", e);\n        toast.close();\n        return;\n      }\n\n      x = Math.min(start.offsetX, end.offsetX);\n      y = Math.min(start.offsetY, end.offsetY);\n      width = Math.abs(start.offsetX - end.offsetX);\n      height = Math.abs(start.offsetY - end.offsetY);\n\n      toast.close();\n    }\n\n    await this._drawingService.drawImage(base64, x, y, width, height);\n  }\n\n  private async waitForCanvasClick(cancel?: Promise<void>): Promise<PointerEvent> {\n    const click = new Subject<PointerEvent >();\n    const listener = (e: PointerEvent) => {\n      e.stopImmediatePropagation();\n      click.next(e);\n      return false;\n    };\n\n    cancel?.then(() => {\n      click.complete();\n      events.remove(\"pointerdown\", listener);\n    });\n\n    const events = await this._canvasEventsSetup.complete();\n    events.add(\"preDraw\")(\"pointerdown\", listener);\n    const result = await firstValueFrom(click);\n    events.remove(\"pointerdown\", listener);\n    return result;\n  }\n}","<script lang=\"ts\">\n  import Checkbox from \"@/lib/checkbox/checkbox.svelte\";\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import IconButton from \"@/lib/icon-button/icon-button.svelte\";\n  import type { ToolbarImagePostFeature } from \"./toolbar-imagepost.feature\";\n\n  export let feature: ToolbarImagePostFeature;\n\n  let sendAsEmbed = true;\n  let viewIndex = 0;\n  let loading: Promise<void> | null = null;\n  const history = feature.imageHistoryStore;\n  const member = feature.memberStore;\n\n  let selectedWebhook = $member?.webhooks[0] ?? null;\n  $: viewIndex = $history.length - 1;\n</script>\n\n<style lang=\"scss\">\n\n  .typo-image-post {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    align-items: stretch;\n    gap: 1em;\n\n    img {\n      border-radius: 3px;\n    }\n\n    .navigate-image {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n\n    .not-logged-in, .typo-post-info {\n      font-weight: 600;\n      opacity: 0.7;\n    }\n  }\n\n</style>\n\n<div class=\"typo-image-post\">\n\n  {#if ($history.length > 0 && $member !== undefined && $member !== null)}\n\n    <input type=\"text\" class=\"typo\" placeholder=\"Custom image name\" bind:value={$history[viewIndex].name} />\n    <img src=\"{$history[viewIndex].image.getBase64()}\" alt=\"Post image\" />\n\n    <div class=\"navigate-image\">\n      <IconButton icon=\"file-img-arrow-left-gif\" name=\"Previous\" size=\"1.5rem\" hoverMove=\"{false}\"\n                  disabled=\"{viewIndex <= 0}\"\n                  on:click={() => viewIndex--} />\n\n      <span>{$history[viewIndex].artist} at  {$history[viewIndex].date.toLocaleTimeString()}</span>\n\n      <IconButton icon=\"file-img-arrow-right-gif\" name=\"Next\" size=\"1.5rem\" hoverMove=\"{false}\"\n                  disabled=\"{viewIndex >= $history.length - 1}\"\n        on:click={() => viewIndex++} />\n    </div>\n\n    <Checkbox bind:checked={sendAsEmbed} description=\"Send with Discord embed\" />\n\n    <div class=\"typo-post-info\">\n      Select one of your connected discord servers. When you submit, the image will appear in a channel on the server!\n    </div>\n\n    <select bind:value={selectedWebhook}>\n      {#each $member.webhooks as webhook}\n        <option value=\"{webhook}\">{webhook.name} ({webhook.guild.guildName})</option>\n      {/each}\n    </select>\n\n    {#if (selectedWebhook !== null && loading === null)}\n      <FlatButton content=\"Send to Server\" color=\"green\" on:click={() => loading = selectedWebhook ? feature.postWebhook(selectedWebhook, $history[viewIndex], !sendAsEmbed) : null} />\n    {/if}\n\n  {:else}\n    <div>The image history is empty. Check again later!</div>\n  {/if}\n\n  {#if ($member === null || $member === undefined)}\n    <div class=\"not-logged-in\">\n      Log in with your typo account to post images to one of your Discord servers!\n    </div>\n  {/if}\n</div>\n","import { GuildsApi, type MemberWebhookDto } from \"@/api\";\nimport { ApiService } from \"@/content/services/api/api.service\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { ImageFinishedService, type skribblImage } from \"@/content/services/image-finished/image-finished.service\";\nimport { ImagePostService } from \"@/content/features/toolbar-imagepost/image-post.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { inject } from \"inversify\";\nimport {\n  map,\n  mergeWith, of,\n  Subject,\n  Subscription, switchMap, take,\n} from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport ToolbarPost from \"./toolbar-imagepost.svelte\";\n\nexport class ToolbarImagePostFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(ImagePostService) private readonly _imagePostService!: ImagePostService;\n  @inject(ImageFinishedService) private readonly _imageFinishedService!: ImageFinishedService;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(ApiService) private readonly _apiService!: ApiService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n\n  public readonly name = \"Image Post\";\n  public readonly description =\n    \"Adds an icon to the typo toolbar to send images from your lobby directly to one of your connected discord servers\";\n  public readonly featureId = 11;\n\n  protected override get boundServices(){\n    return [this._imagePostService];\n  }\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n\n  private _popoutOpened$ = new Subject<void>();\n  private _submitted$ = new Subject<void>();\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach to toolbar */\n    this._iconComponent = new IconButton({\n      target: elements.toolbar,\n      props: {\n        icon: \"file-img-letter-gif\",\n        name: \"Post Image\",\n        order: 5,\n        tooltipAction: this.createTooltip,\n        lockTooltip: \"Y\"\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n      /* if already opened, return */\n      if (this._flyoutComponent) {\n        return;\n      }\n\n      this._popoutOpened$.next();\n\n      /* create fly out content */\n      const flyoutContent: componentData<ToolbarPost> = {\n        componentType: ToolbarPost,\n        props: {\n          feature: this,\n        },\n      };\n\n      /* open flyout and destroy when clicked out */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          title: \"Post Image\",\n          iconName: \"file-img-letter-gif\",\n        },\n      });\n      this._flyoutSubscription = this._flyoutComponent.closed$\n        .pipe(mergeWith(this._submitted$))\n        .subscribe(() => {\n          this._logger.info(\"Destroyed flyout\");\n          this._flyoutComponent?.$destroy();\n          this._flyoutSubscription?.unsubscribe();\n          this._flyoutComponent = undefined;\n        });\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._flyoutComponent?.$destroy();\n    this._flyoutSubscription?.unsubscribe();\n    this._flyoutComponent = undefined;\n  }\n\n  /**\n   * Gets a store based on the saved image history, joined with the current image\n   * state if someone is currently drawing\n   */\n  public get imageHistoryStore() {\n    const observable = this._imagePostService.history$.pipe( /* take current history as base */\n      switchMap((history) => this._drawingService.drawingState$.pipe(\n        take(1), /* get current drawing state once */\n        switchMap(state => {\n          if(state === \"drawing\") return this._imageFinishedService.mapToImageState(of(1)); /* if someone is drawing, fetch current image state */\n          else return of(null);\n        }),\n        map(currentImage => currentImage === null ? history : [...history, currentImage])  /* if someone drawing, temporary add current state to history */\n      ))\n    );\n    return fromObservable(observable, []);\n  }\n\n  /**\n   * Gets a store based on the authenticated member\n   */\n  public get memberStore() {\n    return fromObservable(this._memberService.memberData$, null);\n  }\n\n  /**\n   * Post an image to discord\n   * @param webhook\n   * @param image\n   * @param onlyImage\n   */\n  public async postWebhook(webhook: MemberWebhookDto, image: skribblImage, onlyImage: boolean){\n    const toast = await this._toastService.showLoadingToast(\"Posting image to \" + webhook.name);\n\n    try{\n      await this._apiService.getApi(GuildsApi).postImageToGuild({\n        token: webhook.guild.invite,\n        id: webhook.name,\n        postImageDto: {\n          title: image.name,\n          author: image.artist,\n          posterName: image.player,\n          onlyImage,\n          imageBase64: image.image.base64ApiTruncated,\n        }\n      });\n      this._submitted$.next();\n      toast.resolve();\n    }\n    catch (e) {\n      this._logger.error(\"Failed to post image to discord\", e);\n      toast.reject();\n    }\n  }\n}","export const copyBlobToClipboard = async (blob: Blob) => {\n  const data = [new ClipboardItem({ [blob.type]: blob })];\n  await navigator.clipboard.write(data);\n};","export const gifRendererWorkerBase64 = \"InVzZSBzdHJpY3QiOwooKCkgPT4gewogIHZhciBfX2NyZWF0ZSA9IE9iamVjdC5jcmVhdGU7CiAgdmFyIF9fZGVmUHJvcCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKICB2YXIgX19nZXRPd25Qcm9wRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CiAgdmFyIF9fZ2V0T3duUHJvcE5hbWVzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7CiAgdmFyIF9fZ2V0UHJvdG9PZiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjsKICB2YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKICB2YXIgX19jb21tb25KUyA9IChjYiwgbW9kKSA9PiBmdW5jdGlvbiBfX3JlcXVpcmUoKSB7CiAgICByZXR1cm4gbW9kIHx8ICgwLCBjYltfX2dldE93blByb3BOYW1lcyhjYilbMF1dKSgobW9kID0geyBleHBvcnRzOiB7fSB9KS5leHBvcnRzLCBtb2QpLCBtb2QuZXhwb3J0czsKICB9OwogIHZhciBfX2NvcHlQcm9wcyA9ICh0bywgZnJvbSwgZXhjZXB0LCBkZXNjKSA9PiB7CiAgICBpZiAoZnJvbSAmJiB0eXBlb2YgZnJvbSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGZyb20gPT09ICJmdW5jdGlvbiIpIHsKICAgICAgZm9yIChsZXQga2V5IG9mIF9fZ2V0T3duUHJvcE5hbWVzKGZyb20pKQogICAgICAgIGlmICghX19oYXNPd25Qcm9wLmNhbGwodG8sIGtleSkgJiYga2V5ICE9PSBleGNlcHQpCiAgICAgICAgICBfX2RlZlByb3AodG8sIGtleSwgeyBnZXQ6ICgpID0+IGZyb21ba2V5XSwgZW51bWVyYWJsZTogIShkZXNjID0gX19nZXRPd25Qcm9wRGVzYyhmcm9tLCBrZXkpKSB8fCBkZXNjLmVudW1lcmFibGUgfSk7CiAgICB9CiAgICByZXR1cm4gdG87CiAgfTsKICB2YXIgX190b0VTTSA9IChtb2QsIGlzTm9kZU1vZGUsIHRhcmdldCkgPT4gKHRhcmdldCA9IG1vZCAhPSBudWxsID8gX19jcmVhdGUoX19nZXRQcm90b09mKG1vZCkpIDoge30sIF9fY29weVByb3BzKAogICAgLy8gSWYgdGhlIGltcG9ydGVyIGlzIGluIG5vZGUgY29tcGF0aWJpbGl0eSBtb2RlIG9yIHRoaXMgaXMgbm90IGFuIEVTTQogICAgLy8gZmlsZSB0aGF0IGhhcyBiZWVuIGNvbnZlcnRlZCB0byBhIENvbW1vbkpTIGZpbGUgdXNpbmcgYSBCYWJlbC0KICAgIC8vIGNvbXBhdGlibGUgdHJhbnNmb3JtIChpLmUuICJfX2VzTW9kdWxlIiBoYXMgbm90IGJlZW4gc2V0KSwgdGhlbiBzZXQKICAgIC8vICJkZWZhdWx0IiB0byB0aGUgQ29tbW9uSlMgIm1vZHVsZS5leHBvcnRzIiBmb3Igbm9kZSBjb21wYXRpYmlsaXR5LgogICAgaXNOb2RlTW9kZSB8fCAhbW9kIHx8ICFtb2QuX19lc01vZHVsZSA/IF9fZGVmUHJvcCh0YXJnZXQsICJkZWZhdWx0IiwgeyB2YWx1ZTogbW9kLCBlbnVtZXJhYmxlOiB0cnVlIH0pIDogdGFyZ2V0LAogICAgbW9kCiAgKSk7CgogIC8vIG5vZGVfbW9kdWxlcy9vbWdnaWYvb21nZ2lmLmpzCiAgdmFyIHJlcXVpcmVfb21nZ2lmID0gX19jb21tb25KUyh7CiAgICAibm9kZV9tb2R1bGVzL29tZ2dpZi9vbWdnaWYuanMiKGV4cG9ydHMpIHsKICAgICAgInVzZSBzdHJpY3QiOwogICAgICBmdW5jdGlvbiBHaWZXcml0ZXIyKGJ1Ziwgd2lkdGgsIGhlaWdodCwgZ29wdHMpIHsKICAgICAgICB2YXIgcCA9IDA7CiAgICAgICAgdmFyIGdvcHRzID0gZ29wdHMgPT09IHZvaWQgMCA/IHt9IDogZ29wdHM7CiAgICAgICAgdmFyIGxvb3BfY291bnQgPSBnb3B0cy5sb29wID09PSB2b2lkIDAgPyBudWxsIDogZ29wdHMubG9vcDsKICAgICAgICB2YXIgZ2xvYmFsX3BhbGV0dGUgPSBnb3B0cy5wYWxldHRlID09PSB2b2lkIDAgPyBudWxsIDogZ29wdHMucGFsZXR0ZTsKICAgICAgICBpZiAod2lkdGggPD0gMCB8fCBoZWlnaHQgPD0gMCB8fCB3aWR0aCA+IDY1NTM1IHx8IGhlaWdodCA+IDY1NTM1KQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJXaWR0aC9IZWlnaHQgaW52YWxpZC4iKTsKICAgICAgICBmdW5jdGlvbiBjaGVja19wYWxldHRlX2FuZF9udW1fY29sb3JzKHBhbGV0dGUpIHsKICAgICAgICAgIHZhciBudW1fY29sb3JzID0gcGFsZXR0ZS5sZW5ndGg7CiAgICAgICAgICBpZiAobnVtX2NvbG9ycyA8IDIgfHwgbnVtX2NvbG9ycyA+IDI1NiB8fCBudW1fY29sb3JzICYgbnVtX2NvbG9ycyAtIDEpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICJJbnZhbGlkIGNvZGUvY29sb3IgbGVuZ3RoLCBtdXN0IGJlIHBvd2VyIG9mIDIgYW5kIDIgLi4gMjU2LiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBudW1fY29sb3JzOwogICAgICAgIH0KICAgICAgICBidWZbcCsrXSA9IDcxOwogICAgICAgIGJ1ZltwKytdID0gNzM7CiAgICAgICAgYnVmW3ArK10gPSA3MDsKICAgICAgICBidWZbcCsrXSA9IDU2OwogICAgICAgIGJ1ZltwKytdID0gNTc7CiAgICAgICAgYnVmW3ArK10gPSA5NzsKICAgICAgICB2YXIgZ3BfbnVtX2NvbG9yc19wb3cyID0gMDsKICAgICAgICB2YXIgYmFja2dyb3VuZCA9IDA7CiAgICAgICAgaWYgKGdsb2JhbF9wYWxldHRlICE9PSBudWxsKSB7CiAgICAgICAgICB2YXIgZ3BfbnVtX2NvbG9ycyA9IGNoZWNrX3BhbGV0dGVfYW5kX251bV9jb2xvcnMoZ2xvYmFsX3BhbGV0dGUpOwogICAgICAgICAgd2hpbGUgKGdwX251bV9jb2xvcnMgPj49IDEpICsrZ3BfbnVtX2NvbG9yc19wb3cyOwogICAgICAgICAgZ3BfbnVtX2NvbG9ycyA9IDEgPDwgZ3BfbnVtX2NvbG9yc19wb3cyOwogICAgICAgICAgLS1ncF9udW1fY29sb3JzX3BvdzI7CiAgICAgICAgICBpZiAoZ29wdHMuYmFja2dyb3VuZCAhPT0gdm9pZCAwKSB7CiAgICAgICAgICAgIGJhY2tncm91bmQgPSBnb3B0cy5iYWNrZ3JvdW5kOwogICAgICAgICAgICBpZiAoYmFja2dyb3VuZCA+PSBncF9udW1fY29sb3JzKQogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQmFja2dyb3VuZCBpbmRleCBvdXQgb2YgcmFuZ2UuIik7CiAgICAgICAgICAgIGlmIChiYWNrZ3JvdW5kID09PSAwKQogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQmFja2dyb3VuZCBpbmRleCBleHBsaWNpdGx5IHBhc3NlZCBhcyAwLiIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBidWZbcCsrXSA9IHdpZHRoICYgMjU1OwogICAgICAgIGJ1ZltwKytdID0gd2lkdGggPj4gOCAmIDI1NTsKICAgICAgICBidWZbcCsrXSA9IGhlaWdodCAmIDI1NTsKICAgICAgICBidWZbcCsrXSA9IGhlaWdodCA+PiA4ICYgMjU1OwogICAgICAgIGJ1ZltwKytdID0gKGdsb2JhbF9wYWxldHRlICE9PSBudWxsID8gMTI4IDogMCkgfCAvLyBHbG9iYWwgQ29sb3IgVGFibGUgRmxhZy4KICAgICAgICBncF9udW1fY29sb3JzX3BvdzI7CiAgICAgICAgYnVmW3ArK10gPSBiYWNrZ3JvdW5kOwogICAgICAgIGJ1ZltwKytdID0gMDsKICAgICAgICBpZiAoZ2xvYmFsX3BhbGV0dGUgIT09IG51bGwpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IGdsb2JhbF9wYWxldHRlLmxlbmd0aDsgaSA8IGlsOyArK2kpIHsKICAgICAgICAgICAgdmFyIHJnYiA9IGdsb2JhbF9wYWxldHRlW2ldOwogICAgICAgICAgICBidWZbcCsrXSA9IHJnYiA+PiAxNiAmIDI1NTsKICAgICAgICAgICAgYnVmW3ArK10gPSByZ2IgPj4gOCAmIDI1NTsKICAgICAgICAgICAgYnVmW3ArK10gPSByZ2IgJiAyNTU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChsb29wX2NvdW50ICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAobG9vcF9jb3VudCA8IDAgfHwgbG9vcF9jb3VudCA+IDY1NTM1KQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkxvb3AgY291bnQgaW52YWxpZC4iKTsKICAgICAgICAgIGJ1ZltwKytdID0gMzM7CiAgICAgICAgICBidWZbcCsrXSA9IDI1NTsKICAgICAgICAgIGJ1ZltwKytdID0gMTE7CiAgICAgICAgICBidWZbcCsrXSA9IDc4OwogICAgICAgICAgYnVmW3ArK10gPSA2OTsKICAgICAgICAgIGJ1ZltwKytdID0gODQ7CiAgICAgICAgICBidWZbcCsrXSA9IDgzOwogICAgICAgICAgYnVmW3ArK10gPSA2NzsKICAgICAgICAgIGJ1ZltwKytdID0gNjU7CiAgICAgICAgICBidWZbcCsrXSA9IDgwOwogICAgICAgICAgYnVmW3ArK10gPSA2OTsKICAgICAgICAgIGJ1ZltwKytdID0gNTA7CiAgICAgICAgICBidWZbcCsrXSA9IDQ2OwogICAgICAgICAgYnVmW3ArK10gPSA0ODsKICAgICAgICAgIGJ1ZltwKytdID0gMzsKICAgICAgICAgIGJ1ZltwKytdID0gMTsKICAgICAgICAgIGJ1ZltwKytdID0gbG9vcF9jb3VudCAmIDI1NTsKICAgICAgICAgIGJ1ZltwKytdID0gbG9vcF9jb3VudCA+PiA4ICYgMjU1OwogICAgICAgICAgYnVmW3ArK10gPSAwOwogICAgICAgIH0KICAgICAgICB2YXIgZW5kZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLmFkZEZyYW1lID0gZnVuY3Rpb24oeCwgeSwgdywgaCwgaW5kZXhlZF9waXhlbHMsIG9wdHMpIHsKICAgICAgICAgIGlmIChlbmRlZCA9PT0gdHJ1ZSkgewogICAgICAgICAgICAtLXA7CiAgICAgICAgICAgIGVuZGVkID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBvcHRzID0gb3B0cyA9PT0gdm9pZCAwID8ge30gOiBvcHRzOwogICAgICAgICAgaWYgKHggPCAwIHx8IHkgPCAwIHx8IHggPiA2NTUzNSB8fCB5ID4gNjU1MzUpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigieC95IGludmFsaWQuIik7CiAgICAgICAgICBpZiAodyA8PSAwIHx8IGggPD0gMCB8fCB3ID4gNjU1MzUgfHwgaCA+IDY1NTM1KQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIldpZHRoL0hlaWdodCBpbnZhbGlkLiIpOwogICAgICAgICAgaWYgKGluZGV4ZWRfcGl4ZWxzLmxlbmd0aCA8IHcgKiBoKQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk5vdCBlbm91Z2ggcGl4ZWxzIGZvciB0aGUgZnJhbWUgc2l6ZS4iKTsKICAgICAgICAgIHZhciB1c2luZ19sb2NhbF9wYWxldHRlID0gdHJ1ZTsKICAgICAgICAgIHZhciBwYWxldHRlID0gb3B0cy5wYWxldHRlOwogICAgICAgICAgaWYgKHBhbGV0dGUgPT09IHZvaWQgMCB8fCBwYWxldHRlID09PSBudWxsKSB7CiAgICAgICAgICAgIHVzaW5nX2xvY2FsX3BhbGV0dGUgPSBmYWxzZTsKICAgICAgICAgICAgcGFsZXR0ZSA9IGdsb2JhbF9wYWxldHRlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHBhbGV0dGUgPT09IHZvaWQgMCB8fCBwYWxldHRlID09PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk11c3Qgc3VwcGx5IGVpdGhlciBhIGxvY2FsIG9yIGdsb2JhbCBwYWxldHRlLiIpOwogICAgICAgICAgdmFyIG51bV9jb2xvcnMgPSBjaGVja19wYWxldHRlX2FuZF9udW1fY29sb3JzKHBhbGV0dGUpOwogICAgICAgICAgdmFyIG1pbl9jb2RlX3NpemUgPSAwOwogICAgICAgICAgd2hpbGUgKG51bV9jb2xvcnMgPj49IDEpICsrbWluX2NvZGVfc2l6ZTsKICAgICAgICAgIG51bV9jb2xvcnMgPSAxIDw8IG1pbl9jb2RlX3NpemU7CiAgICAgICAgICB2YXIgZGVsYXkgPSBvcHRzLmRlbGF5ID09PSB2b2lkIDAgPyAwIDogb3B0cy5kZWxheTsKICAgICAgICAgIHZhciBkaXNwb3NhbCA9IG9wdHMuZGlzcG9zYWwgPT09IHZvaWQgMCA/IDAgOiBvcHRzLmRpc3Bvc2FsOwogICAgICAgICAgaWYgKGRpc3Bvc2FsIDwgMCB8fCBkaXNwb3NhbCA+IDMpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRGlzcG9zYWwgb3V0IG9mIHJhbmdlLiIpOwogICAgICAgICAgdmFyIHVzZV90cmFuc3BhcmVuY3kgPSBmYWxzZTsKICAgICAgICAgIHZhciB0cmFuc3BhcmVudF9pbmRleCA9IDA7CiAgICAgICAgICBpZiAob3B0cy50cmFuc3BhcmVudCAhPT0gdm9pZCAwICYmIG9wdHMudHJhbnNwYXJlbnQgIT09IG51bGwpIHsKICAgICAgICAgICAgdXNlX3RyYW5zcGFyZW5jeSA9IHRydWU7CiAgICAgICAgICAgIHRyYW5zcGFyZW50X2luZGV4ID0gb3B0cy50cmFuc3BhcmVudDsKICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50X2luZGV4IDwgMCB8fCB0cmFuc3BhcmVudF9pbmRleCA+PSBudW1fY29sb3JzKQogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVHJhbnNwYXJlbnQgY29sb3IgaW5kZXguIik7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZGlzcG9zYWwgIT09IDAgfHwgdXNlX3RyYW5zcGFyZW5jeSB8fCBkZWxheSAhPT0gMCkgewogICAgICAgICAgICBidWZbcCsrXSA9IDMzOwogICAgICAgICAgICBidWZbcCsrXSA9IDI0OTsKICAgICAgICAgICAgYnVmW3ArK10gPSA0OwogICAgICAgICAgICBidWZbcCsrXSA9IGRpc3Bvc2FsIDw8IDIgfCAodXNlX3RyYW5zcGFyZW5jeSA9PT0gdHJ1ZSA/IDEgOiAwKTsKICAgICAgICAgICAgYnVmW3ArK10gPSBkZWxheSAmIDI1NTsKICAgICAgICAgICAgYnVmW3ArK10gPSBkZWxheSA+PiA4ICYgMjU1OwogICAgICAgICAgICBidWZbcCsrXSA9IHRyYW5zcGFyZW50X2luZGV4OwogICAgICAgICAgICBidWZbcCsrXSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgICBidWZbcCsrXSA9IDQ0OwogICAgICAgICAgYnVmW3ArK10gPSB4ICYgMjU1OwogICAgICAgICAgYnVmW3ArK10gPSB4ID4+IDggJiAyNTU7CiAgICAgICAgICBidWZbcCsrXSA9IHkgJiAyNTU7CiAgICAgICAgICBidWZbcCsrXSA9IHkgPj4gOCAmIDI1NTsKICAgICAgICAgIGJ1ZltwKytdID0gdyAmIDI1NTsKICAgICAgICAgIGJ1ZltwKytdID0gdyA+PiA4ICYgMjU1OwogICAgICAgICAgYnVmW3ArK10gPSBoICYgMjU1OwogICAgICAgICAgYnVmW3ArK10gPSBoID4+IDggJiAyNTU7CiAgICAgICAgICBidWZbcCsrXSA9IHVzaW5nX2xvY2FsX3BhbGV0dGUgPT09IHRydWUgPyAxMjggfCBtaW5fY29kZV9zaXplIC0gMSA6IDA7CiAgICAgICAgICBpZiAodXNpbmdfbG9jYWxfcGFsZXR0ZSA9PT0gdHJ1ZSkgewogICAgICAgICAgICBmb3IgKHZhciBpMiA9IDAsIGlsMiA9IHBhbGV0dGUubGVuZ3RoOyBpMiA8IGlsMjsgKytpMikgewogICAgICAgICAgICAgIHZhciByZ2IyID0gcGFsZXR0ZVtpMl07CiAgICAgICAgICAgICAgYnVmW3ArK10gPSByZ2IyID4+IDE2ICYgMjU1OwogICAgICAgICAgICAgIGJ1ZltwKytdID0gcmdiMiA+PiA4ICYgMjU1OwogICAgICAgICAgICAgIGJ1ZltwKytdID0gcmdiMiAmIDI1NTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcCA9IEdpZldyaXRlck91dHB1dExaV0NvZGVTdHJlYW0oCiAgICAgICAgICAgIGJ1ZiwKICAgICAgICAgICAgcCwKICAgICAgICAgICAgbWluX2NvZGVfc2l6ZSA8IDIgPyAyIDogbWluX2NvZGVfc2l6ZSwKICAgICAgICAgICAgaW5kZXhlZF9waXhlbHMKICAgICAgICAgICk7CiAgICAgICAgICByZXR1cm4gcDsKICAgICAgICB9OwogICAgICAgIHRoaXMuZW5kID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAoZW5kZWQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGJ1ZltwKytdID0gNTk7CiAgICAgICAgICAgIGVuZGVkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CiAgICAgICAgdGhpcy5nZXRPdXRwdXRCdWZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBidWY7CiAgICAgICAgfTsKICAgICAgICB0aGlzLnNldE91dHB1dEJ1ZmZlciA9IGZ1bmN0aW9uKHYpIHsKICAgICAgICAgIGJ1ZiA9IHY7CiAgICAgICAgfTsKICAgICAgICB0aGlzLmdldE91dHB1dEJ1ZmZlclBvc2l0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gcDsKICAgICAgICB9OwogICAgICAgIHRoaXMuc2V0T3V0cHV0QnVmZmVyUG9zaXRpb24gPSBmdW5jdGlvbih2KSB7CiAgICAgICAgICBwID0gdjsKICAgICAgICB9OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIEdpZldyaXRlck91dHB1dExaV0NvZGVTdHJlYW0oYnVmLCBwLCBtaW5fY29kZV9zaXplLCBpbmRleF9zdHJlYW0pIHsKICAgICAgICBidWZbcCsrXSA9IG1pbl9jb2RlX3NpemU7CiAgICAgICAgdmFyIGN1cl9zdWJibG9jayA9IHArKzsKICAgICAgICB2YXIgY2xlYXJfY29kZSA9IDEgPDwgbWluX2NvZGVfc2l6ZTsKICAgICAgICB2YXIgY29kZV9tYXNrID0gY2xlYXJfY29kZSAtIDE7CiAgICAgICAgdmFyIGVvaV9jb2RlID0gY2xlYXJfY29kZSArIDE7CiAgICAgICAgdmFyIG5leHRfY29kZSA9IGVvaV9jb2RlICsgMTsKICAgICAgICB2YXIgY3VyX2NvZGVfc2l6ZSA9IG1pbl9jb2RlX3NpemUgKyAxOwogICAgICAgIHZhciBjdXJfc2hpZnQgPSAwOwogICAgICAgIHZhciBjdXIgPSAwOwogICAgICAgIGZ1bmN0aW9uIGVtaXRfYnl0ZXNfdG9fYnVmZmVyKGJpdF9ibG9ja19zaXplKSB7CiAgICAgICAgICB3aGlsZSAoY3VyX3NoaWZ0ID49IGJpdF9ibG9ja19zaXplKSB7CiAgICAgICAgICAgIGJ1ZltwKytdID0gY3VyICYgMjU1OwogICAgICAgICAgICBjdXIgPj49IDg7CiAgICAgICAgICAgIGN1cl9zaGlmdCAtPSA4OwogICAgICAgICAgICBpZiAocCA9PT0gY3VyX3N1YmJsb2NrICsgMjU2KSB7CiAgICAgICAgICAgICAgYnVmW2N1cl9zdWJibG9ja10gPSAyNTU7CiAgICAgICAgICAgICAgY3VyX3N1YmJsb2NrID0gcCsrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIGVtaXRfY29kZShjKSB7CiAgICAgICAgICBjdXIgfD0gYyA8PCBjdXJfc2hpZnQ7CiAgICAgICAgICBjdXJfc2hpZnQgKz0gY3VyX2NvZGVfc2l6ZTsKICAgICAgICAgIGVtaXRfYnl0ZXNfdG9fYnVmZmVyKDgpOwogICAgICAgIH0KICAgICAgICB2YXIgaWJfY29kZSA9IGluZGV4X3N0cmVhbVswXSAmIGNvZGVfbWFzazsKICAgICAgICB2YXIgY29kZV90YWJsZSA9IHt9OwogICAgICAgIGVtaXRfY29kZShjbGVhcl9jb2RlKTsKICAgICAgICBmb3IgKHZhciBpID0gMSwgaWwgPSBpbmRleF9zdHJlYW0ubGVuZ3RoOyBpIDwgaWw7ICsraSkgewogICAgICAgICAgdmFyIGsgPSBpbmRleF9zdHJlYW1baV0gJiBjb2RlX21hc2s7CiAgICAgICAgICB2YXIgY3VyX2tleSA9IGliX2NvZGUgPDwgOCB8IGs7CiAgICAgICAgICB2YXIgY3VyX2NvZGUgPSBjb2RlX3RhYmxlW2N1cl9rZXldOwogICAgICAgICAgaWYgKGN1cl9jb2RlID09PSB2b2lkIDApIHsKICAgICAgICAgICAgY3VyIHw9IGliX2NvZGUgPDwgY3VyX3NoaWZ0OwogICAgICAgICAgICBjdXJfc2hpZnQgKz0gY3VyX2NvZGVfc2l6ZTsKICAgICAgICAgICAgd2hpbGUgKGN1cl9zaGlmdCA+PSA4KSB7CiAgICAgICAgICAgICAgYnVmW3ArK10gPSBjdXIgJiAyNTU7CiAgICAgICAgICAgICAgY3VyID4+PSA4OwogICAgICAgICAgICAgIGN1cl9zaGlmdCAtPSA4OwogICAgICAgICAgICAgIGlmIChwID09PSBjdXJfc3ViYmxvY2sgKyAyNTYpIHsKICAgICAgICAgICAgICAgIGJ1ZltjdXJfc3ViYmxvY2tdID0gMjU1OwogICAgICAgICAgICAgICAgY3VyX3N1YmJsb2NrID0gcCsrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobmV4dF9jb2RlID09PSA0MDk2KSB7CiAgICAgICAgICAgICAgZW1pdF9jb2RlKGNsZWFyX2NvZGUpOwogICAgICAgICAgICAgIG5leHRfY29kZSA9IGVvaV9jb2RlICsgMTsKICAgICAgICAgICAgICBjdXJfY29kZV9zaXplID0gbWluX2NvZGVfc2l6ZSArIDE7CiAgICAgICAgICAgICAgY29kZV90YWJsZSA9IHt9OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmIChuZXh0X2NvZGUgPj0gMSA8PCBjdXJfY29kZV9zaXplKSArK2N1cl9jb2RlX3NpemU7CiAgICAgICAgICAgICAgY29kZV90YWJsZVtjdXJfa2V5XSA9IG5leHRfY29kZSsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGliX2NvZGUgPSBrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWJfY29kZSA9IGN1cl9jb2RlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbWl0X2NvZGUoaWJfY29kZSk7CiAgICAgICAgZW1pdF9jb2RlKGVvaV9jb2RlKTsKICAgICAgICBlbWl0X2J5dGVzX3RvX2J1ZmZlcigxKTsKICAgICAgICBpZiAoY3VyX3N1YmJsb2NrICsgMSA9PT0gcCkgewogICAgICAgICAgYnVmW2N1cl9zdWJibG9ja10gPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBidWZbY3VyX3N1YmJsb2NrXSA9IHAgLSBjdXJfc3ViYmxvY2sgLSAxOwogICAgICAgICAgYnVmW3ArK10gPSAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcDsKICAgICAgfQogICAgICBmdW5jdGlvbiBHaWZSZWFkZXIoYnVmKSB7CiAgICAgICAgdmFyIHAgPSAwOwogICAgICAgIGlmIChidWZbcCsrXSAhPT0gNzEgfHwgYnVmW3ArK10gIT09IDczIHx8IGJ1ZltwKytdICE9PSA3MCB8fCBidWZbcCsrXSAhPT0gNTYgfHwgKGJ1ZltwKytdICsgMSAmIDI1MykgIT09IDU2IHx8IGJ1ZltwKytdICE9PSA5NykgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIEdJRiA4N2EvODlhIGhlYWRlci4iKTsKICAgICAgICB9CiAgICAgICAgdmFyIHdpZHRoID0gYnVmW3ArK10gfCBidWZbcCsrXSA8PCA4OwogICAgICAgIHZhciBoZWlnaHQgPSBidWZbcCsrXSB8IGJ1ZltwKytdIDw8IDg7CiAgICAgICAgdmFyIHBmMCA9IGJ1ZltwKytdOwogICAgICAgIHZhciBnbG9iYWxfcGFsZXR0ZV9mbGFnID0gcGYwID4+IDc7CiAgICAgICAgdmFyIG51bV9nbG9iYWxfY29sb3JzX3BvdzIgPSBwZjAgJiA3OwogICAgICAgIHZhciBudW1fZ2xvYmFsX2NvbG9ycyA9IDEgPDwgbnVtX2dsb2JhbF9jb2xvcnNfcG93MiArIDE7CiAgICAgICAgdmFyIGJhY2tncm91bmQgPSBidWZbcCsrXTsKICAgICAgICBidWZbcCsrXTsKICAgICAgICB2YXIgZ2xvYmFsX3BhbGV0dGVfb2Zmc2V0ID0gbnVsbDsKICAgICAgICB2YXIgZ2xvYmFsX3BhbGV0dGVfc2l6ZSA9IG51bGw7CiAgICAgICAgaWYgKGdsb2JhbF9wYWxldHRlX2ZsYWcpIHsKICAgICAgICAgIGdsb2JhbF9wYWxldHRlX29mZnNldCA9IHA7CiAgICAgICAgICBnbG9iYWxfcGFsZXR0ZV9zaXplID0gbnVtX2dsb2JhbF9jb2xvcnM7CiAgICAgICAgICBwICs9IG51bV9nbG9iYWxfY29sb3JzICogMzsKICAgICAgICB9CiAgICAgICAgdmFyIG5vX2VvZiA9IHRydWU7CiAgICAgICAgdmFyIGZyYW1lcyA9IFtdOwogICAgICAgIHZhciBkZWxheSA9IDA7CiAgICAgICAgdmFyIHRyYW5zcGFyZW50X2luZGV4ID0gbnVsbDsKICAgICAgICB2YXIgZGlzcG9zYWwgPSAwOwogICAgICAgIHZhciBsb29wX2NvdW50ID0gbnVsbDsKICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgd2hpbGUgKG5vX2VvZiAmJiBwIDwgYnVmLmxlbmd0aCkgewogICAgICAgICAgc3dpdGNoIChidWZbcCsrXSkgewogICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgIHN3aXRjaCAoYnVmW3ArK10pIHsKICAgICAgICAgICAgICAgIGNhc2UgMjU1OgogICAgICAgICAgICAgICAgICBpZiAoYnVmW3BdICE9PSAxMSB8fCAvLyAyMSBGRiBhbHJlYWR5IHJlYWQsIGNoZWNrIGJsb2NrIHNpemUuCiAgICAgICAgICAgICAgICAgIC8vIE5FVFNDQVBFMi4wCiAgICAgICAgICAgICAgICAgIGJ1ZltwICsgMV0gPT0gNzggJiYgYnVmW3AgKyAyXSA9PSA2OSAmJiBidWZbcCArIDNdID09IDg0ICYmIGJ1ZltwICsgNF0gPT0gODMgJiYgYnVmW3AgKyA1XSA9PSA2NyAmJiBidWZbcCArIDZdID09IDY1ICYmIGJ1ZltwICsgN10gPT0gODAgJiYgYnVmW3AgKyA4XSA9PSA2OSAmJiBidWZbcCArIDldID09IDUwICYmIGJ1ZltwICsgMTBdID09IDQ2ICYmIGJ1ZltwICsgMTFdID09IDQ4ICYmIC8vIFN1Yi1ibG9jawogICAgICAgICAgICAgICAgICBidWZbcCArIDEyXSA9PSAzICYmIGJ1ZltwICsgMTNdID09IDEgJiYgYnVmW3AgKyAxNl0gPT0gMCkgewogICAgICAgICAgICAgICAgICAgIHAgKz0gMTQ7CiAgICAgICAgICAgICAgICAgICAgbG9vcF9jb3VudCA9IGJ1ZltwKytdIHwgYnVmW3ArK10gPDwgODsKICAgICAgICAgICAgICAgICAgICBwKys7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcCArPSAxMjsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGJsb2NrX3NpemUgPSBidWZbcCsrXTsKICAgICAgICAgICAgICAgICAgICAgIGlmICghKGJsb2NrX3NpemUgPj0gMCkpIHRocm93IEVycm9yKCJJbnZhbGlkIGJsb2NrIHNpemUiKTsKICAgICAgICAgICAgICAgICAgICAgIGlmIChibG9ja19zaXplID09PSAwKSBicmVhazsKICAgICAgICAgICAgICAgICAgICAgIHAgKz0gYmxvY2tfc2l6ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDI0OToKICAgICAgICAgICAgICAgICAgaWYgKGJ1ZltwKytdICE9PSA0IHx8IGJ1ZltwICsgNF0gIT09IDApCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGdyYXBoaWNzIGV4dGVuc2lvbiBibG9jay4iKTsKICAgICAgICAgICAgICAgICAgdmFyIHBmMSA9IGJ1ZltwKytdOwogICAgICAgICAgICAgICAgICBkZWxheSA9IGJ1ZltwKytdIHwgYnVmW3ArK10gPDwgODsKICAgICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRfaW5kZXggPSBidWZbcCsrXTsKICAgICAgICAgICAgICAgICAgaWYgKChwZjEgJiAxKSA9PT0gMCkgdHJhbnNwYXJlbnRfaW5kZXggPSBudWxsOwogICAgICAgICAgICAgICAgICBkaXNwb3NhbCA9IHBmMSA+PiAyICYgNzsKICAgICAgICAgICAgICAgICAgcCsrOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjU0OgogICAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBibG9ja19zaXplID0gYnVmW3ArK107CiAgICAgICAgICAgICAgICAgICAgaWYgKCEoYmxvY2tfc2l6ZSA+PSAwKSkgdGhyb3cgRXJyb3IoIkludmFsaWQgYmxvY2sgc2l6ZSIpOwogICAgICAgICAgICAgICAgICAgIGlmIChibG9ja19zaXplID09PSAwKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBwICs9IGJsb2NrX3NpemU7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgIlVua25vd24gZ3JhcGhpYyBjb250cm9sIGxhYmVsOiAweCIgKyBidWZbcCAtIDFdLnRvU3RyaW5nKDE2KQogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgICB2YXIgeCA9IGJ1ZltwKytdIHwgYnVmW3ArK10gPDwgODsKICAgICAgICAgICAgICB2YXIgeSA9IGJ1ZltwKytdIHwgYnVmW3ArK10gPDwgODsKICAgICAgICAgICAgICB2YXIgdyA9IGJ1ZltwKytdIHwgYnVmW3ArK10gPDwgODsKICAgICAgICAgICAgICB2YXIgaCA9IGJ1ZltwKytdIHwgYnVmW3ArK10gPDwgODsKICAgICAgICAgICAgICB2YXIgcGYyID0gYnVmW3ArK107CiAgICAgICAgICAgICAgdmFyIGxvY2FsX3BhbGV0dGVfZmxhZyA9IHBmMiA+PiA3OwogICAgICAgICAgICAgIHZhciBpbnRlcmxhY2VfZmxhZyA9IHBmMiA+PiA2ICYgMTsKICAgICAgICAgICAgICB2YXIgbnVtX2xvY2FsX2NvbG9yc19wb3cyID0gcGYyICYgNzsKICAgICAgICAgICAgICB2YXIgbnVtX2xvY2FsX2NvbG9ycyA9IDEgPDwgbnVtX2xvY2FsX2NvbG9yc19wb3cyICsgMTsKICAgICAgICAgICAgICB2YXIgcGFsZXR0ZV9vZmZzZXQgPSBnbG9iYWxfcGFsZXR0ZV9vZmZzZXQ7CiAgICAgICAgICAgICAgdmFyIHBhbGV0dGVfc2l6ZSA9IGdsb2JhbF9wYWxldHRlX3NpemU7CiAgICAgICAgICAgICAgdmFyIGhhc19sb2NhbF9wYWxldHRlID0gZmFsc2U7CiAgICAgICAgICAgICAgaWYgKGxvY2FsX3BhbGV0dGVfZmxhZykgewogICAgICAgICAgICAgICAgdmFyIGhhc19sb2NhbF9wYWxldHRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHBhbGV0dGVfb2Zmc2V0ID0gcDsKICAgICAgICAgICAgICAgIHBhbGV0dGVfc2l6ZSA9IG51bV9sb2NhbF9jb2xvcnM7CiAgICAgICAgICAgICAgICBwICs9IG51bV9sb2NhbF9jb2xvcnMgKiAzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YXIgZGF0YV9vZmZzZXQgPSBwOwogICAgICAgICAgICAgIHArKzsKICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgdmFyIGJsb2NrX3NpemUgPSBidWZbcCsrXTsKICAgICAgICAgICAgICAgIGlmICghKGJsb2NrX3NpemUgPj0gMCkpIHRocm93IEVycm9yKCJJbnZhbGlkIGJsb2NrIHNpemUiKTsKICAgICAgICAgICAgICAgIGlmIChibG9ja19zaXplID09PSAwKSBicmVhazsKICAgICAgICAgICAgICAgIHAgKz0gYmxvY2tfc2l6ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZnJhbWVzLnB1c2goewogICAgICAgICAgICAgICAgeCwKICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICB3aWR0aDogdywKICAgICAgICAgICAgICAgIGhlaWdodDogaCwKICAgICAgICAgICAgICAgIGhhc19sb2NhbF9wYWxldHRlLAogICAgICAgICAgICAgICAgcGFsZXR0ZV9vZmZzZXQsCiAgICAgICAgICAgICAgICBwYWxldHRlX3NpemUsCiAgICAgICAgICAgICAgICBkYXRhX29mZnNldCwKICAgICAgICAgICAgICAgIGRhdGFfbGVuZ3RoOiBwIC0gZGF0YV9vZmZzZXQsCiAgICAgICAgICAgICAgICB0cmFuc3BhcmVudF9pbmRleCwKICAgICAgICAgICAgICAgIGludGVybGFjZWQ6ICEhaW50ZXJsYWNlX2ZsYWcsCiAgICAgICAgICAgICAgICBkZWxheSwKICAgICAgICAgICAgICAgIGRpc3Bvc2FsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNTk6CiAgICAgICAgICAgICAgbm9fZW9mID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIGdpZiBibG9jazogMHgiICsgYnVmW3AgLSAxXS50b1N0cmluZygxNikpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLm51bUZyYW1lcyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIGZyYW1lcy5sZW5ndGg7CiAgICAgICAgfTsKICAgICAgICB0aGlzLmxvb3BDb3VudCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIGxvb3BfY291bnQ7CiAgICAgICAgfTsKICAgICAgICB0aGlzLmZyYW1lSW5mbyA9IGZ1bmN0aW9uKGZyYW1lX251bSkgewogICAgICAgICAgaWYgKGZyYW1lX251bSA8IDAgfHwgZnJhbWVfbnVtID49IGZyYW1lcy5sZW5ndGgpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRnJhbWUgaW5kZXggb3V0IG9mIHJhbmdlLiIpOwogICAgICAgICAgcmV0dXJuIGZyYW1lc1tmcmFtZV9udW1dOwogICAgICAgIH07CiAgICAgICAgdGhpcy5kZWNvZGVBbmRCbGl0RnJhbWVCR1JBID0gZnVuY3Rpb24oZnJhbWVfbnVtLCBwaXhlbHMpIHsKICAgICAgICAgIHZhciBmcmFtZSA9IHRoaXMuZnJhbWVJbmZvKGZyYW1lX251bSk7CiAgICAgICAgICB2YXIgbnVtX3BpeGVscyA9IGZyYW1lLndpZHRoICogZnJhbWUuaGVpZ2h0OwogICAgICAgICAgdmFyIGluZGV4X3N0cmVhbSA9IG5ldyBVaW50OEFycmF5KG51bV9waXhlbHMpOwogICAgICAgICAgR2lmUmVhZGVyTFpXT3V0cHV0SW5kZXhTdHJlYW0oCiAgICAgICAgICAgIGJ1ZiwKICAgICAgICAgICAgZnJhbWUuZGF0YV9vZmZzZXQsCiAgICAgICAgICAgIGluZGV4X3N0cmVhbSwKICAgICAgICAgICAgbnVtX3BpeGVscwogICAgICAgICAgKTsKICAgICAgICAgIHZhciBwYWxldHRlX29mZnNldDIgPSBmcmFtZS5wYWxldHRlX29mZnNldDsKICAgICAgICAgIHZhciB0cmFucyA9IGZyYW1lLnRyYW5zcGFyZW50X2luZGV4OwogICAgICAgICAgaWYgKHRyYW5zID09PSBudWxsKSB0cmFucyA9IDI1NjsKICAgICAgICAgIHZhciBmcmFtZXdpZHRoID0gZnJhbWUud2lkdGg7CiAgICAgICAgICB2YXIgZnJhbWVzdHJpZGUgPSB3aWR0aCAtIGZyYW1ld2lkdGg7CiAgICAgICAgICB2YXIgeGxlZnQgPSBmcmFtZXdpZHRoOwogICAgICAgICAgdmFyIG9wYmVnID0gKGZyYW1lLnkgKiB3aWR0aCArIGZyYW1lLngpICogNDsKICAgICAgICAgIHZhciBvcGVuZCA9ICgoZnJhbWUueSArIGZyYW1lLmhlaWdodCkgKiB3aWR0aCArIGZyYW1lLngpICogNDsKICAgICAgICAgIHZhciBvcCA9IG9wYmVnOwogICAgICAgICAgdmFyIHNjYW5zdHJpZGUgPSBmcmFtZXN0cmlkZSAqIDQ7CiAgICAgICAgICBpZiAoZnJhbWUuaW50ZXJsYWNlZCA9PT0gdHJ1ZSkgewogICAgICAgICAgICBzY2Fuc3RyaWRlICs9IHdpZHRoICogNCAqIDc7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgaW50ZXJsYWNlc2tpcCA9IDg7CiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBpbmRleF9zdHJlYW0ubGVuZ3RoOyBpIDwgaWw7ICsraSkgewogICAgICAgICAgICB2YXIgaW5kZXggPSBpbmRleF9zdHJlYW1baV07CiAgICAgICAgICAgIGlmICh4bGVmdCA9PT0gMCkgewogICAgICAgICAgICAgIG9wICs9IHNjYW5zdHJpZGU7CiAgICAgICAgICAgICAgeGxlZnQgPSBmcmFtZXdpZHRoOwogICAgICAgICAgICAgIGlmIChvcCA+PSBvcGVuZCkgewogICAgICAgICAgICAgICAgc2NhbnN0cmlkZSA9IGZyYW1lc3RyaWRlICogNCArIHdpZHRoICogNCAqIChpbnRlcmxhY2Vza2lwIC0gMSk7CiAgICAgICAgICAgICAgICBvcCA9IG9wYmVnICsgKGZyYW1ld2lkdGggKyBmcmFtZXN0cmlkZSkgKiAoaW50ZXJsYWNlc2tpcCA8PCAxKTsKICAgICAgICAgICAgICAgIGludGVybGFjZXNraXAgPj49IDE7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdHJhbnMpIHsKICAgICAgICAgICAgICBvcCArPSA0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciByID0gYnVmW3BhbGV0dGVfb2Zmc2V0MiArIGluZGV4ICogM107CiAgICAgICAgICAgICAgdmFyIGcgPSBidWZbcGFsZXR0ZV9vZmZzZXQyICsgaW5kZXggKiAzICsgMV07CiAgICAgICAgICAgICAgdmFyIGIgPSBidWZbcGFsZXR0ZV9vZmZzZXQyICsgaW5kZXggKiAzICsgMl07CiAgICAgICAgICAgICAgcGl4ZWxzW29wKytdID0gYjsKICAgICAgICAgICAgICBwaXhlbHNbb3ArK10gPSBnOwogICAgICAgICAgICAgIHBpeGVsc1tvcCsrXSA9IHI7CiAgICAgICAgICAgICAgcGl4ZWxzW29wKytdID0gMjU1OwogICAgICAgICAgICB9CiAgICAgICAgICAgIC0teGxlZnQ7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICB0aGlzLmRlY29kZUFuZEJsaXRGcmFtZVJHQkEgPSBmdW5jdGlvbihmcmFtZV9udW0sIHBpeGVscykgewogICAgICAgICAgdmFyIGZyYW1lID0gdGhpcy5mcmFtZUluZm8oZnJhbWVfbnVtKTsKICAgICAgICAgIHZhciBudW1fcGl4ZWxzID0gZnJhbWUud2lkdGggKiBmcmFtZS5oZWlnaHQ7CiAgICAgICAgICB2YXIgaW5kZXhfc3RyZWFtID0gbmV3IFVpbnQ4QXJyYXkobnVtX3BpeGVscyk7CiAgICAgICAgICBHaWZSZWFkZXJMWldPdXRwdXRJbmRleFN0cmVhbSgKICAgICAgICAgICAgYnVmLAogICAgICAgICAgICBmcmFtZS5kYXRhX29mZnNldCwKICAgICAgICAgICAgaW5kZXhfc3RyZWFtLAogICAgICAgICAgICBudW1fcGl4ZWxzCiAgICAgICAgICApOwogICAgICAgICAgdmFyIHBhbGV0dGVfb2Zmc2V0MiA9IGZyYW1lLnBhbGV0dGVfb2Zmc2V0OwogICAgICAgICAgdmFyIHRyYW5zID0gZnJhbWUudHJhbnNwYXJlbnRfaW5kZXg7CiAgICAgICAgICBpZiAodHJhbnMgPT09IG51bGwpIHRyYW5zID0gMjU2OwogICAgICAgICAgdmFyIGZyYW1ld2lkdGggPSBmcmFtZS53aWR0aDsKICAgICAgICAgIHZhciBmcmFtZXN0cmlkZSA9IHdpZHRoIC0gZnJhbWV3aWR0aDsKICAgICAgICAgIHZhciB4bGVmdCA9IGZyYW1ld2lkdGg7CiAgICAgICAgICB2YXIgb3BiZWcgPSAoZnJhbWUueSAqIHdpZHRoICsgZnJhbWUueCkgKiA0OwogICAgICAgICAgdmFyIG9wZW5kID0gKChmcmFtZS55ICsgZnJhbWUuaGVpZ2h0KSAqIHdpZHRoICsgZnJhbWUueCkgKiA0OwogICAgICAgICAgdmFyIG9wID0gb3BiZWc7CiAgICAgICAgICB2YXIgc2NhbnN0cmlkZSA9IGZyYW1lc3RyaWRlICogNDsKICAgICAgICAgIGlmIChmcmFtZS5pbnRlcmxhY2VkID09PSB0cnVlKSB7CiAgICAgICAgICAgIHNjYW5zdHJpZGUgKz0gd2lkdGggKiA0ICogNzsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBpbnRlcmxhY2Vza2lwID0gODsKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IGluZGV4X3N0cmVhbS5sZW5ndGg7IGkgPCBpbDsgKytpKSB7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGluZGV4X3N0cmVhbVtpXTsKICAgICAgICAgICAgaWYgKHhsZWZ0ID09PSAwKSB7CiAgICAgICAgICAgICAgb3AgKz0gc2NhbnN0cmlkZTsKICAgICAgICAgICAgICB4bGVmdCA9IGZyYW1ld2lkdGg7CiAgICAgICAgICAgICAgaWYgKG9wID49IG9wZW5kKSB7CiAgICAgICAgICAgICAgICBzY2Fuc3RyaWRlID0gZnJhbWVzdHJpZGUgKiA0ICsgd2lkdGggKiA0ICogKGludGVybGFjZXNraXAgLSAxKTsKICAgICAgICAgICAgICAgIG9wID0gb3BiZWcgKyAoZnJhbWV3aWR0aCArIGZyYW1lc3RyaWRlKSAqIChpbnRlcmxhY2Vza2lwIDw8IDEpOwogICAgICAgICAgICAgICAgaW50ZXJsYWNlc2tpcCA+Pj0gMTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0cmFucykgewogICAgICAgICAgICAgIG9wICs9IDQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdmFyIHIgPSBidWZbcGFsZXR0ZV9vZmZzZXQyICsgaW5kZXggKiAzXTsKICAgICAgICAgICAgICB2YXIgZyA9IGJ1ZltwYWxldHRlX29mZnNldDIgKyBpbmRleCAqIDMgKyAxXTsKICAgICAgICAgICAgICB2YXIgYiA9IGJ1ZltwYWxldHRlX29mZnNldDIgKyBpbmRleCAqIDMgKyAyXTsKICAgICAgICAgICAgICBwaXhlbHNbb3ArK10gPSByOwogICAgICAgICAgICAgIHBpeGVsc1tvcCsrXSA9IGc7CiAgICAgICAgICAgICAgcGl4ZWxzW29wKytdID0gYjsKICAgICAgICAgICAgICBwaXhlbHNbb3ArK10gPSAyNTU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLS14bGVmdDsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIEdpZlJlYWRlckxaV091dHB1dEluZGV4U3RyZWFtKGNvZGVfc3RyZWFtLCBwLCBvdXRwdXQsIG91dHB1dF9sZW5ndGgpIHsKICAgICAgICB2YXIgbWluX2NvZGVfc2l6ZSA9IGNvZGVfc3RyZWFtW3ArK107CiAgICAgICAgdmFyIGNsZWFyX2NvZGUgPSAxIDw8IG1pbl9jb2RlX3NpemU7CiAgICAgICAgdmFyIGVvaV9jb2RlID0gY2xlYXJfY29kZSArIDE7CiAgICAgICAgdmFyIG5leHRfY29kZSA9IGVvaV9jb2RlICsgMTsKICAgICAgICB2YXIgY3VyX2NvZGVfc2l6ZSA9IG1pbl9jb2RlX3NpemUgKyAxOwogICAgICAgIHZhciBjb2RlX21hc2sgPSAoMSA8PCBjdXJfY29kZV9zaXplKSAtIDE7CiAgICAgICAgdmFyIGN1cl9zaGlmdCA9IDA7CiAgICAgICAgdmFyIGN1ciA9IDA7CiAgICAgICAgdmFyIG9wID0gMDsKICAgICAgICB2YXIgc3ViYmxvY2tfc2l6ZSA9IGNvZGVfc3RyZWFtW3ArK107CiAgICAgICAgdmFyIGNvZGVfdGFibGUgPSBuZXcgSW50MzJBcnJheSg0MDk2KTsKICAgICAgICB2YXIgcHJldl9jb2RlID0gbnVsbDsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgd2hpbGUgKGN1cl9zaGlmdCA8IDE2KSB7CiAgICAgICAgICAgIGlmIChzdWJibG9ja19zaXplID09PSAwKSBicmVhazsKICAgICAgICAgICAgY3VyIHw9IGNvZGVfc3RyZWFtW3ArK10gPDwgY3VyX3NoaWZ0OwogICAgICAgICAgICBjdXJfc2hpZnQgKz0gODsKICAgICAgICAgICAgaWYgKHN1YmJsb2NrX3NpemUgPT09IDEpIHsKICAgICAgICAgICAgICBzdWJibG9ja19zaXplID0gY29kZV9zdHJlYW1bcCsrXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAtLXN1YmJsb2NrX3NpemU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChjdXJfc2hpZnQgPCBjdXJfY29kZV9zaXplKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIHZhciBjb2RlID0gY3VyICYgY29kZV9tYXNrOwogICAgICAgICAgY3VyID4+PSBjdXJfY29kZV9zaXplOwogICAgICAgICAgY3VyX3NoaWZ0IC09IGN1cl9jb2RlX3NpemU7CiAgICAgICAgICBpZiAoY29kZSA9PT0gY2xlYXJfY29kZSkgewogICAgICAgICAgICBuZXh0X2NvZGUgPSBlb2lfY29kZSArIDE7CiAgICAgICAgICAgIGN1cl9jb2RlX3NpemUgPSBtaW5fY29kZV9zaXplICsgMTsKICAgICAgICAgICAgY29kZV9tYXNrID0gKDEgPDwgY3VyX2NvZGVfc2l6ZSkgLSAxOwogICAgICAgICAgICBwcmV2X2NvZGUgPSBudWxsOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gZW9pX2NvZGUpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgY2hhc2VfY29kZSA9IGNvZGUgPCBuZXh0X2NvZGUgPyBjb2RlIDogcHJldl9jb2RlOwogICAgICAgICAgdmFyIGNoYXNlX2xlbmd0aCA9IDA7CiAgICAgICAgICB2YXIgY2hhc2UgPSBjaGFzZV9jb2RlOwogICAgICAgICAgd2hpbGUgKGNoYXNlID4gY2xlYXJfY29kZSkgewogICAgICAgICAgICBjaGFzZSA9IGNvZGVfdGFibGVbY2hhc2VdID4+IDg7CiAgICAgICAgICAgICsrY2hhc2VfbGVuZ3RoOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGsgPSBjaGFzZTsKICAgICAgICAgIHZhciBvcF9lbmQgPSBvcCArIGNoYXNlX2xlbmd0aCArIChjaGFzZV9jb2RlICE9PSBjb2RlID8gMSA6IDApOwogICAgICAgICAgaWYgKG9wX2VuZCA+IG91dHB1dF9sZW5ndGgpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIldhcm5pbmcsIGdpZiBzdHJlYW0gbG9uZ2VyIHRoYW4gZXhwZWN0ZWQuIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIG91dHB1dFtvcCsrXSA9IGs7CiAgICAgICAgICBvcCArPSBjaGFzZV9sZW5ndGg7CiAgICAgICAgICB2YXIgYiA9IG9wOwogICAgICAgICAgaWYgKGNoYXNlX2NvZGUgIT09IGNvZGUpCiAgICAgICAgICAgIG91dHB1dFtvcCsrXSA9IGs7CiAgICAgICAgICBjaGFzZSA9IGNoYXNlX2NvZGU7CiAgICAgICAgICB3aGlsZSAoY2hhc2VfbGVuZ3RoLS0pIHsKICAgICAgICAgICAgY2hhc2UgPSBjb2RlX3RhYmxlW2NoYXNlXTsKICAgICAgICAgICAgb3V0cHV0Wy0tYl0gPSBjaGFzZSAmIDI1NTsKICAgICAgICAgICAgY2hhc2UgPj49IDg7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAocHJldl9jb2RlICE9PSBudWxsICYmIG5leHRfY29kZSA8IDQwOTYpIHsKICAgICAgICAgICAgY29kZV90YWJsZVtuZXh0X2NvZGUrK10gPSBwcmV2X2NvZGUgPDwgOCB8IGs7CiAgICAgICAgICAgIGlmIChuZXh0X2NvZGUgPj0gY29kZV9tYXNrICsgMSAmJiBjdXJfY29kZV9zaXplIDwgMTIpIHsKICAgICAgICAgICAgICArK2N1cl9jb2RlX3NpemU7CiAgICAgICAgICAgICAgY29kZV9tYXNrID0gY29kZV9tYXNrIDw8IDEgfCAxOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBwcmV2X2NvZGUgPSBjb2RlOwogICAgICAgIH0KICAgICAgICBpZiAob3AgIT09IG91dHB1dF9sZW5ndGgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJXYXJuaW5nLCBnaWYgc3RyZWFtIHNob3J0ZXIgdGhhbiBleHBlY3RlZC4iKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG91dHB1dDsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIGV4cG9ydHMuR2lmV3JpdGVyID0gR2lmV3JpdGVyMjsKICAgICAgICBleHBvcnRzLkdpZlJlYWRlciA9IEdpZlJlYWRlcjsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIHNyYy91dGlsL2NvbG9yLnRzCiAgdmFyIENvbG9yID0gY2xhc3MgX0NvbG9yIHsKICAgIGNvbnN0cnVjdG9yKF9yLCBfZywgX2IsIF9hKSB7CiAgICAgIHRoaXMuX3IgPSBfcjsKICAgICAgdGhpcy5fZyA9IF9nOwogICAgICB0aGlzLl9iID0gX2I7CiAgICAgIHRoaXMuX2EgPSBfYTsKICAgIH0KICAgIHN0YXRpYyBza3JpYmJsQ29sb3JzID0gWwogICAgICBbMjU1LCAyNTUsIDI1NV0sCiAgICAgIFswLCAwLCAwXSwKICAgICAgWzE5MywgMTkzLCAxOTNdLAogICAgICBbODAsIDgwLCA4MF0sCiAgICAgIFsyMzksIDE5LCAxMV0sCiAgICAgIFsxMTYsIDExLCA3XSwKICAgICAgWzI1NSwgMTEzLCAwXSwKICAgICAgWzE5NCwgNTYsIDBdLAogICAgICBbMjU1LCAyMjgsIDBdLAogICAgICBbMjMyLCAxNjIsIDBdLAogICAgICBbMCwgMjA0LCAwXSwKICAgICAgWzAsIDcwLCAyNV0sCiAgICAgIFswLCAyNTUsIDE0NV0sCiAgICAgIFswLCAxMjAsIDkzXSwKICAgICAgWzAsIDE3OCwgMjU1XSwKICAgICAgWzAsIDg2LCAxNThdLAogICAgICBbMzUsIDMxLCAyMTFdLAogICAgICBbMTQsIDgsIDEwMV0sCiAgICAgIFsxNjMsIDAsIDE4Nl0sCiAgICAgIFs4NSwgMCwgMTA1XSwKICAgICAgWzIyMywgMTA1LCAxNjddLAogICAgICBbMTM1LCA1MywgODRdLAogICAgICBbMjU1LCAxNzIsIDE0Ml0sCiAgICAgIFsyMDQsIDExOSwgNzddLAogICAgICBbMTYwLCA4MiwgNDVdLAogICAgICBbOTksIDQ4LCAxM10KICAgIF07CiAgICBnZXQgcigpIHsKICAgICAgcmV0dXJuIHRoaXMuX3I7CiAgICB9CiAgICBnZXQgZygpIHsKICAgICAgcmV0dXJuIHRoaXMuX2c7CiAgICB9CiAgICBnZXQgYigpIHsKICAgICAgcmV0dXJuIHRoaXMuX2I7CiAgICB9CiAgICAvLyBnZXQgdGhlIHJnYiBzdHJpbmcgb2YgdGhlIGNvbG9yCiAgICBnZXQgcmdiU3RyaW5nKCkgewogICAgICByZXR1cm4gInJnYigiICsgW3RoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIHRoaXMuX2FdLmZpbHRlcigodikgPT4gdiAhPT0gdm9pZCAwKS5qb2luKCIsIikgKyAiKSI7CiAgICB9CiAgICBnZXQgcmdiQXJyYXkoKSB7CiAgICAgIHJldHVybiB0aGlzLl9hID8gW3RoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIHRoaXMuX2FdIDogW3RoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2JdOwogICAgfQogICAgLy8gZ2V0IHRoZSByZ2IgdmFsdWVzIG9mIHRoZSBjb2xvcgogICAgZ2V0IHJnYigpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICByOiB0aGlzLl9yLAogICAgICAgIGc6IHRoaXMuX2csCiAgICAgICAgYjogdGhpcy5fYiwKICAgICAgICBhOiB0aGlzLl9hCiAgICAgIH07CiAgICB9CiAgICAvLyBnZXQgdGhlIGhleCBzdHJpbmcgb2YgdGhlIGNvbG9yCiAgICBnZXQgaGV4KCkgewogICAgICByZXR1cm4gIiMiICsgdGhpcy5fci50b1N0cmluZygxNikucGFkU3RhcnQoMiwgIjAiKSArIHRoaXMuX2cudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIikgKyB0aGlzLl9iLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAiMCIpICsgKHRoaXMuX2EgPyBNYXRoLmZsb29yKDI1NSAqIHRoaXMuX2EpLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAiMCIpIDogIiIpOwogICAgfQogICAgc2V0IGhleChoZXgpIHsKICAgICAgY29uc3QgY29sb3IgPSBfQ29sb3IuZnJvbUhleChoZXgpOwogICAgICB0aGlzLl9yID0gY29sb3IuX3I7CiAgICAgIHRoaXMuX2cgPSBjb2xvci5fZzsKICAgICAgdGhpcy5fYiA9IGNvbG9yLl9iOwogICAgICB0aGlzLl9hID0gY29sb3IuX2E7CiAgICB9CiAgICAvKioKICAgICAqIFRoZSBhdHR0ZW1wdGVkIHNrcmliYmwgY29sb3IgY29kZQogICAgICogSWYgbm90IGZvdW5kLCByZXR1cm4gdHlvcG8gY29kZSBpbnN0ZWFkIChoZXggdmFsICsgMTAwMDApCiAgICAgKi8KICAgIGdldCBza3JpYmJsQ29kZSgpIHsKICAgICAgY29uc3Qgc2tyaWJibEluZGV4ID0gX0NvbG9yLnNrcmliYmxDb2xvcnMuZmluZEluZGV4KChjKSA9PiBjWzBdID09PSB0aGlzLl9yICYmIGNbMV0gPT09IHRoaXMuX2cgJiYgY1syXSA9PT0gdGhpcy5fYik7CiAgICAgIGlmIChza3JpYmJsSW5kZXggIT09IC0xKSByZXR1cm4gc2tyaWJibEluZGV4OwogICAgICByZXR1cm4gdGhpcy50eXBvQ29kZTsKICAgIH0KICAgIC8qKgogICAgICogVGhlIGNvbG9yIGNvZGUgZm9yIHRoZSB0eXBvIGNvbG9yIChoZXggdmFsICsgMTAwMDApCiAgICAgKi8KICAgIGdldCB0eXBvQ29kZSgpIHsKICAgICAgY29uc3QgaGV4U3RyaW5nID0gKHRoaXMuX3IgPDwgMTYgfCB0aGlzLl9nIDw8IDggfCB0aGlzLl9iKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTsKICAgICAgcmV0dXJuIHBhcnNlSW50KGhleFN0cmluZywgMTYpICsgMWU0OwogICAgfQogICAgLy9zb3VyY2U6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL21qYWNrc29uLzUzMTEyNTYKICAgIGdldCBoc2woKSB7CiAgICAgIGNvbnN0IHIgPSB0aGlzLnIgLyAyNTUsIGcgPSB0aGlzLmcgLyAyNTUsIGIgPSB0aGlzLmIgLyAyNTU7CiAgICAgIGNvbnN0IG1heCA9IE1hdGgubWF4KHIsIGcsIGIpLCBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTsKICAgICAgbGV0IGggPSAwLCBzID0gMDsKICAgICAgY29uc3QgbCA9IChtYXggKyBtaW4pIC8gMjsKICAgICAgaWYgKG1heCA9PSBtaW4pIHsKICAgICAgICBoID0gcyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZCA9IG1heCAtIG1pbjsKICAgICAgICBzID0gbCA+IDAuNSA/IGQgLyAoMiAtIG1heCAtIG1pbikgOiBkIC8gKG1heCArIG1pbik7CiAgICAgICAgc3dpdGNoIChtYXgpIHsKICAgICAgICAgIGNhc2UgcjoKICAgICAgICAgICAgaCA9IChnIC0gYikgLyBkICsgKGcgPCBiID8gNiA6IDApOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgZzoKICAgICAgICAgICAgaCA9IChiIC0gcikgLyBkICsgMjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIGI6CiAgICAgICAgICAgIGggPSAociAtIGcpIC8gZCArIDQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBoIC89IDY7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuX2EgIT09IHZvaWQgMCA/IFtoICogMzYwLCBzICogMTAwLCBsICogMTAwLCB0aGlzLl9hXSA6IFtoICogMzYwLCBzICogMTAwLCBsICogMTAwXTsKICAgIH0KICAgIC8vIENvbnZlcnQgdG8gSFNWCiAgICBnZXQgaHN2KCkgewogICAgICBjb25zdCByID0gdGhpcy5yIC8gMjU1LCBnID0gdGhpcy5nIC8gMjU1LCBiID0gdGhpcy5iIC8gMjU1OwogICAgICBjb25zdCBtYXggPSBNYXRoLm1heChyLCBnLCBiKSwgbWluID0gTWF0aC5taW4ociwgZywgYik7CiAgICAgIGNvbnN0IGRlbHRhID0gbWF4IC0gbWluOwogICAgICBsZXQgaCA9IDAsIHMgPSAwOwogICAgICBjb25zdCB2ID0gbWF4OwogICAgICBpZiAobWF4ICE9PSAwKSB7CiAgICAgICAgcyA9IGRlbHRhIC8gbWF4OwogICAgICB9IGVsc2UgewogICAgICAgIGggPSAwOwogICAgICAgIHMgPSAwOwogICAgICB9CiAgICAgIGlmIChtYXggIT09IG1pbikgewogICAgICAgIHN3aXRjaCAobWF4KSB7CiAgICAgICAgICBjYXNlIHI6CiAgICAgICAgICAgIGggPSAoZyAtIGIpIC8gZGVsdGEgKyAoZyA8IGIgPyA2IDogMCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSBnOgogICAgICAgICAgICBoID0gKGIgLSByKSAvIGRlbHRhICsgMjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIGI6CiAgICAgICAgICAgIGggPSAociAtIGcpIC8gZGVsdGEgKyA0OwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaCAvPSA2OwogICAgICB9CiAgICAgIHJldHVybiBbaCAqIDM2MCwgcyAqIDEwMCwgdiAqIDEwMCwgdGhpcy5fYV07CiAgICB9CiAgICBzdGF0aWMgZnJvbVJnYihyLCBnLCBiLCBhKSB7CiAgICAgIHJldHVybiBuZXcgX0NvbG9yKE1hdGgucm91bmQociksIE1hdGgucm91bmQoZyksIE1hdGgucm91bmQoYiksIGEgPyBNYXRoLnJvdW5kKGEgKiAxMDApIC8gMTAwIDogdm9pZCAwKTsKICAgIH0KICAgIHN0YXRpYyBmcm9tSGV4KGhleCkgewogICAgICBpZiAoaGV4WzBdID09ICIjIikgaGV4ID0gaGV4LnN1YnN0cmluZygxKTsKICAgICAgY29uc3QgciA9IE1hdGgucm91bmQocGFyc2VJbnQoIjB4IiArIGhleC5zdWJzdHJpbmcoMCwgMikpKTsKICAgICAgY29uc3QgZyA9IE1hdGgucm91bmQocGFyc2VJbnQoIjB4IiArIGhleC5zdWJzdHJpbmcoMiwgNCkpKTsKICAgICAgY29uc3QgYiA9IE1hdGgucm91bmQocGFyc2VJbnQoIjB4IiArIGhleC5zdWJzdHJpbmcoNCwgNikpKTsKICAgICAgY29uc3QgYSA9IGhleC5sZW5ndGggPiA2ID8gTWF0aC5yb3VuZChwYXJzZUludCgiMHgiICsgaGV4LnN1YnN0cmluZyg2LCA4KSkpIDogdm9pZCAwOwogICAgICByZXR1cm4gbmV3IF9Db2xvcihyLCBnLCBiLCBhKTsKICAgIH0KICAgIHN0YXRpYyBmcm9tUmdiU3RyaW5nKHJnYikgewogICAgICBjb25zdCByZ2JzID0gcmdiLnRyaW0oKS5yZXBsYWNlKCIgIiwgIiIpLnNwbGl0KCIsIik7CiAgICAgIGNvbnN0IHIgPSBwYXJzZUludChyZ2JzWzBdLnJlcGxhY2UoL1teXGRdL2csICIiKSwgMTApOwogICAgICBjb25zdCBnID0gcGFyc2VJbnQocmdic1sxXS5yZXBsYWNlKC9bXlxkXS9nLCAiIiksIDEwKTsKICAgICAgY29uc3QgYiA9IHBhcnNlSW50KHJnYnNbMl0ucmVwbGFjZSgvW15cZF0vZywgIiIpLCAxMCk7CiAgICAgIGNvbnN0IGEgPSByZ2JzLmxlbmd0aCA+IDMgPyBwYXJzZUludChyZ2JzWzRdLnJlcGxhY2UoL1teXGRdL2csICIiKSwgMTApIDogdm9pZCAwOwogICAgICByZXR1cm4gbmV3IF9Db2xvcihyLCBnLCBiLCBhKTsKICAgIH0KICAgIHN0YXRpYyBmcm9tU2tyaWJibENvZGUoY29kZSkgewogICAgICBpZiAoY29kZSA8IDFlNCkgewogICAgICAgIGNvbnN0IHJnYiA9IF9Db2xvci5za3JpYmJsQ29sb3JzW2NvZGVdOwogICAgICAgIHJldHVybiBfQ29sb3IuZnJvbVJnYihyZ2JbMF0sIHJnYlsxXSwgcmdiWzJdKTsKICAgICAgfQogICAgICBjb25zdCBoZXggPSAoY29kZSAtIDFlNCkudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDYsICIwIik7CiAgICAgIHJldHVybiBfQ29sb3IuZnJvbUhleChoZXgpOwogICAgfQogICAgLy8gc291cmNlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zNjcyMTgzMC9jb252ZXJ0LWhzbC10by1yZ2ItYW5kLWhleAogICAgc3RhdGljIGZyb21Ic2woaCwgcywgbCwgYWxwaGEpIHsKICAgICAgcyAvPSAxMDA7CiAgICAgIGwgLz0gMTAwOwogICAgICBjb25zdCBrID0gKG4pID0+IChuICsgaCAvIDMwKSAlIDEyOwogICAgICBjb25zdCBhID0gcyAqIE1hdGgubWluKGwsIDEgLSBsKTsKICAgICAgY29uc3QgZiA9IChuKSA9PiBsIC0gYSAqIE1hdGgubWF4KC0xLCBNYXRoLm1pbihrKG4pIC0gMywgTWF0aC5taW4oOSAtIGsobiksIDEpKSk7CiAgICAgIGNvbnN0IHIgPSBNYXRoLnJvdW5kKGYoMCkgKiAyNTUpOwogICAgICBjb25zdCBnID0gTWF0aC5yb3VuZChmKDgpICogMjU1KTsKICAgICAgY29uc3QgYiA9IE1hdGgucm91bmQoZig0KSAqIDI1NSk7CiAgICAgIHJldHVybiBuZXcgX0NvbG9yKHIsIGcsIGIsIGFscGhhKTsKICAgIH0KICAgIC8vIFN0YXRpYyBmYWN0b3J5IG1ldGhvZCBmb3IgSFNWIHRvIFJHQiBjb252ZXJzaW9uCiAgICBzdGF0aWMgZnJvbUhzdihoLCBzLCB2LCBhKSB7CiAgICAgIHMgLz0gMTAwOwogICAgICB2IC89IDEwMDsKICAgICAgY29uc3QgYyA9IHYgKiBzOwogICAgICBjb25zdCB4ID0gYyAqICgxIC0gTWF0aC5hYnMoaCAvIDYwICUgMiAtIDEpKTsKICAgICAgY29uc3QgbSA9IHYgLSBjOwogICAgICBsZXQgciA9IDAsIGcgPSAwLCBiID0gMDsKICAgICAgaWYgKDAgPD0gaCAmJiBoIDwgNjApIHsKICAgICAgICByID0gYzsKICAgICAgICBnID0geDsKICAgICAgICBiID0gMDsKICAgICAgfSBlbHNlIGlmICg2MCA8PSBoICYmIGggPCAxMjApIHsKICAgICAgICByID0geDsKICAgICAgICBnID0gYzsKICAgICAgICBiID0gMDsKICAgICAgfSBlbHNlIGlmICgxMjAgPD0gaCAmJiBoIDwgMTgwKSB7CiAgICAgICAgciA9IDA7CiAgICAgICAgZyA9IGM7CiAgICAgICAgYiA9IHg7CiAgICAgIH0gZWxzZSBpZiAoMTgwIDw9IGggJiYgaCA8IDI0MCkgewogICAgICAgIHIgPSAwOwogICAgICAgIGcgPSB4OwogICAgICAgIGIgPSBjOwogICAgICB9IGVsc2UgaWYgKDI0MCA8PSBoICYmIGggPCAzMDApIHsKICAgICAgICByID0geDsKICAgICAgICBnID0gMDsKICAgICAgICBiID0gYzsKICAgICAgfSBlbHNlIGlmICgzMDAgPD0gaCAmJiBoIDwgMzYwKSB7CiAgICAgICAgciA9IGM7CiAgICAgICAgZyA9IDA7CiAgICAgICAgYiA9IHg7CiAgICAgIH0KICAgICAgciA9IE1hdGgucm91bmQoKHIgKyBtKSAqIDI1NSk7CiAgICAgIGcgPSBNYXRoLnJvdW5kKChnICsgbSkgKiAyNTUpOwogICAgICBiID0gTWF0aC5yb3VuZCgoYiArIG0pICogMjU1KTsKICAgICAgcmV0dXJuIG5ldyBfQ29sb3IociwgZywgYiwgYSk7CiAgICB9CiAgICBjb3B5KCkgewogICAgICByZXR1cm4gbmV3IF9Db2xvcih0aGlzLl9yLCB0aGlzLl9nLCB0aGlzLl9iLCB0aGlzLl9hKTsKICAgIH0KICAgIHdpdGhBbHBoYShhKSB7CiAgICAgIHRoaXMuX2EgPSBhOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9OwoKICAvLyBzcmMvdXRpbC9naWYvY2FudmFzQ29tbWFuZFByb2Nlc3Nvci50cwogIHZhciBDYW52YXNDb21tYW5kUHJvY2Vzc29yID0gY2xhc3MgewogICAgY29uc3RydWN0b3IoX2NhbnZhc0NvbnRleHQpIHsKICAgICAgdGhpcy5fY2FudmFzQ29udGV4dCA9IF9jYW52YXNDb250ZXh0OwogICAgICB0aGlzLl93aWR0aCA9IF9jYW52YXNDb250ZXh0LmNhbnZhcy53aWR0aDsKICAgICAgdGhpcy5faGVpZ2h0ID0gX2NhbnZhc0NvbnRleHQuY2FudmFzLmhlaWdodDsKICAgICAgdGhpcy5fY2FudmFzQ29udGV4dC5maWxsU3R5bGUgPSAid2hpdGUiOwogICAgICB0aGlzLl9jYW52YXNDb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHQpOwogICAgfQogICAgX3dpZHRoOwogICAgX2hlaWdodDsKICAgIF90aGlja25lc3NNaW4gPSA0OwogICAgX3RoaWNrbmVzc01heCA9IDQwOwogICAgLyoqCiAgICAgKiBTa3JpYmJsIGNvbWFtbmQgaW50ZXJmYWNlCiAgICAgKiBAcGFyYW0gY29tbWFuZAogICAgICogYnJ1c2g6IFswLCBjb2xvckNvZGUsIHNpemUsIHgxLCB5MSwgeDIsIHkyXQogICAgICogZmlsbDogWzEsIGNvbG9yQ29kZSwgeCwgeV0KICAgICAqCiAgICAgKi8KICAgIHByb2Nlc3NEcmF3Q29tbWFuZChjb21tYW5kKSB7CiAgICAgIGlmIChjb21tYW5kLmxlbmd0aCA8IDIpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgY29tbWFuZCBsZW5ndGggc21hbGxlciB0aGFuIDIiKTsKICAgICAgfQogICAgICBzd2l0Y2ggKGNvbW1hbmRbMF0pIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBpZiAoY29tbWFuZC5sZW5ndGggPCA3KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBicnVzaCBjb21tYW5kIGxlbmd0aCBzbWFsbGVyIHRoYW4gNyIpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5kcmF3TGluZShjb21tYW5kWzNdLCBjb21tYW5kWzRdLCBjb21tYW5kWzVdLCBjb21tYW5kWzZdLCBjb21tYW5kWzFdLCBjb21tYW5kWzJdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIGlmIChjb21tYW5kLmxlbmd0aCA8IDQpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGZpbGwgY29tbWFuZCBsZW5ndGggc21hbGxlciB0aGFuIDQiKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZmxvb2RGaWxsKGNvbW1hbmRbMl0sIGNvbW1hbmRbM10sIGNvbW1hbmRbMV0pOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGNsZWFyKCkgewogICAgICB0aGlzLl9jYW52YXNDb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLl93aWR0aCwgdGhpcy5faGVpZ2h0KTsKICAgIH0KICAgIC8qKgogICAgICogRXhwb3J0cyBjdXJyZW50IGltYWdlIGFzIHVpbnQ4Y2xhbXBlZGFycmF5CiAgICAgKi8KICAgIGV4cG9ydEltYWdlKCkgewogICAgICByZXR1cm4gdGhpcy5fY2FudmFzQ29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5fd2lkdGgsIHRoaXMuX2hlaWdodCkuZGF0YTsKICAgIH0KICAgIGRyYXdMaW5lKHgxLCB5MSwgeDIsIHkyLCBjb2xvciwgc2l6ZSkgewogICAgICBzaXplID0gc2l6ZSA8IHRoaXMuX3RoaWNrbmVzc01pbiA/IHRoaXMuX3RoaWNrbmVzc01pbiA6IHNpemUgPiB0aGlzLl90aGlja25lc3NNYXggPyB0aGlzLl90aGlja25lc3NNYXggOiBNYXRoLmZsb29yKHNpemUpOwogICAgICBjb25zdCByZ2IgPSBDb2xvci5mcm9tU2tyaWJibENvZGUoY29sb3IpLnJnYjsKICAgICAgY29uc3QgcmFkaXVzID0gTWF0aC5jZWlsKHNpemUgLyAyKTsKICAgICAgY29uc3QgcmFkaXVzU3F1YXJlZCA9IHJhZGl1cyAqIHJhZGl1czsKICAgICAgbGV0IHN0YXJ0WCA9IHRoaXMuY2xhbXAoTWF0aC5mbG9vcih4MSksIC1yYWRpdXMsIHRoaXMuX3dpZHRoICsgcmFkaXVzKTsKICAgICAgbGV0IHN0YXJ0WSA9IHRoaXMuY2xhbXAoTWF0aC5mbG9vcih5MSksIC1yYWRpdXMsIHRoaXMuX2hlaWdodCArIHJhZGl1cyk7CiAgICAgIGxldCBlbmRYID0gdGhpcy5jbGFtcChNYXRoLmZsb29yKHgyKSwgLXJhZGl1cywgdGhpcy5fd2lkdGggKyByYWRpdXMpOwogICAgICBsZXQgZW5kWSA9IHRoaXMuY2xhbXAoTWF0aC5mbG9vcih5MiksIC1yYWRpdXMsIHRoaXMuX2hlaWdodCArIHJhZGl1cyk7CiAgICAgIGNvbnN0IG1pblggPSBNYXRoLm1pbihzdGFydFgsIGVuZFgpIC0gcmFkaXVzOwogICAgICBjb25zdCBtaW5ZID0gTWF0aC5taW4oc3RhcnRZLCBlbmRZKSAtIHJhZGl1czsKICAgICAgY29uc3QgbWF4WCA9IE1hdGgubWF4KHN0YXJ0WCwgZW5kWCkgKyByYWRpdXM7CiAgICAgIGNvbnN0IG1heFkgPSBNYXRoLm1heChzdGFydFksIGVuZFkpICsgcmFkaXVzOwogICAgICBzdGFydFggLT0gbWluWDsKICAgICAgc3RhcnRZIC09IG1pblk7CiAgICAgIGVuZFggLT0gbWluWDsKICAgICAgZW5kWSAtPSBtaW5ZOwogICAgICBjb25zdCBpbWFnZURhdGEgPSB0aGlzLl9jYW52YXNDb250ZXh0LmdldEltYWdlRGF0YShtaW5YLCBtaW5ZLCBtYXhYIC0gbWluWCwgbWF4WSAtIG1pblkpOwogICAgICBjb25zdCBhcHBseUJydXNoID0gKHgsIHkpID0+IHsKICAgICAgICBmb3IgKGxldCBvZmZzZXRYID0gLXJhZGl1czsgb2Zmc2V0WCA8PSByYWRpdXM7IG9mZnNldFgrKykgewogICAgICAgICAgZm9yIChsZXQgb2Zmc2V0WSA9IC1yYWRpdXM7IG9mZnNldFkgPD0gcmFkaXVzOyBvZmZzZXRZKyspIHsKICAgICAgICAgICAgaWYgKG9mZnNldFggKiBvZmZzZXRYICsgb2Zmc2V0WSAqIG9mZnNldFkgPCByYWRpdXNTcXVhcmVkKSB7CiAgICAgICAgICAgICAgY29uc3QgcGl4ZWxJbmRleCA9IDQgKiAoKHkgKyBvZmZzZXRZKSAqIGltYWdlRGF0YS53aWR0aCArIHggKyBvZmZzZXRYKTsKICAgICAgICAgICAgICB0aGlzLnNldFBpeGVsKGltYWdlRGF0YSwgcGl4ZWxJbmRleCwgcmdiLnIsIHJnYi5nLCByZ2IuYik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChzdGFydFggPT09IGVuZFggJiYgc3RhcnRZID09PSBlbmRZKSB7CiAgICAgICAgYXBwbHlCcnVzaChzdGFydFgsIHN0YXJ0WSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXBwbHlCcnVzaChzdGFydFgsIHN0YXJ0WSk7CiAgICAgICAgYXBwbHlCcnVzaChlbmRYLCBlbmRZKTsKICAgICAgICBjb25zdCBkZWx0YVggPSBNYXRoLmFicyhlbmRYIC0gc3RhcnRYKTsKICAgICAgICBjb25zdCBkZWx0YVkgPSBNYXRoLmFicyhlbmRZIC0gc3RhcnRZKTsKICAgICAgICBjb25zdCBzdGVwWCA9IHN0YXJ0WCA8IGVuZFggPyAxIDogLTE7CiAgICAgICAgY29uc3Qgc3RlcFkgPSBzdGFydFkgPCBlbmRZID8gMSA6IC0xOwogICAgICAgIGxldCBlcnJvciA9IGRlbHRhWCAtIGRlbHRhWTsKICAgICAgICB3aGlsZSAoc3RhcnRYICE9PSBlbmRYIHx8IHN0YXJ0WSAhPT0gZW5kWSkgewogICAgICAgICAgY29uc3QgZG91YmxlRXJyb3IgPSBlcnJvciAqIDI7CiAgICAgICAgICBpZiAoZG91YmxlRXJyb3IgPiAtZGVsdGFZKSB7CiAgICAgICAgICAgIGVycm9yIC09IGRlbHRhWTsKICAgICAgICAgICAgc3RhcnRYICs9IHN0ZXBYOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGRvdWJsZUVycm9yIDwgZGVsdGFYKSB7CiAgICAgICAgICAgIGVycm9yICs9IGRlbHRhWDsKICAgICAgICAgICAgc3RhcnRZICs9IHN0ZXBZOwogICAgICAgICAgfQogICAgICAgICAgYXBwbHlCcnVzaChzdGFydFgsIHN0YXJ0WSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuX2NhbnZhc0NvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgbWluWCwgbWluWSk7CiAgICB9CiAgICBmbG9vZEZpbGwoeCwgeSwgY29sb3IpIHsKICAgICAgY29uc3QgaW1hZ2VEYXRhID0gdGhpcy5fY2FudmFzQ29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5fd2lkdGgsIHRoaXMuX2hlaWdodCk7CiAgICAgIHggPSB0aGlzLmNsYW1wKE1hdGguZmxvb3IoeCksIDAsIHRoaXMuX3dpZHRoKTsKICAgICAgeSA9IHRoaXMuY2xhbXAoTWF0aC5mbG9vcih5KSwgMCwgdGhpcy5faGVpZ2h0KTsKICAgICAgY29uc3QgZmlsbCA9IENvbG9yLmZyb21Ta3JpYmJsQ29kZShjb2xvcikucmdiOwogICAgICBjb25zdCBwaXhlbFN0YWNrID0gW1t4LCB5XV07CiAgICAgIGNvbnN0IHRhcmdldENvbG9yID0gdGhpcy5nZXRQaXhlbChpbWFnZURhdGEsIHgsIHkpOwogICAgICBpZiAoZmlsbC5yICE9PSB0YXJnZXRDb2xvclswXSB8fCBmaWxsLmcgIT09IHRhcmdldENvbG9yWzFdIHx8IGZpbGwuYiAhPT0gdGFyZ2V0Q29sb3JbMl0pIHsKICAgICAgICBjb25zdCBpc01hdGNoaW5nQ29sb3IgPSAocGl4ZWxJbmRleCkgPT4gewogICAgICAgICAgY29uc3QgciA9IGltYWdlRGF0YS5kYXRhW3BpeGVsSW5kZXhdOwogICAgICAgICAgY29uc3QgZyA9IGltYWdlRGF0YS5kYXRhW3BpeGVsSW5kZXggKyAxXTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVtwaXhlbEluZGV4ICsgMl07CiAgICAgICAgICByZXR1cm4gciA9PT0gdGFyZ2V0Q29sb3JbMF0gJiYgZyA9PT0gdGFyZ2V0Q29sb3JbMV0gJiYgYiA9PT0gdGFyZ2V0Q29sb3JbMl07CiAgICAgICAgfTsKICAgICAgICBjb25zdCB3aWR0aCA9IGltYWdlRGF0YS53aWR0aDsKICAgICAgICBjb25zdCBoZWlnaHQgPSBpbWFnZURhdGEuaGVpZ2h0OwogICAgICAgIHdoaWxlIChwaXhlbFN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGxldCBbeDIsIHkyXSA9IHBpeGVsU3RhY2sucG9wKCkgPz8gWy0xLCAtMV07CiAgICAgICAgICBsZXQgcGl4ZWxJbmRleCA9IDQgKiAoeTIgKiB3aWR0aCArIHgyKTsKICAgICAgICAgIHdoaWxlICh5MiA+PSAwICYmIGlzTWF0Y2hpbmdDb2xvcihwaXhlbEluZGV4KSkgewogICAgICAgICAgICBwaXhlbEluZGV4IC09IDQgKiB3aWR0aDsKICAgICAgICAgICAgeTItLTsKICAgICAgICAgIH0KICAgICAgICAgIHBpeGVsSW5kZXggKz0gNCAqIHdpZHRoOwogICAgICAgICAgeTIrKzsKICAgICAgICAgIGxldCBsZWZ0U2lkZUZpbGxlZCA9IGZhbHNlOwogICAgICAgICAgbGV0IHJpZ2h0U2lkZUZpbGxlZCA9IGZhbHNlOwogICAgICAgICAgd2hpbGUgKHkyIDwgaGVpZ2h0ICYmIGlzTWF0Y2hpbmdDb2xvcihwaXhlbEluZGV4KSkgewogICAgICAgICAgICB0aGlzLnNldFBpeGVsKGltYWdlRGF0YSwgcGl4ZWxJbmRleCwgZmlsbC5yLCBmaWxsLmcsIGZpbGwuYik7CiAgICAgICAgICAgIGlmICh4MiA+IDAgJiYgaXNNYXRjaGluZ0NvbG9yKHBpeGVsSW5kZXggLSA0KSkgewogICAgICAgICAgICAgIGlmICghbGVmdFNpZGVGaWxsZWQpIHsKICAgICAgICAgICAgICAgIHBpeGVsU3RhY2sucHVzaChbeDIgLSAxLCB5Ml0pOwogICAgICAgICAgICAgICAgbGVmdFNpZGVGaWxsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChsZWZ0U2lkZUZpbGxlZCkgewogICAgICAgICAgICAgIGxlZnRTaWRlRmlsbGVkID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHgyIDwgd2lkdGggLSAxICYmIGlzTWF0Y2hpbmdDb2xvcihwaXhlbEluZGV4ICsgNCkpIHsKICAgICAgICAgICAgICBpZiAoIXJpZ2h0U2lkZUZpbGxlZCkgewogICAgICAgICAgICAgICAgcGl4ZWxTdGFjay5wdXNoKFt4MiArIDEsIHkyXSk7CiAgICAgICAgICAgICAgICByaWdodFNpZGVGaWxsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChyaWdodFNpZGVGaWxsZWQpIHsKICAgICAgICAgICAgICByaWdodFNpZGVGaWxsZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwaXhlbEluZGV4ICs9IDQgKiB3aWR0aDsKICAgICAgICAgICAgeTIrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5fY2FudmFzQ29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTsKICAgICAgfQogICAgfQogICAgZ2V0UGl4ZWwoaW1hZ2VEYXRhLCB4LCB5KSB7CiAgICAgIGNvbnN0IHBpeGVsSW5kZXggPSA0ICogKHkgKiBpbWFnZURhdGEud2lkdGggKyB4KTsKICAgICAgaWYgKHBpeGVsSW5kZXggPCAwIHx8IHBpeGVsSW5kZXggPj0gaW1hZ2VEYXRhLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIFswLCAwLCAwXTsKICAgICAgfQogICAgICByZXR1cm4gW2ltYWdlRGF0YS5kYXRhW3BpeGVsSW5kZXhdLCBpbWFnZURhdGEuZGF0YVtwaXhlbEluZGV4ICsgMV0sIGltYWdlRGF0YS5kYXRhW3BpeGVsSW5kZXggKyAyXV07CiAgICB9CiAgICBzZXRQaXhlbChpbWFnZURhdGEsIGluZGV4LCByLCBnLCBiKSB7CiAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gaW1hZ2VEYXRhLmRhdGEubGVuZ3RoKSByZXR1cm47CiAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4XSA9IHI7CiAgICAgIGltYWdlRGF0YS5kYXRhW2luZGV4ICsgMV0gPSBnOwogICAgICBpbWFnZURhdGEuZGF0YVtpbmRleCArIDJdID0gYjsKICAgICAgaW1hZ2VEYXRhLmRhdGFbaW5kZXggKyAzXSA9IDI1NTsKICAgIH0KICAgIGNsYW1wKHZhbHVlLCBtaW4sIG1heCkgewogICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIG1pbiksIG1heCk7CiAgICB9CiAgfTsKCiAgLy8gc3JjL3V0aWwvZ2lmL2dpZkVuY29kZXIudHMKICB2YXIgaW1wb3J0X29tZ2dpZiA9IF9fdG9FU00ocmVxdWlyZV9vbWdnaWYoKSwgMSk7CiAgdmFyIEdpZkVuY29kZXIgPSBjbGFzcyB7CiAgICB3aWR0aCA9IDgwMDsKICAgIGhlaWdodCA9IDYwMDsKICAgIGJ1ZmZlcjsKICAgIGdpZldyaXRlcjsKICAgIGZyYW1lQ291bnQgPSAwOwogICAgY29sb3JzOwogICAgY29uc3RydWN0b3IoY29sb3JTZXQsIGZyYW1lQ291bnQpIHsKICAgICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSh0aGlzLndpZHRoICogdGhpcy5oZWlnaHQgKiA1ICogZnJhbWVDb3VudCk7CiAgICAgIHRoaXMuZ2lmV3JpdGVyID0gbmV3IGltcG9ydF9vbWdnaWYuR2lmV3JpdGVyKHRoaXMuYnVmZmVyLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgeyBsb29wOiAxIH0pOwogICAgICBjb25zdCBjb2xvclRvS2V5ID0gKGNvbG9yKSA9PiBjb2xvci5yZ2JBcnJheS5zbGljZSgwLCAzKS5qb2luKCIsIik7CiAgICAgIGNvbnN0IHdoaXRlID0gQ29sb3IuZnJvbVJnYigyNTUsIDI1NSwgMjU1KTsKICAgICAgdGhpcy5jb2xvcnMgPSBuZXcgTWFwKAogICAgICAgIGNvbG9yU2V0LnZhbHVlcygpLm1hcCgoY29sb3IsIGluZGV4KSA9PiBbY29sb3IucmdiQXJyYXkuc2xpY2UoMCwgMykudG9TdHJpbmcoKSwgeyBjb2xvciwgaW5kZXggfV0pCiAgICAgICk7CiAgICAgIGlmICghdGhpcy5jb2xvcnMuaGFzKGNvbG9yVG9LZXkod2hpdGUpKSkgewogICAgICAgIHRoaXMuY29sb3JzLnNldChjb2xvclRvS2V5KHdoaXRlKSwgeyBjb2xvcjogd2hpdGUsIGluZGV4OiB0aGlzLmNvbG9ycy5zaXplIH0pOwogICAgICB9CiAgICAgIGNvbnN0IG5leHRQb3dlck9mVHdvID0gKG4pID0+IE1hdGgucG93KDIsIE1hdGguY2VpbChNYXRoLmxvZzIobikpKTsKICAgICAgY29uc3QgcmVxdWlyZWRTaXplID0gbmV4dFBvd2VyT2ZUd28odGhpcy5jb2xvcnMuc2l6ZSk7CiAgICAgIGlmICh0aGlzLmNvbG9ycy5zaXplIDwgcmVxdWlyZWRTaXplKSB7CiAgICAgICAgY29uc3QgZmlsbCA9IG5ldyBBcnJheShyZXF1aXJlZFNpemUgLSB0aGlzLmNvbG9ycy5zaXplKS5maWxsKHdoaXRlKTsKICAgICAgICBmaWxsLmZvckVhY2goKGNvbG9yLCBpbmRleCkgPT4gewogICAgICAgICAgdGhpcy5jb2xvcnMuc2V0KGBmaWxsLSR7aW5kZXh9YCwgeyBjb2xvciwgaW5kZXg6IHRoaXMuY29sb3JzLnNpemUgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIGdldCBwYWxldHRlKCkgewogICAgICByZXR1cm4gWy4uLnRoaXMuY29sb3JzLnZhbHVlcygpXS5tYXAoKGMpID0+IHsKICAgICAgICBjb25zdCByZ2IgPSBjLmNvbG9yLnJnYkFycmF5OwogICAgICAgIHJldHVybiByZ2JbMl0gfCByZ2JbMV0gPDwgOCB8IHJnYlswXSA8PCAxNjsKICAgICAgfSk7CiAgICB9CiAgICBtYXBUb1BhbGV0dGVJbmRleChjb2xvcikgewogICAgICByZXR1cm4gdGhpcy5jb2xvcnMuZ2V0KGNvbG9yLnRvU3RyaW5nKCkpPy5pbmRleCA/PyAwOwogICAgfQogICAgYWRkRnJhbWUoaW1hZ2VEYXRhLCBkZWxheU1zKSB7CiAgICAgIGNvbnN0IHBhbGV0dGUgPSB0aGlzLnBhbGV0dGU7CiAgICAgIGNvbnN0IGluZGV4ZWRQaXhlbHMgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWFnZURhdGEubGVuZ3RoOyBpICs9IDQpIHsKICAgICAgICBjb25zdCBjb2xvciA9IFtpbWFnZURhdGFbaV0sIGltYWdlRGF0YVtpICsgMV0sIGltYWdlRGF0YVtpICsgMl1dOwogICAgICAgIGluZGV4ZWRQaXhlbHMucHVzaCh0aGlzLm1hcFRvUGFsZXR0ZUluZGV4KGNvbG9yKSk7CiAgICAgIH0KICAgICAgdGhpcy5naWZXcml0ZXIuYWRkRnJhbWUoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIGluZGV4ZWRQaXhlbHMsIHsKICAgICAgICBkZWxheTogZGVsYXlNcyAvIDEwLAogICAgICAgIHBhbGV0dGUsCiAgICAgICAgZGlzcG9zYWw6IDIKICAgICAgfSk7CiAgICAgIHRoaXMuZnJhbWVDb3VudCsrOwogICAgfQogICAgZmluYWxpemUoKSB7CiAgICAgIGlmICh0aGlzLmZyYW1lQ291bnQgPT09IDApIHRocm93IG5ldyBFcnJvcigiTm8gZnJhbWVzIGFkZGVkIHRvIHRoZSBHSUYuIik7CiAgICAgIGNvbnN0IGdpZkRhdGEgPSB0aGlzLmJ1ZmZlci5zdWJhcnJheSgwLCB0aGlzLmdpZldyaXRlci5lbmQoKSk7CiAgICAgIHJldHVybiBuZXcgQmxvYihbZ2lmRGF0YV0sIHsgdHlwZTogImltYWdlL2dpZiIgfSk7CiAgICB9CiAgfTsKCiAgLy8gc3JjL3V0aWwvZ2lmL2NyZWF0ZUdpZi50cwogIGZ1bmN0aW9uIGNyZWF0ZUdpZihwcm9jZXNzb3IsIGNvbW1hbmRzLCBjb21tYW5kUmVzb2x1dGlvbiwgZnJhbWVEZWxheSwgZnJhbWVDb3VudCwgb25GcmFtZVJlbmRlcmVkKSB7CiAgICBjb25zdCBza3JpYmJsQ29sb3JDb2RlcyA9IG5ldyBTZXQoY29tbWFuZHMubWFwKChjKSA9PiBjWzFdKSk7CiAgICBpZiAoc2tyaWJibENvbG9yQ29kZXMuc2l6ZSA+IDI1NikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlRvbyBtYW55IGNvbG9ycyBpbiB0aGUgc2tyaWJibCBjb21tYW5kcyB0byByZW5kZXIgZ2lmIik7CiAgICB9CiAgICBjb25zdCBjb2xvclNldCA9IG5ldyBTZXQoc2tyaWJibENvbG9yQ29kZXMudmFsdWVzKCkubWFwKChjKSA9PiBDb2xvci5mcm9tU2tyaWJibENvZGUoYykpKTsKICAgIGNvbnN0IGdpZkVuY29kZXIgPSBuZXcgR2lmRW5jb2Rlcihjb2xvclNldCwgZnJhbWVDb3VudCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbW1hbmRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHByb2Nlc3Nvci5wcm9jZXNzRHJhd0NvbW1hbmQoY29tbWFuZHNbaV0pOwogICAgICBpZiAoaSAlIGNvbW1hbmRSZXNvbHV0aW9uID09PSAwKSB7CiAgICAgICAgY29uc3QgaW1hZ2UgPSBwcm9jZXNzb3IuZXhwb3J0SW1hZ2UoKTsKICAgICAgICBnaWZFbmNvZGVyLmFkZEZyYW1lKGltYWdlLCBmcmFtZURlbGF5KTsKICAgICAgICBvbkZyYW1lUmVuZGVyZWQ/LihpLCBjb21tYW5kcy5sZW5ndGgpOwogICAgICB9CiAgICB9CiAgICBnaWZFbmNvZGVyLmFkZEZyYW1lKHByb2Nlc3Nvci5leHBvcnRJbWFnZSgpLCAyZTMpOwogICAgcmV0dXJuIGdpZkVuY29kZXIuZmluYWxpemUoKTsKICB9CgogIC8vIHNyYy93b3JrZXIvdHlwZWQtd29ya2VyLnRzCiAgdmFyIFR5cGVkV29ya2VyID0gY2xhc3MgewogICAgY29uc3RydWN0b3Iod29ya2VyKSB7CiAgICAgIHRoaXMud29ya2VyID0gd29ya2VyOwogICAgICBhZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgYXN5bmMgKGV2ZW50KSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXZlbnQpOwogICAgICAgIGNvbnN0IHsgbWV0aG9kTmFtZSwgYXJncywgbWVzc2FnZUlkIH0gPSBldmVudC5kYXRhOwogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMud29ya2VyW21ldGhvZE5hbWVdKC4uLmFyZ3MpOwogICAgICAgIHBvc3RNZXNzYWdlKHsgdHlwZTogInJlc3VsdCIsIG1lc3NhZ2VJZCwgcmVzdWx0IH0pOwogICAgICB9KTsKICAgIH0KICAgIHNlbmQobWV0aG9kTmFtZSwgLi4uYXJncykgewogICAgICBwb3N0TWVzc2FnZSh7IHR5cGU6ICJub3RpZmljYXRpb24iLCBtZXRob2ROYW1lLCBhcmdzIH0pOwogICAgfQogIH07CgogIC8vIHNyYy93b3JrZXIvZ2lmLXJlbmRlcmVyL2dpZi1yZW5kZXJlci53b3JrZXIudHMKICB2YXIgZ2lmUmVuZGVyZXJXb3JrZXIgPSB7CiAgICByZW5kZXJHaWYoY29tbWFuZHMsIGR1cmF0aW9uKSB7CiAgICAgIGNvbnNvbGUubG9nKCJSZW5kZXJpbmcgZ2lmIiwgY29tbWFuZHMsIGR1cmF0aW9uKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuQ2FudmFzID0gbmV3IE9mZnNjcmVlbkNhbnZhcyg4MDAsIDYwMCk7CiAgICAgIGNvbnN0IGNvbnRleHQgPSBvZmZzY3JlZW5DYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7IHdpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZSB9KTsKICAgICAgaWYgKCFjb250ZXh0KSB0aHJvdyBuZXcgRXJyb3IoIkZhaWxlZCB0byBnZXQgMmQgY29udGV4dCIpOwogICAgICBjb25zdCBwcm9jZXNzb3IgPSBuZXcgQ2FudmFzQ29tbWFuZFByb2Nlc3Nvcihjb250ZXh0KTsKICAgICAgY29uc3QgZnJhbWVEZWxheSA9IDUwOwogICAgICBjb25zdCBmcmFtZUNvdW50ID0gTWF0aC5jZWlsKGR1cmF0aW9uIC8gZnJhbWVEZWxheSk7CiAgICAgIGNvbnN0IGNvbW1hbmRSZXNvbHV0aW9uID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihjb21tYW5kcy5sZW5ndGggLyBmcmFtZUNvdW50KSk7CiAgICAgIGNvbnN0IGdpZiA9IGNyZWF0ZUdpZihwcm9jZXNzb3IsIGNvbW1hbmRzLCBjb21tYW5kUmVzb2x1dGlvbiwgZnJhbWVEZWxheSwgZnJhbWVDb3VudCwgKGZyYW1lSW5kZXgsIHRvdGFsRnJhbWVzKSA9PiBwYXJlbnQuc2VuZCgiZnJhbWVSZW5kZXJlZCIsIGZyYW1lSW5kZXgsIHRvdGFsRnJhbWVzKSk7CiAgICAgIHJldHVybiBnaWY7CiAgICB9CiAgfTsKICB2YXIgcGFyZW50ID0gbmV3IFR5cGVkV29ya2VyKGdpZlJlbmRlcmVyV29ya2VyKTsKfSkoKTsK\";","<script lang=\"ts\">\n  import FlatButton from \"@/lib/flat-button/flat-button.svelte\";\n  import type { ToolbarSaveFeature } from \"./toolbar-save.feature\";\n  export let feature: ToolbarSaveFeature;\n  feature.customName = \"\";\n</script>\n\n<style lang=\"scss\">\n  .typo-toolbar-save-actions {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    align-items: stretch;\n    gap: 1em;\n  }\n</style>\n\n<div class=\"typo-toolbar-save-actions\">\n  <input type=\"text\" class=\"typo\" placeholder=\"Custom image name\" bind:value={feature.customName} />\n  <FlatButton content=\"Download PNG\" color=\"green\" on:click={() => feature.saveAsPng()}  />\n  <FlatButton content=\"Download GIF\" color=\"green\" on:click={() => feature.saveAsGif()} />\n  <FlatButton content=\"Download Draw Progress\" color=\"green\" on:click={() => feature.saveAsDrawCommands()} />\n  <FlatButton content=\"Copy to Clipboard\" color=\"blue\" on:click={() => feature.saveToClipboard()}  />\n  <FlatButton content=\"Save in Cloud\" color=\"blue\" on:click={() => feature.saveInCloud()} />\n</div>","import { ExtensionCommand } from \"@/content/core/commands/command\";\nimport { StringOptionalCommandParameter } from \"@/content/core/commands/params/string-optional-command-parameter\";\nimport { InterpretableSilentSuccess } from \"@/content/core/commands/results/interpretable-silent-success\";\nimport { HotkeyAction } from \"@/content/core/hotkeys/hotkey\";\nimport { CloudService } from \"@/content/features/controls-cloud/cloud.service\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { ImageFinishedService } from \"@/content/services/image-finished/image-finished.service\";\nimport { LobbyService } from \"@/content/services/lobby/lobby.service\";\nimport { MemberService } from \"@/content/services/member/member.service\";\nimport type { componentData } from \"@/content/services/modal/modal.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ElementsSetup } from \"@/content/setups/elements/elements.setup\";\nimport { copyBlobToClipboard } from \"@/util/clipboard\";\nimport { downloadBlob, downloadText } from \"@/util/download\";\nimport {\n  type IGifRendererParent,\n  type IGifRendererWorker,\n} from \"@/worker/gif-renderer/gif-renderer.worker\";\nimport { TypedWorkerExecutor } from \"@/worker/typed-worker\";\nimport { gifRendererWorkerBase64 } from \"@/worker/workers\";\nimport { inject } from \"inversify\";\nimport { catchError, combineLatest, map, of, Subscription, switchMap, take, withLatestFrom } from \"rxjs\";\nimport { fromPromise } from \"rxjs/internal/observable/innerFrom\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport ToolbarSave from \"./toolbar-save.svelte\";\nimport IconButton from \"@/lib/icon-button/icon-button.svelte\";\nimport AreaFlyout from \"@/lib/area-flyout/area-flyout.svelte\";\n\nexport class ToolbarSaveFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(DrawingService) private readonly _drawingService!: DrawingService;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n  @inject(ToastService) private readonly _toastService!: ToastService;\n  @inject(CloudService) private readonly _cloudService!: CloudService;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(ImageFinishedService) private readonly _imageFinishedService!: ImageFinishedService;\n\n  public readonly name = \"Save Image\";\n  public readonly description =\n    \"Adds an icon to the typo toolbar to save the current image locally, to cloud, as gif or as draw command file\";\n  public readonly featureId = 12;\n\n  private _iconComponent?: IconButton;\n  private _iconClickSubscription?: Subscription;\n  private _flyoutComponent?: AreaFlyout;\n  private _flyoutSubscription?: Subscription;\n  private _customName?: string;\n\n  public set customName(value: string | undefined){\n    const val = value?.replace(/[^a-z0-9]/gi, \"_\") ?? undefined;\n    this._customName = val && val.length > 0 ? val : undefined;\n  }\n\n  public get customName(){\n    return this._customName;\n  }\n\n  private readonly _saveCommand = this.useCommand(\n    new ExtensionCommand(\"save\", this, \"Save Image\", \"Downloads the current image\"),\n  ).withParameters(params => params\n    .addParam(new StringOptionalCommandParameter(\"File name\", \"The filename of the downloaded image\", name => ({ name })))\n    .run(async (args, command) => {\n      this._customName = args.name;\n      await this.saveAsPng();\n      return new InterpretableSilentSuccess(command);\n    })\n  );\n\n  private readonly _copyHotkey = this.useHotkey(\n    new HotkeyAction(\n      \"save\",\n      \"Copy to Clipboard\",\n      \"Copy the current image to the clipboard\",\n      this,\n      () => this.saveToClipboard(),\n      true,\n      [\"ControlLeft\", \"KeyC\"]\n    ));\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    /* create icon and attach to toolbar */\n    this._iconComponent = new IconButton({\n      target: elements.toolbar,\n      props: {\n        icon: \"file-img-floppy-drive-gif\",\n        name: \"Save Image\",\n        order: 2,\n        tooltipAction: this.createTooltip,\n        lockTooltip: \"Y\"\n      },\n    });\n\n    /* listen for click on icon */\n    this._iconClickSubscription = this._iconComponent.click$.subscribe(() => {\n\n      /* if already opened, return */\n      if (this._flyoutComponent) {\n        return;\n      }\n\n      /* create fly out content */\n      const flyoutContent: componentData<ToolbarSave> = {\n        componentType: ToolbarSave,\n        props: {\n          feature: this,\n        },\n      };\n\n      /* open flyout and destroy when clicked out */\n      this._flyoutComponent = new AreaFlyout({\n        target: elements.gameWrapper,\n        props: {\n          componentData: flyoutContent,\n          areaName: \"chat\",\n          maxHeight: \"600px\",\n          maxWidth: \"300px\",\n          title: \"Save Image\",\n          iconName: \"file-img-floppy-drive-gif\",\n        },\n      });\n      this._flyoutSubscription = this._flyoutComponent.closed$.subscribe(() => {\n        this._logger.info(\"Destroyed flyout\");\n        this._flyoutComponent?.$destroy();\n        this._flyoutSubscription?.unsubscribe();\n        this._flyoutComponent = undefined;\n      });\n    });\n  }\n\n  async saveInCloud() {\n    const toast = await this._toastService.showLoadingToast(\"Uploading image\");\n    this._imageFinishedService\n      .mapToImageState()\n      .pipe(\n        withLatestFrom(this._memberService.member$),\n        catchError((err) => {\n          this._logger.error(\"Failed to save image\", err);\n          toast.reject(\"Unknown error :(\");\n          throw err;\n        }),\n      )\n      .subscribe(async ([image, member]) => {\n        if (!image) {\n          this._logger.error(\"Failed to get image data, no drawing active?\");\n          toast.reject(\"Failed to get image\");\n          throw new Error(\"No drawing active\");\n        }\n        if (!member) {\n          this._logger.error(\"Failed to get member, not logged in?\");\n          toast.reject(\"You need to log in to use the cloud\");\n          return of(false);\n        }\n\n        /* use custom name */\n        if (this._customName) {\n          image.name = this._customName;\n        }\n\n        await this._cloudService.uploadToCloud(image, member);\n        toast.resolve();\n      });\n  }\n\n  async saveAsPng() {\n    const toast = await this._toastService.showLoadingToast(\"Downloading image\");\n    combineLatest({\n      blob: fromPromise(this._drawingService.getCurrentImageData()).pipe(map(data => data.blob)),\n      meta: this._drawingService.imageState$.pipe(take(1)),\n      lobby: this._lobbyService.lobby$.pipe(take(1)),\n    }).pipe(\n      catchError(err => {\n        this._logger.error(\"Failed to download image\", err);\n        toast.reject();\n        throw err;\n      })\n    ).subscribe(({ blob, meta, lobby }) => {\n      if(!meta) {\n        this._logger.error(\"Failed to get image meta data, no drawing active?\");\n        toast.reject(\"Failed to get image\");\n        throw new Error(\"No drawing active\");\n      }\n\n      if(!lobby) {\n        this._logger.error(\"Failed to get lobby, not joined?\");\n        toast.reject(\"failed to get lobby details\");\n        throw new Error(\"Not joined in lobby\");\n      }\n\n      const drawer = lobby.players.find(player => player.id === meta.drawerId)?.name ?? \"unknown\";\n      downloadBlob(blob, (this._customName ?? `skribbl-${meta.word.hints}-by-${drawer}`) + \".png\");\n      toast.resolve();\n    });\n  }\n\n  async saveToClipboard(){\n    this._logger.debug(\"Saving to clipboard\");\n\n    const toast = await this._toastService.showLoadingToast(\"Saving image to clipboard\");\n    combineLatest({\n      blob: fromPromise(this._drawingService.getCurrentImageData()).pipe(map(data => data.blob))\n    }).pipe(\n      catchError(err => {\n        this._logger.error(\"Failed to copy image\", err);\n        toast.reject();\n        throw err;\n      })\n    ).subscribe(async ({ blob }) => {\n      try {\n        await copyBlobToClipboard(blob);\n        toast.resolve();\n      }\n      catch(err){\n        this._logger.error(\"Failed to copy image\", err);\n        toast.reject(\"Failed to copy image\");\n      }\n    });\n  }\n\n  async saveAsGif() {\n    this._logger.debug(\"Saving as gif\");\n    const toast = await this._toastService.showStickyToast(\"Generating GIF\");\n\n    combineLatest({\n      commands: this._drawingService.commands$,\n      lobby: this._lobbyService.lobby$.pipe(take(1)),\n      state: this._drawingService.imageState$,\n      duration: fromPromise(this._toastService.showPromptToast(\"Generate GIF\", \"Enter the preferred duration in seconds\")).pipe(\n        switchMap(v => v.result)\n      )\n    }).pipe(\n      take(1)\n    ).subscribe(async ({commands, lobby, state, duration}) => {\n\n      const durationMs = parseFloat(duration ?? \"\") * 1000;\n      if(Number.isNaN(durationMs)){\n        toast.resolve(\"Invalid duration entered\");\n        return;\n      }\n\n      if(state === null) {\n        this._logger.warn(\"Attempted to save commands, but state null. In a lobby?\");\n        toast.resolve(\"No drawing active\");\n        throw new Error(\"state is null\");\n      }\n\n      if(!lobby) {\n        this._logger.error(\"Failed to get lobby, not joined?\");\n        toast.resolve(\"Failed to get lobby details\");\n        throw new Error(\"Not joined in lobby\");\n      }\n\n      const progressBar = (progress: number) => {\n        const doneChar = \"█\";\n        const leftChar = \"░\";\n        const length = 10;\n        const done = Math.floor(progress * length);\n        const left = length - done;\n        return `${doneChar.repeat(done)}${leftChar.repeat(left)}`;\n      };\n\n      const drawer = lobby.players.find(player => player.id === state.drawerId)?.name ?? \"unknown\";\n      const name = this._customName ?? `skribbl-${state.word.hints}-by-${drawer}`;\n\n      const workerBlob = new Blob([atob(gifRendererWorkerBase64)], { type: \"application/javascript\" });\n      const worker = new TypedWorkerExecutor<IGifRendererWorker, IGifRendererParent>(\n        URL.createObjectURL(workerBlob),\n        {\n          frameRendered: (index, total) => {\n            toast.update(`Rendering GIF..   ${progressBar(index / total)} (${Math.floor(index*100/total).toString().padStart(2, \" \")}%)`);\n          }\n        }\n      );\n      const gif = await worker.run(\"renderGif\", commands, durationMs);\n      /*const gif = gifRendererWorker.renderGif(commands, 5000);*/\n\n      toast.resolve(`${name} rendered`, 3000);\n      downloadBlob(gif, `${name}.gif`);\n    });\n  }\n\n  async saveAsDrawCommands() {\n    this._logger.debug(\"Saving as draw commands\");\n    const toast = await this._toastService.showLoadingToast(\"Downloading commands\");\n\n    combineLatest({\n      meta: this._drawingService.imageState$.pipe(take(1)),\n      lobby: this._lobbyService.lobby$.pipe(take(1)),\n      commands: this._drawingService.commands$.pipe(take(1)),\n    }).pipe(\n      catchError(err => {\n        this._logger.error(\"Failed to download commands\", err);\n        toast.reject();\n        throw err;\n      })\n    ).subscribe(({meta, lobby, commands}) => {\n      if(!meta) {\n        this._logger.error(\"Failed to get image meta data, no drawing active?\");\n        toast.reject(\"Failed to get image\");\n        throw new Error(\"No drawing active\");\n      }\n\n      if(!lobby) {\n        this._logger.error(\"Failed to get lobby, not joined?\");\n        toast.reject(\"failed to get lobby details\");\n        throw new Error(\"Not joined in lobby\");\n      }\n\n      const json = JSON.stringify(commands);\n      const drawer = lobby.players.find(player => player.id === meta.drawerId)?.name ?? \"unknown\";\n      downloadText(json, (this._customName ?? `skribbl-${meta.word.hints}-by-${drawer}`) + \".skd\");\n      toast.resolve();\n    });\n  }\n\n  protected override onDestroy(): Promise<void> | void {\n    this._iconClickSubscription?.unsubscribe();\n    this._iconComponent?.$destroy();\n    this._flyoutComponent?.$destroy();\n    this._flyoutSubscription?.unsubscribe();\n  }\n}","<script lang=\"ts\">\n  export let title: string;\n  export let direction: \"N\" | \"S\" | \"E\" | \"W\";\n  export let anchorX: number;\n  export let anchorY: number;\n</script>\n\n<style lang=\"scss\">\n\n  @keyframes appear {\n    from {\n      opacity: 0;\n      scale: 0;\n    }\n    to {\n      opacity: 1;\n      scale: 1;\n    }\n  }\n\n  .typo-tooltip {\n    position: fixed;\n    display: flex;\n    z-index: 10000;\n    align-items: center;\n    animation: appear .1s forwards ease-out;\n    pointer-events: none;\n    transform-origin: 0 0;\n\n    span {\n      background-color: var(--COLOR_TOOL_TIP_BG);\n      color: var(--COLOR_PANEL_TEXT);\n      border-radius: var(--BORDER_RADIUS);\n      padding: 7px;\n      text-shadow: 1px 1px 0 #00000038;\n      text-align: center;\n      font-size: 13px;\n      font-weight: 700;\n      white-space: pre;\n    }\n\n    .typo-tooltip-arrow {\n      height: 0;\n      width: 0;\n    }\n\n    &.E {\n      transform: translateY(-50%);\n      flex-direction: row;\n\n      .typo-tooltip-arrow {\n        border-right: 10px solid var(--COLOR_TOOL_TIP_BG);\n        border-top: 10px solid transparent;\n        border-bottom: 10px solid transparent;\n      }\n    }\n\n    &.S {\n      transform: translateX(-50%);\n      flex-direction: column;\n\n      .typo-tooltip-arrow {\n        border-bottom: 10px solid var(--COLOR_TOOL_TIP_BG);\n        border-left: 10px solid transparent;\n        border-right: 10px solid transparent;\n      }\n    }\n\n    &.N {\n      flex-direction: column-reverse;\n      transform: translateX(-50%) translateY(-100%); ;\n\n      .typo-tooltip-arrow {\n        border-top: 10px solid var(--COLOR_TOOL_TIP_BG);\n        border-left: 10px solid transparent;\n        border-right: 10px solid transparent;\n      }\n    }\n\n    &.W {\n      flex-direction: row-reverse;\n      transform: translateX(-100%) translateY(-50%);\n\n      .typo-tooltip-arrow {\n        border-left: 10px solid var(--COLOR_TOOL_TIP_BG);\n        border-top: 10px solid transparent;\n        border-bottom: 10px solid transparent;\n      }\n    }\n  }\n\n</style>\n\n<div class=\"typo-tooltip {direction}\" style=\"top: {anchorY}px; left: {anchorX}px\">\n  <div class=\"typo-tooltip-arrow\"></div>\n  <span>{title}</span>\n</div>","import { TypoFeature } from \"@/content/core/feature/feature\";\nimport type { registeredTooltip } from \"@/content/core/tooltips/tooltips.service\";\nimport { BehaviorSubject, combineLatestWith, type Subscription } from \"rxjs\";\nimport Tooltip from \"./tooltip.svelte\";\n\ninterface activeTooltip {\n  registration: registeredTooltip,\n  tooltip: Tooltip\n}\n\nexport class TooltipsFeature extends TypoFeature {\n\n  public readonly name = \"Tooltips\";\n  public readonly description = \"Show helpful information when hovering over icons and buttons\";\n  public readonly featureId = 35;\n\n  private readonly _pointeroverListener = this.handlePointerover.bind(this);\n  private _currentTarget = new BehaviorSubject<HTMLElement | null>(null);\n  private _targetSubscription?: Subscription;\n  private _activeTooltips = new Map<HTMLElement, activeTooltip>();\n\n  protected override async onActivate() {\n    this._targetSubscription = this._currentTarget.pipe(\n      combineLatestWith(this._tooltipsService.tooltips$)\n    ).subscribe(([target, tooltips]) => {\n      this.handleTooltipChange(target, tooltips);\n    });\n    document.addEventListener(\"pointerover\", this._pointeroverListener);\n  }\n\n  protected override async onDestroy() {\n    this._targetSubscription?.unsubscribe();\n    this._targetSubscription = undefined;\n    document.removeEventListener(\"pointerover\", this._pointeroverListener);\n\n    this._activeTooltips.forEach(t => t.tooltip.remove());\n    this._activeTooltips.clear();\n  }\n\n  /**\n   * handle a DOM pointerover event and refresh the current target\n   * @param event\n   * @private\n   */\n  private handlePointerover(event: PointerEvent) {\n    this._logger.debug(\"Pointerover\", event.target);\n    const target = event.target;\n\n    if(target instanceof HTMLElement){\n      const targets = this._tooltipsService.getTooltipsUntilElement(target);\n\n      if(targets.length >= 1){\n        const target = targets[0];\n        if(target !== this._currentTarget.value) {\n          this._logger.info(\"Found new target\", targets);\n          this._currentTarget.next(target);\n        }\n      }\n      else if(this._currentTarget.value !== null) {\n        this._logger.info(\"Removed tooltip target\", targets);\n        this._currentTarget.next(null);\n      }\n    }\n    else this._currentTarget.next(null);\n  }\n\n  /**\n   * Refresh the currently displayed tooltips, after the target or registered tooltips changed\n   * @param target\n   * @param tooltips\n   * @private\n   */\n  private handleTooltipChange(target: HTMLElement | null, tooltips: registeredTooltip[]){\n    this._logger.info(\"Tooltip change\", target, tooltips);\n\n    /* remove inactive tooltips */\n    this._activeTooltips.forEach(t => {\n      if(t.registration.target !== target) {\n        this._activeTooltips.delete(t.registration.target);\n        t.tooltip.$destroy();\n      }\n    });\n\n    /* create new if not present */\n    if(target !== null && !this._activeTooltips.has(target)) {\n      const registration = tooltips.find(t => t.target === target);\n      if(!registration) return;\n\n      const tooltip = this.buildTooltip(registration);\n      this._activeTooltips.set(target, {registration, tooltip: tooltip});\n    }\n  }\n\n  /**\n   * Build a tooltip element and attach it to the DOM\n   * @param tooltip\n   * @private\n   */\n  private buildTooltip(tooltip: registeredTooltip): Tooltip {\n\n    /* get direction with most space to viewport bounds */\n    const coordinates = this.getVisibleDimensionsAndCoordinates(tooltip.target);\n\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n\n    const spaceTop = coordinates.top;\n    const spaceBottom = viewportHeight - coordinates.top - coordinates.height;\n    const spaceLeft = coordinates.left;\n    const spaceRight = viewportWidth - coordinates.left - coordinates.width;\n\n    /* set defaults, with respect of axis lock */\n    let direction: \"N\" | \"S\" | \"E\" | \"W\" = tooltip.lock !== \"Y\" ? \"E\" : \"N\";\n    let anchorX = tooltip.lock !== \"Y\" ? coordinates.left + coordinates.width : coordinates.left + coordinates.width / 2;\n    let anchorY = tooltip.lock !== \"Y\" ? coordinates.top + coordinates.height / 2 : coordinates.top;\n\n    /* check if another orientation is better, with respect to axis lock */\n    if (tooltip.lock !== \"X\" && spaceTop > spaceBottom && (spaceTop > spaceLeft && spaceTop > spaceRight || tooltip.lock === \"Y\")) {\n      direction = \"N\";\n      anchorX = coordinates.left + coordinates.width / 2;\n      anchorY = coordinates.top;\n    } else if (tooltip.lock !== \"X\" && spaceBottom > spaceTop && (spaceBottom > spaceLeft && spaceBottom > spaceRight || tooltip.lock === \"Y\")) {\n      direction = \"S\";\n      anchorX = coordinates.left + coordinates.width / 2;\n      anchorY = coordinates.top + coordinates.height;\n    } else if (tooltip.lock !== \"Y\" && spaceLeft > spaceRight) {\n      direction = \"W\";\n      anchorX = coordinates.left;\n      anchorY = coordinates.top + coordinates.height / 2;\n    }\n\n    const element = new Tooltip({\n      target: document.body,\n      props: {\n        title: tooltip.title,\n        anchorX,\n        anchorY,\n        direction\n      }\n    });\n    return element;\n  }\n\n  /**\n   * Get the visible dimensions and coordinates of an element, considering overflow\n   * Caution: Chatgpt\n   * Prompt:\n   * write me a ts function that gets the dimensions and coordinates of the visible area of an element.\n   * consider that elements can be scrollable (higher than visible), may not be the element that produces the overflow (clientHeight/Width does not directly work), and that there may be multiple ensted scrollable containers.\n   * if there is anything else that should be considered, do so.\n   * @param element\n   */\n  getVisibleDimensionsAndCoordinates(element: HTMLElement): {\n    width: number;\n    height: number;\n    top: number;\n    left: number;\n  } {\n    const elementRect = element.getBoundingClientRect();\n    const visibleRect = {\n      top: elementRect.top,\n      left: elementRect.left,\n      width: elementRect.width,\n      height: elementRect.height,\n    };\n\n    let currentElement: HTMLElement | null = element;\n\n    while (currentElement !== null) {\n      const parent: HTMLElement | null = currentElement.parentElement;\n\n      if (parent) {\n        const parentRect = parent.getBoundingClientRect();\n        const parentStyle = getComputedStyle(parent);\n\n        if (parentStyle.overflow !== \"visible\") {\n          visibleRect.top = Math.max(visibleRect.top, parentRect.top);\n          visibleRect.left = Math.max(visibleRect.left, parentRect.left);\n          visibleRect.width = Math.min(\n            visibleRect.width,\n            parentRect.right - visibleRect.left\n          );\n          visibleRect.height = Math.min(\n            visibleRect.height,\n            parentRect.bottom - visibleRect.top\n          );\n        }\n      }\n\n      currentElement = parent;\n    }\n\n    // Clip the visibleRect dimensions to fit within the viewport\n    visibleRect.width = Math.min(visibleRect.width, window.innerWidth - visibleRect.left);\n    visibleRect.height = Math.min(visibleRect.height, window.innerHeight - visibleRect.top);\n    visibleRect.top = Math.max(visibleRect.top, 0);\n    visibleRect.left = Math.max(visibleRect.left, 0);\n\n    return {\n      width: Math.max(0, visibleRect.width),\n      height: Math.max(0, visibleRect.height),\n      top: visibleRect.top,\n      left: visibleRect.left,\n    };\n  }\n}","<script lang=\"ts\">\n  import type { LobbyNavigationFeature } from \"./lobby-navigation.feature\";\n  export let feature: LobbyNavigationFeature;\n</script>\n\n<style lang=\"scss\">\n  .lobby-navigation {\n    gap: 1rem;\n    display: flex;\n    position: absolute;\n    width: fit-content;\n    right: 50px;\n    padding-right: 1rem;\n    height: 100%;\n    align-items: center;\n\n    .lobby-exit, .lobby-next {\n      content: var(--file-img-arrow-small-gif);\n      cursor: pointer;\n      height:42px;\n      aspect-ratio: 1;\n      transition: scale 0.1s ease-in-out;\n\n      &:hover {\n        scale: 1.1;\n      }\n    }\n\n    .lobby-exit {\n      filter: drop-shadow(rgba(0, 0, 0, 0.3) 3px 3px 0px) sepia(1) saturate(5) brightness(0.8) hue-rotate(324deg);\n    }\n\n    .lobby-next {\n      transform: rotateY(180deg);\n      filter: drop-shadow(rgba(0, 0, 0, 0.3) -3px 3px 0px) sepia(1) saturate(5) brightness(0.7) hue-rotate(56deg);\n    }\n  }\n</style>\n\n<div class=\"lobby-navigation\">\n  <!-- lobbyNavIcon exit for legacy theme compatibility -->\n  <img src=\"\" alt=\"Exit Lobby\" class=\"lobby-exit lobbyNavIcon exit\" on:click={() => feature.exitLobby()} use:feature.createTooltip={{title: \"Exit Lobby\", lock: \"Y\"}} />\n\n  <!-- lobbyNavIcon next for legacy theme compatibility -->\n  <img src=\"\" alt=\"Next Lobby\" class=\"lobby-next lobbyNavIcon next\" on:click={() => feature.nextLobby()} use:feature.createTooltip={{title: \"Next Lobby\", lock: \"Y\"}} />\n</div>","import { ExtensionCommand } from \"@/content/core/commands/command\";\nimport { InterpretableSuccess } from \"@/content/core/commands/results/interpretable-success\";\nimport { BooleanExtensionSetting } from \"@/content/core/settings/setting\";\nimport { inject } from \"inversify\";\nimport { filter, type Subscription, take, tap } from \"rxjs\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { LobbyService } from \"../../services/lobby/lobby.service\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\nimport LobbyNavigation from \"./lobby-navigation.svelte\";\n\nexport class LobbyNavigationFeature extends TypoFeature {\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(LobbyService) private readonly _lobbyService!: LobbyService;\n\n  public readonly name = \"Lobby Navigation\";\n  public readonly description = \"Show a navigation bar in-game to exit or skip the current lobby\";\n  public readonly featureId = 2;\n\n  private _component?: LobbyNavigation;\n\n  private readonly _overrideLogoExitSetting = this.useSetting(\n    new BooleanExtensionSetting(\"overrideLogoExit\", true, this)\n      .withName(\"Enhanced Logo Exit\")\n      .withDescription(\"Exit the lobby instead reloading skribbl when clicking the logo\"),\n  );\n\n  private readonly _nextCommand = this.useCommand(\n    new ExtensionCommand(\"skip\", this, \"Skip Lobby\", \"Leave the current lobby and join another\"),\n  ).run(async (command) => {\n    this.nextLobby();\n    return new InterpretableSuccess(command, \"Skipping lobby\");\n  });\n\n  private readonly _leaveCommand = this.useCommand(\n    new ExtensionCommand(\"leave\", this, \"Left Lobby\", \"Leave the current lobby\"),\n  ).run(async (command) => {\n    this.exitLobby();\n    return new InterpretableSuccess(command, \"Skipped lobby\");\n  });\n\n  private _logoClickListener = this.onLogoClick.bind(this);\n  private _settingChangeSubscription?: Subscription;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n\n    this._component = new LobbyNavigation({\n      target: elements.gameBar,\n      anchor: elements.gameSettings,\n      props: {\n        feature: this,\n      },\n    });\n\n    this._settingChangeSubscription = this._overrideLogoExitSetting.changes$.subscribe((value) => {\n      if (value) {\n        elements.logoIngame.addEventListener(\"click\", this._logoClickListener);\n      } else {\n        elements.logoIngame.removeEventListener(\"click\", this._logoClickListener);\n      }\n    });\n  }\n\n  protected override async onDestroy(): Promise<void> {\n    this._component?.$destroy();\n    const elements = await this._elementsSetup.complete();\n    elements.logoIngame.removeEventListener(\"click\", this._logoClickListener);\n  }\n\n  private onLogoClick(event: Event){\n    event.stopImmediatePropagation();\n    event.preventDefault();\n    this._settingChangeSubscription?.unsubscribe();\n    this._settingChangeSubscription = undefined;\n    this.exitLobby();\n  }\n\n  public nextLobby() {\n    /* get first lobby from observable (current) and leave if not null until null received, then join */\n    this._lobbyService.lobby$\n      .pipe(\n        tap((lobby) => {\n          if (lobby !== null) {\n            this._lobbyService.leaveLobby();\n          }\n        }),\n        filter((lobby) => lobby === null),\n        take(1),\n      )\n      .subscribe(() => {\n        this._lobbyService.joinLobby();\n      });\n  }\n\n  public exitLobby() {\n    /* get first lobby from observable (current) and leave if not null*/\n    this._lobbyService.lobby$\n      .pipe(\n        take(1),\n        filter((lobby) => lobby !== null),\n      )\n      .subscribe(() => {\n        this._lobbyService.leaveLobby();\n      });\n  }\n}","<script lang=\"ts\">\n  import { UserInfoFeature } from \"./user-info.feature\";\n  import Bounceload from \"../../../lib/bounceload/bounceload.svelte\";\n\n  export let feature: UserInfoFeature;\n  const member = feature.memberStore;\n  const devmode  = feature.devmodeStore;\n</script>\n\n<style lang=\"scss\">\n\n  :global(#home) .panel.member-info {\n    display: flex;\n    flex-direction: column;\n    gap: 1em;\n    padding: 1em;\n    width: 100%;\n    margin-bottom: 10px; // like avatar customizer above\n    color: var(--COLOR_PANEL_TEXT);\n\n    > .member-info-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n\n      > span, > a {\n        display: flex;\n        align-items: center;\n        gap: .5em;\n        font-weight: bold;\n        font-size: 0.9rem;\n        cursor: pointer;\n        opacity: 0.7;\n        color: inherit;\n        text-decoration: none;\n\n        > img {\n          height: 1.2em;\n          image-rendering: auto;\n          aspect-ratio: 1;\n          content: var(--file-icons-128maxfit-png);\n        }\n      }\n    }\n\n    > .member-info-stats {\n      display: flex;\n      justify-content: space-evenly;\n\n      > div {\n        display: flex;\n        gap: .2em;\n\n        > span {\n          font-weight: bold;\n        }\n\n        > span:nth-child(2) {\n          opacity: 0.8;\n        }\n      }\n    }\n  }\n\n</style>\n\n<div class=\"member-info panel\">\n  {#if ($member === null)}\n    <div>\n      <input type=\"button\" value=\"Login\" on:click={() => feature.login()} />\n    </div>\n\n  {:else if ($member === undefined)}\n    <div>\n      <Bounceload content=\"Loading...\"/>\n    </div>\n\n  {:else}\n\n    <div class=\"member-info-header\">\n      <a href=\"https://www.typo.rip\">\n        <img alt=\"typo icon\" src=\"\"/>\n        {$member.userName}\n      </a>\n      <a href=\"https://www.typo.rip/user\">Manage</a>\n      <span role=\"button\" tabindex=\"0\" on:keydown={() => feature.logout()} on:click={() => feature.logout()}>Logout</span>\n    </div>\n\n    <div class=\"member-info-stats\">\n      <div><span>🫧</span><span>Bubbles:</span><span>{$member.bubbles}</span></div>\n      <div><span>💧</span><span>Drops:</span><span>{Math.round($member.drops * 10) / 10}</span></div>\n    </div>\n\n    {#if $devmode}\n      <div class=\"member-info-stats\">\n        <div><span></span><span>Typo ID:</span><span>{$member.userLogin}</span></div>\n      </div>\n    {/if}\n\n  {/if}\n</div>","import { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { fromObservable } from \"@/util/store/fromObservable\";\nimport { MemberService } from \"../../services/member/member.service\";\nimport UserInfo from \"./user-info.svelte\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\nexport class UserInfoFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elementsSetup!: ElementsSetup;\n  @inject(MemberService) private readonly _memberService!: MemberService;\n  @inject(GlobalSettingsService) private readonly _globalSettingsService!: GlobalSettingsService;\n\n  private _element?: UserInfo;\n\n  public readonly name = \"User Info\";\n  public readonly description = \"Shows information about the logged-in user beneath the avatar selection\";\n  public readonly featureId = 13;\n\n  protected override async onActivate() {\n    const elements = await this._elementsSetup.complete();\n    this._element = new UserInfo({\n      target: elements.avatarPanel,\n      anchor: elements.playButton,\n      props: {\n        feature: this\n      },\n    });\n  }\n\n  protected override onDestroy() {\n    this._element?.$destroy();\n  }\n\n  get memberStore() {\n    return fromObservable(this._memberService.member$, null);\n  }\n\n  get devmodeStore() {\n    return this._globalSettingsService.settings.devMode.store;\n  }\n\n  public login(){\n    this._memberService.login();\n  }\n  public logout() {\n    this._memberService.logout();\n  }\n}","<script lang=\"ts\">\n  import type { AnnouncementDto } from \"@/api\";\n  import { PanelNewsFeature } from \"./panel-news.feature\";\n  import Bounceload from \"@/lib/bounceload/bounceload.svelte\";\n\n  export let feature: PanelNewsFeature;\n  export let announcements: AnnouncementDto[] | undefined = undefined;\n</script>\n\n<style lang=\"scss\">\n  div.typo-news {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    padding: 0 .5rem;\n\n    > .news {\n      white-space: pre;\n      text-wrap: pretty;\n      display: flex;\n      flex-direction: column;\n\n      .announcement {\n        display: flex;\n        flex-direction: column;\n        gap: .5rem;\n        padding: .5rem 0;\n\n        &:not(:last-child) {\n          border-bottom: 1px solid var(--COLOR_PANEL_BORDER_FOCUS);\n        }\n\n        .title {\n          display: flex;\n          justify-content: space-between;\n          gap: 1rem;\n          align-items: center;\n\n          span {\n            font-size: .8rem;\n            opacity: .7;\n          }\n        }\n      }\n    }\n  }\n</style>\n\n<div class=\"typo-news\">\n  <div class=\"news\">\n    {#if announcements === undefined}\n      <Bounceload content=\"Loading news..\" />\n\n    {:else}\n      {#each announcements as announcement}\n        <div class=\"announcement\">\n          <div class=\"title\">\n            <b>{announcement.title}</b>\n            <span>{new Date(Number(announcement.date)).toDateString()}</span>\n          </div>\n          <p>{announcement.content}</p>\n        </div>\n      {/each}\n    {/if}\n  </div>\n</div>","import { AnnouncementDtoTypeEnum } from \"@/api\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { TypoFeature } from \"../../core/feature/feature\";\nimport { inject } from \"inversify\";\nimport PanelNews from \"./panel-news.svelte\";\nimport { ElementsSetup } from \"../../setups/elements/elements.setup\";\n\nexport class PanelNewsFeature extends TypoFeature {\n\n  @inject(ElementsSetup) private readonly _elements!: ElementsSetup;\n  @inject(ApiDataSetup) private readonly _apiDataSetup!: ApiDataSetup;\n\n  private _component?: PanelNews;\n\n  public readonly name = \"Typo News\";\n  public readonly description = \"Displays updates and typo hints on the start page\";\n  public readonly featureId = 7;\n\n  protected override async onActivate() {\n    const elements = await this._elements.complete();\n    this._component = new PanelNews({\n      target: elements.newsTab,\n      props: {\n        feature: this\n      }\n    });\n\n    const data = await this._apiDataSetup.complete();\n    const version = chrome.runtime.getManifest().version;\n    const announcements = data.announcements\n      .filter(announcement => announcement.type === AnnouncementDtoTypeEnum.Announcement &&\n        (announcement.affectedTypoVersion === version || announcement.affectedTypoVersion === undefined)\n      ).sort((a, b) => Number(b.date) - Number(a.date));\n    this._component.$set({ announcements });\n  }\n\n  protected override onDestroy(): void {\n    this._component?.$destroy();\n  }\n}","import \"@abraham/reflection\";\nimport { Interceptor } from \"@/content/core/interceptor/interceptor\";\nimport { LoggingService } from \"@/content/core/logger/logging.service\";\nimport { canvasClearedEventRegistration } from \"@/content/events/canvas-cleared.event\";\nimport { chatTypedEventRegistration } from \"@/content/events/chat-typed.event\";\nimport { colorChangedEventRegistration } from \"@/content/events/color-changed.event\";\nimport { drawEventRegistration } from \"@/content/events/draw.event\";\nimport { hintsAddedEventRegistration } from \"@/content/events/hints-added.event\";\nimport { imageResetEventRegistration } from \"@/content/events/image-reset.event\";\nimport { lobbyInteractedEventRegistration } from \"@/content/events/lobby-interacted.event\";\nimport { lobbyPlayerChangedEventRegistration } from \"@/content/events/lobby-player-changed.event\";\nimport { lobbyStateChangedEventRegistration } from \"@/content/events/lobby-state-changed.event\";\nimport { messageReceivedEventRegistration } from \"@/content/events/message-received.event\";\nimport { messageSentEventRegistration } from \"@/content/events/message-sent.event\";\nimport { playerPopupVisibilityChangedEventRegistration } from \"@/content/events/player-popup-visible.event\";\nimport { roundStartedEventRegistration } from \"@/content/events/round-started.event\";\nimport { scoreboardVisibilityChangedEventRegistration } from \"@/content/events/scoreboard-visible.event\";\nimport { sizeChangedEventRegistration } from \"@/content/events/size-changed.event\";\nimport { textOverlayVisibilityChangedEventRegistration } from \"@/content/events/text-overlay-visible.event\";\nimport { toolChangedEventRegistration } from \"@/content/events/tool-changed.event\";\nimport { wordGuessedEventRegistration } from \"@/content/events/word-guessed.event\";\nimport { CanvasRateIconsFeature } from \"@/content/features/canvas-rate-icons/canvas-rate-icons.feature\";\nimport { CanvasZoomFeature } from \"@/content/features/canvas-zoom/canvas-zoom.feature\";\nimport { ChatClearFeature } from \"@/content/features/chat-clear/chat-clear.feature\";\nimport { ChatCommandsFeature } from \"@/content/features/chat-commands/chat-commands.feature\";\nimport { ChatCopyFormattedFeature } from \"@/content/features/chat-copy-formatted/chat-copy-formatted.feature\";\nimport { ChatEmojisFeature } from \"@/content/features/chat-emojis/chat-emojis.feature\";\nimport { ChatFocusFeature } from \"@/content/features/chat-focus/chat-focus.feature\";\nimport { ChatMessageSplitsFeature } from \"@/content/features/chat-message-splits/chat-message-splits.feature\";\nimport { ChatProfileLinkFeature } from \"@/content/features/chat-profile-link/chat-profile-link.feature\";\nimport { ChatQuickReactFeature } from \"@/content/features/chat-quick-react/chat-quick-react.feature\";\nimport { ChatRecallFeature } from \"@/content/features/chat-recall/chat-recall.feature\";\nimport { CloudService } from \"@/content/features/controls-cloud/cloud.service\";\nimport { ControlsCloudFeature } from \"@/content/features/controls-cloud/controls-cloud.feature\";\nimport { ControlsSettingsFeature } from \"@/content/features/controls-settings/controls-settings.feature\";\nimport { ControlsThemesFeature } from \"@/content/features/controls-themes/controls-themes.feature\";\nimport {\n  CustomizerOutfitToggleFeature\n} from \"@/content/features/customizer-outfit-toggle/customizer-outfit-toggle.feature\";\nimport {\n  CustomizerPracticeJoinFeature\n} from \"@/content/features/customizer-practice-join/customizer-practice-join.feature\";\nimport { DrawingBrushLabFeature } from \"@/content/features/drawing-brush-lab/drawing-brush-lab.feature\";\nimport { DrawingColorPalettesFeature } from \"@/content/features/drawing-color-palettes/drawing-color-palettes.feature\";\nimport { DrawingColorToolsFeature } from \"@/content/features/drawing-color-tools/drawing-color-tools.feature\";\nimport { DrawingPressureFeature } from \"@/content/features/drawing-pressure/drawing-pressure.feature\";\nimport { DropsFeature } from \"@/content/features/drops/drops.feature\";\nimport { GuessCheckFeature } from \"@/content/features/guess-check/guess-check.feature\";\nimport { HotkeysFeature } from \"@/content/features/hotkeys/hotkeys.feature\";\nimport { ImageAgentFeature } from \"@/content/features/image-agent/image-agent.feature\";\nimport { LineToolFeature } from \"@/content/features/line-tool/line-tool.feature\";\nimport { LobbyStatusFeature } from \"@/content/features/lobby-status/lobby-status.feature\";\nimport { LobbyConnectionService } from \"@/content/features/lobby-status/lobby-connection.service\";\nimport { LobbyTimeVisualizerFeature } from \"@/content/features/lobby-time-visualizer/lobby-time-visualizer.feature\";\nimport { LoggingFeature } from \"@/content/features/logging/logging.feature\";\nimport { PanelCabinFeature } from \"@/content/features/panel-cabin/panel-cabin.feature\";\nimport { PanelChangelogFeature } from \"@/content/features/panel-changelog/panel-changelog.feature\";\nimport { PanelFiltersFeature } from \"@/content/features/panel-filters/panel-filters.feature\";\nimport { PanelLobbiesFeature } from \"@/content/features/panel-lobbies/panel-lobbies.feature\";\nimport { PlayerAwardsFeature } from \"@/content/features/player-awards/player-awards-feature\";\nimport { PlayerIdsFeature } from \"@/content/features/player-ids/player-ids.feature\";\nimport { PlayerScenesFeature } from \"@/content/features/player-scenes/player-scenes.feature\";\nimport { PlayerSpritesFeature } from \"@/content/features/player-sprites/player-sprites.feature\";\nimport { ToolbarChallengesFeature } from \"@/content/features/toolbar-challenges/toolbar-challenges.feature\";\nimport { ToolbarFullscreenFeature } from \"@/content/features/toolbar-fullscreen/toolbar-fullscreen.feature\";\nimport { ToolbarImageLabFeature } from \"@/content/features/toolbar-imagelab/toolbar-imagelab.feature\";\nimport { ToolbarImagePostFeature } from \"@/content/features/toolbar-imagepost/toolbar-imagepost.feature\";\nimport { ToolbarSaveFeature } from \"@/content/features/toolbar-save/toolbar-save.feature\";\nimport { ImagelabService } from \"@/content/features/toolbar-imagelab/imagelab.service\";\nimport { TooltipsFeature } from \"@/content/features/tooltips/tooltips.feature\";\nimport { ChatService } from \"@/content/services/chat/chat.service\";\nimport { ColorsService } from \"@/content/services/colors/colors.service\";\nimport { DrawingService } from \"@/content/services/drawing/drawing.service\";\nimport { ExtensionContainer } from \"@/content/core/extension-container/extension-container\";\nimport { GlobalSettingsService } from \"@/content/services/global-settings/global-settings.service\";\nimport { ImageFinishedService } from \"@/content/services/image-finished/image-finished.service\";\nimport { ImagePostService } from \"@/content/features/toolbar-imagepost/image-post.service\";\nimport { LobbyInteractionsService } from \"@/content/services/lobby-interactions/lobby-interactions.service\";\nimport { LobbyItemsService } from \"@/content/services/lobby-items/lobby-items.service\";\nimport { PlayersService } from \"@/content/services/players/players.service\";\nimport { SocketService } from \"@/content/services/socket/socket.service\";\nimport { ThemesService } from \"@/content/services/themes/themes.service\";\nimport { ToastService } from \"@/content/services/toast/toast.service\";\nimport { ToolsService } from \"@/content/services/tools/tools.service\";\nimport { ApiDataSetup } from \"@/content/setups/api-data/api-data.setup\";\nimport { ChatControlsSetup } from \"@/content/setups/chat-controls/chat-controls.setup\";\nimport { ControlsSetup } from \"@/content/setups/controls/controls.setup\";\nimport { CssColorVarSelectorsSetup } from \"@/content/setups/css-color-var-selectors/cssColorVarSelectors.setup\";\nimport { CustomizerActionsSetup } from \"@/content/setups/customizer-actions/customizer-actions.setup\";\nimport { LandingPlayerSetup } from \"@/content/setups/landing-player/landing-player.setup\";\nimport {\n  PrioritizedCanvasEventsSetup\n} from \"@/content/setups/prioritized-canvas-events/prioritized-canvas-events.setup\";\nimport { SkribblEmitRelaySetup } from \"@/content/setups/skribbl-emit-relay/skribbl-emit-relay.setup\";\nimport { SkribblInitializedSetup } from \"@/content/setups/skribbl-initialized/skribbl-initialized.setup\";\nimport { ToastSetup } from \"@/content/setups/toast/toast.setup\";\nimport { lobbyJoinedEventRegistration } from \"./events/lobby-joined.event\";\nimport { lobbyLeftEventRegistration } from \"./events/lobby-left.event\";\nimport { LobbyNavigationFeature } from \"./features/lobby-navigation/lobby-navigation.feature\";\nimport { LobbyService } from \"./services/lobby/lobby.service\";\nimport { UserInfoFeature } from \"./features/user-info/user-info.feature\";\nimport { PanelNewsFeature } from \"@/content/features/panel-news/panel-news.feature\";\nimport { ApiService } from \"./services/api/api.service\";\nimport { MemberService } from \"./services/member/member.service\";\nimport { ModalService } from \"./services/modal/modal.service\";\nimport { GamePatchReadySetup } from \"./setups/game-patch-ready/game-patch-ready.setup\";\nimport { GameSettingsSetup } from \"./setups/game-settings/game-settings.setup\";\nimport { PanelSetup } from \"./setups/panel/panel.setup\";\nimport { ElementsSetup } from \"./setups/elements/elements.setup\";\n\nimport \"./content.scss\";\nimport { SkribblMessageRelaySetup } from \"./setups/skribbl-message-relay/skribbl-message-relay.setup\";\nimport { ToolbarSetup } from \"./setups/toolbar/toolbar.setup\";\n\n/**\n * Entry point for the skribbltypo extension\n * For details about architecture and design, refer to the README.md\n */\n\n/* interceptor to patch DOM build */\nconst interceptor = new Interceptor(true);\n\n/* set initial log level */\nLoggingService.defaultLogLevel = \"warn\";\n\n/* start application container */\nnew ExtensionContainer(interceptor)\n  .registerServices( /* register services to the application */\n    {type: ModalService, scope: \"scoped\"},\n    {type: ApiService, scope: \"singleton\"},\n    {type: MemberService, scope: \"singleton\"},\n    {type: LobbyService, scope: \"singleton\"},\n    {type: DrawingService, scope: \"singleton\"},\n    {type: ToolsService, scope: \"singleton\"},\n    {type: GlobalSettingsService, scope: \"singleton\"},\n    {type: ImageFinishedService, scope: \"singleton\"},\n    {type: ImagelabService, scope: \"singleton\"},\n    {type: ImagePostService, scope: \"singleton\"},\n    {type: CloudService, scope: \"singleton\"},\n    {type: ToastService, scope: \"scoped\"},\n    {type: SocketService, scope: \"scoped\"},\n    {type: LobbyItemsService, scope: \"singleton\"},\n    {type: PlayersService, scope: \"singleton\"},\n    {type: ChatService, scope: \"singleton\"},\n    {type: LobbyInteractionsService, scope: \"singleton\"},\n    {type: ThemesService, scope: \"singleton\"},\n    {type: LobbyConnectionService, scope: \"singleton\"},\n    {type: ColorsService, scope: \"singleton\"}\n  )\n  .registerSetups( /* register setup dependencies to the application */\n    PanelSetup,\n    ElementsSetup,\n    GameSettingsSetup,\n    GamePatchReadySetup,\n    SkribblMessageRelaySetup,\n    ToolbarSetup,\n    SkribblEmitRelaySetup,\n    ControlsSetup,\n    SkribblInitializedSetup,\n    ApiDataSetup,\n    ToastSetup,\n    ChatControlsSetup,\n    PrioritizedCanvasEventsSetup,\n    CssColorVarSelectorsSetup,\n    LandingPlayerSetup,\n    CustomizerActionsSetup\n  )\n  .registerEventProcessors( /* register event processors and their listeners */\n    lobbyJoinedEventRegistration,\n    lobbyLeftEventRegistration,\n    lobbyStateChangedEventRegistration,\n    hintsAddedEventRegistration,\n    lobbyPlayerChangedEventRegistration,\n    roundStartedEventRegistration,\n    wordGuessedEventRegistration,\n    drawEventRegistration,\n    imageResetEventRegistration,\n    messageSentEventRegistration,\n    messageReceivedEventRegistration,\n    chatTypedEventRegistration,\n    toolChangedEventRegistration,\n    sizeChangedEventRegistration,\n    colorChangedEventRegistration,\n    scoreboardVisibilityChangedEventRegistration,\n    playerPopupVisibilityChangedEventRegistration,\n    textOverlayVisibilityChangedEventRegistration,\n    lobbyInteractedEventRegistration,\n    canvasClearedEventRegistration\n  )\n  .registerFeatures( /* register application features */\n    UserInfoFeature,\n    PanelNewsFeature,\n    LobbyNavigationFeature,\n    ToolbarSaveFeature,\n    ToolbarImagePostFeature,\n    ToolbarChallengesFeature,\n    ToolbarFullscreenFeature,\n    ToolbarImageLabFeature,\n    ControlsSettingsFeature,\n    PanelChangelogFeature,\n    PanelLobbiesFeature,\n    PanelCabinFeature,\n    PanelFiltersFeature,\n    ChatRecallFeature,\n    ImageAgentFeature,\n    ControlsCloudFeature,\n    GuessCheckFeature,\n    LobbyStatusFeature,\n    PlayerSpritesFeature,\n    PlayerScenesFeature,\n    ChatEmojisFeature,\n    ChatProfileLinkFeature,\n    LoggingFeature,\n    HotkeysFeature,\n    CanvasZoomFeature,\n    LineToolFeature,\n    ChatFocusFeature,\n    PlayerIdsFeature,\n    LobbyTimeVisualizerFeature,\n    DrawingColorToolsFeature,\n    DrawingColorPalettesFeature,\n    ChatQuickReactFeature,\n    ControlsThemesFeature,\n    TooltipsFeature,\n    ChatCopyFormattedFeature,\n    DrawingPressureFeature,\n    ChatCommandsFeature,\n    DrawingBrushLabFeature,\n    DropsFeature,\n    PlayerAwardsFeature,\n    ChatClearFeature,\n    ChatMessageSplitsFeature,\n    CustomizerPracticeJoinFeature,\n    CustomizerOutfitToggleFeature,\n    CanvasRateIconsFeature\n  );\n\n/* indicate for interceptor that content script has loaded */\ninterceptor.triggerPatchInjection();\n\n"],"names":["Metadata","d","b","__awaiter","resolve","__generator","__spreadArray","from","v","instance","Subscription","_a","empty","timeout","Subscriber","ConsumerObserver","SafeSubscriber","Observable","subscribe","observable","Symbol_observable","init","OperatorSubscriber","err","Subject","AnonymousSubject","BehaviorSubject","Action","delay","AsyncAction","id","Scheduler","AsyncScheduler","isPromise","Symbol_iterator","process","repeat","iterator","config","TimeoutError","isArray","combineLatest","i","sourceIndex","asyncScheduler","merge","block","noop","ctx","create_if_block","create_if_block_1","BooleanSettingInput","TextSettingInput","NumericSettingInput","ChoiceSettingInput","Binding","MetadataReader","METADATA_KEY.PARAM_TYPES","METADATA_KEY.TAGGED","METADATA_KEY.TAGGED_PROP","ERROR_MSGS.STACK_OVERFLOW","getBindings","ERROR_MSGS.CIRCULAR_DEPENDENCY","func","Context","plan","METADATA_KEY.NAMED_TAG","Plan","LazyServiceIdentifier","QueryableString","Target","METADATA_KEY.MULTI_INJECT_TAG","metadata","METADATA_KEY.NON_CUSTOM_TAG_KEYS","METADATA_KEY.OPTIONAL_TAG","ERROR_MSGS.MISSING_INJECTABLE_ANNOTATION","isFunction","ERROR_MSGS.MISSING_INJECT_ANNOTATION","inject","METADATA_KEY.UNMANAGED_TAG","METADATA_KEY.INJECT_TAG","METADATA_KEY.NAME_TAG","Request","ERROR_MSGS.NOT_REGISTERED","ERROR_MSGS.AMBIGUOUS_MATCH","ERROR_MSGS.ARGUMENTS_LENGTH_MISMATCH","FactoryType","ERROR_MSGS.INVALID_BINDING_TYPE","__assign","METADATA_KEY.POST_CONSTRUCT","METADATA_KEY.PRE_DESTROY","ERROR_MSGS.CIRCULAR_DEPENDENCY_IN_FACTORY","BindingWhenSyntax","BindingOnSyntax","BindingWhenOnSyntax","BindingInSyntax","BindingInWhenOnSyntax","BindingToSyntax","ERROR_MSGS.INVALID_TO_SELF_VALUE","self","ERROR_MSGS.INVALID_FUNCTION_BINDING","ContainerSnapshot","Lookup","ERROR_MSGS.NULL_ARGUMENT","ERROR_MSGS.KEY_NOT_FOUND","ModuleActivationStore","Container","ERROR_MSGS.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT","ERROR_MSGS.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE","ERROR_MSGS.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE","ERROR_MSGS.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK","ERROR_MSGS.NO_MORE_SNAPSHOTS_AVAILABLE","ERROR_MSGS.ON_DEACTIVATION_ERROR","ERROR_MSGS.INVALID_MIDDLEWARE_RETURN","ERROR_MSGS.LAZY_IN_SYNC","ERROR_MSGS.ASYNC_UNBIND_REQUIRED","ERROR_MSGS.CANNOT_UNBIND","ERROR_MSGS.INVALID_DECORATOR_OPERATION","ERROR_MSGS.DUPLICATED_METADATA","m","ERRORS_MSGS.DUPLICATED_INJECTABLE_DECORATOR","METADATA_KEY.DESIGN_PARAM_TYPES","ERRORS_MSGS.MULTIPLE_POST_CONSTRUCT_METHODS","__publicField","__decorateClass","loggerFactory","__decorateParam","element","postConstruct","params","ChatControls","CustomizerIcons","ToastContainer","click_handler","PanelTabs","getElements","elements","skribblTool","CanvasRateIconsComponent","gameSettings","map","create_if_block_4","create_if_block_3","create_if_block_2","create_if_block_5","title","content","CanvasZoomInfo","runtime.BaseAPI","runtime.JSONApiResponse","runtime.RequiredError","runtime.VoidApiResponse","sum","MessageComponent","text","CommandInput","CommandPreview","AreaFlyout","IconButton","ChatEmojis","EmojiPicker","ChatFocusInfo","ChatMessageSplitsComponent","ChatProfileLink","last","QuickReact","scheduled","ModalDocument","ModalCard","result","ControlsSettings","_b","_d","_c","ControlsThemes","interval","DrawingBrushLabInfo","BrushLabGroup","BrushLabSwitch","BrushLabManage","func_2","ColorPalettesInfo","ColorPalettesManage","ColorPalettePicker","ColorToolsInfo","DrawingColorTools","DrawingPressureInfo","LogLevel","MessageType","HubConnectionState","HttpTransportType","TransferFormat","AbortController","DropsInfoComponent","DropsComponent","GuessCheck","images","ImageAgent","LineToolInfo","LobbyStatus","LobbyTimeVisualizerInfo","LoggingManage","LoggingInfo","PanelCabin","SpritePicker","ScenePicker","scene","PanelChangelog","filter","PanelFilters","FilterSearch","filters","FilterForm","PanelLobbies","OnlineItemTypeDto","AwardsComponent","AwardsDisplay","AwardPicker","SceneContainer","SpriteContainer","ToolbarPost","click_handler_5","ToolbarImageLab","commands","ImagelabPositionPicker","ToolbarSave","target","LobbyNavigation","UserInfo","PanelNews"],"mappings":"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C,CAAC,KAAM,yBAA0B,MAAO,WAAW,EACnD,CAAC,KAAM,cAAe,MAAO,WAAW,EACxC,CAAC,KAAM,uBAAwB,MAAO,WAAW,EACjD,CAAC,KAAM,cAAe,MAAO,WAAW,CAC1C,EACC,eACC,WACA,cACA,kBACA,oBACA,yBACA,aACA,sBACA,cACA,wBACA,aACA,WACA,kBACA,6BACA,0BACA,mBACA,sBACF,EACC,wBACC,6BACA,2BACA,mCACA,4BACA,oCACA,8BACA,6BACA,sBACA,4BACA,6BACA,iCACA,2BACA,6BACA,6BACA,8BACA,6CACA,8CACA,8CACA,iCACA,8BACF,EACC,iBACC,gBACA,iBACA,uBACA,mBACA,wBACA,yBACA,yBACA,uBACA,wBACA,sBACA,oBACA,kBACA,oBACA,kBACA,kBACA,qBACA,kBACA,mBACA,qBACA,oBACA,kBACA,uBACA,eACA,eACA,kBACA,gBACA,iBACA,iBACA,2BACA,yBACA,4BACA,sBACA,sBACA,gBACA,yBACA,uBACA,oBACA,uBACA,aACA,oBACA,iBACA,yBACA,8BACA,8BACA,sBACF,EAGF,YAAY,sBAAsB","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420]}